(function(e, undefined) {
  var t, n, r = typeof undefined,
    i = e.location,
    o = e.document,
    s = o.documentElement,
    a = e.jQuery,
    u = e.$,
    l = {},
    c = [],
    p = "2.0.3",
    f = c.concat,
    h = c.push,
    d = c.slice,
    g = c.indexOf,
    m = l.toString,
    y = l.hasOwnProperty,
    v = p.trim,
    x = function(e, n) {
      return new x.fn.init(e, n, t)
    },
    b = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
    w = /\S+/g,
    T = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
    C = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
    k = /^-ms-/,
    N = /-([\da-z])/gi,
    E = function(e, t) {
      return t.toUpperCase()
    },
    S = function() {
      o.removeEventListener("DOMContentLoaded", S, !1), e.removeEventListener("load", S, !1), x.ready()
    };
  x.fn = x.prototype = {
    jquery: p,
    constructor: x,
    init: function(e, t, n) {
      var r, i;
      if (!e) return this;
      if ("string" == typeof e) {
        if (r = "<" === e.charAt(0) && ">" === e.charAt(e.length - 1) && e.length >= 3 ? [null, e, null] : T.exec(e), !r || !r[1] && t) return !t || t.jquery ? (t || n).find(e) : this.constructor(t).find(e);
        if (r[1]) {
          if (t = t instanceof x ? t[0] : t, x.merge(this, x.parseHTML(r[1], t && t.nodeType ? t.ownerDocument || t : o, !0)), C.test(r[1]) && x.isPlainObject(t))
            for (r in t) x.isFunction(this[r]) ? this[r](t[r]) : this.attr(r, t[r]);
          return this
        }
        return i = o.getElementById(r[2]), i && i.parentNode && (this.length = 1, this[0] = i), this.context = o, this.selector = e, this
      }
      return e.nodeType ? (this.context = this[0] = e, this.length = 1, this) : x.isFunction(e) ? n.ready(e) : (e.selector !== undefined && (this.selector = e.selector, this.context = e.context), x.makeArray(e, this))
    },
    selector: "",
    length: 0,
    toArray: function() {
      return d.call(this)
    },
    get: function(e) {
      return null == e ? this.toArray() : 0 > e ? this[this.length + e] : this[e]
    },
    pushStack: function(e) {
      var t = x.merge(this.constructor(), e);
      return t.prevObject = this, t.context = this.context, t
    },
    each: function(e, t) {
      return x.each(this, e, t)
    },
    ready: function(e) {
      return x.ready.promise().done(e), this
    },
    slice: function() {
      return this.pushStack(d.apply(this, arguments))
    },
    first: function() {
      return this.eq(0)
    },
    last: function() {
      return this.eq(-1)
    },
    eq: function(e) {
      var t = this.length,
        n = +e + (0 > e ? t : 0);
      return this.pushStack(n >= 0 && t > n ? [this[n]] : [])
    },
    map: function(e) {
      return this.pushStack(x.map(this, function(t, n) {
        return e.call(t, n, t)
      }))
    },
    end: function() {
      return this.prevObject || this.constructor(null)
    },
    push: h,
    sort: [].sort,
    splice: [].splice
  }, x.fn.init.prototype = x.fn, x.extend = x.fn.extend = function() {
    var e, t, n, r, i, o, s = arguments[0] || {},
      a = 1,
      u = arguments.length,
      l = !1;
    for ("boolean" == typeof s && (l = s, s = arguments[1] || {}, a = 2), "object" == typeof s || x.isFunction(s) || (s = {}), u === a && (s = this, --a); u > a; a++)
      if (null != (e = arguments[a]))
        for (t in e) n = s[t], r = e[t], s !== r && (l && r && (x.isPlainObject(r) || (i = x.isArray(r))) ? (i ? (i = !1, o = n && x.isArray(n) ? n : []) : o = n && x.isPlainObject(n) ? n : {}, s[t] = x.extend(l, o, r)) : r !== undefined && (s[t] = r));
    return s
  }, x.extend({
    expando: "jQuery" + (p + Math.random()).replace(/\D/g, ""),
    noConflict: function(t) {
      return e.$ === x && (e.$ = u), t && e.jQuery === x && (e.jQuery = a), x
    },
    isReady: !1,
    readyWait: 1,
    holdReady: function(e) {
      e ? x.readyWait++ : x.ready(!0)
    },
    ready: function(e) {
      (e === !0 ? --x.readyWait : x.isReady) || (x.isReady = !0, e !== !0 && --x.readyWait > 0 || (n.resolveWith(o, [x]), x.fn.trigger && x(o).trigger("ready").off("ready")))
    },
    isFunction: function(e) {
      return "function" === x.type(e)
    },
    isArray: Array.isArray,
    isWindow: function(e) {
      return null != e && e === e.window
    },
    isNumeric: function(e) {
      return !isNaN(parseFloat(e)) && isFinite(e)
    },
    type: function(e) {
      return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? l[m.call(e)] || "object" : typeof e
    },
    isPlainObject: function(e) {
      if ("object" !== x.type(e) || e.nodeType || x.isWindow(e)) return !1;
      try {
        if (e.constructor && !y.call(e.constructor.prototype, "isPrototypeOf")) return !1
      } catch (t) {
        return !1
      }
      return !0
    },
    isEmptyObject: function(e) {
      var t;
      for (t in e) return !1;
      return !0
    },
    error: function(e) {
      throw Error(e)
    },
    parseHTML: function(e, t, n) {
      if (!e || "string" != typeof e) return null;
      "boolean" == typeof t && (n = t, t = !1), t = t || o;
      var r = C.exec(e),
        i = !n && [];
      return r ? [t.createElement(r[1])] : (r = x.buildFragment([e], t, i), i && x(i).remove(), x.merge([], r.childNodes))
    },
    parseJSON: JSON.parse,
    parseXML: function(e) {
      var t, n;
      if (!e || "string" != typeof e) return null;
      try {
        n = new DOMParser, t = n.parseFromString(e, "text/xml")
      } catch (r) {
        t = undefined
      }
      return (!t || t.getElementsByTagName("parsererror").length) && x.error("Invalid XML: " + e), t
    },
    noop: function() {},
    globalEval: function(e) {
      var t, n = eval;
      e = x.trim(e), e && (1 === e.indexOf("use strict") ? (t = o.createElement("script"), t.text = e, o.head.appendChild(t).parentNode.removeChild(t)) : n(e))
    },
    camelCase: function(e) {
      return e.replace(k, "ms-").replace(N, E)
    },
    nodeName: function(e, t) {
      return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase()
    },
    each: function(e, t, n) {
      var r, i = 0,
        o = e.length,
        s = j(e);
      if (n) {
        if (s) {
          for (; o > i; i++)
            if (r = t.apply(e[i], n), r === !1) break
        } else
          for (i in e)
            if (r = t.apply(e[i], n), r === !1) break
      } else if (s) {
        for (; o > i; i++)
          if (r = t.call(e[i], i, e[i]), r === !1) break
      } else
        for (i in e)
          if (r = t.call(e[i], i, e[i]), r === !1) break; return e
    },
    trim: function(e) {
      return null == e ? "" : v.call(e)
    },
    makeArray: function(e, t) {
      var n = t || [];
      return null != e && (j(Object(e)) ? x.merge(n, "string" == typeof e ? [e] : e) : h.call(n, e)), n
    },
    inArray: function(e, t, n) {
      return null == t ? -1 : g.call(t, e, n)
    },
    merge: function(e, t) {
      var n = t.length,
        r = e.length,
        i = 0;
      if ("number" == typeof n)
        for (; n > i; i++) e[r++] = t[i];
      else
        while (t[i] !== undefined) e[r++] = t[i++];
      return e.length = r, e
    },
    grep: function(e, t, n) {
      var r, i = [],
        o = 0,
        s = e.length;
      for (n = !!n; s > o; o++) r = !!t(e[o], o), n !== r && i.push(e[o]);
      return i
    },
    map: function(e, t, n) {
      var r, i = 0,
        o = e.length,
        s = j(e),
        a = [];
      if (s)
        for (; o > i; i++) r = t(e[i], i, n), null != r && (a[a.length] = r);
      else
        for (i in e) r = t(e[i], i, n), null != r && (a[a.length] = r);
      return f.apply([], a)
    },
    guid: 1,
    proxy: function(e, t) {
      var n, r, i;
      return "string" == typeof t && (n = e[t], t = e, e = n), x.isFunction(e) ? (r = d.call(arguments, 2), i = function() {
        return e.apply(t || this, r.concat(d.call(arguments)))
      }, i.guid = e.guid = e.guid || x.guid++, i) : undefined
    },
    access: function(e, t, n, r, i, o, s) {
      var a = 0,
        u = e.length,
        l = null == n;
      if ("object" === x.type(n)) {
        i = !0;
        for (a in n) x.access(e, t, a, n[a], !0, o, s)
      } else if (r !== undefined && (i = !0, x.isFunction(r) || (s = !0), l && (s ? (t.call(e, r), t = null) : (l = t, t = function(e, t, n) {
          return l.call(x(e), n)
        })), t))
        for (; u > a; a++) t(e[a], n, s ? r : r.call(e[a], a, t(e[a], n)));
      return i ? e : l ? t.call(e) : u ? t(e[0], n) : o
    },
    now: Date.now,
    swap: function(e, t, n, r) {
      var i, o, s = {};
      for (o in t) s[o] = e.style[o], e.style[o] = t[o];
      i = n.apply(e, r || []);
      for (o in t) e.style[o] = s[o];
      return i
    }
  }), x.ready.promise = function(t) {
    return n || (n = x.Deferred(), "complete" === o.readyState ? setTimeout(x.ready) : (o.addEventListener("DOMContentLoaded", S, !1), e.addEventListener("load", S, !1))), n.promise(t)
  }, x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(e, t) {
    l["[object " + t + "]"] = t.toLowerCase()
  });

  function j(e) {
    var t = e.length,
      n = x.type(e);
    return x.isWindow(e) ? !1 : 1 === e.nodeType && t ? !0 : "array" === n || "function" !== n && (0 === t || "number" == typeof t && t > 0 && t - 1 in e)
  }
  t = x(o),
    function(e, undefined) {
      var t, n, r, i, o, s, a, u, l, c, p, f, h, d, g, m, y, v = "sizzle" + -new Date,
        b = e.document,
        w = 0,
        T = 0,
        C = st(),
        k = st(),
        N = st(),
        E = !1,
        S = function(e, t) {
          return e === t ? (E = !0, 0) : 0
        },
        j = typeof undefined,
        D = 1 << 31,
        A = {}.hasOwnProperty,
        L = [],
        q = L.pop,
        H = L.push,
        O = L.push,
        F = L.slice,
        P = L.indexOf || function(e) {
          var t = 0,
            n = this.length;
          for (; n > t; t++)
            if (this[t] === e) return t;
          return -1
        },
        R = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
        M = "[\\x20\\t\\r\\n\\f]",
        W = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
        $ = W.replace("w", "w#"),
        B = "\\[" + M + "*(" + W + ")" + M + "*(?:([*^$|!~]?=)" + M + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + $ + ")|)|)" + M + "*\\]",
        I = ":(" + W + ")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|" + B.replace(3, 8) + ")*)|.*)\\)|)",
        z = RegExp("^" + M + "+|((?:^|[^\\\\])(?:\\\\.)*)" + M + "+$", "g"),
        _ = RegExp("^" + M + "*," + M + "*"),
        X = RegExp("^" + M + "*([>+~]|" + M + ")" + M + "*"),
        U = RegExp(M + "*[+~]"),
        Y = RegExp("=" + M + "*([^\\]'\"]*)" + M + "*\\]", "g"),
        V = RegExp(I),
        G = RegExp("^" + $ + "$"),
        J = {
          ID: RegExp("^#(" + W + ")"),
          CLASS: RegExp("^\\.(" + W + ")"),
          TAG: RegExp("^(" + W.replace("w", "w*") + ")"),
          ATTR: RegExp("^" + B),
          PSEUDO: RegExp("^" + I),
          CHILD: RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + M + "*(even|odd|(([+-]|)(\\d*)n|)" + M + "*(?:([+-]|)" + M + "*(\\d+)|))" + M + "*\\)|)", "i"),
          bool: RegExp("^(?:" + R + ")$", "i"),
          needsContext: RegExp("^" + M + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + M + "*((?:-\\d)?\\d*)" + M + "*\\)|)(?=[^-]|$)", "i")
        },
        Q = /^[^{]+\{\s*\[native \w/,
        K = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
        Z = /^(?:input|select|textarea|button)$/i,
        et = /^h\d$/i,
        tt = /'|\\/g,
        nt = RegExp("\\\\([\\da-f]{1,6}" + M + "?|(" + M + ")|.)", "ig"),
        rt = function(e, t, n) {
          var r = "0x" + t - 65536;
          return r !== r || n ? t : 0 > r ? String.fromCharCode(r + 65536) : String.fromCharCode(55296 | r >> 10, 56320 | 1023 & r)
        };
      try {
        O.apply(L = F.call(b.childNodes), b.childNodes), L[b.childNodes.length].nodeType
      } catch (it) {
        O = {
          apply: L.length ? function(e, t) {
            H.apply(e, F.call(t))
          } : function(e, t) {
            var n = e.length,
              r = 0;
            while (e[n++] = t[r++]);
            e.length = n - 1
          }
        }
      }

      function ot(e, t, r, i) {
        var o, s, a, u, l, f, g, m, x, w;
        if ((t ? t.ownerDocument || t : b) !== p && c(t), t = t || p, r = r || [], !e || "string" != typeof e) return r;
        if (1 !== (u = t.nodeType) && 9 !== u) return [];
        if (h && !i) {
          if (o = K.exec(e))
            if (a = o[1]) {
              if (9 === u) {
                if (s = t.getElementById(a), !s || !s.parentNode) return r;
                if (s.id === a) return r.push(s), r
              } else if (t.ownerDocument && (s = t.ownerDocument.getElementById(a)) && y(t, s) && s.id === a) return r.push(s), r
            } else {
              if (o[2]) return O.apply(r, t.getElementsByTagName(e)), r;
              if ((a = o[3]) && n.getElementsByClassName && t.getElementsByClassName) return O.apply(r, t.getElementsByClassName(a)), r
            }
          if (n.qsa && (!d || !d.test(e))) {
            if (m = g = v, x = t, w = 9 === u && e, 1 === u && "object" !== t.nodeName.toLowerCase()) {
              f = gt(e), (g = t.getAttribute("id")) ? m = g.replace(tt, "\\$&") : t.setAttribute("id", m), m = "[id='" + m + "'] ", l = f.length;
              while (l--) f[l] = m + mt(f[l]);
              x = U.test(e) && t.parentNode || t, w = f.join(",")
            }
            if (w) try {
              return O.apply(r, x.querySelectorAll(w)), r
            } catch (T) {} finally {
              g || t.removeAttribute("id")
            }
          }
        }
        return kt(e.replace(z, "$1"), t, r, i)
      }

      function st() {
        var e = [];

        function t(n, r) {
          return e.push(n += " ") > i.cacheLength && delete t[e.shift()], t[n] = r
        }
        return t
      }

      function at(e) {
        return e[v] = !0, e
      }

      function ut(e) {
        var t = p.createElement("div");
        try {
          return !!e(t)
        } catch (n) {
          return !1
        } finally {
          t.parentNode && t.parentNode.removeChild(t), t = null
        }
      }

      function lt(e, t) {
        var n = e.split("|"),
          r = e.length;
        while (r--) i.attrHandle[n[r]] = t
      }

      function ct(e, t) {
        var n = t && e,
          r = n && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || D) - (~e.sourceIndex || D);
        if (r) return r;
        if (n)
          while (n = n.nextSibling)
            if (n === t) return -1;
        return e ? 1 : -1
      }

      function pt(e) {
        return function(t) {
          var n = t.nodeName.toLowerCase();
          return "input" === n && t.type === e
        }
      }

      function ft(e) {
        return function(t) {
          var n = t.nodeName.toLowerCase();
          return ("input" === n || "button" === n) && t.type === e
        }
      }

      function ht(e) {
        return at(function(t) {
          return t = +t, at(function(n, r) {
            var i, o = e([], n.length, t),
              s = o.length;
            while (s--) n[i = o[s]] && (n[i] = !(r[i] = n[i]))
          })
        })
      }
      s = ot.isXML = function(e) {
        var t = e && (e.ownerDocument || e).documentElement;
        return t ? "HTML" !== t.nodeName : !1
      }, n = ot.support = {}, c = ot.setDocument = function(e) {
        var t = e ? e.ownerDocument || e : b,
          r = t.defaultView;
        return t !== p && 9 === t.nodeType && t.documentElement ? (p = t, f = t.documentElement, h = !s(t), r && r.attachEvent && r !== r.top && r.attachEvent("onbeforeunload", function() {
          c()
        }), n.attributes = ut(function(e) {
          return e.className = "i", !e.getAttribute("className")
        }), n.getElementsByTagName = ut(function(e) {
          return e.appendChild(t.createComment("")), !e.getElementsByTagName("*").length
        }), n.getElementsByClassName = ut(function(e) {
          return e.innerHTML = "<div class='a'></div><div class='a i'></div>", e.firstChild.className = "i", 2 === e.getElementsByClassName("i").length
        }), n.getById = ut(function(e) {
          return f.appendChild(e).id = v, !t.getElementsByName || !t.getElementsByName(v).length
        }), n.getById ? (i.find.ID = function(e, t) {
          if (typeof t.getElementById !== j && h) {
            var n = t.getElementById(e);
            return n && n.parentNode ? [n] : []
          }
        }, i.filter.ID = function(e) {
          var t = e.replace(nt, rt);
          return function(e) {
            return e.getAttribute("id") === t
          }
        }) : (delete i.find.ID, i.filter.ID = function(e) {
          var t = e.replace(nt, rt);
          return function(e) {
            var n = typeof e.getAttributeNode !== j && e.getAttributeNode("id");
            return n && n.value === t
          }
        }), i.find.TAG = n.getElementsByTagName ? function(e, t) {
          return typeof t.getElementsByTagName !== j ? t.getElementsByTagName(e) : undefined
        } : function(e, t) {
          var n, r = [],
            i = 0,
            o = t.getElementsByTagName(e);
          if ("*" === e) {
            while (n = o[i++]) 1 === n.nodeType && r.push(n);
            return r
          }
          return o
        }, i.find.CLASS = n.getElementsByClassName && function(e, t) {
          return typeof t.getElementsByClassName !== j && h ? t.getElementsByClassName(e) : undefined
        }, g = [], d = [], (n.qsa = Q.test(t.querySelectorAll)) && (ut(function(e) {
          e.innerHTML = "<select><option selected=''></option></select>", e.querySelectorAll("[selected]").length || d.push("\\[" + M + "*(?:value|" + R + ")"), e.querySelectorAll(":checked").length || d.push(":checked")
        }), ut(function(e) {
          var n = t.createElement("input");
          n.setAttribute("type", "hidden"), e.appendChild(n).setAttribute("t", ""), e.querySelectorAll("[t^='']").length && d.push("[*^$]=" + M + "*(?:''|\"\")"), e.querySelectorAll(":enabled").length || d.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), d.push(",.*:")
        })), (n.matchesSelector = Q.test(m = f.webkitMatchesSelector || f.mozMatchesSelector || f.oMatchesSelector || f.msMatchesSelector)) && ut(function(e) {
          n.disconnectedMatch = m.call(e, "div"), m.call(e, "[s!='']:x"), g.push("!=", I)
        }), d = d.length && RegExp(d.join("|")), g = g.length && RegExp(g.join("|")), y = Q.test(f.contains) || f.compareDocumentPosition ? function(e, t) {
          var n = 9 === e.nodeType ? e.documentElement : e,
            r = t && t.parentNode;
          return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r)))
        } : function(e, t) {
          if (t)
            while (t = t.parentNode)
              if (t === e) return !0;
          return !1
        }, S = f.compareDocumentPosition ? function(e, r) {
          if (e === r) return E = !0, 0;
          var i = r.compareDocumentPosition && e.compareDocumentPosition && e.compareDocumentPosition(r);
          return i ? 1 & i || !n.sortDetached && r.compareDocumentPosition(e) === i ? e === t || y(b, e) ? -1 : r === t || y(b, r) ? 1 : l ? P.call(l, e) - P.call(l, r) : 0 : 4 & i ? -1 : 1 : e.compareDocumentPosition ? -1 : 1
        } : function(e, n) {
          var r, i = 0,
            o = e.parentNode,
            s = n.parentNode,
            a = [e],
            u = [n];
          if (e === n) return E = !0, 0;
          if (!o || !s) return e === t ? -1 : n === t ? 1 : o ? -1 : s ? 1 : l ? P.call(l, e) - P.call(l, n) : 0;
          if (o === s) return ct(e, n);
          r = e;
          while (r = r.parentNode) a.unshift(r);
          r = n;
          while (r = r.parentNode) u.unshift(r);
          while (a[i] === u[i]) i++;
          return i ? ct(a[i], u[i]) : a[i] === b ? -1 : u[i] === b ? 1 : 0
        }, t) : p
      }, ot.matches = function(e, t) {
        return ot(e, null, null, t)
      }, ot.matchesSelector = function(e, t) {
        if ((e.ownerDocument || e) !== p && c(e), t = t.replace(Y, "='$1']"), !(!n.matchesSelector || !h || g && g.test(t) || d && d.test(t))) try {
          var r = m.call(e, t);
          if (r || n.disconnectedMatch || e.document && 11 !== e.document.nodeType) return r
        } catch (i) {}
        return ot(t, p, null, [e]).length > 0
      }, ot.contains = function(e, t) {
        return (e.ownerDocument || e) !== p && c(e), y(e, t)
      }, ot.attr = function(e, t) {
        (e.ownerDocument || e) !== p && c(e);
        var r = i.attrHandle[t.toLowerCase()],
          o = r && A.call(i.attrHandle, t.toLowerCase()) ? r(e, t, !h) : undefined;
        return o === undefined ? n.attributes || !h ? e.getAttribute(t) : (o = e.getAttributeNode(t)) && o.specified ? o.value : null : o
      }, ot.error = function(e) {
        throw Error("Syntax error, unrecognized expression: " + e)
      }, ot.uniqueSort = function(e) {
        var t, r = [],
          i = 0,
          o = 0;
        if (E = !n.detectDuplicates, l = !n.sortStable && e.slice(0), e.sort(S), E) {
          while (t = e[o++]) t === e[o] && (i = r.push(o));
          while (i--) e.splice(r[i], 1)
        }
        return e
      }, o = ot.getText = function(e) {
        var t, n = "",
          r = 0,
          i = e.nodeType;
        if (i) {
          if (1 === i || 9 === i || 11 === i) {
            if ("string" == typeof e.textContent) return e.textContent;
            for (e = e.firstChild; e; e = e.nextSibling) n += o(e)
          } else if (3 === i || 4 === i) return e.nodeValue
        } else
          for (; t = e[r]; r++) n += o(t);
        return n
      }, i = ot.selectors = {
        cacheLength: 50,
        createPseudo: at,
        match: J,
        attrHandle: {},
        find: {},
        relative: {
          ">": {
            dir: "parentNode",
            first: !0
          },
          " ": {
            dir: "parentNode"
          },
          "+": {
            dir: "previousSibling",
            first: !0
          },
          "~": {
            dir: "previousSibling"
          }
        },
        preFilter: {
          ATTR: function(e) {
            return e[1] = e[1].replace(nt, rt), e[3] = (e[4] || e[5] || "").replace(nt, rt), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4)
          },
          CHILD: function(e) {
            return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || ot.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && ot.error(e[0]), e
          },
          PSEUDO: function(e) {
            var t, n = !e[5] && e[2];
            return J.CHILD.test(e[0]) ? null : (e[3] && e[4] !== undefined ? e[2] = e[4] : n && V.test(n) && (t = gt(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3))
          }
        },
        filter: {
          TAG: function(e) {
            var t = e.replace(nt, rt).toLowerCase();
            return "*" === e ? function() {
              return !0
            } : function(e) {
              return e.nodeName && e.nodeName.toLowerCase() === t
            }
          },
          CLASS: function(e) {
            var t = C[e + " "];
            return t || (t = RegExp("(^|" + M + ")" + e + "(" + M + "|$)")) && C(e, function(e) {
              return t.test("string" == typeof e.className && e.className || typeof e.getAttribute !== j && e.getAttribute("class") || "")
            })
          },
          ATTR: function(e, t, n) {
            return function(r) {
              var i = ot.attr(r, e);
              return null == i ? "!=" === t : t ? (i += "", "=" === t ? i === n : "!=" === t ? i !== n : "^=" === t ? n && 0 === i.indexOf(n) : "*=" === t ? n && i.indexOf(n) > -1 : "$=" === t ? n && i.slice(-n.length) === n : "~=" === t ? (" " + i + " ").indexOf(n) > -1 : "|=" === t ? i === n || i.slice(0, n.length + 1) === n + "-" : !1) : !0
            }
          },
          CHILD: function(e, t, n, r, i) {
            var o = "nth" !== e.slice(0, 3),
              s = "last" !== e.slice(-4),
              a = "of-type" === t;
            return 1 === r && 0 === i ? function(e) {
              return !!e.parentNode
            } : function(t, n, u) {
              var l, c, p, f, h, d, g = o !== s ? "nextSibling" : "previousSibling",
                m = t.parentNode,
                y = a && t.nodeName.toLowerCase(),
                x = !u && !a;
              if (m) {
                if (o) {
                  while (g) {
                    p = t;
                    while (p = p[g])
                      if (a ? p.nodeName.toLowerCase() === y : 1 === p.nodeType) return !1;
                    d = g = "only" === e && !d && "nextSibling"
                  }
                  return !0
                }
                if (d = [s ? m.firstChild : m.lastChild], s && x) {
                  c = m[v] || (m[v] = {}), l = c[e] || [], h = l[0] === w && l[1], f = l[0] === w && l[2], p = h && m.childNodes[h];
                  while (p = ++h && p && p[g] || (f = h = 0) || d.pop())
                    if (1 === p.nodeType && ++f && p === t) {
                      c[e] = [w, h, f];
                      break
                    }
                } else if (x && (l = (t[v] || (t[v] = {}))[e]) && l[0] === w) f = l[1];
                else
                  while (p = ++h && p && p[g] || (f = h = 0) || d.pop())
                    if ((a ? p.nodeName.toLowerCase() === y : 1 === p.nodeType) && ++f && (x && ((p[v] || (p[v] = {}))[e] = [w, f]), p === t)) break; return f -= i, f === r || 0 === f % r && f / r >= 0
              }
            }
          },
          PSEUDO: function(e, t) {
            var n, r = i.pseudos[e] || i.setFilters[e.toLowerCase()] || ot.error("unsupported pseudo: " + e);
            return r[v] ? r(t) : r.length > 1 ? (n = [e, e, "", t], i.setFilters.hasOwnProperty(e.toLowerCase()) ? at(function(e, n) {
              var i, o = r(e, t),
                s = o.length;
              while (s--) i = P.call(e, o[s]), e[i] = !(n[i] = o[s])
            }) : function(e) {
              return r(e, 0, n)
            }) : r
          }
        },
        pseudos: {
          not: at(function(e) {
            var t = [],
              n = [],
              r = a(e.replace(z, "$1"));
            return r[v] ? at(function(e, t, n, i) {
              var o, s = r(e, null, i, []),
                a = e.length;
              while (a--)(o = s[a]) && (e[a] = !(t[a] = o))
            }) : function(e, i, o) {
              return t[0] = e, r(t, null, o, n), !n.pop()
            }
          }),
          has: at(function(e) {
            return function(t) {
              return ot(e, t).length > 0
            }
          }),
          contains: at(function(e) {
            return function(t) {
              return (t.textContent || t.innerText || o(t)).indexOf(e) > -1
            }
          }),
          lang: at(function(e) {
            return G.test(e || "") || ot.error("unsupported lang: " + e), e = e.replace(nt, rt).toLowerCase(),
              function(t) {
                var n;
                do
                  if (n = h ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang")) return n = n.toLowerCase(), n === e || 0 === n.indexOf(e + "-");
                while ((t = t.parentNode) && 1 === t.nodeType);
                return !1
              }
          }),
          target: function(t) {
            var n = e.location && e.location.hash;
            return n && n.slice(1) === t.id
          },
          root: function(e) {
            return e === f
          },
          focus: function(e) {
            return e === p.activeElement && (!p.hasFocus || p.hasFocus()) && !!(e.type || e.href || ~e.tabIndex)
          },
          enabled: function(e) {
            return e.disabled === !1
          },
          disabled: function(e) {
            return e.disabled === !0
          },
          checked: function(e) {
            var t = e.nodeName.toLowerCase();
            return "input" === t && !!e.checked || "option" === t && !!e.selected
          },
          selected: function(e) {
            return e.parentNode && e.parentNode.selectedIndex, e.selected === !0
          },
          empty: function(e) {
            for (e = e.firstChild; e; e = e.nextSibling)
              if (e.nodeName > "@" || 3 === e.nodeType || 4 === e.nodeType) return !1;
            return !0
          },
          parent: function(e) {
            return !i.pseudos.empty(e)
          },
          header: function(e) {
            return et.test(e.nodeName)
          },
          input: function(e) {
            return Z.test(e.nodeName)
          },
          button: function(e) {
            var t = e.nodeName.toLowerCase();
            return "input" === t && "button" === e.type || "button" === t
          },
          text: function(e) {
            var t;
            return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || t.toLowerCase() === e.type)
          },
          first: ht(function() {
            return [0]
          }),
          last: ht(function(e, t) {
            return [t - 1]
          }),
          eq: ht(function(e, t, n) {
            return [0 > n ? n + t : n]
          }),
          even: ht(function(e, t) {
            var n = 0;
            for (; t > n; n += 2) e.push(n);
            return e
          }),
          odd: ht(function(e, t) {
            var n = 1;
            for (; t > n; n += 2) e.push(n);
            return e
          }),
          lt: ht(function(e, t, n) {
            var r = 0 > n ? n + t : n;
            for (; --r >= 0;) e.push(r);
            return e
          }),
          gt: ht(function(e, t, n) {
            var r = 0 > n ? n + t : n;
            for (; t > ++r;) e.push(r);
            return e
          })
        }
      }, i.pseudos.nth = i.pseudos.eq;
      for (t in {
          radio: !0,
          checkbox: !0,
          file: !0,
          password: !0,
          image: !0
        }) i.pseudos[t] = pt(t);
      for (t in {
          submit: !0,
          reset: !0
        }) i.pseudos[t] = ft(t);

      function dt() {}
      dt.prototype = i.filters = i.pseudos, i.setFilters = new dt;

      function gt(e, t) {
        var n, r, o, s, a, u, l, c = k[e + " "];
        if (c) return t ? 0 : c.slice(0);
        a = e, u = [], l = i.preFilter;
        while (a) {
          (!n || (r = _.exec(a))) && (r && (a = a.slice(r[0].length) || a), u.push(o = [])), n = !1, (r = X.exec(a)) && (n = r.shift(), o.push({
            value: n,
            type: r[0].replace(z, " ")
          }), a = a.slice(n.length));
          for (s in i.filter) !(r = J[s].exec(a)) || l[s] && !(r = l[s](r)) || (n = r.shift(), o.push({
            value: n,
            type: s,
            matches: r
          }), a = a.slice(n.length));
          if (!n) break
        }
        return t ? a.length : a ? ot.error(e) : k(e, u).slice(0)
      }

      function mt(e) {
        var t = 0,
          n = e.length,
          r = "";
        for (; n > t; t++) r += e[t].value;
        return r
      }

      function yt(e, t, n) {
        var i = t.dir,
          o = n && "parentNode" === i,
          s = T++;
        return t.first ? function(t, n, r) {
          while (t = t[i])
            if (1 === t.nodeType || o) return e(t, n, r)
        } : function(t, n, a) {
          var u, l, c, p = w + " " + s;
          if (a) {
            while (t = t[i])
              if ((1 === t.nodeType || o) && e(t, n, a)) return !0
          } else
            while (t = t[i])
              if (1 === t.nodeType || o)
                if (c = t[v] || (t[v] = {}), (l = c[i]) && l[0] === p) {
                  if ((u = l[1]) === !0 || u === r) return u === !0
                } else if (l = c[i] = [p], l[1] = e(t, n, a) || r, l[1] === !0) return !0
        }
      }

      function vt(e) {
        return e.length > 1 ? function(t, n, r) {
          var i = e.length;
          while (i--)
            if (!e[i](t, n, r)) return !1;
          return !0
        } : e[0]
      }

      function xt(e, t, n, r, i) {
        var o, s = [],
          a = 0,
          u = e.length,
          l = null != t;
        for (; u > a; a++)(o = e[a]) && (!n || n(o, r, i)) && (s.push(o), l && t.push(a));
        return s
      }

      function bt(e, t, n, r, i, o) {
        return r && !r[v] && (r = bt(r)), i && !i[v] && (i = bt(i, o)), at(function(o, s, a, u) {
          var l, c, p, f = [],
            h = [],
            d = s.length,
            g = o || Ct(t || "*", a.nodeType ? [a] : a, []),
            m = !e || !o && t ? g : xt(g, f, e, a, u),
            y = n ? i || (o ? e : d || r) ? [] : s : m;
          if (n && n(m, y, a, u), r) {
            l = xt(y, h), r(l, [], a, u), c = l.length;
            while (c--)(p = l[c]) && (y[h[c]] = !(m[h[c]] = p))
          }
          if (o) {
            if (i || e) {
              if (i) {
                l = [], c = y.length;
                while (c--)(p = y[c]) && l.push(m[c] = p);
                i(null, y = [], l, u)
              }
              c = y.length;
              while (c--)(p = y[c]) && (l = i ? P.call(o, p) : f[c]) > -1 && (o[l] = !(s[l] = p))
            }
          } else y = xt(y === s ? y.splice(d, y.length) : y), i ? i(null, s, y, u) : O.apply(s, y)
        })
      }

      function wt(e) {
        var t, n, r, o = e.length,
          s = i.relative[e[0].type],
          a = s || i.relative[" "],
          l = s ? 1 : 0,
          c = yt(function(e) {
            return e === t
          }, a, !0),
          p = yt(function(e) {
            return P.call(t, e) > -1
          }, a, !0),
          f = [function(e, n, r) {
            return !s && (r || n !== u) || ((t = n).nodeType ? c(e, n, r) : p(e, n, r))
          }];
        for (; o > l; l++)
          if (n = i.relative[e[l].type]) f = [yt(vt(f), n)];
          else {
            if (n = i.filter[e[l].type].apply(null, e[l].matches), n[v]) {
              for (r = ++l; o > r; r++)
                if (i.relative[e[r].type]) break;
              return bt(l > 1 && vt(f), l > 1 && mt(e.slice(0, l - 1).concat({
                value: " " === e[l - 2].type ? "*" : ""
              })).replace(z, "$1"), n, r > l && wt(e.slice(l, r)), o > r && wt(e = e.slice(r)), o > r && mt(e))
            }
            f.push(n)
          }
        return vt(f)
      }

      function Tt(e, t) {
        var n = 0,
          o = t.length > 0,
          s = e.length > 0,
          a = function(a, l, c, f, h) {
            var d, g, m, y = [],
              v = 0,
              x = "0",
              b = a && [],
              T = null != h,
              C = u,
              k = a || s && i.find.TAG("*", h && l.parentNode || l),
              N = w += null == C ? 1 : Math.random() || .1;
            for (T && (u = l !== p && l, r = n); null != (d = k[x]); x++) {
              if (s && d) {
                g = 0;
                while (m = e[g++])
                  if (m(d, l, c)) {
                    f.push(d);
                    break
                  }
                T && (w = N, r = ++n)
              }
              o && ((d = !m && d) && v--, a && b.push(d))
            }
            if (v += x, o && x !== v) {
              g = 0;
              while (m = t[g++]) m(b, y, l, c);
              if (a) {
                if (v > 0)
                  while (x--) b[x] || y[x] || (y[x] = q.call(f));
                y = xt(y)
              }
              O.apply(f, y), T && !a && y.length > 0 && v + t.length > 1 && ot.uniqueSort(f)
            }
            return T && (w = N, u = C), b
          };
        return o ? at(a) : a
      }
      a = ot.compile = function(e, t) {
        var n, r = [],
          i = [],
          o = N[e + " "];
        if (!o) {
          t || (t = gt(e)), n = t.length;
          while (n--) o = wt(t[n]), o[v] ? r.push(o) : i.push(o);
          o = N(e, Tt(i, r))
        }
        return o
      };

      function Ct(e, t, n) {
        var r = 0,
          i = t.length;
        for (; i > r; r++) ot(e, t[r], n);
        return n
      }

      function kt(e, t, r, o) {
        var s, u, l, c, p, f = gt(e);
        if (!o && 1 === f.length) {
          if (u = f[0] = f[0].slice(0), u.length > 2 && "ID" === (l = u[0]).type && n.getById && 9 === t.nodeType && h && i.relative[u[1].type]) {
            if (t = (i.find.ID(l.matches[0].replace(nt, rt), t) || [])[0], !t) return r;
            e = e.slice(u.shift().value.length)
          }
          s = J.needsContext.test(e) ? 0 : u.length;
          while (s--) {
            if (l = u[s], i.relative[c = l.type]) break;
            if ((p = i.find[c]) && (o = p(l.matches[0].replace(nt, rt), U.test(u[0].type) && t.parentNode || t))) {
              if (u.splice(s, 1), e = o.length && mt(u), !e) return O.apply(r, o), r;
              break
            }
          }
        }
        return a(e, f)(o, t, !h, r, U.test(e)), r
      }
      n.sortStable = v.split("").sort(S).join("") === v, n.detectDuplicates = E, c(), n.sortDetached = ut(function(e) {
        return 1 & e.compareDocumentPosition(p.createElement("div"))
      }), ut(function(e) {
        return e.innerHTML = "<a href='#'></a>", "#" === e.firstChild.getAttribute("href")
      }) || lt("type|href|height|width", function(e, t, n) {
        return n ? undefined : e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2)
      }), n.attributes && ut(function(e) {
        return e.innerHTML = "<input/>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value")
      }) || lt("value", function(e, t, n) {
        return n || "input" !== e.nodeName.toLowerCase() ? undefined : e.defaultValue
      }), ut(function(e) {
        return null == e.getAttribute("disabled")
      }) || lt(R, function(e, t, n) {
        var r;
        return n ? undefined : (r = e.getAttributeNode(t)) && r.specified ? r.value : e[t] === !0 ? t.toLowerCase() : null
      }), x.find = ot, x.expr = ot.selectors, x.expr[":"] = x.expr.pseudos, x.unique = ot.uniqueSort, x.text = ot.getText, x.isXMLDoc = ot.isXML, x.contains = ot.contains
    }(e);
  var D = {};

  function A(e) {
    var t = D[e] = {};
    return x.each(e.match(w) || [], function(e, n) {
      t[n] = !0
    }), t
  }
  x.Callbacks = function(e) {
    e = "string" == typeof e ? D[e] || A(e) : x.extend({}, e);
    var t, n, r, i, o, s, a = [],
      u = !e.once && [],
      l = function(p) {
        for (t = e.memory && p, n = !0, s = i || 0, i = 0, o = a.length, r = !0; a && o > s; s++)
          if (a[s].apply(p[0], p[1]) === !1 && e.stopOnFalse) {
            t = !1;
            break
          }
        r = !1, a && (u ? u.length && l(u.shift()) : t ? a = [] : c.disable())
      },
      c = {
        add: function() {
          if (a) {
            var n = a.length;
            (function s(t) {
              x.each(t, function(t, n) {
                var r = x.type(n);
                "function" === r ? e.unique && c.has(n) || a.push(n) : n && n.length && "string" !== r && s(n)
              })
            })(arguments), r ? o = a.length : t && (i = n, l(t))
          }
          return this
        },
        remove: function() {
          return a && x.each(arguments, function(e, t) {
            var n;
            while ((n = x.inArray(t, a, n)) > -1) a.splice(n, 1), r && (o >= n && o--, s >= n && s--)
          }), this
        },
        has: function(e) {
          return e ? x.inArray(e, a) > -1 : !(!a || !a.length)
        },
        empty: function() {
          return a = [], o = 0, this
        },
        disable: function() {
          return a = u = t = undefined, this
        },
        disabled: function() {
          return !a
        },
        lock: function() {
          return u = undefined, t || c.disable(), this
        },
        locked: function() {
          return !u
        },
        fireWith: function(e, t) {
          return !a || n && !u || (t = t || [], t = [e, t.slice ? t.slice() : t], r ? u.push(t) : l(t)), this
        },
        fire: function() {
          return c.fireWith(this, arguments), this
        },
        fired: function() {
          return !!n
        }
      };
    return c
  }, x.extend({
    Deferred: function(e) {
      var t = [
          ["resolve", "done", x.Callbacks("once memory"), "resolved"],
          ["reject", "fail", x.Callbacks("once memory"), "rejected"],
          ["notify", "progress", x.Callbacks("memory")]
        ],
        n = "pending",
        r = {
          state: function() {
            return n
          },
          always: function() {
            return i.done(arguments).fail(arguments), this
          },
          then: function() {
            var e = arguments;
            return x.Deferred(function(n) {
              x.each(t, function(t, o) {
                var s = o[0],
                  a = x.isFunction(e[t]) && e[t];
                i[o[1]](function() {
                  var e = a && a.apply(this, arguments);
                  e && x.isFunction(e.promise) ? e.promise().done(n.resolve).fail(n.reject).progress(n.notify) : n[s + "With"](this === r ? n.promise() : this, a ? [e] : arguments)
                })
              }), e = null
            }).promise()
          },
          promise: function(e) {
            return null != e ? x.extend(e, r) : r
          }
        },
        i = {};
      return r.pipe = r.then, x.each(t, function(e, o) {
        var s = o[2],
          a = o[3];
        r[o[1]] = s.add, a && s.add(function() {
          n = a
        }, t[1 ^ e][2].disable, t[2][2].lock), i[o[0]] = function() {
          return i[o[0] + "With"](this === i ? r : this, arguments), this
        }, i[o[0] + "With"] = s.fireWith
      }), r.promise(i), e && e.call(i, i), i
    },
    when: function(e) {
      var t = 0,
        n = d.call(arguments),
        r = n.length,
        i = 1 !== r || e && x.isFunction(e.promise) ? r : 0,
        o = 1 === i ? e : x.Deferred(),
        s = function(e, t, n) {
          return function(r) {
            t[e] = this, n[e] = arguments.length > 1 ? d.call(arguments) : r, n === a ? o.notifyWith(t, n) : --i || o.resolveWith(t, n)
          }
        },
        a, u, l;
      if (r > 1)
        for (a = Array(r), u = Array(r), l = Array(r); r > t; t++) n[t] && x.isFunction(n[t].promise) ? n[t].promise().done(s(t, l, n)).fail(o.reject).progress(s(t, u, a)) : --i;
      return i || o.resolveWith(l, n), o.promise()
    }
  }), x.support = function(t) {
    var n = o.createElement("input"),
      r = o.createDocumentFragment(),
      i = o.createElement("div"),
      s = o.createElement("select"),
      a = s.appendChild(o.createElement("option"));
    return n.type ? (n.type = "checkbox", t.checkOn = "" !== n.value, t.optSelected = a.selected, t.reliableMarginRight = !0, t.boxSizingReliable = !0, t.pixelPosition = !1, n.checked = !0, t.noCloneChecked = n.cloneNode(!0).checked, s.disabled = !0, t.optDisabled = !a.disabled, n = o.createElement("input"), n.value = "t", n.type = "radio", t.radioValue = "t" === n.value, n.setAttribute("checked", "t"), n.setAttribute("name", "t"), r.appendChild(n), t.checkClone = r.cloneNode(!0).cloneNode(!0).lastChild.checked, t.focusinBubbles = "onfocusin" in e, i.style.backgroundClip = "content-box", i.cloneNode(!0).style.backgroundClip = "", t.clearCloneStyle = "content-box" === i.style.backgroundClip, x(function() {
      var n, r, s = "padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",
        a = o.getElementsByTagName("body")[0];
      a && (n = o.createElement("div"), n.style.cssText = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px", a.appendChild(n).appendChild(i), i.innerHTML = "", i.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%", x.swap(a, null != a.style.zoom ? {
        zoom: 1
      } : {}, function() {
        t.boxSizing = 4 === i.offsetWidth
      }), e.getComputedStyle && (t.pixelPosition = "1%" !== (e.getComputedStyle(i, null) || {}).top, t.boxSizingReliable = "4px" === (e.getComputedStyle(i, null) || {
        width: "4px"
      }).width, r = i.appendChild(o.createElement("div")), r.style.cssText = i.style.cssText = s, r.style.marginRight = r.style.width = "0", i.style.width = "1px", t.reliableMarginRight = !parseFloat((e.getComputedStyle(r, null) || {}).marginRight)), a.removeChild(n))
    }), t) : t
  }({});
  var L, q, H = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
    O = /([A-Z])/g;

  function F() {
    Object.defineProperty(this.cache = {}, 0, {
      get: function() {
        return {}
      }
    }), this.expando = x.expando + Math.random()
  }
  F.uid = 1, F.accepts = function(e) {
    return e.nodeType ? 1 === e.nodeType || 9 === e.nodeType : !0
  }, F.prototype = {
    key: function(e) {
      if (!F.accepts(e)) return 0;
      var t = {},
        n = e[this.expando];
      if (!n) {
        n = F.uid++;
        try {
          t[this.expando] = {
            value: n
          }, Object.defineProperties(e, t)
        } catch (r) {
          t[this.expando] = n, x.extend(e, t)
        }
      }
      return this.cache[n] || (this.cache[n] = {}), n
    },
    set: function(e, t, n) {
      var r, i = this.key(e),
        o = this.cache[i];
      if ("string" == typeof t) o[t] = n;
      else if (x.isEmptyObject(o)) x.extend(this.cache[i], t);
      else
        for (r in t) o[r] = t[r];
      return o
    },
    get: function(e, t) {
      var n = this.cache[this.key(e)];
      return t === undefined ? n : n[t]
    },
    access: function(e, t, n) {
      var r;
      return t === undefined || t && "string" == typeof t && n === undefined ? (r = this.get(e, t), r !== undefined ? r : this.get(e, x.camelCase(t))) : (this.set(e, t, n), n !== undefined ? n : t)
    },
    remove: function(e, t) {
      var n, r, i, o = this.key(e),
        s = this.cache[o];
      if (t === undefined) this.cache[o] = {};
      else {
        x.isArray(t) ? r = t.concat(t.map(x.camelCase)) : (i = x.camelCase(t), t in s ? r = [t, i] : (r = i, r = r in s ? [r] : r.match(w) || [])), n = r.length;
        while (n--) delete s[r[n]]
      }
    },
    hasData: function(e) {
      return !x.isEmptyObject(this.cache[e[this.expando]] || {})
    },
    discard: function(e) {
      e[this.expando] && delete this.cache[e[this.expando]]
    }
  }, L = new F, q = new F, x.extend({
    acceptData: F.accepts,
    hasData: function(e) {
      return L.hasData(e) || q.hasData(e)
    },
    data: function(e, t, n) {
      return L.access(e, t, n)
    },
    removeData: function(e, t) {
      L.remove(e, t)
    },
    _data: function(e, t, n) {
      return q.access(e, t, n)
    },
    _removeData: function(e, t) {
      q.remove(e, t)
    }
  }), x.fn.extend({
    data: function(e, t) {
      var n, r, i = this[0],
        o = 0,
        s = null;
      if (e === undefined) {
        if (this.length && (s = L.get(i), 1 === i.nodeType && !q.get(i, "hasDataAttrs"))) {
          for (n = i.attributes; n.length > o; o++) r = n[o].name, 0 === r.indexOf("data-") && (r = x.camelCase(r.slice(5)), P(i, r, s[r]));
          q.set(i, "hasDataAttrs", !0)
        }
        return s
      }
      return "object" == typeof e ? this.each(function() {
        L.set(this, e)
      }) : x.access(this, function(t) {
        var n, r = x.camelCase(e);
        if (i && t === undefined) {
          if (n = L.get(i, e), n !== undefined) return n;
          if (n = L.get(i, r), n !== undefined) return n;
          if (n = P(i, r, undefined), n !== undefined) return n
        } else this.each(function() {
          var n = L.get(this, r);
          L.set(this, r, t), -1 !== e.indexOf("-") && n !== undefined && L.set(this, e, t)
        })
      }, null, t, arguments.length > 1, null, !0)
    },
    removeData: function(e) {
      return this.each(function() {
        L.remove(this, e)
      })
    }
  });

  function P(e, t, n) {
    var r;
    if (n === undefined && 1 === e.nodeType)
      if (r = "data-" + t.replace(O, "-$1").toLowerCase(), n = e.getAttribute(r), "string" == typeof n) {
        try {
          n = "true" === n ? !0 : "false" === n ? !1 : "null" === n ? null : +n + "" === n ? +n : H.test(n) ? JSON.parse(n) : n
        } catch (i) {}
        L.set(e, t, n)
      } else n = undefined;
    return n
  }
  x.extend({
    queue: function(e, t, n) {
      var r;
      return e ? (t = (t || "fx") + "queue", r = q.get(e, t), n && (!r || x.isArray(n) ? r = q.access(e, t, x.makeArray(n)) : r.push(n)), r || []) : undefined
    },
    dequeue: function(e, t) {
      t = t || "fx";
      var n = x.queue(e, t),
        r = n.length,
        i = n.shift(),
        o = x._queueHooks(e, t),
        s = function() {
          x.dequeue(e, t)
        };
      "inprogress" === i && (i = n.shift(), r--), i && ("fx" === t && n.unshift("inprogress"), delete o.stop, i.call(e, s, o)), !r && o && o.empty.fire()
    },
    _queueHooks: function(e, t) {
      var n = t + "queueHooks";
      return q.get(e, n) || q.access(e, n, {
        empty: x.Callbacks("once memory").add(function() {
          q.remove(e, [t + "queue", n])
        })
      })
    }
  }), x.fn.extend({
    queue: function(e, t) {
      var n = 2;
      return "string" != typeof e && (t = e, e = "fx", n--), n > arguments.length ? x.queue(this[0], e) : t === undefined ? this : this.each(function() {
        var n = x.queue(this, e, t);
        x._queueHooks(this, e), "fx" === e && "inprogress" !== n[0] && x.dequeue(this, e)
      })
    },
    dequeue: function(e) {
      return this.each(function() {
        x.dequeue(this, e)
      })
    },
    delay: function(e, t) {
      return e = x.fx ? x.fx.speeds[e] || e : e, t = t || "fx", this.queue(t, function(t, n) {
        var r = setTimeout(t, e);
        n.stop = function() {
          clearTimeout(r)
        }
      })
    },
    clearQueue: function(e) {
      return this.queue(e || "fx", [])
    },
    promise: function(e, t) {
      var n, r = 1,
        i = x.Deferred(),
        o = this,
        s = this.length,
        a = function() {
          --r || i.resolveWith(o, [o])
        };
      "string" != typeof e && (t = e, e = undefined), e = e || "fx";
      while (s--) n = q.get(o[s], e + "queueHooks"), n && n.empty && (r++, n.empty.add(a));
      return a(), i.promise(t)
    }
  });
  var R, M, W = /[\t\r\n\f]/g,
    $ = /\r/g,
    B = /^(?:input|select|textarea|button)$/i;
  x.fn.extend({
    attr: function(e, t) {
      return x.access(this, x.attr, e, t, arguments.length > 1)
    },
    removeAttr: function(e) {
      return this.each(function() {
        x.removeAttr(this, e)
      })
    },
    prop: function(e, t) {
      return x.access(this, x.prop, e, t, arguments.length > 1)
    },
    removeProp: function(e) {
      return this.each(function() {
        delete this[x.propFix[e] || e]
      })
    },
    addClass: function(e) {
      var t, n, r, i, o, s = 0,
        a = this.length,
        u = "string" == typeof e && e;
      if (x.isFunction(e)) return this.each(function(t) {
        x(this).addClass(e.call(this, t, this.className))
      });
      if (u)
        for (t = (e || "").match(w) || []; a > s; s++)
          if (n = this[s], r = 1 === n.nodeType && (n.className ? (" " + n.className + " ").replace(W, " ") : " ")) {
            o = 0;
            while (i = t[o++]) 0 > r.indexOf(" " + i + " ") && (r += i + " ");
            n.className = x.trim(r)
          }
      return this
    },
    removeClass: function(e) {
      var t, n, r, i, o, s = 0,
        a = this.length,
        u = 0 === arguments.length || "string" == typeof e && e;
      if (x.isFunction(e)) return this.each(function(t) {
        x(this).removeClass(e.call(this, t, this.className))
      });
      if (u)
        for (t = (e || "").match(w) || []; a > s; s++)
          if (n = this[s], r = 1 === n.nodeType && (n.className ? (" " + n.className + " ").replace(W, " ") : "")) {
            o = 0;
            while (i = t[o++])
              while (r.indexOf(" " + i + " ") >= 0) r = r.replace(" " + i + " ", " ");
            n.className = e ? x.trim(r) : ""
          }
      return this
    },
    toggleClass: function(e, t) {
      var n = typeof e;
      return "boolean" == typeof t && "string" === n ? t ? this.addClass(e) : this.removeClass(e) : x.isFunction(e) ? this.each(function(n) {
        x(this).toggleClass(e.call(this, n, this.className, t), t)
      }) : this.each(function() {
        if ("string" === n) {
          var t, i = 0,
            o = x(this),
            s = e.match(w) || [];
          while (t = s[i++]) o.hasClass(t) ? o.removeClass(t) : o.addClass(t)
        } else(n === r || "boolean" === n) && (this.className && q.set(this, "__className__", this.className), this.className = this.className || e === !1 ? "" : q.get(this, "__className__") || "")
      })
    },
    hasClass: function(e) {
      var t = " " + e + " ",
        n = 0,
        r = this.length;
      for (; r > n; n++)
        if (1 === this[n].nodeType && (" " + this[n].className + " ").replace(W, " ").indexOf(t) >= 0) return !0;
      return !1
    },
    val: function(e) {
      var t, n, r, i = this[0]; {
        if (arguments.length) return r = x.isFunction(e), this.each(function(n) {
          var i;
          1 === this.nodeType && (i = r ? e.call(this, n, x(this).val()) : e, null == i ? i = "" : "number" == typeof i ? i += "" : x.isArray(i) && (i = x.map(i, function(e) {
            return null == e ? "" : e + ""
          })), t = x.valHooks[this.type] || x.valHooks[this.nodeName.toLowerCase()], t && "set" in t && t.set(this, i, "value") !== undefined || (this.value = i))
        });
        if (i) return t = x.valHooks[i.type] || x.valHooks[i.nodeName.toLowerCase()], t && "get" in t && (n = t.get(i, "value")) !== undefined ? n : (n = i.value, "string" == typeof n ? n.replace($, "") : null == n ? "" : n)
      }
    }
  }), x.extend({
    valHooks: {
      option: {
        get: function(e) {
          var t = e.attributes.value;
          return !t || t.specified ? e.value : e.text
        }
      },
      select: {
        get: function(e) {
          var t, n, r = e.options,
            i = e.selectedIndex,
            o = "select-one" === e.type || 0 > i,
            s = o ? null : [],
            a = o ? i + 1 : r.length,
            u = 0 > i ? a : o ? i : 0;
          for (; a > u; u++)
            if (n = r[u], !(!n.selected && u !== i || (x.support.optDisabled ? n.disabled : null !== n.getAttribute("disabled")) || n.parentNode.disabled && x.nodeName(n.parentNode, "optgroup"))) {
              if (t = x(n).val(), o) return t;
              s.push(t)
            }
          return s
        },
        set: function(e, t) {
          var n, r, i = e.options,
            o = x.makeArray(t),
            s = i.length;
          while (s--) r = i[s], (r.selected = x.inArray(x(r).val(), o) >= 0) && (n = !0);
          return n || (e.selectedIndex = -1), o
        }
      }
    },
    attr: function(e, t, n) {
      var i, o, s = e.nodeType;
      if (e && 3 !== s && 8 !== s && 2 !== s) return typeof e.getAttribute === r ? x.prop(e, t, n) : (1 === s && x.isXMLDoc(e) || (t = t.toLowerCase(), i = x.attrHooks[t] || (x.expr.match.bool.test(t) ? M : R)), n === undefined ? i && "get" in i && null !== (o = i.get(e, t)) ? o : (o = x.find.attr(e, t), null == o ? undefined : o) : null !== n ? i && "set" in i && (o = i.set(e, n, t)) !== undefined ? o : (e.setAttribute(t, n + ""), n) : (x.removeAttr(e, t), undefined))
    },
    removeAttr: function(e, t) {
      var n, r, i = 0,
        o = t && t.match(w);
      if (o && 1 === e.nodeType)
        while (n = o[i++]) r = x.propFix[n] || n, x.expr.match.bool.test(n) && (e[r] = !1), e.removeAttribute(n)
    },
    attrHooks: {
      type: {
        set: function(e, t) {
          if (!x.support.radioValue && "radio" === t && x.nodeName(e, "input")) {
            var n = e.value;
            return e.setAttribute("type", t), n && (e.value = n), t
          }
        }
      }
    },
    propFix: {
      "for": "htmlFor",
      "class": "className"
    },
    prop: function(e, t, n) {
      var r, i, o, s = e.nodeType;
      if (e && 3 !== s && 8 !== s && 2 !== s) return o = 1 !== s || !x.isXMLDoc(e), o && (t = x.propFix[t] || t, i = x.propHooks[t]), n !== undefined ? i && "set" in i && (r = i.set(e, n, t)) !== undefined ? r : e[t] = n : i && "get" in i && null !== (r = i.get(e, t)) ? r : e[t]
    },
    propHooks: {
      tabIndex: {
        get: function(e) {
          return e.hasAttribute("tabindex") || B.test(e.nodeName) || e.href ? e.tabIndex : -1
        }
      }
    }
  }), M = {
    set: function(e, t, n) {
      return t === !1 ? x.removeAttr(e, n) : e.setAttribute(n, n), n
    }
  }, x.each(x.expr.match.bool.source.match(/\w+/g), function(e, t) {
    var n = x.expr.attrHandle[t] || x.find.attr;
    x.expr.attrHandle[t] = function(e, t, r) {
      var i = x.expr.attrHandle[t],
        o = r ? undefined : (x.expr.attrHandle[t] = undefined) != n(e, t, r) ? t.toLowerCase() : null;
      return x.expr.attrHandle[t] = i, o
    }
  }), x.support.optSelected || (x.propHooks.selected = {
    get: function(e) {
      var t = e.parentNode;
      return t && t.parentNode && t.parentNode.selectedIndex, null
    }
  }), x.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
    x.propFix[this.toLowerCase()] = this
  }), x.each(["radio", "checkbox"], function() {
    x.valHooks[this] = {
      set: function(e, t) {
        return x.isArray(t) ? e.checked = x.inArray(x(e).val(), t) >= 0 : undefined
      }
    }, x.support.checkOn || (x.valHooks[this].get = function(e) {
      return null === e.getAttribute("value") ? "on" : e.value
    })
  });
  var I = /^key/,
    z = /^(?:mouse|contextmenu)|click/,
    _ = /^(?:focusinfocus|focusoutblur)$/,
    X = /^([^.]*)(?:\.(.+)|)$/;

  function U() {
    return !0
  }

  function Y() {
    return !1
  }

  function V() {
    try {
      return o.activeElement
    } catch (e) {}
  }
  x.event = {
    global: {},
    add: function(e, t, n, i, o) {
      var s, a, u, l, c, p, f, h, d, g, m, y = q.get(e);
      if (y) {
        n.handler && (s = n, n = s.handler, o = s.selector), n.guid || (n.guid = x.guid++), (l = y.events) || (l = y.events = {}), (a = y.handle) || (a = y.handle = function(e) {
          return typeof x === r || e && x.event.triggered === e.type ? undefined : x.event.dispatch.apply(a.elem, arguments)
        }, a.elem = e), t = (t || "").match(w) || [""], c = t.length;
        while (c--) u = X.exec(t[c]) || [], d = m = u[1], g = (u[2] || "").split(".").sort(), d && (f = x.event.special[d] || {}, d = (o ? f.delegateType : f.bindType) || d, f = x.event.special[d] || {}, p = x.extend({
          type: d,
          origType: m,
          data: i,
          handler: n,
          guid: n.guid,
          selector: o,
          needsContext: o && x.expr.match.needsContext.test(o),
          namespace: g.join(".")
        }, s), (h = l[d]) || (h = l[d] = [], h.delegateCount = 0, f.setup && f.setup.call(e, i, g, a) !== !1 || e.addEventListener && e.addEventListener(d, a, !1)), f.add && (f.add.call(e, p), p.handler.guid || (p.handler.guid = n.guid)), o ? h.splice(h.delegateCount++, 0, p) : h.push(p), x.event.global[d] = !0);
        e = null
      }
    },
    remove: function(e, t, n, r, i) {
      var o, s, a, u, l, c, p, f, h, d, g, m = q.hasData(e) && q.get(e);
      if (m && (u = m.events)) {
        t = (t || "").match(w) || [""], l = t.length;
        while (l--)
          if (a = X.exec(t[l]) || [], h = g = a[1], d = (a[2] || "").split(".").sort(), h) {
            p = x.event.special[h] || {}, h = (r ? p.delegateType : p.bindType) || h, f = u[h] || [], a = a[2] && RegExp("(^|\\.)" + d.join("\\.(?:.*\\.|)") + "(\\.|$)"), s = o = f.length;
            while (o--) c = f[o], !i && g !== c.origType || n && n.guid !== c.guid || a && !a.test(c.namespace) || r && r !== c.selector && ("**" !== r || !c.selector) || (f.splice(o, 1), c.selector && f.delegateCount--, p.remove && p.remove.call(e, c));
            s && !f.length && (p.teardown && p.teardown.call(e, d, m.handle) !== !1 || x.removeEvent(e, h, m.handle), delete u[h])
          } else
            for (h in u) x.event.remove(e, h + t[l], n, r, !0);
        x.isEmptyObject(u) && (delete m.handle, q.remove(e, "events"))
      }
    },
    trigger: function(t, n, r, i) {
      var s, a, u, l, c, p, f, h = [r || o],
        d = y.call(t, "type") ? t.type : t,
        g = y.call(t, "namespace") ? t.namespace.split(".") : [];
      if (a = u = r = r || o, 3 !== r.nodeType && 8 !== r.nodeType && !_.test(d + x.event.triggered) && (d.indexOf(".") >= 0 && (g = d.split("."), d = g.shift(), g.sort()), c = 0 > d.indexOf(":") && "on" + d, t = t[x.expando] ? t : new x.Event(d, "object" == typeof t && t), t.isTrigger = i ? 2 : 3, t.namespace = g.join("."), t.namespace_re = t.namespace ? RegExp("(^|\\.)" + g.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, t.result = undefined, t.target || (t.target = r), n = null == n ? [t] : x.makeArray(n, [t]), f = x.event.special[d] || {}, i || !f.trigger || f.trigger.apply(r, n) !== !1)) {
        if (!i && !f.noBubble && !x.isWindow(r)) {
          for (l = f.delegateType || d, _.test(l + d) || (a = a.parentNode); a; a = a.parentNode) h.push(a), u = a;
          u === (r.ownerDocument || o) && h.push(u.defaultView || u.parentWindow || e)
        }
        s = 0;
        while ((a = h[s++]) && !t.isPropagationStopped()) t.type = s > 1 ? l : f.bindType || d, p = (q.get(a, "events") || {})[t.type] && q.get(a, "handle"), p && p.apply(a, n), p = c && a[c], p && x.acceptData(a) && p.apply && p.apply(a, n) === !1 && t.preventDefault();
        return t.type = d, i || t.isDefaultPrevented() || f._default && f._default.apply(h.pop(), n) !== !1 || !x.acceptData(r) || c && x.isFunction(r[d]) && !x.isWindow(r) && (u = r[c], u && (r[c] = null), x.event.triggered = d, r[d](), x.event.triggered = undefined, u && (r[c] = u)), t.result
      }
    },
    dispatch: function(e) {
      e = x.event.fix(e);
      var t, n, r, i, o, s = [],
        a = d.call(arguments),
        u = (q.get(this, "events") || {})[e.type] || [],
        l = x.event.special[e.type] || {};
      if (a[0] = e, e.delegateTarget = this, !l.preDispatch || l.preDispatch.call(this, e) !== !1) {
        s = x.event.handlers.call(this, e, u), t = 0;
        while ((i = s[t++]) && !e.isPropagationStopped()) {
          e.currentTarget = i.elem, n = 0;
          while ((o = i.handlers[n++]) && !e.isImmediatePropagationStopped())(!e.namespace_re || e.namespace_re.test(o.namespace)) && (e.handleObj = o, e.data = o.data, r = ((x.event.special[o.origType] || {}).handle || o.handler).apply(i.elem, a), r !== undefined && (e.result = r) === !1 && (e.preventDefault(), e.stopPropagation()))
        }
        return l.postDispatch && l.postDispatch.call(this, e), e.result
      }
    },
    handlers: function(e, t) {
      var n, r, i, o, s = [],
        a = t.delegateCount,
        u = e.target;
      if (a && u.nodeType && (!e.button || "click" !== e.type))
        for (; u !== this; u = u.parentNode || this)
          if (u.disabled !== !0 || "click" !== e.type) {
            for (r = [], n = 0; a > n; n++) o = t[n], i = o.selector + " ", r[i] === undefined && (r[i] = o.needsContext ? x(i, this).index(u) >= 0 : x.find(i, this, null, [u]).length), r[i] && r.push(o);
            r.length && s.push({
              elem: u,
              handlers: r
            })
          }
      return t.length > a && s.push({
        elem: this,
        handlers: t.slice(a)
      }), s
    },
    props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
    fixHooks: {},
    keyHooks: {
      props: "char charCode key keyCode".split(" "),
      filter: function(e, t) {
        return null == e.which && (e.which = null != t.charCode ? t.charCode : t.keyCode), e
      }
    },
    mouseHooks: {
      props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
      filter: function(e, t) {
        var n, r, i, s = t.button;
        return null == e.pageX && null != t.clientX && (n = e.target.ownerDocument || o, r = n.documentElement, i = n.body, e.pageX = t.clientX + (r && r.scrollLeft || i && i.scrollLeft || 0) - (r && r.clientLeft || i && i.clientLeft || 0), e.pageY = t.clientY + (r && r.scrollTop || i && i.scrollTop || 0) - (r && r.clientTop || i && i.clientTop || 0)), e.which || s === undefined || (e.which = 1 & s ? 1 : 2 & s ? 3 : 4 & s ? 2 : 0), e
      }
    },
    fix: function(e) {
      if (e[x.expando]) return e;
      var t, n, r, i = e.type,
        s = e,
        a = this.fixHooks[i];
      a || (this.fixHooks[i] = a = z.test(i) ? this.mouseHooks : I.test(i) ? this.keyHooks : {}), r = a.props ? this.props.concat(a.props) : this.props, e = new x.Event(s), t = r.length;
      while (t--) n = r[t], e[n] = s[n];
      return e.target || (e.target = o), 3 === e.target.nodeType && (e.target = e.target.parentNode), a.filter ? a.filter(e, s) : e
    },
    special: {
      load: {
        noBubble: !0
      },
      focus: {
        trigger: function() {
          return this !== V() && this.focus ? (this.focus(), !1) : undefined
        },
        delegateType: "focusin"
      },
      blur: {
        trigger: function() {
          return this === V() && this.blur ? (this.blur(), !1) : undefined
        },
        delegateType: "focusout"
      },
      click: {
        trigger: function() {
          return "checkbox" === this.type && this.click && x.nodeName(this, "input") ? (this.click(), !1) : undefined
        },
        _default: function(e) {
          return x.nodeName(e.target, "a")
        }
      },
      beforeunload: {
        postDispatch: function(e) {
          e.result !== undefined && (e.originalEvent.returnValue = e.result)
        }
      }
    },
    simulate: function(e, t, n, r) {
      var i = x.extend(new x.Event, n, {
        type: e,
        isSimulated: !0,
        originalEvent: {}
      });
      r ? x.event.trigger(i, null, t) : x.event.dispatch.call(t, i), i.isDefaultPrevented() && n.preventDefault()
    }
  }, x.removeEvent = function(e, t, n) {
    e.removeEventListener && e.removeEventListener(t, n, !1)
  }, x.Event = function(e, t) {
    return this instanceof x.Event ? (e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || e.getPreventDefault && e.getPreventDefault() ? U : Y) : this.type = e, t && x.extend(this, t), this.timeStamp = e && e.timeStamp || x.now(), this[x.expando] = !0, undefined) : new x.Event(e, t)
  }, x.Event.prototype = {
    isDefaultPrevented: Y,
    isPropagationStopped: Y,
    isImmediatePropagationStopped: Y,
    preventDefault: function() {
      var e = this.originalEvent;
      this.isDefaultPrevented = U, e && e.preventDefault && e.preventDefault()
    },
    stopPropagation: function() {
      var e = this.originalEvent;
      this.isPropagationStopped = U, e && e.stopPropagation && e.stopPropagation()
    },
    stopImmediatePropagation: function() {
      this.isImmediatePropagationStopped = U, this.stopPropagation()
    }
  }, x.each({
    mouseenter: "mouseover",
    mouseleave: "mouseout"
  }, function(e, t) {
    x.event.special[e] = {
      delegateType: t,
      bindType: t,
      handle: function(e) {
        var n, r = this,
          i = e.relatedTarget,
          o = e.handleObj;
        return (!i || i !== r && !x.contains(r, i)) && (e.type = o.origType, n = o.handler.apply(this, arguments), e.type = t), n
      }
    }
  }), x.support.focusinBubbles || x.each({
    focus: "focusin",
    blur: "focusout"
  }, function(e, t) {
    var n = 0,
      r = function(e) {
        x.event.simulate(t, e.target, x.event.fix(e), !0)
      };
    x.event.special[t] = {
      setup: function() {
        0 === n++ && o.addEventListener(e, r, !0)
      },
      teardown: function() {
        0 === --n && o.removeEventListener(e, r, !0)
      }
    }
  }), x.fn.extend({
    on: function(e, t, n, r, i) {
      var o, s;
      if ("object" == typeof e) {
        "string" != typeof t && (n = n || t, t = undefined);
        for (s in e) this.on(s, t, n, e[s], i);
        return this
      }
      if (null == n && null == r ? (r = t, n = t = undefined) : null == r && ("string" == typeof t ? (r = n, n = undefined) : (r = n, n = t, t = undefined)), r === !1) r = Y;
      else if (!r) return this;
      return 1 === i && (o = r, r = function(e) {
        return x().off(e), o.apply(this, arguments)
      }, r.guid = o.guid || (o.guid = x.guid++)), this.each(function() {
        x.event.add(this, e, r, n, t)
      })
    },
    one: function(e, t, n, r) {
      return this.on(e, t, n, r, 1)
    },
    off: function(e, t, n) {
      var r, i;
      if (e && e.preventDefault && e.handleObj) return r = e.handleObj, x(e.delegateTarget).off(r.namespace ? r.origType + "." + r.namespace : r.origType, r.selector, r.handler), this;
      if ("object" == typeof e) {
        for (i in e) this.off(i, t, e[i]);
        return this
      }
      return (t === !1 || "function" == typeof t) && (n = t, t = undefined), n === !1 && (n = Y), this.each(function() {
        x.event.remove(this, e, n, t)
      })
    },
    trigger: function(e, t) {
      return this.each(function() {
        x.event.trigger(e, t, this)
      })
    },
    triggerHandler: function(e, t) {
      var n = this[0];
      return n ? x.event.trigger(e, t, n, !0) : undefined
    }
  });
  var G = /^.[^:#\[\.,]*$/,
    J = /^(?:parents|prev(?:Until|All))/,
    Q = x.expr.match.needsContext,
    K = {
      children: !0,
      contents: !0,
      next: !0,
      prev: !0
    };
  x.fn.extend({
    find: function(e) {
      var t, n = [],
        r = this,
        i = r.length;
      if ("string" != typeof e) return this.pushStack(x(e).filter(function() {
        for (t = 0; i > t; t++)
          if (x.contains(r[t], this)) return !0
      }));
      for (t = 0; i > t; t++) x.find(e, r[t], n);
      return n = this.pushStack(i > 1 ? x.unique(n) : n), n.selector = this.selector ? this.selector + " " + e : e, n
    },
    has: function(e) {
      var t = x(e, this),
        n = t.length;
      return this.filter(function() {
        var e = 0;
        for (; n > e; e++)
          if (x.contains(this, t[e])) return !0
      })
    },
    not: function(e) {
      return this.pushStack(et(this, e || [], !0))
    },
    filter: function(e) {
      return this.pushStack(et(this, e || [], !1))
    },
    is: function(e) {
      return !!et(this, "string" == typeof e && Q.test(e) ? x(e) : e || [], !1).length
    },
    closest: function(e, t) {
      var n, r = 0,
        i = this.length,
        o = [],
        s = Q.test(e) || "string" != typeof e ? x(e, t || this.context) : 0;
      for (; i > r; r++)
        for (n = this[r]; n && n !== t; n = n.parentNode)
          if (11 > n.nodeType && (s ? s.index(n) > -1 : 1 === n.nodeType && x.find.matchesSelector(n, e))) {
            n = o.push(n);
            break
          }
      return this.pushStack(o.length > 1 ? x.unique(o) : o)
    },
    index: function(e) {
      return e ? "string" == typeof e ? g.call(x(e), this[0]) : g.call(this, e.jquery ? e[0] : e) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
    },
    add: function(e, t) {
      var n = "string" == typeof e ? x(e, t) : x.makeArray(e && e.nodeType ? [e] : e),
        r = x.merge(this.get(), n);
      return this.pushStack(x.unique(r))
    },
    addBack: function(e) {
      return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
    }
  });

  function Z(e, t) {
    while ((e = e[t]) && 1 !== e.nodeType);
    return e
  }
  x.each({
    parent: function(e) {
      var t = e.parentNode;
      return t && 11 !== t.nodeType ? t : null
    },
    parents: function(e) {
      return x.dir(e, "parentNode")
    },
    parentsUntil: function(e, t, n) {
      return x.dir(e, "parentNode", n)
    },
    next: function(e) {
      return Z(e, "nextSibling")
    },
    prev: function(e) {
      return Z(e, "previousSibling")
    },
    nextAll: function(e) {
      return x.dir(e, "nextSibling")
    },
    prevAll: function(e) {
      return x.dir(e, "previousSibling")
    },
    nextUntil: function(e, t, n) {
      return x.dir(e, "nextSibling", n)
    },
    prevUntil: function(e, t, n) {
      return x.dir(e, "previousSibling", n)
    },
    siblings: function(e) {
      return x.sibling((e.parentNode || {}).firstChild, e)
    },
    children: function(e) {
      return x.sibling(e.firstChild)
    },
    contents: function(e) {
      return e.contentDocument || x.merge([], e.childNodes)
    }
  }, function(e, t) {
    x.fn[e] = function(n, r) {
      var i = x.map(this, t, n);
      return "Until" !== e.slice(-5) && (r = n), r && "string" == typeof r && (i = x.filter(r, i)), this.length > 1 && (K[e] || x.unique(i), J.test(e) && i.reverse()), this.pushStack(i)
    }
  }), x.extend({
    filter: function(e, t, n) {
      var r = t[0];
      return n && (e = ":not(" + e + ")"), 1 === t.length && 1 === r.nodeType ? x.find.matchesSelector(r, e) ? [r] : [] : x.find.matches(e, x.grep(t, function(e) {
        return 1 === e.nodeType
      }))
    },
    dir: function(e, t, n) {
      var r = [],
        i = n !== undefined;
      while ((e = e[t]) && 9 !== e.nodeType)
        if (1 === e.nodeType) {
          if (i && x(e).is(n)) break;
          r.push(e)
        }
      return r
    },
    sibling: function(e, t) {
      var n = [];
      for (; e; e = e.nextSibling) 1 === e.nodeType && e !== t && n.push(e);
      return n
    }
  });

  function et(e, t, n) {
    if (x.isFunction(t)) return x.grep(e, function(e, r) {
      return !!t.call(e, r, e) !== n
    });
    if (t.nodeType) return x.grep(e, function(e) {
      return e === t !== n
    });
    if ("string" == typeof t) {
      if (G.test(t)) return x.filter(t, e, n);
      t = x.filter(t, e)
    }
    return x.grep(e, function(e) {
      return g.call(t, e) >= 0 !== n
    })
  }
  var tt = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
    nt = /<([\w:]+)/,
    rt = /<|&#?\w+;/,
    it = /<(?:script|style|link)/i,
    ot = /^(?:checkbox|radio)$/i,
    st = /checked\s*(?:[^=]|=\s*.checked.)/i,
    at = /^$|\/(?:java|ecma)script/i,
    ut = /^true\/(.*)/,
    lt = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
    ct = {
      option: [1, "<select multiple='multiple'>", "</select>"],
      thead: [1, "<table>", "</table>"],
      col: [2, "<table><colgroup>", "</colgroup></table>"],
      tr: [2, "<table><tbody>", "</tbody></table>"],
      td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
      _default: [0, "", ""]
    };
  ct.optgroup = ct.option, ct.tbody = ct.tfoot = ct.colgroup = ct.caption = ct.thead, ct.th = ct.td, x.fn.extend({
    text: function(e) {
      return x.access(this, function(e) {
        return e === undefined ? x.text(this) : this.empty().append((this[0] && this[0].ownerDocument || o).createTextNode(e))
      }, null, e, arguments.length)
    },
    append: function() {
      return this.domManip(arguments, function(e) {
        if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
          var t = pt(this, e);
          t.appendChild(e)
        }
      })
    },
    prepend: function() {
      return this.domManip(arguments, function(e) {
        if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
          var t = pt(this, e);
          t.insertBefore(e, t.firstChild)
        }
      })
    },
    before: function() {
      return this.domManip(arguments, function(e) {
        this.parentNode && this.parentNode.insertBefore(e, this)
      })
    },
    after: function() {
      return this.domManip(arguments, function(e) {
        this.parentNode && this.parentNode.insertBefore(e, this.nextSibling)
      })
    },
    remove: function(e, t) {
      var n, r = e ? x.filter(e, this) : this,
        i = 0;
      for (; null != (n = r[i]); i++) t || 1 !== n.nodeType || x.cleanData(mt(n)), n.parentNode && (t && x.contains(n.ownerDocument, n) && dt(mt(n, "script")), n.parentNode.removeChild(n));
      return this
    },
    empty: function() {
      var e, t = 0;
      for (; null != (e = this[t]); t++) 1 === e.nodeType && (x.cleanData(mt(e, !1)), e.textContent = "");
      return this
    },
    clone: function(e, t) {
      return e = null == e ? !1 : e, t = null == t ? e : t, this.map(function() {
        return x.clone(this, e, t)
      })
    },
    html: function(e) {
      return x.access(this, function(e) {
        var t = this[0] || {},
          n = 0,
          r = this.length;
        if (e === undefined && 1 === t.nodeType) return t.innerHTML;
        if ("string" == typeof e && !it.test(e) && !ct[(nt.exec(e) || ["", ""])[1].toLowerCase()]) {
          e = e.replace(tt, "<$1></$2>");
          try {
            for (; r > n; n++) t = this[n] || {}, 1 === t.nodeType && (x.cleanData(mt(t, !1)), t.innerHTML = e);
            t = 0
          } catch (i) {}
        }
        t && this.empty().append(e)
      }, null, e, arguments.length)
    },
    replaceWith: function() {
      var e = x.map(this, function(e) {
          return [e.nextSibling, e.parentNode]
        }),
        t = 0;
      return this.domManip(arguments, function(n) {
        var r = e[t++],
          i = e[t++];
        i && (r && r.parentNode !== i && (r = this.nextSibling), x(this).remove(), i.insertBefore(n, r))
      }, !0), t ? this : this.remove()
    },
    detach: function(e) {
      return this.remove(e, !0)
    },
    domManip: function(e, t, n) {
      e = f.apply([], e);
      var r, i, o, s, a, u, l = 0,
        c = this.length,
        p = this,
        h = c - 1,
        d = e[0],
        g = x.isFunction(d);
      if (g || !(1 >= c || "string" != typeof d || x.support.checkClone) && st.test(d)) return this.each(function(r) {
        var i = p.eq(r);
        g && (e[0] = d.call(this, r, i.html())), i.domManip(e, t, n)
      });
      if (c && (r = x.buildFragment(e, this[0].ownerDocument, !1, !n && this), i = r.firstChild, 1 === r.childNodes.length && (r = i), i)) {
        for (o = x.map(mt(r, "script"), ft), s = o.length; c > l; l++) a = r, l !== h && (a = x.clone(a, !0, !0), s && x.merge(o, mt(a, "script"))), t.call(this[l], a, l);
        if (s)
          for (u = o[o.length - 1].ownerDocument, x.map(o, ht), l = 0; s > l; l++) a = o[l], at.test(a.type || "") && !q.access(a, "globalEval") && x.contains(u, a) && (a.src ? x._evalUrl(a.src) : x.globalEval(a.textContent.replace(lt, "")))
      }
      return this
    }
  }), x.each({
    appendTo: "append",
    prependTo: "prepend",
    insertBefore: "before",
    insertAfter: "after",
    replaceAll: "replaceWith"
  }, function(e, t) {
    x.fn[e] = function(e) {
      var n, r = [],
        i = x(e),
        o = i.length - 1,
        s = 0;
      for (; o >= s; s++) n = s === o ? this : this.clone(!0), x(i[s])[t](n), h.apply(r, n.get());
      return this.pushStack(r)
    }
  }), x.extend({
    clone: function(e, t, n) {
      var r, i, o, s, a = e.cloneNode(!0),
        u = x.contains(e.ownerDocument, e);
      if (!(x.support.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || x.isXMLDoc(e)))
        for (s = mt(a), o = mt(e), r = 0, i = o.length; i > r; r++) yt(o[r], s[r]);
      if (t)
        if (n)
          for (o = o || mt(e), s = s || mt(a), r = 0, i = o.length; i > r; r++) gt(o[r], s[r]);
        else gt(e, a);
      return s = mt(a, "script"), s.length > 0 && dt(s, !u && mt(e, "script")), a
    },
    buildFragment: function(e, t, n, r) {
      var i, o, s, a, u, l, c = 0,
        p = e.length,
        f = t.createDocumentFragment(),
        h = [];
      for (; p > c; c++)
        if (i = e[c], i || 0 === i)
          if ("object" === x.type(i)) x.merge(h, i.nodeType ? [i] : i);
          else if (rt.test(i)) {
        o = o || f.appendChild(t.createElement("div")), s = (nt.exec(i) || ["", ""])[1].toLowerCase(), a = ct[s] || ct._default, o.innerHTML = a[1] + i.replace(tt, "<$1></$2>") + a[2], l = a[0];
        while (l--) o = o.lastChild;
        x.merge(h, o.childNodes), o = f.firstChild, o.textContent = ""
      } else h.push(t.createTextNode(i));
      f.textContent = "", c = 0;
      while (i = h[c++])
        if ((!r || -1 === x.inArray(i, r)) && (u = x.contains(i.ownerDocument, i), o = mt(f.appendChild(i), "script"), u && dt(o), n)) {
          l = 0;
          while (i = o[l++]) at.test(i.type || "") && n.push(i)
        }
      return f
    },
    cleanData: function(e) {
      var t, n, r, i, o, s, a = x.event.special,
        u = 0;
      for (;
        (n = e[u]) !== undefined; u++) {
        if (F.accepts(n) && (o = n[q.expando], o && (t = q.cache[o]))) {
          if (r = Object.keys(t.events || {}), r.length)
            for (s = 0;
              (i = r[s]) !== undefined; s++) a[i] ? x.event.remove(n, i) : x.removeEvent(n, i, t.handle);
          q.cache[o] && delete q.cache[o]
        }
        delete L.cache[n[L.expando]]
      }
    },
    _evalUrl: function(e) {
      return x.ajax({
        url: e,
        type: "GET",
        dataType: "script",
        async: !1,
        global: !1,
        "throws": !0
      })
    }
  });

  function pt(e, t) {
    return x.nodeName(e, "table") && x.nodeName(1 === t.nodeType ? t : t.firstChild, "tr") ? e.getElementsByTagName("tbody")[0] || e.appendChild(e.ownerDocument.createElement("tbody")) : e
  }

  function ft(e) {
    return e.type = (null !== e.getAttribute("type")) + "/" + e.type, e
  }

  function ht(e) {
    var t = ut.exec(e.type);
    return t ? e.type = t[1] : e.removeAttribute("type"), e
  }

  function dt(e, t) {
    var n = e.length,
      r = 0;
    for (; n > r; r++) q.set(e[r], "globalEval", !t || q.get(t[r], "globalEval"))
  }

  function gt(e, t) {
    var n, r, i, o, s, a, u, l;
    if (1 === t.nodeType) {
      if (q.hasData(e) && (o = q.access(e), s = q.set(t, o), l = o.events)) {
        delete s.handle, s.events = {};
        for (i in l)
          for (n = 0, r = l[i].length; r > n; n++) x.event.add(t, i, l[i][n])
      }
      L.hasData(e) && (a = L.access(e), u = x.extend({}, a), L.set(t, u))
    }
  }

  function mt(e, t) {
    var n = e.getElementsByTagName ? e.getElementsByTagName(t || "*") : e.querySelectorAll ? e.querySelectorAll(t || "*") : [];
    return t === undefined || t && x.nodeName(e, t) ? x.merge([e], n) : n
  }

  function yt(e, t) {
    var n = t.nodeName.toLowerCase();
    "input" === n && ot.test(e.type) ? t.checked = e.checked : ("input" === n || "textarea" === n) && (t.defaultValue = e.defaultValue)
  }
  x.fn.extend({
    wrapAll: function(e) {
      var t;
      return x.isFunction(e) ? this.each(function(t) {
        x(this).wrapAll(e.call(this, t))
      }) : (this[0] && (t = x(e, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && t.insertBefore(this[0]), t.map(function() {
        var e = this;
        while (e.firstElementChild) e = e.firstElementChild;
        return e
      }).append(this)), this)
    },
    wrapInner: function(e) {
      return x.isFunction(e) ? this.each(function(t) {
        x(this).wrapInner(e.call(this, t))
      }) : this.each(function() {
        var t = x(this),
          n = t.contents();
        n.length ? n.wrapAll(e) : t.append(e)
      })
    },
    wrap: function(e) {
      var t = x.isFunction(e);
      return this.each(function(n) {
        x(this).wrapAll(t ? e.call(this, n) : e)
      })
    },
    unwrap: function() {
      return this.parent().each(function() {
        x.nodeName(this, "body") || x(this).replaceWith(this.childNodes)
      }).end()
    }
  });
  var vt, xt, bt = /^(none|table(?!-c[ea]).+)/,
    wt = /^margin/,
    Tt = RegExp("^(" + b + ")(.*)$", "i"),
    Ct = RegExp("^(" + b + ")(?!px)[a-z%]+$", "i"),
    kt = RegExp("^([+-])=(" + b + ")", "i"),
    Nt = {
      BODY: "block"
    },
    Et = {
      position: "absolute",
      visibility: "hidden",
      display: "block"
    },
    St = {
      letterSpacing: 0,
      fontWeight: 400
    },
    jt = ["Top", "Right", "Bottom", "Left"],
    Dt = ["Webkit", "O", "Moz", "ms"];

  function At(e, t) {
    if (t in e) return t;
    var n = t.charAt(0).toUpperCase() + t.slice(1),
      r = t,
      i = Dt.length;
    while (i--)
      if (t = Dt[i] + n, t in e) return t;
    return r
  }

  function Lt(e, t) {
    return e = t || e, "none" === x.css(e, "display") || !x.contains(e.ownerDocument, e)
  }

  function qt(t) {
    return e.getComputedStyle(t, null)
  }

  function Ht(e, t) {
    var n, r, i, o = [],
      s = 0,
      a = e.length;
    for (; a > s; s++) r = e[s], r.style && (o[s] = q.get(r, "olddisplay"), n = r.style.display, t ? (o[s] || "none" !== n || (r.style.display = ""), "" === r.style.display && Lt(r) && (o[s] = q.access(r, "olddisplay", Rt(r.nodeName)))) : o[s] || (i = Lt(r), (n && "none" !== n || !i) && q.set(r, "olddisplay", i ? n : x.css(r, "display"))));
    for (s = 0; a > s; s++) r = e[s], r.style && (t && "none" !== r.style.display && "" !== r.style.display || (r.style.display = t ? o[s] || "" : "none"));
    return e
  }
  x.fn.extend({
    css: function(e, t) {
      return x.access(this, function(e, t, n) {
        var r, i, o = {},
          s = 0;
        if (x.isArray(t)) {
          for (r = qt(e), i = t.length; i > s; s++) o[t[s]] = x.css(e, t[s], !1, r);
          return o
        }
        return n !== undefined ? x.style(e, t, n) : x.css(e, t)
      }, e, t, arguments.length > 1)
    },
    show: function() {
      return Ht(this, !0)
    },
    hide: function() {
      return Ht(this)
    },
    toggle: function(e) {
      return "boolean" == typeof e ? e ? this.show() : this.hide() : this.each(function() {
        Lt(this) ? x(this).show() : x(this).hide()
      })
    }
  }), x.extend({
    cssHooks: {
      opacity: {
        get: function(e, t) {
          if (t) {
            var n = vt(e, "opacity");
            return "" === n ? "1" : n
          }
        }
      }
    },
    cssNumber: {
      columnCount: !0,
      fillOpacity: !0,
      fontWeight: !0,
      lineHeight: !0,
      opacity: !0,
      order: !0,
      orphans: !0,
      widows: !0,
      zIndex: !0,
      zoom: !0
    },
    cssProps: {
      "float": "cssFloat"
    },
    style: function(e, t, n, r) {
      if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) {
        var i, o, s, a = x.camelCase(t),
          u = e.style;
        return t = x.cssProps[a] || (x.cssProps[a] = At(u, a)), s = x.cssHooks[t] || x.cssHooks[a], n === undefined ? s && "get" in s && (i = s.get(e, !1, r)) !== undefined ? i : u[t] : (o = typeof n, "string" === o && (i = kt.exec(n)) && (n = (i[1] + 1) * i[2] + parseFloat(x.css(e, t)), o = "number"), null == n || "number" === o && isNaN(n) || ("number" !== o || x.cssNumber[a] || (n += "px"), x.support.clearCloneStyle || "" !== n || 0 !== t.indexOf("background") || (u[t] = "inherit"), s && "set" in s && (n = s.set(e, n, r)) === undefined || (u[t] = n)), undefined)
      }
    },
    css: function(e, t, n, r) {
      var i, o, s, a = x.camelCase(t);
      return t = x.cssProps[a] || (x.cssProps[a] = At(e.style, a)), s = x.cssHooks[t] || x.cssHooks[a], s && "get" in s && (i = s.get(e, !0, n)), i === undefined && (i = vt(e, t, r)), "normal" === i && t in St && (i = St[t]), "" === n || n ? (o = parseFloat(i), n === !0 || x.isNumeric(o) ? o || 0 : i) : i
    }
  }), vt = function(e, t, n) {
    var r, i, o, s = n || qt(e),
      a = s ? s.getPropertyValue(t) || s[t] : undefined,
      u = e.style;
    return s && ("" !== a || x.contains(e.ownerDocument, e) || (a = x.style(e, t)), Ct.test(a) && wt.test(t) && (r = u.width, i = u.minWidth, o = u.maxWidth, u.minWidth = u.maxWidth = u.width = a, a = s.width, u.width = r, u.minWidth = i, u.maxWidth = o)), a
  };

  function Ot(e, t, n) {
    var r = Tt.exec(t);
    return r ? Math.max(0, r[1] - (n || 0)) + (r[2] || "px") : t
  }

  function Ft(e, t, n, r, i) {
    var o = n === (r ? "border" : "content") ? 4 : "width" === t ? 1 : 0,
      s = 0;
    for (; 4 > o; o += 2) "margin" === n && (s += x.css(e, n + jt[o], !0, i)), r ? ("content" === n && (s -= x.css(e, "padding" + jt[o], !0, i)), "margin" !== n && (s -= x.css(e, "border" + jt[o] + "Width", !0, i))) : (s += x.css(e, "padding" + jt[o], !0, i), "padding" !== n && (s += x.css(e, "border" + jt[o] + "Width", !0, i)));
    return s
  }

  function Pt(e, t, n) {
    var r = !0,
      i = "width" === t ? e.offsetWidth : e.offsetHeight,
      o = qt(e),
      s = x.support.boxSizing && "border-box" === x.css(e, "boxSizing", !1, o);
    if (0 >= i || null == i) {
      if (i = vt(e, t, o), (0 > i || null == i) && (i = e.style[t]), Ct.test(i)) return i;
      r = s && (x.support.boxSizingReliable || i === e.style[t]), i = parseFloat(i) || 0
    }
    return i + Ft(e, t, n || (s ? "border" : "content"), r, o) + "px"
  }

  function Rt(e) {
    var t = o,
      n = Nt[e];
    return n || (n = Mt(e, t), "none" !== n && n || (xt = (xt || x("<iframe frameborder='0' width='0' height='0'/>").css("cssText", "display:block !important")).appendTo(t.documentElement), t = (xt[0].contentWindow || xt[0].contentDocument).document, t.write("<!doctype html><html><body>"), t.close(), n = Mt(e, t), xt.detach()), Nt[e] = n), n
  }

  function Mt(e, t) {
    var n = x(t.createElement(e)).appendTo(t.body),
      r = x.css(n[0], "display");
    return n.remove(), r
  }
  x.each(["height", "width"], function(e, t) {
    x.cssHooks[t] = {
      get: function(e, n, r) {
        return n ? 0 === e.offsetWidth && bt.test(x.css(e, "display")) ? x.swap(e, Et, function() {
          return Pt(e, t, r)
        }) : Pt(e, t, r) : undefined
      },
      set: function(e, n, r) {
        var i = r && qt(e);
        return Ot(e, n, r ? Ft(e, t, r, x.support.boxSizing && "border-box" === x.css(e, "boxSizing", !1, i), i) : 0)
      }
    }
  }), x(function() {
    x.support.reliableMarginRight || (x.cssHooks.marginRight = {
      get: function(e, t) {
        return t ? x.swap(e, {
          display: "inline-block"
        }, vt, [e, "marginRight"]) : undefined
      }
    }), !x.support.pixelPosition && x.fn.position && x.each(["top", "left"], function(e, t) {
      x.cssHooks[t] = {
        get: function(e, n) {
          return n ? (n = vt(e, t), Ct.test(n) ? x(e).position()[t] + "px" : n) : undefined
        }
      }
    })
  }), x.expr && x.expr.filters && (x.expr.filters.hidden = function(e) {
    return 0 >= e.offsetWidth && 0 >= e.offsetHeight
  }, x.expr.filters.visible = function(e) {
    return !x.expr.filters.hidden(e)
  }), x.each({
    margin: "",
    padding: "",
    border: "Width"
  }, function(e, t) {
    x.cssHooks[e + t] = {
      expand: function(n) {
        var r = 0,
          i = {},
          o = "string" == typeof n ? n.split(" ") : [n];
        for (; 4 > r; r++) i[e + jt[r] + t] = o[r] || o[r - 2] || o[0];
        return i
      }
    }, wt.test(e) || (x.cssHooks[e + t].set = Ot)
  });
  var Wt = /%20/g,
    $t = /\[\]$/,
    Bt = /\r?\n/g,
    It = /^(?:submit|button|image|reset|file)$/i,
    zt = /^(?:input|select|textarea|keygen)/i;
  x.fn.extend({
    serialize: function() {
      return x.param(this.serializeArray())
    },
    serializeArray: function() {
      return this.map(function() {
        var e = x.prop(this, "elements");
        return e ? x.makeArray(e) : this
      }).filter(function() {
        var e = this.type;
        return this.name && !x(this).is(":disabled") && zt.test(this.nodeName) && !It.test(e) && (this.checked || !ot.test(e))
      }).map(function(e, t) {
        var n = x(this).val();
        return null == n ? null : x.isArray(n) ? x.map(n, function(e) {
          return {
            name: t.name,
            value: e.replace(Bt, "\r\n")
          }
        }) : {
          name: t.name,
          value: n.replace(Bt, "\r\n")
        }
      }).get()
    }
  }), x.param = function(e, t) {
    var n, r = [],
      i = function(e, t) {
        t = x.isFunction(t) ? t() : null == t ? "" : t, r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t)
      };
    if (t === undefined && (t = x.ajaxSettings && x.ajaxSettings.traditional), x.isArray(e) || e.jquery && !x.isPlainObject(e)) x.each(e, function() {
      i(this.name, this.value)
    });
    else
      for (n in e) _t(n, e[n], t, i);
    return r.join("&").replace(Wt, "+")
  };

  function _t(e, t, n, r) {
    var i;
    if (x.isArray(t)) x.each(t, function(t, i) {
      n || $t.test(e) ? r(e, i) : _t(e + "[" + ("object" == typeof i ? t : "") + "]", i, n, r)
    });
    else if (n || "object" !== x.type(t)) r(e, t);
    else
      for (i in t) _t(e + "[" + i + "]", t[i], n, r)
  }
  x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(e, t) {
    x.fn[t] = function(e, n) {
      return arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t)
    }
  }), x.fn.extend({
    hover: function(e, t) {
      return this.mouseenter(e).mouseleave(t || e)
    },
    bind: function(e, t, n) {
      return this.on(e, null, t, n)
    },
    unbind: function(e, t) {
      return this.off(e, null, t)
    },
    delegate: function(e, t, n, r) {
      return this.on(t, e, n, r)
    },
    undelegate: function(e, t, n) {
      return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", n)
    }
  });
  var Xt, Ut, Yt = x.now(),
    Vt = /\?/,
    Gt = /#.*$/,
    Jt = /([?&])_=[^&]*/,
    Qt = /^(.*?):[ \t]*([^\r\n]*)$/gm,
    Kt = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
    Zt = /^(?:GET|HEAD)$/,
    en = /^\/\//,
    tn = /^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,
    nn = x.fn.load,
    rn = {},
    on = {},
    sn = "*/".concat("*");
  try {
    Ut = i.href
  } catch (an) {
    Ut = o.createElement("a"), Ut.href = "", Ut = Ut.href
  }
  Xt = tn.exec(Ut.toLowerCase()) || [];

  function un(e) {
    return function(t, n) {
      "string" != typeof t && (n = t, t = "*");
      var r, i = 0,
        o = t.toLowerCase().match(w) || [];
      if (x.isFunction(n))
        while (r = o[i++]) "+" === r[0] ? (r = r.slice(1) || "*", (e[r] = e[r] || []).unshift(n)) : (e[r] = e[r] || []).push(n)
    }
  }

  function ln(e, t, n, r) {
    var i = {},
      o = e === on;

    function s(a) {
      var u;
      return i[a] = !0, x.each(e[a] || [], function(e, a) {
        var l = a(t, n, r);
        return "string" != typeof l || o || i[l] ? o ? !(u = l) : undefined : (t.dataTypes.unshift(l), s(l), !1)
      }), u
    }
    return s(t.dataTypes[0]) || !i["*"] && s("*")
  }

  function cn(e, t) {
    var n, r, i = x.ajaxSettings.flatOptions || {};
    for (n in t) t[n] !== undefined && ((i[n] ? e : r || (r = {}))[n] = t[n]);
    return r && x.extend(!0, e, r), e
  }
  x.fn.load = function(e, t, n) {
    if ("string" != typeof e && nn) return nn.apply(this, arguments);
    var r, i, o, s = this,
      a = e.indexOf(" ");
    return a >= 0 && (r = e.slice(a), e = e.slice(0, a)), x.isFunction(t) ? (n = t, t = undefined) : t && "object" == typeof t && (i = "POST"), s.length > 0 && x.ajax({
      url: e,
      type: i,
      dataType: "html",
      data: t
    }).done(function(e) {
      o = arguments, s.html(r ? x("<div>").append(x.parseHTML(e)).find(r) : e)
    }).complete(n && function(e, t) {
      s.each(n, o || [e.responseText, t, e])
    }), this
  }, x.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(e, t) {
    x.fn[t] = function(e) {
      return this.on(t, e)
    }
  }), x.extend({
    active: 0,
    lastModified: {},
    etag: {},
    ajaxSettings: {
      url: Ut,
      type: "GET",
      isLocal: Kt.test(Xt[1]),
      global: !0,
      processData: !0,
      async: !0,
      contentType: "application/x-www-form-urlencoded; charset=UTF-8",
      accepts: {
        "*": sn,
        text: "text/plain",
        html: "text/html",
        xml: "application/xml, text/xml",
        json: "application/json, text/javascript"
      },
      contents: {
        xml: /xml/,
        html: /html/,
        json: /json/
      },
      responseFields: {
        xml: "responseXML",
        text: "responseText",
        json: "responseJSON"
      },
      converters: {
        "* text": String,
        "text html": !0,
        "text json": x.parseJSON,
        "text xml": x.parseXML
      },
      flatOptions: {
        url: !0,
        context: !0
      }
    },
    ajaxSetup: function(e, t) {
      return t ? cn(cn(e, x.ajaxSettings), t) : cn(x.ajaxSettings, e)
    },
    ajaxPrefilter: un(rn),
    ajaxTransport: un(on),
    ajax: function(e, t) {
      "object" == typeof e && (t = e, e = undefined), t = t || {};
      var n, r, i, o, s, a, u, l, c = x.ajaxSetup({}, t),
        p = c.context || c,
        f = c.context && (p.nodeType || p.jquery) ? x(p) : x.event,
        h = x.Deferred(),
        d = x.Callbacks("once memory"),
        g = c.statusCode || {},
        m = {},
        y = {},
        v = 0,
        b = "canceled",
        T = {
          readyState: 0,
          getResponseHeader: function(e) {
            var t;
            if (2 === v) {
              if (!o) {
                o = {};
                while (t = Qt.exec(i)) o[t[1].toLowerCase()] = t[2]
              }
              t = o[e.toLowerCase()]
            }
            return null == t ? null : t
          },
          getAllResponseHeaders: function() {
            return 2 === v ? i : null
          },
          setRequestHeader: function(e, t) {
            var n = e.toLowerCase();
            return v || (e = y[n] = y[n] || e, m[e] = t), this
          },
          overrideMimeType: function(e) {
            return v || (c.mimeType = e), this
          },
          statusCode: function(e) {
            var t;
            if (e)
              if (2 > v)
                for (t in e) g[t] = [g[t], e[t]];
              else T.always(e[T.status]);
            return this
          },
          abort: function(e) {
            var t = e || b;
            return n && n.abort(t), k(0, t), this
          }
        };
      if (h.promise(T).complete = d.add, T.success = T.done, T.error = T.fail, c.url = ((e || c.url || Ut) + "").replace(Gt, "").replace(en, Xt[1] + "//"), c.type = t.method || t.type || c.method || c.type, c.dataTypes = x.trim(c.dataType || "*").toLowerCase().match(w) || [""], null == c.crossDomain && (a = tn.exec(c.url.toLowerCase()), c.crossDomain = !(!a || a[1] === Xt[1] && a[2] === Xt[2] && (a[3] || ("http:" === a[1] ? "80" : "443")) === (Xt[3] || ("http:" === Xt[1] ? "80" : "443")))), c.data && c.processData && "string" != typeof c.data && (c.data = x.param(c.data, c.traditional)), ln(rn, c, t, T), 2 === v) return T;
      u = c.global, u && 0 === x.active++ && x.event.trigger("ajaxStart"), c.type = c.type.toUpperCase(), c.hasContent = !Zt.test(c.type), r = c.url, c.hasContent || (c.data && (r = c.url += (Vt.test(r) ? "&" : "?") + c.data, delete c.data), c.cache === !1 && (c.url = Jt.test(r) ? r.replace(Jt, "$1_=" + Yt++) : r + (Vt.test(r) ? "&" : "?") + "_=" + Yt++)), c.ifModified && (x.lastModified[r] && T.setRequestHeader("If-Modified-Since", x.lastModified[r]), x.etag[r] && T.setRequestHeader("If-None-Match", x.etag[r])), (c.data && c.hasContent && c.contentType !== !1 || t.contentType) && T.setRequestHeader("Content-Type", c.contentType), T.setRequestHeader("Accept", c.dataTypes[0] && c.accepts[c.dataTypes[0]] ? c.accepts[c.dataTypes[0]] + ("*" !== c.dataTypes[0] ? ", " + sn + "; q=0.01" : "") : c.accepts["*"]);
      for (l in c.headers) T.setRequestHeader(l, c.headers[l]);
      if (c.beforeSend && (c.beforeSend.call(p, T, c) === !1 || 2 === v)) return T.abort();
      b = "abort";
      for (l in {
          success: 1,
          error: 1,
          complete: 1
        }) T[l](c[l]);
      if (n = ln(on, c, t, T)) {
        T.readyState = 1, u && f.trigger("ajaxSend", [T, c]), c.async && c.timeout > 0 && (s = setTimeout(function() {
          T.abort("timeout")
        }, c.timeout));
        try {
          v = 1, n.send(m, k)
        } catch (C) {
          if (!(2 > v)) throw C;
          k(-1, C)
        }
      } else k(-1, "No Transport");

      function k(e, t, o, a) {
        var l, m, y, b, w, C = t;
        2 !== v && (v = 2, s && clearTimeout(s), n = undefined, i = a || "", T.readyState = e > 0 ? 4 : 0, l = e >= 200 && 300 > e || 304 === e, o && (b = pn(c, T, o)), b = fn(c, b, T, l), l ? (c.ifModified && (w = T.getResponseHeader("Last-Modified"), w && (x.lastModified[r] = w), w = T.getResponseHeader("etag"), w && (x.etag[r] = w)), 204 === e || "HEAD" === c.type ? C = "nocontent" : 304 === e ? C = "notmodified" : (C = b.state, m = b.data, y = b.error, l = !y)) : (y = C, (e || !C) && (C = "error", 0 > e && (e = 0))), T.status = e, T.statusText = (t || C) + "", l ? h.resolveWith(p, [m, C, T]) : h.rejectWith(p, [T, C, y]), T.statusCode(g), g = undefined, u && f.trigger(l ? "ajaxSuccess" : "ajaxError", [T, c, l ? m : y]), d.fireWith(p, [T, C]), u && (f.trigger("ajaxComplete", [T, c]), --x.active || x.event.trigger("ajaxStop")))
      }
      return T
    },
    getJSON: function(e, t, n) {
      return x.get(e, t, n, "json")
    },
    getScript: function(e, t) {
      return x.get(e, undefined, t, "script")
    }
  }), x.each(["get", "post"], function(e, t) {
    x[t] = function(e, n, r, i) {
      return x.isFunction(n) && (i = i || r, r = n, n = undefined), x.ajax({
        url: e,
        type: t,
        dataType: i,
        data: n,
        success: r
      })
    }
  });

  function pn(e, t, n) {
    var r, i, o, s, a = e.contents,
      u = e.dataTypes;
    while ("*" === u[0]) u.shift(), r === undefined && (r = e.mimeType || t.getResponseHeader("Content-Type"));
    if (r)
      for (i in a)
        if (a[i] && a[i].test(r)) {
          u.unshift(i);
          break
        }
    if (u[0] in n) o = u[0];
    else {
      for (i in n) {
        if (!u[0] || e.converters[i + " " + u[0]]) {
          o = i;
          break
        }
        s || (s = i)
      }
      o = o || s
    }
    return o ? (o !== u[0] && u.unshift(o), n[o]) : undefined
  }

  function fn(e, t, n, r) {
    var i, o, s, a, u, l = {},
      c = e.dataTypes.slice();
    if (c[1])
      for (s in e.converters) l[s.toLowerCase()] = e.converters[s];
    o = c.shift();
    while (o)
      if (e.responseFields[o] && (n[e.responseFields[o]] = t), !u && r && e.dataFilter && (t = e.dataFilter(t, e.dataType)), u = o, o = c.shift())
        if ("*" === o) o = u;
        else if ("*" !== u && u !== o) {
      if (s = l[u + " " + o] || l["* " + o], !s)
        for (i in l)
          if (a = i.split(" "), a[1] === o && (s = l[u + " " + a[0]] || l["* " + a[0]])) {
            s === !0 ? s = l[i] : l[i] !== !0 && (o = a[0], c.unshift(a[1]));
            break
          }
      if (s !== !0)
        if (s && e["throws"]) t = s(t);
        else try {
          t = s(t)
        } catch (p) {
          return {
            state: "parsererror",
            error: s ? p : "No conversion from " + u + " to " + o
          }
        }
    }
    return {
      state: "success",
      data: t
    }
  }
  x.ajaxSetup({
    accepts: {
      script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
    },
    contents: {
      script: /(?:java|ecma)script/
    },
    converters: {
      "text script": function(e) {
        return x.globalEval(e), e
      }
    }
  }), x.ajaxPrefilter("script", function(e) {
    e.cache === undefined && (e.cache = !1), e.crossDomain && (e.type = "GET")
  }), x.ajaxTransport("script", function(e) {
    if (e.crossDomain) {
      var t, n;
      return {
        send: function(r, i) {
          t = x("<script>").prop({
            async: !0,
            charset: e.scriptCharset,
            src: e.url
          }).on("load error", n = function(e) {
            t.remove(), n = null, e && i("error" === e.type ? 404 : 200, e.type)
          }), o.head.appendChild(t[0])
        },
        abort: function() {
          n && n()
        }
      }
    }
  });
  var hn = [],
    dn = /(=)\?(?=&|$)|\?\?/;
  x.ajaxSetup({
    jsonp: "callback",
    jsonpCallback: function() {
      var e = hn.pop() || x.expando + "_" + Yt++;
      return this[e] = !0, e
    }
  }), x.ajaxPrefilter("json jsonp", function(t, n, r) {
    var i, o, s, a = t.jsonp !== !1 && (dn.test(t.url) ? "url" : "string" == typeof t.data && !(t.contentType || "").indexOf("application/x-www-form-urlencoded") && dn.test(t.data) && "data");
    return a || "jsonp" === t.dataTypes[0] ? (i = t.jsonpCallback = x.isFunction(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback, a ? t[a] = t[a].replace(dn, "$1" + i) : t.jsonp !== !1 && (t.url += (Vt.test(t.url) ? "&" : "?") + t.jsonp + "=" + i), t.converters["script json"] = function() {
      return s || x.error(i + " was not called"), s[0]
    }, t.dataTypes[0] = "json", o = e[i], e[i] = function() {
      s = arguments
    }, r.always(function() {
      e[i] = o, t[i] && (t.jsonpCallback = n.jsonpCallback, hn.push(i)), s && x.isFunction(o) && o(s[0]), s = o = undefined
    }), "script") : undefined
  }), x.ajaxSettings.xhr = function() {
    try {
      return new XMLHttpRequest
    } catch (e) {}
  };
  var gn = x.ajaxSettings.xhr(),
    mn = {
      0: 200,
      1223: 204
    },
    yn = 0,
    vn = {};
  e.ActiveXObject && x(e).on("unload", function() {
    for (var e in vn) vn[e]();
    vn = undefined
  }), x.support.cors = !!gn && "withCredentials" in gn, x.support.ajax = gn = !!gn, x.ajaxTransport(function(e) {
    var t;
    return x.support.cors || gn && !e.crossDomain ? {
      send: function(n, r) {
        var i, o, s = e.xhr();
        if (s.open(e.type, e.url, e.async, e.username, e.password), e.xhrFields)
          for (i in e.xhrFields) s[i] = e.xhrFields[i];
        e.mimeType && s.overrideMimeType && s.overrideMimeType(e.mimeType), e.crossDomain || n["X-Requested-With"] || (n["X-Requested-With"] = "XMLHttpRequest");
        for (i in n) s.setRequestHeader(i, n[i]);
        t = function(e) {
          return function() {
            t && (delete vn[o], t = s.onload = s.onerror = null, "abort" === e ? s.abort() : "error" === e ? r(s.status || 404, s.statusText) : r(mn[s.status] || s.status, s.statusText, "string" == typeof s.responseText ? {
              text: s.responseText
            } : undefined, s.getAllResponseHeaders()))
          }
        }, s.onload = t(), s.onerror = t("error"), t = vn[o = yn++] = t("abort"), s.send(e.hasContent && e.data || null)
      },
      abort: function() {
        t && t()
      }
    } : undefined
  });
  var xn, bn, wn = /^(?:toggle|show|hide)$/,
    Tn = RegExp("^(?:([+-])=|)(" + b + ")([a-z%]*)$", "i"),
    Cn = /queueHooks$/,
    kn = [An],
    Nn = {
      "*": [function(e, t) {
        var n = this.createTween(e, t),
          r = n.cur(),
          i = Tn.exec(t),
          o = i && i[3] || (x.cssNumber[e] ? "" : "px"),
          s = (x.cssNumber[e] || "px" !== o && +r) && Tn.exec(x.css(n.elem, e)),
          a = 1,
          u = 20;
        if (s && s[3] !== o) {
          o = o || s[3], i = i || [], s = +r || 1;
          do a = a || ".5", s /= a, x.style(n.elem, e, s + o); while (a !== (a = n.cur() / r) && 1 !== a && --u)
        }
        return i && (s = n.start = +s || +r || 0, n.unit = o, n.end = i[1] ? s + (i[1] + 1) * i[2] : +i[2]), n
      }]
    };

  function En() {
    return setTimeout(function() {
      xn = undefined
    }), xn = x.now()
  }

  function Sn(e, t, n) {
    var r, i = (Nn[t] || []).concat(Nn["*"]),
      o = 0,
      s = i.length;
    for (; s > o; o++)
      if (r = i[o].call(n, t, e)) return r
  }

  function jn(e, t, n) {
    var r, i, o = 0,
      s = kn.length,
      a = x.Deferred().always(function() {
        delete u.elem
      }),
      u = function() {
        if (i) return !1;
        var t = xn || En(),
          n = Math.max(0, l.startTime + l.duration - t),
          r = n / l.duration || 0,
          o = 1 - r,
          s = 0,
          u = l.tweens.length;
        for (; u > s; s++) l.tweens[s].run(o);
        return a.notifyWith(e, [l, o, n]), 1 > o && u ? n : (a.resolveWith(e, [l]), !1)
      },
      l = a.promise({
        elem: e,
        props: x.extend({}, t),
        opts: x.extend(!0, {
          specialEasing: {}
        }, n),
        originalProperties: t,
        originalOptions: n,
        startTime: xn || En(),
        duration: n.duration,
        tweens: [],
        createTween: function(t, n) {
          var r = x.Tween(e, l.opts, t, n, l.opts.specialEasing[t] || l.opts.easing);
          return l.tweens.push(r), r
        },
        stop: function(t) {
          var n = 0,
            r = t ? l.tweens.length : 0;
          if (i) return this;
          for (i = !0; r > n; n++) l.tweens[n].run(1);
          return t ? a.resolveWith(e, [l, t]) : a.rejectWith(e, [l, t]), this
        }
      }),
      c = l.props;
    for (Dn(c, l.opts.specialEasing); s > o; o++)
      if (r = kn[o].call(l, e, c, l.opts)) return r;
    return x.map(c, Sn, l), x.isFunction(l.opts.start) && l.opts.start.call(e, l), x.fx.timer(x.extend(u, {
      elem: e,
      anim: l,
      queue: l.opts.queue
    })), l.progress(l.opts.progress).done(l.opts.done, l.opts.complete).fail(l.opts.fail).always(l.opts.always)
  }

  function Dn(e, t) {
    var n, r, i, o, s;
    for (n in e)
      if (r = x.camelCase(n), i = t[r], o = e[n], x.isArray(o) && (i = o[1], o = e[n] = o[0]), n !== r && (e[r] = o, delete e[n]), s = x.cssHooks[r], s && "expand" in s) {
        o = s.expand(o), delete e[r];
        for (n in o) n in e || (e[n] = o[n], t[n] = i)
      } else t[r] = i
  }
  x.Animation = x.extend(jn, {
    tweener: function(e, t) {
      x.isFunction(e) ? (t = e, e = ["*"]) : e = e.split(" ");
      var n, r = 0,
        i = e.length;
      for (; i > r; r++) n = e[r], Nn[n] = Nn[n] || [], Nn[n].unshift(t)
    },
    prefilter: function(e, t) {
      t ? kn.unshift(e) : kn.push(e)
    }
  });

  function An(e, t, n) {
    var r, i, o, s, a, u, l = this,
      c = {},
      p = e.style,
      f = e.nodeType && Lt(e),
      h = q.get(e, "fxshow");
    n.queue || (a = x._queueHooks(e, "fx"), null == a.unqueued && (a.unqueued = 0, u = a.empty.fire, a.empty.fire = function() {
      a.unqueued || u()
    }), a.unqueued++, l.always(function() {
      l.always(function() {
        a.unqueued--, x.queue(e, "fx").length || a.empty.fire()
      })
    })), 1 === e.nodeType && ("height" in t || "width" in t) && (n.overflow = [p.overflow, p.overflowX, p.overflowY], "inline" === x.css(e, "display") && "none" === x.css(e, "float") && (p.display = "inline-block")), n.overflow && (p.overflow = "hidden", l.always(function() {
      p.overflow = n.overflow[0], p.overflowX = n.overflow[1], p.overflowY = n.overflow[2]
    }));
    for (r in t)
      if (i = t[r], wn.exec(i)) {
        if (delete t[r], o = o || "toggle" === i, i === (f ? "hide" : "show")) {
          if ("show" !== i || !h || h[r] === undefined) continue;
          f = !0
        }
        c[r] = h && h[r] || x.style(e, r)
      }
    if (!x.isEmptyObject(c)) {
      h ? "hidden" in h && (f = h.hidden) : h = q.access(e, "fxshow", {}), o && (h.hidden = !f), f ? x(e).show() : l.done(function() {
        x(e).hide()
      }), l.done(function() {
        var t;
        q.remove(e, "fxshow");
        for (t in c) x.style(e, t, c[t])
      });
      for (r in c) s = Sn(f ? h[r] : 0, r, l), r in h || (h[r] = s.start, f && (s.end = s.start, s.start = "width" === r || "height" === r ? 1 : 0))
    }
  }

  function Ln(e, t, n, r, i) {
    return new Ln.prototype.init(e, t, n, r, i)
  }
  x.Tween = Ln, Ln.prototype = {
    constructor: Ln,
    init: function(e, t, n, r, i, o) {
      this.elem = e, this.prop = n, this.easing = i || "swing", this.options = t, this.start = this.now = this.cur(), this.end = r, this.unit = o || (x.cssNumber[n] ? "" : "px")
    },
    cur: function() {
      var e = Ln.propHooks[this.prop];
      return e && e.get ? e.get(this) : Ln.propHooks._default.get(this)
    },
    run: function(e) {
      var t, n = Ln.propHooks[this.prop];
      return this.pos = t = this.options.duration ? x.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), n && n.set ? n.set(this) : Ln.propHooks._default.set(this), this
    }
  }, Ln.prototype.init.prototype = Ln.prototype, Ln.propHooks = {
    _default: {
      get: function(e) {
        var t;
        return null == e.elem[e.prop] || e.elem.style && null != e.elem.style[e.prop] ? (t = x.css(e.elem, e.prop, ""), t && "auto" !== t ? t : 0) : e.elem[e.prop]
      },
      set: function(e) {
        x.fx.step[e.prop] ? x.fx.step[e.prop](e) : e.elem.style && (null != e.elem.style[x.cssProps[e.prop]] || x.cssHooks[e.prop]) ? x.style(e.elem, e.prop, e.now + e.unit) : e.elem[e.prop] = e.now
      }
    }
  }, Ln.propHooks.scrollTop = Ln.propHooks.scrollLeft = {
    set: function(e) {
      e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now)
    }
  }, x.each(["toggle", "show", "hide"], function(e, t) {
    var n = x.fn[t];
    x.fn[t] = function(e, r, i) {
      return null == e || "boolean" == typeof e ? n.apply(this, arguments) : this.animate(qn(t, !0), e, r, i)
    }
  }), x.fn.extend({
    fadeTo: function(e, t, n, r) {
      return this.filter(Lt).css("opacity", 0).show().end().animate({
        opacity: t
      }, e, n, r)
    },
    animate: function(e, t, n, r) {
      var i = x.isEmptyObject(e),
        o = x.speed(t, n, r),
        s = function() {
          var t = jn(this, x.extend({}, e), o);
          (i || q.get(this, "finish")) && t.stop(!0)
        };
      return s.finish = s, i || o.queue === !1 ? this.each(s) : this.queue(o.queue, s)
    },
    stop: function(e, t, n) {
      var r = function(e) {
        var t = e.stop;
        delete e.stop, t(n)
      };
      return "string" != typeof e && (n = t, t = e, e = undefined), t && e !== !1 && this.queue(e || "fx", []), this.each(function() {
        var t = !0,
          i = null != e && e + "queueHooks",
          o = x.timers,
          s = q.get(this);
        if (i) s[i] && s[i].stop && r(s[i]);
        else
          for (i in s) s[i] && s[i].stop && Cn.test(i) && r(s[i]);
        for (i = o.length; i--;) o[i].elem !== this || null != e && o[i].queue !== e || (o[i].anim.stop(n), t = !1, o.splice(i, 1));
        (t || !n) && x.dequeue(this, e)
      })
    },
    finish: function(e) {
      return e !== !1 && (e = e || "fx"), this.each(function() {
        var t, n = q.get(this),
          r = n[e + "queue"],
          i = n[e + "queueHooks"],
          o = x.timers,
          s = r ? r.length : 0;
        for (n.finish = !0, x.queue(this, e, []), i && i.stop && i.stop.call(this, !0), t = o.length; t--;) o[t].elem === this && o[t].queue === e && (o[t].anim.stop(!0), o.splice(t, 1));
        for (t = 0; s > t; t++) r[t] && r[t].finish && r[t].finish.call(this);
        delete n.finish
      })
    }
  });

  function qn(e, t) {
    var n, r = {
        height: e
      },
      i = 0;
    for (t = t ? 1 : 0; 4 > i; i += 2 - t) n = jt[i], r["margin" + n] = r["padding" + n] = e;
    return t && (r.opacity = r.width = e), r
  }
  x.each({
    slideDown: qn("show"),
    slideUp: qn("hide"),
    slideToggle: qn("toggle"),
    fadeIn: {
      opacity: "show"
    },
    fadeOut: {
      opacity: "hide"
    },
    fadeToggle: {
      opacity: "toggle"
    }
  }, function(e, t) {
    x.fn[e] = function(e, n, r) {
      return this.animate(t, e, n, r)
    }
  }), x.speed = function(e, t, n) {
    var r = e && "object" == typeof e ? x.extend({}, e) : {
      complete: n || !n && t || x.isFunction(e) && e,
      duration: e,
      easing: n && t || t && !x.isFunction(t) && t
    };
    return r.duration = x.fx.off ? 0 : "number" == typeof r.duration ? r.duration : r.duration in x.fx.speeds ? x.fx.speeds[r.duration] : x.fx.speeds._default, (null == r.queue || r.queue === !0) && (r.queue = "fx"), r.old = r.complete, r.complete = function() {
      x.isFunction(r.old) && r.old.call(this), r.queue && x.dequeue(this, r.queue)
    }, r
  }, x.easing = {
    linear: function(e) {
      return e
    },
    swing: function(e) {
      return .5 - Math.cos(e * Math.PI) / 2
    }
  }, x.timers = [], x.fx = Ln.prototype.init, x.fx.tick = function() {
    var e, t = x.timers,
      n = 0;
    for (xn = x.now(); t.length > n; n++) e = t[n], e() || t[n] !== e || t.splice(n--, 1);
    t.length || x.fx.stop(), xn = undefined
  }, x.fx.timer = function(e) {
    e() && x.timers.push(e) && x.fx.start()
  }, x.fx.interval = 13, x.fx.start = function() {
    bn || (bn = setInterval(x.fx.tick, x.fx.interval))
  }, x.fx.stop = function() {
    clearInterval(bn), bn = null
  }, x.fx.speeds = {
    slow: 600,
    fast: 200,
    _default: 400
  }, x.fx.step = {}, x.expr && x.expr.filters && (x.expr.filters.animated = function(e) {
    return x.grep(x.timers, function(t) {
      return e === t.elem
    }).length
  }), x.fn.offset = function(e) {
    if (arguments.length) return e === undefined ? this : this.each(function(t) {
      x.offset.setOffset(this, e, t)
    });
    var t, n, i = this[0],
      o = {
        top: 0,
        left: 0
      },
      s = i && i.ownerDocument;
    if (s) return t = s.documentElement, x.contains(t, i) ? (typeof i.getBoundingClientRect !== r && (o = i.getBoundingClientRect()), n = Hn(s), {
      top: o.top + n.pageYOffset - t.clientTop,
      left: o.left + n.pageXOffset - t.clientLeft
    }) : o
  }, x.offset = {
    setOffset: function(e, t, n) {
      var r, i, o, s, a, u, l, c = x.css(e, "position"),
        p = x(e),
        f = {};
      "static" === c && (e.style.position = "relative"), a = p.offset(), o = x.css(e, "top"), u = x.css(e, "left"), l = ("absolute" === c || "fixed" === c) && (o + u).indexOf("auto") > -1, l ? (r = p.position(), s = r.top, i = r.left) : (s = parseFloat(o) || 0, i = parseFloat(u) || 0), x.isFunction(t) && (t = t.call(e, n, a)), null != t.top && (f.top = t.top - a.top + s), null != t.left && (f.left = t.left - a.left + i), "using" in t ? t.using.call(e, f) : p.css(f)
    }
  }, x.fn.extend({
    position: function() {
      if (this[0]) {
        var e, t, n = this[0],
          r = {
            top: 0,
            left: 0
          };
        return "fixed" === x.css(n, "position") ? t = n.getBoundingClientRect() : (e = this.offsetParent(), t = this.offset(), x.nodeName(e[0], "html") || (r = e.offset()), r.top += x.css(e[0], "borderTopWidth", !0), r.left += x.css(e[0], "borderLeftWidth", !0)), {
          top: t.top - r.top - x.css(n, "marginTop", !0),
          left: t.left - r.left - x.css(n, "marginLeft", !0)
        }
      }
    },
    offsetParent: function() {
      return this.map(function() {
        var e = this.offsetParent || s;
        while (e && !x.nodeName(e, "html") && "static" === x.css(e, "position")) e = e.offsetParent;
        return e || s
      })
    }
  }), x.each({
    scrollLeft: "pageXOffset",
    scrollTop: "pageYOffset"
  }, function(t, n) {
    var r = "pageYOffset" === n;
    x.fn[t] = function(i) {
      return x.access(this, function(t, i, o) {
        var s = Hn(t);
        return o === undefined ? s ? s[n] : t[i] : (s ? s.scrollTo(r ? e.pageXOffset : o, r ? o : e.pageYOffset) : t[i] = o, undefined)
      }, t, i, arguments.length, null)
    }
  });

  function Hn(e) {
    return x.isWindow(e) ? e : 9 === e.nodeType && e.defaultView
  }
  x.each({
    Height: "height",
    Width: "width"
  }, function(e, t) {
    x.each({
      padding: "inner" + e,
      content: t,
      "": "outer" + e
    }, function(n, r) {
      x.fn[r] = function(r, i) {
        var o = arguments.length && (n || "boolean" != typeof r),
          s = n || (r === !0 || i === !0 ? "margin" : "border");
        return x.access(this, function(t, n, r) {
          var i;
          return x.isWindow(t) ? t.document.documentElement["client" + e] : 9 === t.nodeType ? (i = t.documentElement, Math.max(t.body["scroll" + e], i["scroll" + e], t.body["offset" + e], i["offset" + e], i["client" + e])) : r === undefined ? x.css(t, n, s) : x.style(t, n, r, s)
        }, t, o ? r : undefined, o, null)
      }
    })
  }), x.fn.size = function() {
    return this.length
  }, x.fn.andSelf = x.fn.addBack, "object" == typeof module && module && "object" == typeof module.exports ? module.exports = x : "function" == typeof define && define.amd && define("jquery", [], function() {
    return x
  }), "object" == typeof e && "object" == typeof e.document && (e.jQuery = e.$ = x)
})(window);

(function(t, e) {
  function i(e, i) {
    var n, o, a, r = e.nodeName.toLowerCase();
    return "area" === r ? (n = e.parentNode, o = n.name, e.href && o && "map" === n.nodeName.toLowerCase() ? (a = t("img[usemap=#" + o + "]")[0], !!a && s(a)) : !1) : (/input|select|textarea|button|object/.test(r) ? !e.disabled : "a" === r ? e.href || i : i) && s(e)
  }

  function s(e) {
    return t.expr.filters.visible(e) && !t(e).parents().addBack().filter(function() {
      return "hidden" === t.css(this, "visibility")
    }).length
  }
  var n = 0,
    o = /^ui-id-\d+$/;
  t.ui = t.ui || {}, t.extend(t.ui, {
    version: "1.10.3",
    keyCode: {
      BACKSPACE: 8,
      COMMA: 188,
      DELETE: 46,
      DOWN: 40,
      END: 35,
      ENTER: 13,
      ESCAPE: 27,
      HOME: 36,
      LEFT: 37,
      NUMPAD_ADD: 107,
      NUMPAD_DECIMAL: 110,
      NUMPAD_DIVIDE: 111,
      NUMPAD_ENTER: 108,
      NUMPAD_MULTIPLY: 106,
      NUMPAD_SUBTRACT: 109,
      PAGE_DOWN: 34,
      PAGE_UP: 33,
      PERIOD: 190,
      RIGHT: 39,
      SPACE: 32,
      TAB: 9,
      UP: 38
    }
  }), t.fn.extend({
    focus: function(e) {
      return function(i, s) {
        return "number" == typeof i ? this.each(function() {
          var e = this;
          setTimeout(function() {
            t(e).focus(), s && s.call(e)
          }, i)
        }) : e.apply(this, arguments)
      }
    }(t.fn.focus),
    scrollParent: function() {
      var e;
      return e = t.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function() {
        return /(relative|absolute|fixed)/.test(t.css(this, "position")) && /(auto|scroll)/.test(t.css(this, "overflow") + t.css(this, "overflow-y") + t.css(this, "overflow-x"))
      }).eq(0) : this.parents().filter(function() {
        return /(auto|scroll)/.test(t.css(this, "overflow") + t.css(this, "overflow-y") + t.css(this, "overflow-x"))
      }).eq(0), /fixed/.test(this.css("position")) || !e.length ? t(document) : e
    },
    zIndex: function(i) {
      if (i !== e) return this.css("zIndex", i);
      if (this.length)
        for (var s, n, o = t(this[0]); o.length && o[0] !== document;) {
          if (s = o.css("position"), ("absolute" === s || "relative" === s || "fixed" === s) && (n = parseInt(o.css("zIndex"), 10), !isNaN(n) && 0 !== n)) return n;
          o = o.parent()
        }
      return 0
    },
    uniqueId: function() {
      return this.each(function() {
        this.id || (this.id = "ui-id-" + ++n)
      })
    },
    removeUniqueId: function() {
      return this.each(function() {
        o.test(this.id) && t(this).removeAttr("id")
      })
    }
  }), t.extend(t.expr[":"], {
    data: t.expr.createPseudo ? t.expr.createPseudo(function(e) {
      return function(i) {
        return !!t.data(i, e)
      }
    }) : function(e, i, s) {
      return !!t.data(e, s[3])
    },
    focusable: function(e) {
      return i(e, !isNaN(t.attr(e, "tabindex")))
    },
    tabbable: function(e) {
      var s = t.attr(e, "tabindex"),
        n = isNaN(s);
      return (n || s >= 0) && i(e, !n)
    }
  }), t("<a>").outerWidth(1).jquery || t.each(["Width", "Height"], function(i, s) {
    function n(e, i, s, n) {
      return t.each(o, function() {
        i -= parseFloat(t.css(e, "padding" + this)) || 0, s && (i -= parseFloat(t.css(e, "border" + this + "Width")) || 0), n && (i -= parseFloat(t.css(e, "margin" + this)) || 0)
      }), i
    }
    var o = "Width" === s ? ["Left", "Right"] : ["Top", "Bottom"],
      a = s.toLowerCase(),
      r = {
        innerWidth: t.fn.innerWidth,
        innerHeight: t.fn.innerHeight,
        outerWidth: t.fn.outerWidth,
        outerHeight: t.fn.outerHeight
      };
    t.fn["inner" + s] = function(i) {
      return i === e ? r["inner" + s].call(this) : this.each(function() {
        t(this).css(a, n(this, i) + "px")
      })
    }, t.fn["outer" + s] = function(e, i) {
      return "number" != typeof e ? r["outer" + s].call(this, e) : this.each(function() {
        t(this).css(a, n(this, e, !0, i) + "px")
      })
    }
  }), t.fn.addBack || (t.fn.addBack = function(t) {
    return this.add(null == t ? this.prevObject : this.prevObject.filter(t))
  }), t("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (t.fn.removeData = function(e) {
    return function(i) {
      return arguments.length ? e.call(this, t.camelCase(i)) : e.call(this)
    }
  }(t.fn.removeData)), t.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), t.support.selectstart = "onselectstart" in document.createElement("div"), t.fn.extend({
    disableSelection: function() {
      return this.bind((t.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(t) {
        t.preventDefault()
      })
    },
    enableSelection: function() {
      return this.unbind(".ui-disableSelection")
    }
  }), t.extend(t.ui, {
    plugin: {
      add: function(e, i, s) {
        var n, o = t.ui[e].prototype;
        for (n in s) o.plugins[n] = o.plugins[n] || [], o.plugins[n].push([i, s[n]])
      },
      call: function(t, e, i) {
        var s, n = t.plugins[e];
        if (n && t.element[0].parentNode && 11 !== t.element[0].parentNode.nodeType)
          for (s = 0; n.length > s; s++) t.options[n[s][0]] && n[s][1].apply(t.element, i)
      }
    },
    hasScroll: function(e, i) {
      if ("hidden" === t(e).css("overflow")) return !1;
      var s = i && "left" === i ? "scrollLeft" : "scrollTop",
        n = !1;
      return e[s] > 0 ? !0 : (e[s] = 1, n = e[s] > 0, e[s] = 0, n)
    }
  })
})(jQuery),
function(t, e) {
  var i = 0,
    s = Array.prototype.slice,
    n = t.cleanData;
  t.cleanData = function(e) {
    for (var i, s = 0; null != (i = e[s]); s++) try {
      t(i).triggerHandler("remove")
    } catch (o) {}
    n(e)
  }, t.widget = function(i, s, n) {
    var o, a, r, h, l = {},
      c = i.split(".")[0];
    i = i.split(".")[1], o = c + "-" + i, n || (n = s, s = t.Widget), t.expr[":"][o.toLowerCase()] = function(e) {
      return !!t.data(e, o)
    }, t[c] = t[c] || {}, a = t[c][i], r = t[c][i] = function(t, i) {
      return this._createWidget ? (arguments.length && this._createWidget(t, i), e) : new r(t, i)
    }, t.extend(r, a, {
      version: n.version,
      _proto: t.extend({}, n),
      _childConstructors: []
    }), h = new s, h.options = t.widget.extend({}, h.options), t.each(n, function(i, n) {
      return t.isFunction(n) ? (l[i] = function() {
        var t = function() {
            return s.prototype[i].apply(this, arguments)
          },
          e = function(t) {
            return s.prototype[i].apply(this, t)
          };
        return function() {
          var i, s = this._super,
            o = this._superApply;
          return this._super = t, this._superApply = e, i = n.apply(this, arguments), this._super = s, this._superApply = o, i
        }
      }(), e) : (l[i] = n, e)
    }), r.prototype = t.widget.extend(h, {
      widgetEventPrefix: a ? h.widgetEventPrefix : i
    }, l, {
      constructor: r,
      namespace: c,
      widgetName: i,
      widgetFullName: o
    }), a ? (t.each(a._childConstructors, function(e, i) {
      var s = i.prototype;
      t.widget(s.namespace + "." + s.widgetName, r, i._proto)
    }), delete a._childConstructors) : s._childConstructors.push(r), t.widget.bridge(i, r)
  }, t.widget.extend = function(i) {
    for (var n, o, a = s.call(arguments, 1), r = 0, h = a.length; h > r; r++)
      for (n in a[r]) o = a[r][n], a[r].hasOwnProperty(n) && o !== e && (i[n] = t.isPlainObject(o) ? t.isPlainObject(i[n]) ? t.widget.extend({}, i[n], o) : t.widget.extend({}, o) : o);
    return i
  }, t.widget.bridge = function(i, n) {
    var o = n.prototype.widgetFullName || i;
    t.fn[i] = function(a) {
      var r = "string" == typeof a,
        h = s.call(arguments, 1),
        l = this;
      return a = !r && h.length ? t.widget.extend.apply(null, [a].concat(h)) : a, r ? this.each(function() {
        var s, n = t.data(this, o);
        return n ? t.isFunction(n[a]) && "_" !== a.charAt(0) ? (s = n[a].apply(n, h), s !== n && s !== e ? (l = s && s.jquery ? l.pushStack(s.get()) : s, !1) : e) : t.error("no such method '" + a + "' for " + i + " widget instance") : t.error("cannot call methods on " + i + " prior to initialization; " + "attempted to call method '" + a + "'")
      }) : this.each(function() {
        var e = t.data(this, o);
        e ? e.option(a || {})._init() : t.data(this, o, new n(a, this))
      }), l
    }
  }, t.Widget = function() {}, t.Widget._childConstructors = [], t.Widget.prototype = {
    widgetName: "widget",
    widgetEventPrefix: "",
    defaultElement: "<div>",
    options: {
      disabled: !1,
      create: null
    },
    _createWidget: function(e, s) {
      s = t(s || this.defaultElement || this)[0], this.element = t(s), this.uuid = i++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = t.widget.extend({}, this.options, this._getCreateOptions(), e), this.bindings = t(), this.hoverable = t(), this.focusable = t(), s !== this && (t.data(s, this.widgetFullName, this), this._on(!0, this.element, {
        remove: function(t) {
          t.target === s && this.destroy()
        }
      }), this.document = t(s.style ? s.ownerDocument : s.document || s), this.window = t(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
    },
    _getCreateOptions: t.noop,
    _getCreateEventData: t.noop,
    _create: t.noop,
    _init: t.noop,
    destroy: function() {
      this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
    },
    _destroy: t.noop,
    widget: function() {
      return this.element
    },
    option: function(i, s) {
      var n, o, a, r = i;
      if (0 === arguments.length) return t.widget.extend({}, this.options);
      if ("string" == typeof i)
        if (r = {}, n = i.split("."), i = n.shift(), n.length) {
          for (o = r[i] = t.widget.extend({}, this.options[i]), a = 0; n.length - 1 > a; a++) o[n[a]] = o[n[a]] || {}, o = o[n[a]];
          if (i = n.pop(), s === e) return o[i] === e ? null : o[i];
          o[i] = s
        } else {
          if (s === e) return this.options[i] === e ? null : this.options[i];
          r[i] = s
        }
      return this._setOptions(r), this
    },
    _setOptions: function(t) {
      var e;
      for (e in t) this._setOption(e, t[e]);
      return this
    },
    _setOption: function(t, e) {
      return this.options[t] = e, "disabled" === t && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!e).attr("aria-disabled", e), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
    },
    enable: function() {
      return this._setOption("disabled", !1)
    },
    disable: function() {
      return this._setOption("disabled", !0)
    },
    _on: function(i, s, n) {
      var o, a = this;
      "boolean" != typeof i && (n = s, s = i, i = !1), n ? (s = o = t(s), this.bindings = this.bindings.add(s)) : (n = s, s = this.element, o = this.widget()), t.each(n, function(n, r) {
        function h() {
          return i || a.options.disabled !== !0 && !t(this).hasClass("ui-state-disabled") ? ("string" == typeof r ? a[r] : r).apply(a, arguments) : e
        }
        "string" != typeof r && (h.guid = r.guid = r.guid || h.guid || t.guid++);
        var l = n.match(/^(\w+)\s*(.*)$/),
          c = l[1] + a.eventNamespace,
          u = l[2];
        u ? o.delegate(u, c, h) : s.bind(c, h)
      })
    },
    _off: function(t, e) {
      e = (e || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, t.unbind(e).undelegate(e)
    },
    _delay: function(t, e) {
      function i() {
        return ("string" == typeof t ? s[t] : t).apply(s, arguments)
      }
      var s = this;
      return setTimeout(i, e || 0)
    },
    _hoverable: function(e) {
      this.hoverable = this.hoverable.add(e), this._on(e, {
        mouseenter: function(e) {
          t(e.currentTarget).addClass("ui-state-hover")
        },
        mouseleave: function(e) {
          t(e.currentTarget).removeClass("ui-state-hover")
        }
      })
    },
    _focusable: function(e) {
      this.focusable = this.focusable.add(e), this._on(e, {
        focusin: function(e) {
          t(e.currentTarget).addClass("ui-state-focus")
        },
        focusout: function(e) {
          t(e.currentTarget).removeClass("ui-state-focus")
        }
      })
    },
    _trigger: function(e, i, s) {
      var n, o, a = this.options[e];
      if (s = s || {}, i = t.Event(i), i.type = (e === this.widgetEventPrefix ? e : this.widgetEventPrefix + e).toLowerCase(), i.target = this.element[0], o = i.originalEvent)
        for (n in o) n in i || (i[n] = o[n]);
      return this.element.trigger(i, s), !(t.isFunction(a) && a.apply(this.element[0], [i].concat(s)) === !1 || i.isDefaultPrevented())
    }
  }, t.each({
    show: "fadeIn",
    hide: "fadeOut"
  }, function(e, i) {
    t.Widget.prototype["_" + e] = function(s, n, o) {
      "string" == typeof n && (n = {
        effect: n
      });
      var a, r = n ? n === !0 || "number" == typeof n ? i : n.effect || i : e;
      n = n || {}, "number" == typeof n && (n = {
        duration: n
      }), a = !t.isEmptyObject(n), n.complete = o, n.delay && s.delay(n.delay), a && t.effects && t.effects.effect[r] ? s[e](n) : r !== e && s[r] ? s[r](n.duration, n.easing, o) : s.queue(function(i) {
        t(this)[e](), o && o.call(s[0]), i()
      })
    }
  })
}(jQuery),
function(t) {
  var e = !1;
  t(document).mouseup(function() {
    e = !1
  }), t.widget("ui.mouse", {
    version: "1.10.3",
    options: {
      cancel: "input,textarea,button,select,option",
      distance: 1,
      delay: 0
    },
    _mouseInit: function() {
      var e = this;
      this.element.bind("mousedown." + this.widgetName, function(t) {
        return e._mouseDown(t)
      }).bind("click." + this.widgetName, function(i) {
        return !0 === t.data(i.target, e.widgetName + ".preventClickEvent") ? (t.removeData(i.target, e.widgetName + ".preventClickEvent"), i.stopImmediatePropagation(), !1) : undefined
      }), this.started = !1
    },
    _mouseDestroy: function() {
      this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && t(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
    },
    _mouseDown: function(i) {
      if (!e) {
        this._mouseStarted && this._mouseUp(i), this._mouseDownEvent = i;
        var s = this,
          n = 1 === i.which,
          o = "string" == typeof this.options.cancel && i.target.nodeName ? t(i.target).closest(this.options.cancel).length : !1;
        return n && !o && this._mouseCapture(i) ? (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
          s.mouseDelayMet = !0
        }, this.options.delay)), this._mouseDistanceMet(i) && this._mouseDelayMet(i) && (this._mouseStarted = this._mouseStart(i) !== !1, !this._mouseStarted) ? (i.preventDefault(), !0) : (!0 === t.data(i.target, this.widgetName + ".preventClickEvent") && t.removeData(i.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(t) {
          return s._mouseMove(t)
        }, this._mouseUpDelegate = function(t) {
          return s._mouseUp(t)
        }, t(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), i.preventDefault(), e = !0, !0)) : !0
      }
    },
    _mouseMove: function(e) {
      return t.ui.ie && (!document.documentMode || 9 > document.documentMode) && !e.button ? this._mouseUp(e) : this._mouseStarted ? (this._mouseDrag(e), e.preventDefault()) : (this._mouseDistanceMet(e) && this._mouseDelayMet(e) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, e) !== !1, this._mouseStarted ? this._mouseDrag(e) : this._mouseUp(e)), !this._mouseStarted)
    },
    _mouseUp: function(e) {
      return t(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, e.target === this._mouseDownEvent.target && t.data(e.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(e)), !1
    },
    _mouseDistanceMet: function(t) {
      return Math.max(Math.abs(this._mouseDownEvent.pageX - t.pageX), Math.abs(this._mouseDownEvent.pageY - t.pageY)) >= this.options.distance
    },
    _mouseDelayMet: function() {
      return this.mouseDelayMet
    },
    _mouseStart: function() {},
    _mouseDrag: function() {},
    _mouseStop: function() {},
    _mouseCapture: function() {
      return !0
    }
  })
}(jQuery),
function(t) {
  t.widget("ui.draggable", t.ui.mouse, {
    version: "1.10.3",
    widgetEventPrefix: "drag",
    options: {
      addClasses: !0,
      appendTo: "parent",
      axis: !1,
      connectToSortable: !1,
      containment: !1,
      cursor: "auto",
      cursorAt: !1,
      grid: !1,
      handle: !1,
      helper: "original",
      iframeFix: !1,
      opacity: !1,
      refreshPositions: !1,
      revert: !1,
      revertDuration: 500,
      scope: "default",
      scroll: !0,
      scrollSensitivity: 20,
      scrollSpeed: 20,
      snap: !1,
      snapMode: "both",
      snapTolerance: 20,
      stack: !1,
      zIndex: !1,
      drag: null,
      start: null,
      stop: null
    },
    _create: function() {
      "original" !== this.options.helper || /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
    },
    _destroy: function() {
      this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy()
    },
    _mouseCapture: function(e) {
      var i = this.options;
      return this.helper || i.disabled || t(e.target).closest(".ui-resizable-handle").length > 0 ? !1 : (this.handle = this._getHandle(e), this.handle ? (t(i.iframeFix === !0 ? "iframe" : i.iframeFix).each(function() {
        t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({
          width: this.offsetWidth + "px",
          height: this.offsetHeight + "px",
          position: "absolute",
          opacity: "0.001",
          zIndex: 1e3
        }).css(t(this).offset()).appendTo("body")
      }), !0) : !1)
    },
    _mouseStart: function(e) {
      var i = this.options;
      return this.helper = this._createHelper(e), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), t.ui.ddmanager && (t.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offsetParent = this.helper.offsetParent(), this.offsetParentCssPosition = this.offsetParent.css("position"), this.offset = this.positionAbs = this.element.offset(), this.offset = {
        top: this.offset.top - this.margins.top,
        left: this.offset.left - this.margins.left
      }, this.offset.scroll = !1, t.extend(this.offset, {
        click: {
          left: e.pageX - this.offset.left,
          top: e.pageY - this.offset.top
        },
        parent: this._getParentOffset(),
        relative: this._getRelativeOffset()
      }), this.originalPosition = this.position = this._generatePosition(e), this.originalPageX = e.pageX, this.originalPageY = e.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), this._setContainment(), this._trigger("start", e) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), t.ui.ddmanager && !i.dropBehaviour && t.ui.ddmanager.prepareOffsets(this, e), this._mouseDrag(e, !0), t.ui.ddmanager && t.ui.ddmanager.dragStart(this, e), !0)
    },
    _mouseDrag: function(e, i) {
      if ("fixed" === this.offsetParentCssPosition && (this.offset.parent = this._getParentOffset()), this.position = this._generatePosition(e), this.positionAbs = this._convertPositionTo("absolute"), !i) {
        var s = this._uiHash();
        if (this._trigger("drag", e, s) === !1) return this._mouseUp({}), !1;
        this.position = s.position
      }
      return this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), t.ui.ddmanager && t.ui.ddmanager.drag(this, e), !1
    },
    _mouseStop: function(e) {
      var i = this,
        s = !1;
      return t.ui.ddmanager && !this.options.dropBehaviour && (s = t.ui.ddmanager.drop(this, e)), this.dropped && (s = this.dropped, this.dropped = !1), "original" !== this.options.helper || t.contains(this.element[0].ownerDocument, this.element[0]) ? ("invalid" === this.options.revert && !s || "valid" === this.options.revert && s || this.options.revert === !0 || t.isFunction(this.options.revert) && this.options.revert.call(this.element, s) ? t(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
        i._trigger("stop", e) !== !1 && i._clear()
      }) : this._trigger("stop", e) !== !1 && this._clear(), !1) : !1
    },
    _mouseUp: function(e) {
      return t("div.ui-draggable-iframeFix").each(function() {
        this.parentNode.removeChild(this)
      }), t.ui.ddmanager && t.ui.ddmanager.dragStop(this, e), t.ui.mouse.prototype._mouseUp.call(this, e)
    },
    cancel: function() {
      return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
    },
    _getHandle: function(e) {
      return this.options.handle ? !!t(e.target).closest(this.element.find(this.options.handle)).length : !0
    },
    _createHelper: function(e) {
      var i = this.options,
        s = t.isFunction(i.helper) ? t(i.helper.apply(this.element[0], [e])) : "clone" === i.helper ? this.element.clone().removeAttr("id") : this.element;
      return s.parents("body").length || s.appendTo("parent" === i.appendTo ? this.element[0].parentNode : i.appendTo), s[0] === this.element[0] || /(fixed|absolute)/.test(s.css("position")) || s.css("position", "absolute"), s
    },
    _adjustOffsetFromHelper: function(e) {
      "string" == typeof e && (e = e.split(" ")), t.isArray(e) && (e = {
        left: +e[0],
        top: +e[1] || 0
      }), "left" in e && (this.offset.click.left = e.left + this.margins.left), "right" in e && (this.offset.click.left = this.helperProportions.width - e.right + this.margins.left), "top" in e && (this.offset.click.top = e.top + this.margins.top), "bottom" in e && (this.offset.click.top = this.helperProportions.height - e.bottom + this.margins.top)
    },
    _getParentOffset: function() {
      var e = this.offsetParent.offset();
      return "absolute" === this.cssPosition && this.scrollParent[0] !== document && t.contains(this.scrollParent[0], this.offsetParent[0]) && (e.left += this.scrollParent.scrollLeft(), e.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && t.ui.ie) && (e = {
        top: 0,
        left: 0
      }), {
        top: e.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
        left: e.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
      }
    },
    _getRelativeOffset: function() {
      if ("relative" === this.cssPosition) {
        var t = this.element.position();
        return {
          top: t.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
          left: t.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
        }
      }
      return {
        top: 0,
        left: 0
      }
    },
    _cacheMargins: function() {
      this.margins = {
        left: parseInt(this.element.css("marginLeft"), 10) || 0,
        top: parseInt(this.element.css("marginTop"), 10) || 0,
        right: parseInt(this.element.css("marginRight"), 10) || 0,
        bottom: parseInt(this.element.css("marginBottom"), 10) || 0
      }
    },
    _cacheHelperProportions: function() {
      this.helperProportions = {
        width: this.helper.outerWidth(),
        height: this.helper.outerHeight()
      }
    },
    _setContainment: function() {
      var e, i, s, n = this.options;
      return n.containment ? "window" === n.containment ? (this.containment = [t(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, t(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, t(window).scrollLeft() + t(window).width() - this.helperProportions.width - this.margins.left, t(window).scrollTop() + (t(window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top], undefined) : "document" === n.containment ? (this.containment = [0, 0, t(document).width() - this.helperProportions.width - this.margins.left, (t(document).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top], undefined) : n.containment.constructor === Array ? (this.containment = n.containment, undefined) : ("parent" === n.containment && (n.containment = this.helper[0].parentNode), i = t(n.containment), s = i[0], s && (e = "hidden" !== i.css("overflow"), this.containment = [(parseInt(i.css("borderLeftWidth"), 10) || 0) + (parseInt(i.css("paddingLeft"), 10) || 0), (parseInt(i.css("borderTopWidth"), 10) || 0) + (parseInt(i.css("paddingTop"), 10) || 0), (e ? Math.max(s.scrollWidth, s.offsetWidth) : s.offsetWidth) - (parseInt(i.css("borderRightWidth"), 10) || 0) - (parseInt(i.css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (e ? Math.max(s.scrollHeight, s.offsetHeight) : s.offsetHeight) - (parseInt(i.css("borderBottomWidth"), 10) || 0) - (parseInt(i.css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = i), undefined) : (this.containment = null, undefined)
    },
    _convertPositionTo: function(e, i) {
      i || (i = this.position);
      var s = "absolute" === e ? 1 : -1,
        n = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && t.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent;
      return this.offset.scroll || (this.offset.scroll = {
        top: n.scrollTop(),
        left: n.scrollLeft()
      }), {
        top: i.top + this.offset.relative.top * s + this.offset.parent.top * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top) * s,
        left: i.left + this.offset.relative.left * s + this.offset.parent.left * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left) * s
      }
    },
    _generatePosition: function(e) {
      var i, s, n, o, a = this.options,
        r = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && t.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
        h = e.pageX,
        l = e.pageY;
      return this.offset.scroll || (this.offset.scroll = {
        top: r.scrollTop(),
        left: r.scrollLeft()
      }), this.originalPosition && (this.containment && (this.relative_container ? (s = this.relative_container.offset(), i = [this.containment[0] + s.left, this.containment[1] + s.top, this.containment[2] + s.left, this.containment[3] + s.top]) : i = this.containment, e.pageX - this.offset.click.left < i[0] && (h = i[0] + this.offset.click.left), e.pageY - this.offset.click.top < i[1] && (l = i[1] + this.offset.click.top), e.pageX - this.offset.click.left > i[2] && (h = i[2] + this.offset.click.left), e.pageY - this.offset.click.top > i[3] && (l = i[3] + this.offset.click.top)), a.grid && (n = a.grid[1] ? this.originalPageY + Math.round((l - this.originalPageY) / a.grid[1]) * a.grid[1] : this.originalPageY, l = i ? n - this.offset.click.top >= i[1] || n - this.offset.click.top > i[3] ? n : n - this.offset.click.top >= i[1] ? n - a.grid[1] : n + a.grid[1] : n, o = a.grid[0] ? this.originalPageX + Math.round((h - this.originalPageX) / a.grid[0]) * a.grid[0] : this.originalPageX, h = i ? o - this.offset.click.left >= i[0] || o - this.offset.click.left > i[2] ? o : o - this.offset.click.left >= i[0] ? o - a.grid[0] : o + a.grid[0] : o)), {
        top: l - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top),
        left: h - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left)
      }
    },
    _clear: function() {
      this.helper.removeClass("ui-draggable-dragging"), this.helper[0] === this.element[0] || this.cancelHelperRemoval || this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
    },
    _trigger: function(e, i, s) {
      return s = s || this._uiHash(), t.ui.plugin.call(this, e, [i, s]), "drag" === e && (this.positionAbs = this._convertPositionTo("absolute")), t.Widget.prototype._trigger.call(this, e, i, s)
    },
    plugins: {},
    _uiHash: function() {
      return {
        helper: this.helper,
        position: this.position,
        originalPosition: this.originalPosition,
        offset: this.positionAbs
      }
    }
  }), t.ui.plugin.add("draggable", "connectToSortable", {
    start: function(e, i) {
      var s = t(this).data("ui-draggable"),
        n = s.options,
        o = t.extend({}, i, {
          item: s.element
        });
      s.sortables = [], t(n.connectToSortable).each(function() {
        var i = t.data(this, "ui-sortable");
        i && !i.options.disabled && (s.sortables.push({
          instance: i,
          shouldRevert: i.options.revert
        }), i.refreshPositions(), i._trigger("activate", e, o))
      })
    },
    stop: function(e, i) {
      var s = t(this).data("ui-draggable"),
        n = t.extend({}, i, {
          item: s.element
        });
      t.each(s.sortables, function() {
        this.instance.isOver ? (this.instance.isOver = 0, s.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = this.shouldRevert), this.instance._mouseStop(e), this.instance.options.helper = this.instance.options._helper, "original" === s.options.helper && this.instance.currentItem.css({
          top: "auto",
          left: "auto"
        })) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", e, n))
      })
    },
    drag: function(e, i) {
      var s = t(this).data("ui-draggable"),
        n = this;
      t.each(s.sortables, function() {
        var o = !1,
          a = this;
        this.instance.positionAbs = s.positionAbs, this.instance.helperProportions = s.helperProportions, this.instance.offset.click = s.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (o = !0, t.each(s.sortables, function() {
          return this.instance.positionAbs = s.positionAbs, this.instance.helperProportions = s.helperProportions, this.instance.offset.click = s.offset.click, this !== a && this.instance._intersectsWith(this.instance.containerCache) && t.contains(a.instance.element[0], this.instance.element[0]) && (o = !1), o
        })), o ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = t(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
          return i.helper[0]
        }, e.target = this.instance.currentItem[0], this.instance._mouseCapture(e, !0), this.instance._mouseStart(e, !0, !0), this.instance.offset.click.top = s.offset.click.top, this.instance.offset.click.left = s.offset.click.left, this.instance.offset.parent.left -= s.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= s.offset.parent.top - this.instance.offset.parent.top, s._trigger("toSortable", e), s.dropped = this.instance.element, s.currentItem = s.element, this.instance.fromOutside = s), this.instance.currentItem && this.instance._mouseDrag(e)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", e, this.instance._uiHash(this.instance)), this.instance._mouseStop(e, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), s._trigger("fromSortable", e), s.dropped = !1)
      })
    }
  }), t.ui.plugin.add("draggable", "cursor", {
    start: function() {
      var e = t("body"),
        i = t(this).data("ui-draggable").options;
      e.css("cursor") && (i._cursor = e.css("cursor")), e.css("cursor", i.cursor)
    },
    stop: function() {
      var e = t(this).data("ui-draggable").options;
      e._cursor && t("body").css("cursor", e._cursor)
    }
  }), t.ui.plugin.add("draggable", "opacity", {
    start: function(e, i) {
      var s = t(i.helper),
        n = t(this).data("ui-draggable").options;
      s.css("opacity") && (n._opacity = s.css("opacity")), s.css("opacity", n.opacity)
    },
    stop: function(e, i) {
      var s = t(this).data("ui-draggable").options;
      s._opacity && t(i.helper).css("opacity", s._opacity)
    }
  }), t.ui.plugin.add("draggable", "scroll", {
    start: function() {
      var e = t(this).data("ui-draggable");
      e.scrollParent[0] !== document && "HTML" !== e.scrollParent[0].tagName && (e.overflowOffset = e.scrollParent.offset())
    },
    drag: function(e) {
      var i = t(this).data("ui-draggable"),
        s = i.options,
        n = !1;
      i.scrollParent[0] !== document && "HTML" !== i.scrollParent[0].tagName ? (s.axis && "x" === s.axis || (i.overflowOffset.top + i.scrollParent[0].offsetHeight - e.pageY < s.scrollSensitivity ? i.scrollParent[0].scrollTop = n = i.scrollParent[0].scrollTop + s.scrollSpeed : e.pageY - i.overflowOffset.top < s.scrollSensitivity && (i.scrollParent[0].scrollTop = n = i.scrollParent[0].scrollTop - s.scrollSpeed)), s.axis && "y" === s.axis || (i.overflowOffset.left + i.scrollParent[0].offsetWidth - e.pageX < s.scrollSensitivity ? i.scrollParent[0].scrollLeft = n = i.scrollParent[0].scrollLeft + s.scrollSpeed : e.pageX - i.overflowOffset.left < s.scrollSensitivity && (i.scrollParent[0].scrollLeft = n = i.scrollParent[0].scrollLeft - s.scrollSpeed))) : (s.axis && "x" === s.axis || (e.pageY - t(document).scrollTop() < s.scrollSensitivity ? n = t(document).scrollTop(t(document).scrollTop() - s.scrollSpeed) : t(window).height() - (e.pageY - t(document).scrollTop()) < s.scrollSensitivity && (n = t(document).scrollTop(t(document).scrollTop() + s.scrollSpeed))), s.axis && "y" === s.axis || (e.pageX - t(document).scrollLeft() < s.scrollSensitivity ? n = t(document).scrollLeft(t(document).scrollLeft() - s.scrollSpeed) : t(window).width() - (e.pageX - t(document).scrollLeft()) < s.scrollSensitivity && (n = t(document).scrollLeft(t(document).scrollLeft() + s.scrollSpeed)))), n !== !1 && t.ui.ddmanager && !s.dropBehaviour && t.ui.ddmanager.prepareOffsets(i, e)
    }
  }), t.ui.plugin.add("draggable", "snap", {
    start: function() {
      var e = t(this).data("ui-draggable"),
        i = e.options;
      e.snapElements = [], t(i.snap.constructor !== String ? i.snap.items || ":data(ui-draggable)" : i.snap).each(function() {
        var i = t(this),
          s = i.offset();
        this !== e.element[0] && e.snapElements.push({
          item: this,
          width: i.outerWidth(),
          height: i.outerHeight(),
          top: s.top,
          left: s.left
        })
      })
    },
    drag: function(e, i) {
      var s, n, o, a, r, h, l, c, u, d, p = t(this).data("ui-draggable"),
        f = p.options,
        g = f.snapTolerance,
        m = i.offset.left,
        v = m + p.helperProportions.width,
        _ = i.offset.top,
        b = _ + p.helperProportions.height;
      for (u = p.snapElements.length - 1; u >= 0; u--) r = p.snapElements[u].left, h = r + p.snapElements[u].width, l = p.snapElements[u].top, c = l + p.snapElements[u].height, r - g > v || m > h + g || l - g > b || _ > c + g || !t.contains(p.snapElements[u].item.ownerDocument, p.snapElements[u].item) ? (p.snapElements[u].snapping && p.options.snap.release && p.options.snap.release.call(p.element, e, t.extend(p._uiHash(), {
        snapItem: p.snapElements[u].item
      })), p.snapElements[u].snapping = !1) : ("inner" !== f.snapMode && (s = g >= Math.abs(l - b), n = g >= Math.abs(c - _), o = g >= Math.abs(r - v), a = g >= Math.abs(h - m), s && (i.position.top = p._convertPositionTo("relative", {
        top: l - p.helperProportions.height,
        left: 0
      }).top - p.margins.top), n && (i.position.top = p._convertPositionTo("relative", {
        top: c,
        left: 0
      }).top - p.margins.top), o && (i.position.left = p._convertPositionTo("relative", {
        top: 0,
        left: r - p.helperProportions.width
      }).left - p.margins.left), a && (i.position.left = p._convertPositionTo("relative", {
        top: 0,
        left: h
      }).left - p.margins.left)), d = s || n || o || a, "outer" !== f.snapMode && (s = g >= Math.abs(l - _), n = g >= Math.abs(c - b), o = g >= Math.abs(r - m), a = g >= Math.abs(h - v), s && (i.position.top = p._convertPositionTo("relative", {
        top: l,
        left: 0
      }).top - p.margins.top), n && (i.position.top = p._convertPositionTo("relative", {
        top: c - p.helperProportions.height,
        left: 0
      }).top - p.margins.top), o && (i.position.left = p._convertPositionTo("relative", {
        top: 0,
        left: r
      }).left - p.margins.left), a && (i.position.left = p._convertPositionTo("relative", {
        top: 0,
        left: h - p.helperProportions.width
      }).left - p.margins.left)), !p.snapElements[u].snapping && (s || n || o || a || d) && p.options.snap.snap && p.options.snap.snap.call(p.element, e, t.extend(p._uiHash(), {
        snapItem: p.snapElements[u].item
      })), p.snapElements[u].snapping = s || n || o || a || d)
    }
  }), t.ui.plugin.add("draggable", "stack", {
    start: function() {
      var e, i = this.data("ui-draggable").options,
        s = t.makeArray(t(i.stack)).sort(function(e, i) {
          return (parseInt(t(e).css("zIndex"), 10) || 0) - (parseInt(t(i).css("zIndex"), 10) || 0)
        });
      s.length && (e = parseInt(t(s[0]).css("zIndex"), 10) || 0, t(s).each(function(i) {
        t(this).css("zIndex", e + i)
      }), this.css("zIndex", e + s.length))
    }
  }), t.ui.plugin.add("draggable", "zIndex", {
    start: function(e, i) {
      var s = t(i.helper),
        n = t(this).data("ui-draggable").options;
      s.css("zIndex") && (n._zIndex = s.css("zIndex")), s.css("zIndex", n.zIndex)
    },
    stop: function(e, i) {
      var s = t(this).data("ui-draggable").options;
      s._zIndex && t(i.helper).css("zIndex", s._zIndex)
    }
  })
}(jQuery),
function(t) {
  function e(t, e, i) {
    return t > e && e + i > t
  }
  t.widget("ui.droppable", {
    version: "1.10.3",
    widgetEventPrefix: "drop",
    options: {
      accept: "*",
      activeClass: !1,
      addClasses: !0,
      greedy: !1,
      hoverClass: !1,
      scope: "default",
      tolerance: "intersect",
      activate: null,
      deactivate: null,
      drop: null,
      out: null,
      over: null
    },
    _create: function() {
      var e = this.options,
        i = e.accept;
      this.isover = !1, this.isout = !0, this.accept = t.isFunction(i) ? i : function(t) {
        return t.is(i)
      }, this.proportions = {
        width: this.element[0].offsetWidth,
        height: this.element[0].offsetHeight
      }, t.ui.ddmanager.droppables[e.scope] = t.ui.ddmanager.droppables[e.scope] || [], t.ui.ddmanager.droppables[e.scope].push(this), e.addClasses && this.element.addClass("ui-droppable")
    },
    _destroy: function() {
      for (var e = 0, i = t.ui.ddmanager.droppables[this.options.scope]; i.length > e; e++) i[e] === this && i.splice(e, 1);
      this.element.removeClass("ui-droppable ui-droppable-disabled")
    },
    _setOption: function(e, i) {
      "accept" === e && (this.accept = t.isFunction(i) ? i : function(t) {
        return t.is(i)
      }), t.Widget.prototype._setOption.apply(this, arguments)
    },
    _activate: function(e) {
      var i = t.ui.ddmanager.current;
      this.options.activeClass && this.element.addClass(this.options.activeClass), i && this._trigger("activate", e, this.ui(i))
    },
    _deactivate: function(e) {
      var i = t.ui.ddmanager.current;
      this.options.activeClass && this.element.removeClass(this.options.activeClass), i && this._trigger("deactivate", e, this.ui(i))
    },
    _over: function(e) {
      var i = t.ui.ddmanager.current;
      i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", e, this.ui(i)))
    },
    _out: function(e) {
      var i = t.ui.ddmanager.current;
      i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", e, this.ui(i)))
    },
    _drop: function(e, i) {
      var s = i || t.ui.ddmanager.current,
        n = !1;
      return s && (s.currentItem || s.element)[0] !== this.element[0] ? (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function() {
        var e = t.data(this, "ui-droppable");
        return e.options.greedy && !e.options.disabled && e.options.scope === s.options.scope && e.accept.call(e.element[0], s.currentItem || s.element) && t.ui.intersect(s, t.extend(e, {
          offset: e.element.offset()
        }), e.options.tolerance) ? (n = !0, !1) : undefined
      }), n ? !1 : this.accept.call(this.element[0], s.currentItem || s.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", e, this.ui(s)), this.element) : !1) : !1
    },
    ui: function(t) {
      return {
        draggable: t.currentItem || t.element,
        helper: t.helper,
        position: t.position,
        offset: t.positionAbs
      }
    }
  }), t.ui.intersect = function(t, i, s) {
    if (!i.offset) return !1;
    var n, o, a = (t.positionAbs || t.position.absolute).left,
      r = a + t.helperProportions.width,
      h = (t.positionAbs || t.position.absolute).top,
      l = h + t.helperProportions.height,
      c = i.offset.left,
      u = c + i.proportions.width,
      d = i.offset.top,
      p = d + i.proportions.height;
    switch (s) {
      case "fit":
        return a >= c && u >= r && h >= d && p >= l;
      case "intersect":
        return a + t.helperProportions.width / 2 > c && u > r - t.helperProportions.width / 2 && h + t.helperProportions.height / 2 > d && p > l - t.helperProportions.height / 2;
      case "pointer":
        return n = (t.positionAbs || t.position.absolute).left + (t.clickOffset || t.offset.click).left, o = (t.positionAbs || t.position.absolute).top + (t.clickOffset || t.offset.click).top, e(o, d, i.proportions.height) && e(n, c, i.proportions.width);
      case "touch":
        return (h >= d && p >= h || l >= d && p >= l || d > h && l > p) && (a >= c && u >= a || r >= c && u >= r || c > a && r > u);
      default:
        return !1
    }
  }, t.ui.ddmanager = {
    current: null,
    droppables: {
      "default": []
    },
    prepareOffsets: function(e, i) {
      var s, n, o = t.ui.ddmanager.droppables[e.options.scope] || [],
        a = i ? i.type : null,
        r = (e.currentItem || e.element).find(":data(ui-droppable)").addBack();
      t: for (s = 0; o.length > s; s++)
        if (!(o[s].options.disabled || e && !o[s].accept.call(o[s].element[0], e.currentItem || e.element))) {
          for (n = 0; r.length > n; n++)
            if (r[n] === o[s].element[0]) {
              o[s].proportions.height = 0;
              continue t
            }
          o[s].visible = "none" !== o[s].element.css("display"), o[s].visible && ("mousedown" === a && o[s]._activate.call(o[s], i), o[s].offset = o[s].element.offset(), o[s].proportions = {
            width: o[s].element[0].offsetWidth,
            height: o[s].element[0].offsetHeight
          })
        }
    },
    drop: function(e, i) {
      var s = !1;
      return t.each((t.ui.ddmanager.droppables[e.options.scope] || []).slice(), function() {
        this.options && (!this.options.disabled && this.visible && t.ui.intersect(e, this, this.options.tolerance) && (s = this._drop.call(this, i) || s), !this.options.disabled && this.visible && this.accept.call(this.element[0], e.currentItem || e.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, i)))
      }), s
    },
    dragStart: function(e, i) {
      e.element.parentsUntil("body").bind("scroll.droppable", function() {
        e.options.refreshPositions || t.ui.ddmanager.prepareOffsets(e, i)
      })
    },
    drag: function(e, i) {
      e.options.refreshPositions && t.ui.ddmanager.prepareOffsets(e, i), t.each(t.ui.ddmanager.droppables[e.options.scope] || [], function() {
        if (!this.options.disabled && !this.greedyChild && this.visible) {
          var s, n, o, a = t.ui.intersect(e, this, this.options.tolerance),
            r = !a && this.isover ? "isout" : a && !this.isover ? "isover" : null;
          r && (this.options.greedy && (n = this.options.scope, o = this.element.parents(":data(ui-droppable)").filter(function() {
            return t.data(this, "ui-droppable").options.scope === n
          }), o.length && (s = t.data(o[0], "ui-droppable"), s.greedyChild = "isover" === r)), s && "isover" === r && (s.isover = !1, s.isout = !0, s._out.call(s, i)), this[r] = !0, this["isout" === r ? "isover" : "isout"] = !1, this["isover" === r ? "_over" : "_out"].call(this, i), s && "isout" === r && (s.isout = !1, s.isover = !0, s._over.call(s, i)))
        }
      })
    },
    dragStop: function(e, i) {
      e.element.parentsUntil("body").unbind("scroll.droppable"), e.options.refreshPositions || t.ui.ddmanager.prepareOffsets(e, i)
    }
  }
}(jQuery),
function(t) {
  function e(t) {
    return parseInt(t, 10) || 0
  }

  function i(t) {
    return !isNaN(parseInt(t, 10))
  }
  t.widget("ui.resizable", t.ui.mouse, {
    version: "1.10.3",
    widgetEventPrefix: "resize",
    options: {
      alsoResize: !1,
      animate: !1,
      animateDuration: "slow",
      animateEasing: "swing",
      aspectRatio: !1,
      autoHide: !1,
      containment: !1,
      ghost: !1,
      grid: !1,
      handles: "e,s,se",
      helper: !1,
      maxHeight: null,
      maxWidth: null,
      minHeight: 10,
      minWidth: 10,
      zIndex: 90,
      resize: null,
      start: null,
      stop: null
    },
    _create: function() {
      var e, i, s, n, o, a = this,
        r = this.options;
      if (this.element.addClass("ui-resizable"), t.extend(this, {
          _aspectRatio: !!r.aspectRatio,
          aspectRatio: r.aspectRatio,
          originalElement: this.element,
          _proportionallyResizeElements: [],
          _helper: r.helper || r.ghost || r.animate ? r.helper || "ui-resizable-helper" : null
        }), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
          position: this.element.css("position"),
          width: this.element.outerWidth(),
          height: this.element.outerHeight(),
          top: this.element.css("top"),
          left: this.element.css("left")
        })), this.element = this.element.parent().data("ui-resizable", this.element.data("ui-resizable")), this.elementIsWrapper = !0, this.element.css({
          marginLeft: this.originalElement.css("marginLeft"),
          marginTop: this.originalElement.css("marginTop"),
          marginRight: this.originalElement.css("marginRight"),
          marginBottom: this.originalElement.css("marginBottom")
        }), this.originalElement.css({
          marginLeft: 0,
          marginTop: 0,
          marginRight: 0,
          marginBottom: 0
        }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({
          position: "static",
          zoom: 1,
          display: "block"
        })), this.originalElement.css({
          margin: this.originalElement.css("margin")
        }), this._proportionallyResize()), this.handles = r.handles || (t(".ui-resizable-handle", this.element).length ? {
          n: ".ui-resizable-n",
          e: ".ui-resizable-e",
          s: ".ui-resizable-s",
          w: ".ui-resizable-w",
          se: ".ui-resizable-se",
          sw: ".ui-resizable-sw",
          ne: ".ui-resizable-ne",
          nw: ".ui-resizable-nw"
        } : "e,s,se"), this.handles.constructor === String)
        for ("all" === this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw"), e = this.handles.split(","), this.handles = {}, i = 0; e.length > i; i++) s = t.trim(e[i]), o = "ui-resizable-" + s, n = t("<div class='ui-resizable-handle " + o + "'></div>"), n.css({
          zIndex: r.zIndex
        }), "se" === s && n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[s] = ".ui-resizable-" + s, this.element.append(n);
      this._renderAxis = function(e) {
        var i, s, n, o;
        e = e || this.element;
        for (i in this.handles) this.handles[i].constructor === String && (this.handles[i] = t(this.handles[i], this.element).show()), this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i) && (s = t(this.handles[i], this.element), o = /sw|ne|nw|se|n|s/.test(i) ? s.outerHeight() : s.outerWidth(), n = ["padding", /ne|nw|n/.test(i) ? "Top" : /se|sw|s/.test(i) ? "Bottom" : /^e$/.test(i) ? "Right" : "Left"].join(""), e.css(n, o), this._proportionallyResize()), t(this.handles[i]).length
      }, this._renderAxis(this.element), this._handles = t(".ui-resizable-handle", this.element).disableSelection(), this._handles.mouseover(function() {
        a.resizing || (this.className && (n = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), a.axis = n && n[1] ? n[1] : "se")
      }), r.autoHide && (this._handles.hide(), t(this.element).addClass("ui-resizable-autohide").mouseenter(function() {
        r.disabled || (t(this).removeClass("ui-resizable-autohide"), a._handles.show())
      }).mouseleave(function() {
        r.disabled || a.resizing || (t(this).addClass("ui-resizable-autohide"), a._handles.hide())
      })), this._mouseInit()
    },
    _destroy: function() {
      this._mouseDestroy();
      var e, i = function(e) {
        t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
      };
      return this.elementIsWrapper && (i(this.element), e = this.element, this.originalElement.css({
        position: e.css("position"),
        width: e.outerWidth(),
        height: e.outerHeight(),
        top: e.css("top"),
        left: e.css("left")
      }).insertAfter(e), e.remove()), this.originalElement.css("resize", this.originalResizeStyle), i(this.originalElement), this
    },
    _mouseCapture: function(e) {
      var i, s, n = !1;
      for (i in this.handles) s = t(this.handles[i])[0], (s === e.target || t.contains(s, e.target)) && (n = !0);
      return !this.options.disabled && n
    },
    _mouseStart: function(i) {
      var s, n, o, a = this.options,
        r = this.element.position(),
        h = this.element;
      return this.resizing = !0, /absolute/.test(h.css("position")) ? h.css({
        position: "absolute",
        top: h.css("top"),
        left: h.css("left")
      }) : h.is(".ui-draggable") && h.css({
        position: "absolute",
        top: r.top,
        left: r.left
      }), this._renderProxy(), s = e(this.helper.css("left")), n = e(this.helper.css("top")), a.containment && (s += t(a.containment).scrollLeft() || 0, n += t(a.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {
        left: s,
        top: n
      }, this.size = this._helper ? {
        width: h.outerWidth(),
        height: h.outerHeight()
      } : {
        width: h.width(),
        height: h.height()
      }, this.originalSize = this._helper ? {
        width: h.outerWidth(),
        height: h.outerHeight()
      } : {
        width: h.width(),
        height: h.height()
      }, this.originalPosition = {
        left: s,
        top: n
      }, this.sizeDiff = {
        width: h.outerWidth() - h.width(),
        height: h.outerHeight() - h.height()
      }, this.originalMousePosition = {
        left: i.pageX,
        top: i.pageY
      }, this.aspectRatio = "number" == typeof a.aspectRatio ? a.aspectRatio : this.originalSize.width / this.originalSize.height || 1, o = t(".ui-resizable-" + this.axis).css("cursor"), t("body").css("cursor", "auto" === o ? this.axis + "-resize" : o), h.addClass("ui-resizable-resizing"), this._propagate("start", i), !0
    },
    _mouseDrag: function(e) {
      var i, s = this.helper,
        n = {},
        o = this.originalMousePosition,
        a = this.axis,
        r = this.position.top,
        h = this.position.left,
        l = this.size.width,
        c = this.size.height,
        u = e.pageX - o.left || 0,
        d = e.pageY - o.top || 0,
        p = this._change[a];
      return p ? (i = p.apply(this, [e, u, d]), this._updateVirtualBoundaries(e.shiftKey), (this._aspectRatio || e.shiftKey) && (i = this._updateRatio(i, e)), i = this._respectSize(i, e), this._updateCache(i), this._propagate("resize", e), this.position.top !== r && (n.top = this.position.top + "px"), this.position.left !== h && (n.left = this.position.left + "px"), this.size.width !== l && (n.width = this.size.width + "px"), this.size.height !== c && (n.height = this.size.height + "px"), s.css(n), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), t.isEmptyObject(n) || this._trigger("resize", e, this.ui()), !1) : !1
    },
    _mouseStop: function(e) {
      this.resizing = !1;
      var i, s, n, o, a, r, h, l = this.options,
        c = this;
      return this._helper && (i = this._proportionallyResizeElements, s = i.length && /textarea/i.test(i[0].nodeName), n = s && t.ui.hasScroll(i[0], "left") ? 0 : c.sizeDiff.height, o = s ? 0 : c.sizeDiff.width, a = {
        width: c.helper.width() - o,
        height: c.helper.height() - n
      }, r = parseInt(c.element.css("left"), 10) + (c.position.left - c.originalPosition.left) || null, h = parseInt(c.element.css("top"), 10) + (c.position.top - c.originalPosition.top) || null, l.animate || this.element.css(t.extend(a, {
        top: h,
        left: r
      })), c.helper.height(c.size.height), c.helper.width(c.size.width), this._helper && !l.animate && this._proportionallyResize()), t("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", e), this._helper && this.helper.remove(), !1
    },
    _updateVirtualBoundaries: function(t) {
      var e, s, n, o, a, r = this.options;
      a = {
        minWidth: i(r.minWidth) ? r.minWidth : 0,
        maxWidth: i(r.maxWidth) ? r.maxWidth : 1 / 0,
        minHeight: i(r.minHeight) ? r.minHeight : 0,
        maxHeight: i(r.maxHeight) ? r.maxHeight : 1 / 0
      }, (this._aspectRatio || t) && (e = a.minHeight * this.aspectRatio, n = a.minWidth / this.aspectRatio, s = a.maxHeight * this.aspectRatio, o = a.maxWidth / this.aspectRatio, e > a.minWidth && (a.minWidth = e), n > a.minHeight && (a.minHeight = n), a.maxWidth > s && (a.maxWidth = s), a.maxHeight > o && (a.maxHeight = o)), this._vBoundaries = a
    },
    _updateCache: function(t) {
      this.offset = this.helper.offset(), i(t.left) && (this.position.left = t.left), i(t.top) && (this.position.top = t.top), i(t.height) && (this.size.height = t.height), i(t.width) && (this.size.width = t.width)
    },
    _updateRatio: function(t) {
      var e = this.position,
        s = this.size,
        n = this.axis;
      return i(t.height) ? t.width = t.height * this.aspectRatio : i(t.width) && (t.height = t.width / this.aspectRatio), "sw" === n && (t.left = e.left + (s.width - t.width), t.top = null), "nw" === n && (t.top = e.top + (s.height - t.height), t.left = e.left + (s.width - t.width)), t
    },
    _respectSize: function(t) {
      var e = this._vBoundaries,
        s = this.axis,
        n = i(t.width) && e.maxWidth && e.maxWidth < t.width,
        o = i(t.height) && e.maxHeight && e.maxHeight < t.height,
        a = i(t.width) && e.minWidth && e.minWidth > t.width,
        r = i(t.height) && e.minHeight && e.minHeight > t.height,
        h = this.originalPosition.left + this.originalSize.width,
        l = this.position.top + this.size.height,
        c = /sw|nw|w/.test(s),
        u = /nw|ne|n/.test(s);
      return a && (t.width = e.minWidth), r && (t.height = e.minHeight), n && (t.width = e.maxWidth), o && (t.height = e.maxHeight), a && c && (t.left = h - e.minWidth), n && c && (t.left = h - e.maxWidth), r && u && (t.top = l - e.minHeight), o && u && (t.top = l - e.maxHeight), t.width || t.height || t.left || !t.top ? t.width || t.height || t.top || !t.left || (t.left = null) : t.top = null, t
    },
    _proportionallyResize: function() {
      if (this._proportionallyResizeElements.length) {
        var t, e, i, s, n, o = this.helper || this.element;
        for (t = 0; this._proportionallyResizeElements.length > t; t++) {
          if (n = this._proportionallyResizeElements[t], !this.borderDif)
            for (this.borderDif = [], i = [n.css("borderTopWidth"), n.css("borderRightWidth"), n.css("borderBottomWidth"), n.css("borderLeftWidth")], s = [n.css("paddingTop"), n.css("paddingRight"), n.css("paddingBottom"), n.css("paddingLeft")], e = 0; i.length > e; e++) this.borderDif[e] = (parseInt(i[e], 10) || 0) + (parseInt(s[e], 10) || 0);
          n.css({
            height: o.height() - this.borderDif[0] - this.borderDif[2] || 0,
            width: o.width() - this.borderDif[1] - this.borderDif[3] || 0
          })
        }
      }
    },
    _renderProxy: function() {
      var e = this.element,
        i = this.options;
      this.elementOffset = e.offset(), this._helper ? (this.helper = this.helper || t("<div style='overflow:hidden;'></div>"), this.helper.addClass(this._helper).css({
        width: this.element.outerWidth() - 1,
        height: this.element.outerHeight() - 1,
        position: "absolute",
        left: this.elementOffset.left + "px",
        top: this.elementOffset.top + "px",
        zIndex: ++i.zIndex
      }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element
    },
    _change: {
      e: function(t, e) {
        return {
          width: this.originalSize.width + e
        }
      },
      w: function(t, e) {
        var i = this.originalSize,
          s = this.originalPosition;
        return {
          left: s.left + e,
          width: i.width - e
        }
      },
      n: function(t, e, i) {
        var s = this.originalSize,
          n = this.originalPosition;
        return {
          top: n.top + i,
          height: s.height - i
        }
      },
      s: function(t, e, i) {
        return {
          height: this.originalSize.height + i
        }
      },
      se: function(e, i, s) {
        return t.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [e, i, s]))
      },
      sw: function(e, i, s) {
        return t.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [e, i, s]))
      },
      ne: function(e, i, s) {
        return t.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [e, i, s]))
      },
      nw: function(e, i, s) {
        return t.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [e, i, s]))
      }
    },
    _propagate: function(e, i) {
      t.ui.plugin.call(this, e, [i, this.ui()]), "resize" !== e && this._trigger(e, i, this.ui())
    },
    plugins: {},
    ui: function() {
      return {
        originalElement: this.originalElement,
        element: this.element,
        helper: this.helper,
        position: this.position,
        size: this.size,
        originalSize: this.originalSize,
        originalPosition: this.originalPosition
      }
    }
  }), t.ui.plugin.add("resizable", "animate", {
    stop: function(e) {
      var i = t(this).data("ui-resizable"),
        s = i.options,
        n = i._proportionallyResizeElements,
        o = n.length && /textarea/i.test(n[0].nodeName),
        a = o && t.ui.hasScroll(n[0], "left") ? 0 : i.sizeDiff.height,
        r = o ? 0 : i.sizeDiff.width,
        h = {
          width: i.size.width - r,
          height: i.size.height - a
        },
        l = parseInt(i.element.css("left"), 10) + (i.position.left - i.originalPosition.left) || null,
        c = parseInt(i.element.css("top"), 10) + (i.position.top - i.originalPosition.top) || null;
      i.element.animate(t.extend(h, c && l ? {
        top: c,
        left: l
      } : {}), {
        duration: s.animateDuration,
        easing: s.animateEasing,
        step: function() {
          var s = {
            width: parseInt(i.element.css("width"), 10),
            height: parseInt(i.element.css("height"), 10),
            top: parseInt(i.element.css("top"), 10),
            left: parseInt(i.element.css("left"), 10)
          };
          n && n.length && t(n[0]).css({
            width: s.width,
            height: s.height
          }), i._updateCache(s), i._propagate("resize", e)
        }
      })
    }
  }), t.ui.plugin.add("resizable", "containment", {
    start: function() {
      var i, s, n, o, a, r, h, l = t(this).data("ui-resizable"),
        c = l.options,
        u = l.element,
        d = c.containment,
        p = d instanceof t ? d.get(0) : /parent/.test(d) ? u.parent().get(0) : d;
      p && (l.containerElement = t(p), /document/.test(d) || d === document ? (l.containerOffset = {
        left: 0,
        top: 0
      }, l.containerPosition = {
        left: 0,
        top: 0
      }, l.parentData = {
        element: t(document),
        left: 0,
        top: 0,
        width: t(document).width(),
        height: t(document).height() || document.body.parentNode.scrollHeight
      }) : (i = t(p), s = [], t(["Top", "Right", "Left", "Bottom"]).each(function(t, n) {
        s[t] = e(i.css("padding" + n))
      }), l.containerOffset = i.offset(), l.containerPosition = i.position(), l.containerSize = {
        height: i.innerHeight() - s[3],
        width: i.innerWidth() - s[1]
      }, n = l.containerOffset, o = l.containerSize.height, a = l.containerSize.width, r = t.ui.hasScroll(p, "left") ? p.scrollWidth : a, h = t.ui.hasScroll(p) ? p.scrollHeight : o, l.parentData = {
        element: p,
        left: n.left,
        top: n.top,
        width: r,
        height: h
      }))
    },
    resize: function(e) {
      var i, s, n, o, a = t(this).data("ui-resizable"),
        r = a.options,
        h = a.containerOffset,
        l = a.position,
        c = a._aspectRatio || e.shiftKey,
        u = {
          top: 0,
          left: 0
        },
        d = a.containerElement;
      d[0] !== document && /static/.test(d.css("position")) && (u = h), l.left < (a._helper ? h.left : 0) && (a.size.width = a.size.width + (a._helper ? a.position.left - h.left : a.position.left - u.left), c && (a.size.height = a.size.width / a.aspectRatio), a.position.left = r.helper ? h.left : 0), l.top < (a._helper ? h.top : 0) && (a.size.height = a.size.height + (a._helper ? a.position.top - h.top : a.position.top), c && (a.size.width = a.size.height * a.aspectRatio), a.position.top = a._helper ? h.top : 0), a.offset.left = a.parentData.left + a.position.left, a.offset.top = a.parentData.top + a.position.top, i = Math.abs((a._helper ? a.offset.left - u.left : a.offset.left - u.left) + a.sizeDiff.width), s = Math.abs((a._helper ? a.offset.top - u.top : a.offset.top - h.top) + a.sizeDiff.height), n = a.containerElement.get(0) === a.element.parent().get(0), o = /relative|absolute/.test(a.containerElement.css("position")), n && o && (i -= a.parentData.left), i + a.size.width >= a.parentData.width && (a.size.width = a.parentData.width - i, c && (a.size.height = a.size.width / a.aspectRatio)), s + a.size.height >= a.parentData.height && (a.size.height = a.parentData.height - s, c && (a.size.width = a.size.height * a.aspectRatio))
    },
    stop: function() {
      var e = t(this).data("ui-resizable"),
        i = e.options,
        s = e.containerOffset,
        n = e.containerPosition,
        o = e.containerElement,
        a = t(e.helper),
        r = a.offset(),
        h = a.outerWidth() - e.sizeDiff.width,
        l = a.outerHeight() - e.sizeDiff.height;
      e._helper && !i.animate && /relative/.test(o.css("position")) && t(this).css({
        left: r.left - n.left - s.left,
        width: h,
        height: l
      }), e._helper && !i.animate && /static/.test(o.css("position")) && t(this).css({
        left: r.left - n.left - s.left,
        width: h,
        height: l
      })
    }
  }), t.ui.plugin.add("resizable", "alsoResize", {
    start: function() {
      var e = t(this).data("ui-resizable"),
        i = e.options,
        s = function(e) {
          t(e).each(function() {
            var e = t(this);
            e.data("ui-resizable-alsoresize", {
              width: parseInt(e.width(), 10),
              height: parseInt(e.height(), 10),
              left: parseInt(e.css("left"), 10),
              top: parseInt(e.css("top"), 10)
            })
          })
        };
      "object" != typeof i.alsoResize || i.alsoResize.parentNode ? s(i.alsoResize) : i.alsoResize.length ? (i.alsoResize = i.alsoResize[0], s(i.alsoResize)) : t.each(i.alsoResize, function(t) {
        s(t)
      })
    },
    resize: function(e, i) {
      var s = t(this).data("ui-resizable"),
        n = s.options,
        o = s.originalSize,
        a = s.originalPosition,
        r = {
          height: s.size.height - o.height || 0,
          width: s.size.width - o.width || 0,
          top: s.position.top - a.top || 0,
          left: s.position.left - a.left || 0
        },
        h = function(e, s) {
          t(e).each(function() {
            var e = t(this),
              n = t(this).data("ui-resizable-alsoresize"),
              o = {},
              a = s && s.length ? s : e.parents(i.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
            t.each(a, function(t, e) {
              var i = (n[e] || 0) + (r[e] || 0);
              i && i >= 0 && (o[e] = i || null)
            }), e.css(o)
          })
        };
      "object" != typeof n.alsoResize || n.alsoResize.nodeType ? h(n.alsoResize) : t.each(n.alsoResize, function(t, e) {
        h(t, e)
      })
    },
    stop: function() {
      t(this).removeData("resizable-alsoresize")
    }
  }), t.ui.plugin.add("resizable", "ghost", {
    start: function() {
      var e = t(this).data("ui-resizable"),
        i = e.options,
        s = e.size;
      e.ghost = e.originalElement.clone(), e.ghost.css({
        opacity: .25,
        display: "block",
        position: "relative",
        height: s.height,
        width: s.width,
        margin: 0,
        left: 0,
        top: 0
      }).addClass("ui-resizable-ghost").addClass("string" == typeof i.ghost ? i.ghost : ""), e.ghost.appendTo(e.helper)
    },
    resize: function() {
      var e = t(this).data("ui-resizable");
      e.ghost && e.ghost.css({
        position: "relative",
        height: e.size.height,
        width: e.size.width
      })
    },
    stop: function() {
      var e = t(this).data("ui-resizable");
      e.ghost && e.helper && e.helper.get(0).removeChild(e.ghost.get(0))
    }
  }), t.ui.plugin.add("resizable", "grid", {
    resize: function() {
      var e = t(this).data("ui-resizable"),
        i = e.options,
        s = e.size,
        n = e.originalSize,
        o = e.originalPosition,
        a = e.axis,
        r = "number" == typeof i.grid ? [i.grid, i.grid] : i.grid,
        h = r[0] || 1,
        l = r[1] || 1,
        c = Math.round((s.width - n.width) / h) * h,
        u = Math.round((s.height - n.height) / l) * l,
        d = n.width + c,
        p = n.height + u,
        f = i.maxWidth && d > i.maxWidth,
        g = i.maxHeight && p > i.maxHeight,
        m = i.minWidth && i.minWidth > d,
        v = i.minHeight && i.minHeight > p;
      i.grid = r, m && (d += h), v && (p += l), f && (d -= h), g && (p -= l), /^(se|s|e)$/.test(a) ? (e.size.width = d, e.size.height = p) : /^(ne)$/.test(a) ? (e.size.width = d, e.size.height = p, e.position.top = o.top - u) : /^(sw)$/.test(a) ? (e.size.width = d, e.size.height = p, e.position.left = o.left - c) : (e.size.width = d, e.size.height = p, e.position.top = o.top - u, e.position.left = o.left - c)
    }
  })
}(jQuery),
function(t) {
  t.widget("ui.selectable", t.ui.mouse, {
    version: "1.10.3",
    options: {
      appendTo: "body",
      autoRefresh: !0,
      distance: 0,
      filter: "*",
      tolerance: "touch",
      selected: null,
      selecting: null,
      start: null,
      stop: null,
      unselected: null,
      unselecting: null
    },
    _create: function() {
      var e, i = this;
      this.element.addClass("ui-selectable"), this.dragged = !1, this.refresh = function() {
        e = t(i.options.filter, i.element[0]), e.addClass("ui-selectee"), e.each(function() {
          var e = t(this),
            i = e.offset();
          t.data(this, "selectable-item", {
            element: this,
            $element: e,
            left: i.left,
            top: i.top,
            right: i.left + e.outerWidth(),
            bottom: i.top + e.outerHeight(),
            startselected: !1,
            selected: e.hasClass("ui-selected"),
            selecting: e.hasClass("ui-selecting"),
            unselecting: e.hasClass("ui-unselecting")
          })
        })
      }, this.refresh(), this.selectees = e.addClass("ui-selectee"), this._mouseInit(), this.helper = t("<div class='ui-selectable-helper'></div>")
    },
    _destroy: function() {
      this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled"), this._mouseDestroy()
    },
    _mouseStart: function(e) {
      var i = this,
        s = this.options;
      this.opos = [e.pageX, e.pageY], this.options.disabled || (this.selectees = t(s.filter, this.element[0]), this._trigger("start", e), t(s.appendTo).append(this.helper), this.helper.css({
        left: e.pageX,
        top: e.pageY,
        width: 0,
        height: 0
      }), s.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function() {
        var s = t.data(this, "selectable-item");
        s.startselected = !0, e.metaKey || e.ctrlKey || (s.$element.removeClass("ui-selected"), s.selected = !1, s.$element.addClass("ui-unselecting"), s.unselecting = !0, i._trigger("unselecting", e, {
          unselecting: s.element
        }))
      }), t(e.target).parents().addBack().each(function() {
        var s, n = t.data(this, "selectable-item");
        return n ? (s = !e.metaKey && !e.ctrlKey || !n.$element.hasClass("ui-selected"), n.$element.removeClass(s ? "ui-unselecting" : "ui-selected").addClass(s ? "ui-selecting" : "ui-unselecting"), n.unselecting = !s, n.selecting = s, n.selected = s, s ? i._trigger("selecting", e, {
          selecting: n.element
        }) : i._trigger("unselecting", e, {
          unselecting: n.element
        }), !1) : undefined
      }))
    },
    _mouseDrag: function(e) {
      if (this.dragged = !0, !this.options.disabled) {
        var i, s = this,
          n = this.options,
          o = this.opos[0],
          a = this.opos[1],
          r = e.pageX,
          h = e.pageY;
        return o > r && (i = r, r = o, o = i), a > h && (i = h, h = a, a = i), this.helper.css({
          left: o,
          top: a,
          width: r - o,
          height: h - a
        }), this.selectees.each(function() {
          var i = t.data(this, "selectable-item"),
            l = !1;
          i && i.element !== s.element[0] && ("touch" === n.tolerance ? l = !(i.left > r || o > i.right || i.top > h || a > i.bottom) : "fit" === n.tolerance && (l = i.left > o && r > i.right && i.top > a && h > i.bottom), l ? (i.selected && (i.$element.removeClass("ui-selected"), i.selected = !1), i.unselecting && (i.$element.removeClass("ui-unselecting"), i.unselecting = !1), i.selecting || (i.$element.addClass("ui-selecting"), i.selecting = !0, s._trigger("selecting", e, {
            selecting: i.element
          }))) : (i.selecting && ((e.metaKey || e.ctrlKey) && i.startselected ? (i.$element.removeClass("ui-selecting"), i.selecting = !1, i.$element.addClass("ui-selected"), i.selected = !0) : (i.$element.removeClass("ui-selecting"), i.selecting = !1, i.startselected && (i.$element.addClass("ui-unselecting"), i.unselecting = !0), s._trigger("unselecting", e, {
            unselecting: i.element
          }))), i.selected && (e.metaKey || e.ctrlKey || i.startselected || (i.$element.removeClass("ui-selected"), i.selected = !1, i.$element.addClass("ui-unselecting"), i.unselecting = !0, s._trigger("unselecting", e, {
            unselecting: i.element
          })))))
        }), !1
      }
    },
    _mouseStop: function(e) {
      var i = this;
      return this.dragged = !1, t(".ui-unselecting", this.element[0]).each(function() {
        var s = t.data(this, "selectable-item");
        s.$element.removeClass("ui-unselecting"), s.unselecting = !1, s.startselected = !1, i._trigger("unselected", e, {
          unselected: s.element
        })
      }), t(".ui-selecting", this.element[0]).each(function() {
        var s = t.data(this, "selectable-item");
        s.$element.removeClass("ui-selecting").addClass("ui-selected"), s.selecting = !1, s.selected = !0, s.startselected = !0, i._trigger("selected", e, {
          selected: s.element
        })
      }), this._trigger("stop", e), this.helper.remove(), !1
    }
  })
}(jQuery),
function(t) {
  function e(t, e, i) {
    return t > e && e + i > t
  }

  function i(t) {
    return /left|right/.test(t.css("float")) || /inline|table-cell/.test(t.css("display"))
  }
  t.widget("ui.sortable", t.ui.mouse, {
    version: "1.10.3",
    widgetEventPrefix: "sort",
    ready: !1,
    options: {
      appendTo: "parent",
      axis: !1,
      connectWith: !1,
      containment: !1,
      cursor: "auto",
      cursorAt: !1,
      dropOnEmpty: !0,
      forcePlaceholderSize: !1,
      forceHelperSize: !1,
      grid: !1,
      handle: !1,
      helper: "original",
      items: "> *",
      opacity: !1,
      placeholder: !1,
      revert: !1,
      scroll: !0,
      scrollSensitivity: 20,
      scrollSpeed: 20,
      scope: "default",
      tolerance: "intersect",
      zIndex: 1e3,
      activate: null,
      beforeStop: null,
      change: null,
      deactivate: null,
      out: null,
      over: null,
      receive: null,
      remove: null,
      sort: null,
      start: null,
      stop: null,
      update: null
    },
    _create: function() {
      var t = this.options;
      this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? "x" === t.axis || i(this.items[0].item) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
    },
    _destroy: function() {
      this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
      for (var t = this.items.length - 1; t >= 0; t--) this.items[t].item.removeData(this.widgetName + "-item");
      return this
    },
    _setOption: function(e, i) {
      "disabled" === e ? (this.options[e] = i, this.widget().toggleClass("ui-sortable-disabled", !!i)) : t.Widget.prototype._setOption.apply(this, arguments)
    },
    _mouseCapture: function(e, i) {
      var s = null,
        n = !1,
        o = this;
      return this.reverting ? !1 : this.options.disabled || "static" === this.options.type ? !1 : (this._refreshItems(e), t(e.target).parents().each(function() {
        return t.data(this, o.widgetName + "-item") === o ? (s = t(this), !1) : undefined
      }), t.data(e.target, o.widgetName + "-item") === o && (s = t(e.target)), s ? !this.options.handle || i || (t(this.options.handle, s).find("*").addBack().each(function() {
        this === e.target && (n = !0)
      }), n) ? (this.currentItem = s, this._removeCurrentsFromItems(), !0) : !1 : !1)
    },
    _mouseStart: function(e, i, s) {
      var n, o, a = this.options;
      if (this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(e), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
          top: this.offset.top - this.margins.top,
          left: this.offset.left - this.margins.left
        }, t.extend(this.offset, {
          click: {
            left: e.pageX - this.offset.left,
            top: e.pageY - this.offset.top
          },
          parent: this._getParentOffset(),
          relative: this._getRelativeOffset()
        }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(e), this.originalPageX = e.pageX, this.originalPageY = e.pageY, a.cursorAt && this._adjustOffsetFromHelper(a.cursorAt), this.domPosition = {
          prev: this.currentItem.prev()[0],
          parent: this.currentItem.parent()[0]
        }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), a.containment && this._setContainment(), a.cursor && "auto" !== a.cursor && (o = this.document.find("body"), this.storedCursor = o.css("cursor"), o.css("cursor", a.cursor), this.storedStylesheet = t("<style>*{ cursor: " + a.cursor + " !important; }</style>").appendTo(o)), a.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", a.opacity)), a.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", a.zIndex)), this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", e, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !s)
        for (n = this.containers.length - 1; n >= 0; n--) this.containers[n]._trigger("activate", e, this._uiHash(this));
      return t.ui.ddmanager && (t.ui.ddmanager.current = this), t.ui.ddmanager && !a.dropBehaviour && t.ui.ddmanager.prepareOffsets(this, e), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(e), !0
    },
    _mouseDrag: function(e) {
      var i, s, n, o, a = this.options,
        r = !1;
      for (this.position = this._generatePosition(e), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - e.pageY < a.scrollSensitivity ? this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop + a.scrollSpeed : e.pageY - this.overflowOffset.top < a.scrollSensitivity && (this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop - a.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - e.pageX < a.scrollSensitivity ? this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft + a.scrollSpeed : e.pageX - this.overflowOffset.left < a.scrollSensitivity && (this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft - a.scrollSpeed)) : (e.pageY - t(document).scrollTop() < a.scrollSensitivity ? r = t(document).scrollTop(t(document).scrollTop() - a.scrollSpeed) : t(window).height() - (e.pageY - t(document).scrollTop()) < a.scrollSensitivity && (r = t(document).scrollTop(t(document).scrollTop() + a.scrollSpeed)), e.pageX - t(document).scrollLeft() < a.scrollSensitivity ? r = t(document).scrollLeft(t(document).scrollLeft() - a.scrollSpeed) : t(window).width() - (e.pageX - t(document).scrollLeft()) < a.scrollSensitivity && (r = t(document).scrollLeft(t(document).scrollLeft() + a.scrollSpeed))), r !== !1 && t.ui.ddmanager && !a.dropBehaviour && t.ui.ddmanager.prepareOffsets(this, e)), this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), i = this.items.length - 1; i >= 0; i--)
        if (s = this.items[i], n = s.item[0], o = this._intersectsWithPointer(s), o && s.instance === this.currentContainer && n !== this.currentItem[0] && this.placeholder[1 === o ? "next" : "prev"]()[0] !== n && !t.contains(this.placeholder[0], n) && ("semi-dynamic" === this.options.type ? !t.contains(this.element[0], n) : !0)) {
          if (this.direction = 1 === o ? "down" : "up", "pointer" !== this.options.tolerance && !this._intersectsWithSides(s)) break;
          this._rearrange(e, s), this._trigger("change", e, this._uiHash());
          break
        }
      return this._contactContainers(e), t.ui.ddmanager && t.ui.ddmanager.drag(this, e), this._trigger("sort", e, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
    },
    _mouseStop: function(e, i) {
      if (e) {
        if (t.ui.ddmanager && !this.options.dropBehaviour && t.ui.ddmanager.drop(this, e), this.options.revert) {
          var s = this,
            n = this.placeholder.offset(),
            o = this.options.axis,
            a = {};
          o && "x" !== o || (a.left = n.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft)), o && "y" !== o || (a.top = n.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)), this.reverting = !0, t(this.helper).animate(a, parseInt(this.options.revert, 10) || 500, function() {
            s._clear(e)
          })
        } else this._clear(e, i);
        return !1
      }
    },
    cancel: function() {
      if (this.dragging) {
        this._mouseUp({
          target: null
        }), "original" === this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
        for (var e = this.containers.length - 1; e >= 0; e--) this.containers[e]._trigger("deactivate", null, this._uiHash(this)), this.containers[e].containerCache.over && (this.containers[e]._trigger("out", null, this._uiHash(this)), this.containers[e].containerCache.over = 0)
      }
      return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" !== this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), t.extend(this, {
        helper: null,
        dragging: !1,
        reverting: !1,
        _noFinalSort: null
      }), this.domPosition.prev ? t(this.domPosition.prev).after(this.currentItem) : t(this.domPosition.parent).prepend(this.currentItem)), this
    },
    serialize: function(e) {
      var i = this._getItemsAsjQuery(e && e.connected),
        s = [];
      return e = e || {}, t(i).each(function() {
        var i = (t(e.item || this).attr(e.attribute || "id") || "").match(e.expression || /(.+)[\-=_](.+)/);
        i && s.push((e.key || i[1] + "[]") + "=" + (e.key && e.expression ? i[1] : i[2]))
      }), !s.length && e.key && s.push(e.key + "="), s.join("&")
    },
    toArray: function(e) {
      var i = this._getItemsAsjQuery(e && e.connected),
        s = [];
      return e = e || {}, i.each(function() {
        s.push(t(e.item || this).attr(e.attribute || "id") || "")
      }), s
    },
    _intersectsWith: function(t) {
      var e = this.positionAbs.left,
        i = e + this.helperProportions.width,
        s = this.positionAbs.top,
        n = s + this.helperProportions.height,
        o = t.left,
        a = o + t.width,
        r = t.top,
        h = r + t.height,
        l = this.offset.click.top,
        c = this.offset.click.left,
        u = "x" === this.options.axis || s + l > r && h > s + l,
        d = "y" === this.options.axis || e + c > o && a > e + c,
        p = u && d;
      return "pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > t[this.floating ? "width" : "height"] ? p : e + this.helperProportions.width / 2 > o && a > i - this.helperProportions.width / 2 && s + this.helperProportions.height / 2 > r && h > n - this.helperProportions.height / 2
    },
    _intersectsWithPointer: function(t) {
      var i = "x" === this.options.axis || e(this.positionAbs.top + this.offset.click.top, t.top, t.height),
        s = "y" === this.options.axis || e(this.positionAbs.left + this.offset.click.left, t.left, t.width),
        n = i && s,
        o = this._getDragVerticalDirection(),
        a = this._getDragHorizontalDirection();
      return n ? this.floating ? a && "right" === a || "down" === o ? 2 : 1 : o && ("down" === o ? 2 : 1) : !1
    },
    _intersectsWithSides: function(t) {
      var i = e(this.positionAbs.top + this.offset.click.top, t.top + t.height / 2, t.height),
        s = e(this.positionAbs.left + this.offset.click.left, t.left + t.width / 2, t.width),
        n = this._getDragVerticalDirection(),
        o = this._getDragHorizontalDirection();
      return this.floating && o ? "right" === o && s || "left" === o && !s : n && ("down" === n && i || "up" === n && !i)
    },
    _getDragVerticalDirection: function() {
      var t = this.positionAbs.top - this.lastPositionAbs.top;
      return 0 !== t && (t > 0 ? "down" : "up")
    },
    _getDragHorizontalDirection: function() {
      var t = this.positionAbs.left - this.lastPositionAbs.left;
      return 0 !== t && (t > 0 ? "right" : "left")
    },
    refresh: function(t) {
      return this._refreshItems(t), this.refreshPositions(), this
    },
    _connectWith: function() {
      var t = this.options;
      return t.connectWith.constructor === String ? [t.connectWith] : t.connectWith
    },
    _getItemsAsjQuery: function(e) {
      var i, s, n, o, a = [],
        r = [],
        h = this._connectWith();
      if (h && e)
        for (i = h.length - 1; i >= 0; i--)
          for (n = t(h[i]), s = n.length - 1; s >= 0; s--) o = t.data(n[s], this.widgetFullName), o && o !== this && !o.options.disabled && r.push([t.isFunction(o.options.items) ? o.options.items.call(o.element) : t(o.options.items, o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), o]);
      for (r.push([t.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
          options: this.options,
          item: this.currentItem
        }) : t(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]), i = r.length - 1; i >= 0; i--) r[i][0].each(function() {
        a.push(this)
      });
      return t(a)
    },
    _removeCurrentsFromItems: function() {
      var e = this.currentItem.find(":data(" + this.widgetName + "-item)");
      this.items = t.grep(this.items, function(t) {
        for (var i = 0; e.length > i; i++)
          if (e[i] === t.item[0]) return !1;
        return !0
      })
    },
    _refreshItems: function(e) {
      this.items = [], this.containers = [this];
      var i, s, n, o, a, r, h, l, c = this.items,
        u = [
          [t.isFunction(this.options.items) ? this.options.items.call(this.element[0], e, {
            item: this.currentItem
          }) : t(this.options.items, this.element), this]
        ],
        d = this._connectWith();
      if (d && this.ready)
        for (i = d.length - 1; i >= 0; i--)
          for (n = t(d[i]), s = n.length - 1; s >= 0; s--) o = t.data(n[s], this.widgetFullName), o && o !== this && !o.options.disabled && (u.push([t.isFunction(o.options.items) ? o.options.items.call(o.element[0], e, {
            item: this.currentItem
          }) : t(o.options.items, o.element), o]), this.containers.push(o));
      for (i = u.length - 1; i >= 0; i--)
        for (a = u[i][1], r = u[i][0], s = 0, l = r.length; l > s; s++) h = t(r[s]), h.data(this.widgetName + "-item", a), c.push({
          item: h,
          instance: a,
          width: 0,
          height: 0,
          left: 0,
          top: 0
        })
    },
    refreshPositions: function(e) {
      this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
      var i, s, n, o;
      for (i = this.items.length - 1; i >= 0; i--) s = this.items[i], s.instance !== this.currentContainer && this.currentContainer && s.item[0] !== this.currentItem[0] || (n = this.options.toleranceElement ? t(this.options.toleranceElement, s.item) : s.item, e || (s.width = n.outerWidth(), s.height = n.outerHeight()), o = n.offset(), s.left = o.left, s.top = o.top);
      if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this);
      else
        for (i = this.containers.length - 1; i >= 0; i--) o = this.containers[i].element.offset(), this.containers[i].containerCache.left = o.left, this.containers[i].containerCache.top = o.top, this.containers[i].containerCache.width = this.containers[i].element.outerWidth(), this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
      return this
    },
    _createPlaceholder: function(e) {
      e = e || this;
      var i, s = e.options;
      s.placeholder && s.placeholder.constructor !== String || (i = s.placeholder, s.placeholder = {
        element: function() {
          var s = e.currentItem[0].nodeName.toLowerCase(),
            n = t("<" + s + ">", e.document[0]).addClass(i || e.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper");
          return "tr" === s ? e.currentItem.children().each(function() {
            t("<td>&#160;</td>", e.document[0]).attr("colspan", t(this).attr("colspan") || 1).appendTo(n)
          }) : "img" === s && n.attr("src", e.currentItem.attr("src")), i || n.css("visibility", "hidden"), n
        },
        update: function(t, n) {
          (!i || s.forcePlaceholderSize) && (n.height() || n.height(e.currentItem.innerHeight() - parseInt(e.currentItem.css("paddingTop") || 0, 10) - parseInt(e.currentItem.css("paddingBottom") || 0, 10)), n.width() || n.width(e.currentItem.innerWidth() - parseInt(e.currentItem.css("paddingLeft") || 0, 10) - parseInt(e.currentItem.css("paddingRight") || 0, 10)))
        }
      }), e.placeholder = t(s.placeholder.element.call(e.element, e.currentItem)), e.currentItem.after(e.placeholder), s.placeholder.update(e, e.placeholder)
    },
    _contactContainers: function(s) {
      var n, o, a, r, h, l, c, u, d, p, f = null,
        g = null;
      for (n = this.containers.length - 1; n >= 0; n--)
        if (!t.contains(this.currentItem[0], this.containers[n].element[0]))
          if (this._intersectsWith(this.containers[n].containerCache)) {
            if (f && t.contains(this.containers[n].element[0], f.element[0])) continue;
            f = this.containers[n], g = n
          } else this.containers[n].containerCache.over && (this.containers[n]._trigger("out", s, this._uiHash(this)), this.containers[n].containerCache.over = 0);
      if (f)
        if (1 === this.containers.length) this.containers[g].containerCache.over || (this.containers[g]._trigger("over", s, this._uiHash(this)), this.containers[g].containerCache.over = 1);
        else {
          for (a = 1e4, r = null, p = f.floating || i(this.currentItem), h = p ? "left" : "top", l = p ? "width" : "height", c = this.positionAbs[h] + this.offset.click[h], o = this.items.length - 1; o >= 0; o--) t.contains(this.containers[g].element[0], this.items[o].item[0]) && this.items[o].item[0] !== this.currentItem[0] && (!p || e(this.positionAbs.top + this.offset.click.top, this.items[o].top, this.items[o].height)) && (u = this.items[o].item.offset()[h], d = !1, Math.abs(u - c) > Math.abs(u + this.items[o][l] - c) && (d = !0, u += this.items[o][l]), a > Math.abs(u - c) && (a = Math.abs(u - c), r = this.items[o], this.direction = d ? "up" : "down"));
          if (!r && !this.options.dropOnEmpty) return;
          if (this.currentContainer === this.containers[g]) return;
          r ? this._rearrange(s, r, null, !0) : this._rearrange(s, null, this.containers[g].element, !0), this._trigger("change", s, this._uiHash()), this.containers[g]._trigger("change", s, this._uiHash(this)), this.currentContainer = this.containers[g], this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[g]._trigger("over", s, this._uiHash(this)), this.containers[g].containerCache.over = 1
        }
    },
    _createHelper: function(e) {
      var i = this.options,
        s = t.isFunction(i.helper) ? t(i.helper.apply(this.element[0], [e, this.currentItem])) : "clone" === i.helper ? this.currentItem.clone() : this.currentItem;
      return s.parents("body").length || t("parent" !== i.appendTo ? i.appendTo : this.currentItem[0].parentNode)[0].appendChild(s[0]), s[0] === this.currentItem[0] && (this._storedCSS = {
        width: this.currentItem[0].style.width,
        height: this.currentItem[0].style.height,
        position: this.currentItem.css("position"),
        top: this.currentItem.css("top"),
        left: this.currentItem.css("left")
      }), (!s[0].style.width || i.forceHelperSize) && s.width(this.currentItem.width()), (!s[0].style.height || i.forceHelperSize) && s.height(this.currentItem.height()), s
    },
    _adjustOffsetFromHelper: function(e) {
      "string" == typeof e && (e = e.split(" ")), t.isArray(e) && (e = {
        left: +e[0],
        top: +e[1] || 0
      }), "left" in e && (this.offset.click.left = e.left + this.margins.left), "right" in e && (this.offset.click.left = this.helperProportions.width - e.right + this.margins.left), "top" in e && (this.offset.click.top = e.top + this.margins.top), "bottom" in e && (this.offset.click.top = this.helperProportions.height - e.bottom + this.margins.top)
    },
    _getParentOffset: function() {
      this.offsetParent = this.helper.offsetParent();
      var e = this.offsetParent.offset();
      return "absolute" === this.cssPosition && this.scrollParent[0] !== document && t.contains(this.scrollParent[0], this.offsetParent[0]) && (e.left += this.scrollParent.scrollLeft(), e.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && t.ui.ie) && (e = {
        top: 0,
        left: 0
      }), {
        top: e.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
        left: e.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
      }
    },
    _getRelativeOffset: function() {
      if ("relative" === this.cssPosition) {
        var t = this.currentItem.position();
        return {
          top: t.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
          left: t.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
        }
      }
      return {
        top: 0,
        left: 0
      }
    },
    _cacheMargins: function() {
      this.margins = {
        left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
        top: parseInt(this.currentItem.css("marginTop"), 10) || 0
      }
    },
    _cacheHelperProportions: function() {
      this.helperProportions = {
        width: this.helper.outerWidth(),
        height: this.helper.outerHeight()
      }
    },
    _setContainment: function() {
      var e, i, s, n = this.options;
      "parent" === n.containment && (n.containment = this.helper[0].parentNode), ("document" === n.containment || "window" === n.containment) && (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, t("document" === n.containment ? document : window).width() - this.helperProportions.width - this.margins.left, (t("document" === n.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), /^(document|window|parent)$/.test(n.containment) || (e = t(n.containment)[0], i = t(n.containment).offset(), s = "hidden" !== t(e).css("overflow"), this.containment = [i.left + (parseInt(t(e).css("borderLeftWidth"), 10) || 0) + (parseInt(t(e).css("paddingLeft"), 10) || 0) - this.margins.left, i.top + (parseInt(t(e).css("borderTopWidth"), 10) || 0) + (parseInt(t(e).css("paddingTop"), 10) || 0) - this.margins.top, i.left + (s ? Math.max(e.scrollWidth, e.offsetWidth) : e.offsetWidth) - (parseInt(t(e).css("borderLeftWidth"), 10) || 0) - (parseInt(t(e).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, i.top + (s ? Math.max(e.scrollHeight, e.offsetHeight) : e.offsetHeight) - (parseInt(t(e).css("borderTopWidth"), 10) || 0) - (parseInt(t(e).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top])
    },
    _convertPositionTo: function(e, i) {
      i || (i = this.position);
      var s = "absolute" === e ? 1 : -1,
        n = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && t.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
        o = /(html|body)/i.test(n[0].tagName);
      return {
        top: i.top + this.offset.relative.top * s + this.offset.parent.top * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : o ? 0 : n.scrollTop()) * s,
        left: i.left + this.offset.relative.left * s + this.offset.parent.left * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : o ? 0 : n.scrollLeft()) * s
      }
    },
    _generatePosition: function(e) {
      var i, s, n = this.options,
        o = e.pageX,
        a = e.pageY,
        r = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && t.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
        h = /(html|body)/i.test(r[0].tagName);
      return "relative" !== this.cssPosition || this.scrollParent[0] !== document && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (e.pageX - this.offset.click.left < this.containment[0] && (o = this.containment[0] + this.offset.click.left), e.pageY - this.offset.click.top < this.containment[1] && (a = this.containment[1] + this.offset.click.top), e.pageX - this.offset.click.left > this.containment[2] && (o = this.containment[2] + this.offset.click.left), e.pageY - this.offset.click.top > this.containment[3] && (a = this.containment[3] + this.offset.click.top)), n.grid && (i = this.originalPageY + Math.round((a - this.originalPageY) / n.grid[1]) * n.grid[1], a = this.containment ? i - this.offset.click.top >= this.containment[1] && i - this.offset.click.top <= this.containment[3] ? i : i - this.offset.click.top >= this.containment[1] ? i - n.grid[1] : i + n.grid[1] : i, s = this.originalPageX + Math.round((o - this.originalPageX) / n.grid[0]) * n.grid[0], o = this.containment ? s - this.offset.click.left >= this.containment[0] && s - this.offset.click.left <= this.containment[2] ? s : s - this.offset.click.left >= this.containment[0] ? s - n.grid[0] : s + n.grid[0] : s)), {
        top: a - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : h ? 0 : r.scrollTop()),
        left: o - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : h ? 0 : r.scrollLeft())
      }
    },
    _rearrange: function(t, e, i, s) {
      i ? i[0].appendChild(this.placeholder[0]) : e.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? e.item[0] : e.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
      var n = this.counter;
      this._delay(function() {
        n === this.counter && this.refreshPositions(!s)
      })
    },
    _clear: function(t, e) {
      this.reverting = !1;
      var i, s = [];
      if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] === this.currentItem[0]) {
        for (i in this._storedCSS)("auto" === this._storedCSS[i] || "static" === this._storedCSS[i]) && (this._storedCSS[i] = "");
        this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
      } else this.currentItem.show();
      for (this.fromOutside && !e && s.push(function(t) {
          this._trigger("receive", t, this._uiHash(this.fromOutside))
        }), !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || e || s.push(function(t) {
          this._trigger("update", t, this._uiHash())
        }), this !== this.currentContainer && (e || (s.push(function(t) {
          this._trigger("remove", t, this._uiHash())
        }), s.push(function(t) {
          return function(e) {
            t._trigger("receive", e, this._uiHash(this))
          }
        }.call(this, this.currentContainer)), s.push(function(t) {
          return function(e) {
            t._trigger("update", e, this._uiHash(this))
          }
        }.call(this, this.currentContainer)))), i = this.containers.length - 1; i >= 0; i--) e || s.push(function(t) {
        return function(e) {
          t._trigger("deactivate", e, this._uiHash(this))
        }
      }.call(this, this.containers[i])), this.containers[i].containerCache.over && (s.push(function(t) {
        return function(e) {
          t._trigger("out", e, this._uiHash(this))
        }
      }.call(this, this.containers[i])), this.containers[i].containerCache.over = 0);
      if (this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, this.cancelHelperRemoval) {
        if (!e) {
          for (this._trigger("beforeStop", t, this._uiHash()), i = 0; s.length > i; i++) s[i].call(this, t);
          this._trigger("stop", t, this._uiHash())
        }
        return this.fromOutside = !1, !1
      }
      if (e || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null, !e) {
        for (i = 0; s.length > i; i++) s[i].call(this, t);
        this._trigger("stop", t, this._uiHash())
      }
      return this.fromOutside = !1, !0
    },
    _trigger: function() {
      t.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
    },
    _uiHash: function(e) {
      var i = e || this;
      return {
        helper: i.helper,
        placeholder: i.placeholder || t([]),
        position: i.position,
        originalPosition: i.originalPosition,
        offset: i.positionAbs,
        item: i.currentItem,
        sender: e ? e.element : null
      }
    }
  })
}(jQuery),
function(t, e) {
  var i = "ui-effects-";
  t.effects = {
      effect: {}
    },
    function(t, e) {
      function i(t, e, i) {
        var s = u[e.type] || {};
        return null == t ? i || !e.def ? null : e.def : (t = s.floor ? ~~t : parseFloat(t), isNaN(t) ? e.def : s.mod ? (t + s.mod) % s.mod : 0 > t ? 0 : t > s.max ? s.max : t)
      }

      function s(i) {
        var s = l(),
          n = s._rgba = [];
        return i = i.toLowerCase(), f(h, function(t, o) {
          var a, r = o.re.exec(i),
            h = r && o.parse(r),
            l = o.space || "rgba";
          return h ? (a = s[l](h), s[c[l].cache] = a[c[l].cache], n = s._rgba = a._rgba, !1) : e
        }), n.length ? ("0,0,0,0" === n.join() && t.extend(n, o.transparent), s) : o[i]
      }

      function n(t, e, i) {
        return i = (i + 1) % 1, 1 > 6 * i ? t + 6 * (e - t) * i : 1 > 2 * i ? e : 2 > 3 * i ? t + 6 * (e - t) * (2 / 3 - i) : t
      }
      var o, a = "backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",
        r = /^([\-+])=\s*(\d+\.?\d*)/,
        h = [{
          re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
          parse: function(t) {
            return [t[1], t[2], t[3], t[4]]
          }
        }, {
          re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
          parse: function(t) {
            return [2.55 * t[1], 2.55 * t[2], 2.55 * t[3], t[4]]
          }
        }, {
          re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
          parse: function(t) {
            return [parseInt(t[1], 16), parseInt(t[2], 16), parseInt(t[3], 16)]
          }
        }, {
          re: /#([a-f0-9])([a-f0-9])([a-f0-9])/,
          parse: function(t) {
            return [parseInt(t[1] + t[1], 16), parseInt(t[2] + t[2], 16), parseInt(t[3] + t[3], 16)]
          }
        }, {
          re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
          space: "hsla",
          parse: function(t) {
            return [t[1], t[2] / 100, t[3] / 100, t[4]]
          }
        }],
        l = t.Color = function(e, i, s, n) {
          return new t.Color.fn.parse(e, i, s, n)
        },
        c = {
          rgba: {
            props: {
              red: {
                idx: 0,
                type: "byte"
              },
              green: {
                idx: 1,
                type: "byte"
              },
              blue: {
                idx: 2,
                type: "byte"
              }
            }
          },
          hsla: {
            props: {
              hue: {
                idx: 0,
                type: "degrees"
              },
              saturation: {
                idx: 1,
                type: "percent"
              },
              lightness: {
                idx: 2,
                type: "percent"
              }
            }
          }
        },
        u = {
          "byte": {
            floor: !0,
            max: 255
          },
          percent: {
            max: 1
          },
          degrees: {
            mod: 360,
            floor: !0
          }
        },
        d = l.support = {},
        p = t("<p>")[0],
        f = t.each;
      p.style.cssText = "background-color:rgba(1,1,1,.5)", d.rgba = p.style.backgroundColor.indexOf("rgba") > -1, f(c, function(t, e) {
        e.cache = "_" + t, e.props.alpha = {
          idx: 3,
          type: "percent",
          def: 1
        }
      }), l.fn = t.extend(l.prototype, {
        parse: function(n, a, r, h) {
          if (n === e) return this._rgba = [null, null, null, null], this;
          (n.jquery || n.nodeType) && (n = t(n).css(a), a = e);
          var u = this,
            d = t.type(n),
            p = this._rgba = [];
          return a !== e && (n = [n, a, r, h], d = "array"), "string" === d ? this.parse(s(n) || o._default) : "array" === d ? (f(c.rgba.props, function(t, e) {
            p[e.idx] = i(n[e.idx], e)
          }), this) : "object" === d ? (n instanceof l ? f(c, function(t, e) {
            n[e.cache] && (u[e.cache] = n[e.cache].slice())
          }) : f(c, function(e, s) {
            var o = s.cache;
            f(s.props, function(t, e) {
              if (!u[o] && s.to) {
                if ("alpha" === t || null == n[t]) return;
                u[o] = s.to(u._rgba)
              }
              u[o][e.idx] = i(n[t], e, !0)
            }), u[o] && 0 > t.inArray(null, u[o].slice(0, 3)) && (u[o][3] = 1, s.from && (u._rgba = s.from(u[o])))
          }), this) : e
        },
        is: function(t) {
          var i = l(t),
            s = !0,
            n = this;
          return f(c, function(t, o) {
            var a, r = i[o.cache];
            return r && (a = n[o.cache] || o.to && o.to(n._rgba) || [], f(o.props, function(t, i) {
              return null != r[i.idx] ? s = r[i.idx] === a[i.idx] : e
            })), s
          }), s
        },
        _space: function() {
          var t = [],
            e = this;
          return f(c, function(i, s) {
            e[s.cache] && t.push(i)
          }), t.pop()
        },
        transition: function(t, e) {
          var s = l(t),
            n = s._space(),
            o = c[n],
            a = 0 === this.alpha() ? l("transparent") : this,
            r = a[o.cache] || o.to(a._rgba),
            h = r.slice();
          return s = s[o.cache], f(o.props, function(t, n) {
            var o = n.idx,
              a = r[o],
              l = s[o],
              c = u[n.type] || {};
            null !== l && (null === a ? h[o] = l : (c.mod && (l - a > c.mod / 2 ? a += c.mod : a - l > c.mod / 2 && (a -= c.mod)), h[o] = i((l - a) * e + a, n)))
          }), this[n](h)
        },
        blend: function(e) {
          if (1 === this._rgba[3]) return this;
          var i = this._rgba.slice(),
            s = i.pop(),
            n = l(e)._rgba;
          return l(t.map(i, function(t, e) {
            return (1 - s) * n[e] + s * t
          }))
        },
        toRgbaString: function() {
          var e = "rgba(",
            i = t.map(this._rgba, function(t, e) {
              return null == t ? e > 2 ? 1 : 0 : t
            });
          return 1 === i[3] && (i.pop(), e = "rgb("), e + i.join() + ")"
        },
        toHslaString: function() {
          var e = "hsla(",
            i = t.map(this.hsla(), function(t, e) {
              return null == t && (t = e > 2 ? 1 : 0), e && 3 > e && (t = Math.round(100 * t) + "%"), t
            });
          return 1 === i[3] && (i.pop(), e = "hsl("), e + i.join() + ")"
        },
        toHexString: function(e) {
          var i = this._rgba.slice(),
            s = i.pop();
          return e && i.push(~~(255 * s)), "#" + t.map(i, function(t) {
            return t = (t || 0).toString(16), 1 === t.length ? "0" + t : t
          }).join("")
        },
        toString: function() {
          return 0 === this._rgba[3] ? "transparent" : this.toRgbaString()
        }
      }), l.fn.parse.prototype = l.fn, c.hsla.to = function(t) {
        if (null == t[0] || null == t[1] || null == t[2]) return [null, null, null, t[3]];
        var e, i, s = t[0] / 255,
          n = t[1] / 255,
          o = t[2] / 255,
          a = t[3],
          r = Math.max(s, n, o),
          h = Math.min(s, n, o),
          l = r - h,
          c = r + h,
          u = .5 * c;
        return e = h === r ? 0 : s === r ? 60 * (n - o) / l + 360 : n === r ? 60 * (o - s) / l + 120 : 60 * (s - n) / l + 240, i = 0 === l ? 0 : .5 >= u ? l / c : l / (2 - c), [Math.round(e) % 360, i, u, null == a ? 1 : a]
      }, c.hsla.from = function(t) {
        if (null == t[0] || null == t[1] || null == t[2]) return [null, null, null, t[3]];
        var e = t[0] / 360,
          i = t[1],
          s = t[2],
          o = t[3],
          a = .5 >= s ? s * (1 + i) : s + i - s * i,
          r = 2 * s - a;
        return [Math.round(255 * n(r, a, e + 1 / 3)), Math.round(255 * n(r, a, e)), Math.round(255 * n(r, a, e - 1 / 3)), o]
      }, f(c, function(s, n) {
        var o = n.props,
          a = n.cache,
          h = n.to,
          c = n.from;
        l.fn[s] = function(s) {
          if (h && !this[a] && (this[a] = h(this._rgba)), s === e) return this[a].slice();
          var n, r = t.type(s),
            u = "array" === r || "object" === r ? s : arguments,
            d = this[a].slice();
          return f(o, function(t, e) {
            var s = u["object" === r ? t : e.idx];
            null == s && (s = d[e.idx]), d[e.idx] = i(s, e)
          }), c ? (n = l(c(d)), n[a] = d, n) : l(d)
        }, f(o, function(e, i) {
          l.fn[e] || (l.fn[e] = function(n) {
            var o, a = t.type(n),
              h = "alpha" === e ? this._hsla ? "hsla" : "rgba" : s,
              l = this[h](),
              c = l[i.idx];
            return "undefined" === a ? c : ("function" === a && (n = n.call(this, c), a = t.type(n)), null == n && i.empty ? this : ("string" === a && (o = r.exec(n), o && (n = c + parseFloat(o[2]) * ("+" === o[1] ? 1 : -1))), l[i.idx] = n, this[h](l)))
          })
        })
      }), l.hook = function(e) {
        var i = e.split(" ");
        f(i, function(e, i) {
          t.cssHooks[i] = {
            set: function(e, n) {
              var o, a, r = "";
              if ("transparent" !== n && ("string" !== t.type(n) || (o = s(n)))) {
                if (n = l(o || n), !d.rgba && 1 !== n._rgba[3]) {
                  for (a = "backgroundColor" === i ? e.parentNode : e;
                    ("" === r || "transparent" === r) && a && a.style;) try {
                    r = t.css(a, "backgroundColor"), a = a.parentNode
                  } catch (h) {}
                  n = n.blend(r && "transparent" !== r ? r : "_default")
                }
                n = n.toRgbaString()
              }
              try {
                e.style[i] = n
              } catch (h) {}
            }
          }, t.fx.step[i] = function(e) {
            e.colorInit || (e.start = l(e.elem, i), e.end = l(e.end), e.colorInit = !0), t.cssHooks[i].set(e.elem, e.start.transition(e.end, e.pos))
          }
        })
      }, l.hook(a), t.cssHooks.borderColor = {
        expand: function(t) {
          var e = {};
          return f(["Top", "Right", "Bottom", "Left"], function(i, s) {
            e["border" + s + "Color"] = t
          }), e
        }
      }, o = t.Color.names = {
        aqua: "#00ffff",
        black: "#000000",
        blue: "#0000ff",
        fuchsia: "#ff00ff",
        gray: "#808080",
        green: "#008000",
        lime: "#00ff00",
        maroon: "#800000",
        navy: "#000080",
        olive: "#808000",
        purple: "#800080",
        red: "#ff0000",
        silver: "#c0c0c0",
        teal: "#008080",
        white: "#ffffff",
        yellow: "#ffff00",
        transparent: [null, null, null, 0],
        _default: "#ffffff"
      }
    }(jQuery),
    function() {
      function i(e) {
        var i, s, n = e.ownerDocument.defaultView ? e.ownerDocument.defaultView.getComputedStyle(e, null) : e.currentStyle,
          o = {};
        if (n && n.length && n[0] && n[n[0]])
          for (s = n.length; s--;) i = n[s], "string" == typeof n[i] && (o[t.camelCase(i)] = n[i]);
        else
          for (i in n) "string" == typeof n[i] && (o[i] = n[i]);
        return o
      }

      function s(e, i) {
        var s, n, a = {};
        for (s in i) n = i[s], e[s] !== n && (o[s] || (t.fx.step[s] || !isNaN(parseFloat(n))) && (a[s] = n));
        return a
      }
      var n = ["add", "remove", "toggle"],
        o = {
          border: 1,
          borderBottom: 1,
          borderColor: 1,
          borderLeft: 1,
          borderRight: 1,
          borderTop: 1,
          borderWidth: 1,
          margin: 1,
          padding: 1
        };
      t.each(["borderLeftStyle", "borderRightStyle", "borderBottomStyle", "borderTopStyle"], function(e, i) {
        t.fx.step[i] = function(t) {
          ("none" !== t.end && !t.setAttr || 1 === t.pos && !t.setAttr) && (jQuery.style(t.elem, i, t.end), t.setAttr = !0)
        }
      }), t.fn.addBack || (t.fn.addBack = function(t) {
        return this.add(null == t ? this.prevObject : this.prevObject.filter(t))
      }), t.effects.animateClass = function(e, o, a, r) {
        var h = t.speed(o, a, r);
        return this.queue(function() {
          var o, a = t(this),
            r = a.attr("class") || "",
            l = h.children ? a.find("*").addBack() : a;
          l = l.map(function() {
            var e = t(this);
            return {
              el: e,
              start: i(this)
            }
          }), o = function() {
            t.each(n, function(t, i) {
              e[i] && a[i + "Class"](e[i])
            })
          }, o(), l = l.map(function() {
            return this.end = i(this.el[0]), this.diff = s(this.start, this.end), this
          }), a.attr("class", r), l = l.map(function() {
            var e = this,
              i = t.Deferred(),
              s = t.extend({}, h, {
                queue: !1,
                complete: function() {
                  i.resolve(e)
                }
              });
            return this.el.animate(this.diff, s), i.promise()
          }), t.when.apply(t, l.get()).done(function() {
            o(), t.each(arguments, function() {
              var e = this.el;
              t.each(this.diff, function(t) {
                e.css(t, "")
              })
            }), h.complete.call(a[0])
          })
        })
      }, t.fn.extend({
        addClass: function(e) {
          return function(i, s, n, o) {
            return s ? t.effects.animateClass.call(this, {
              add: i
            }, s, n, o) : e.apply(this, arguments)
          }
        }(t.fn.addClass),
        removeClass: function(e) {
          return function(i, s, n, o) {
            return arguments.length > 1 ? t.effects.animateClass.call(this, {
              remove: i
            }, s, n, o) : e.apply(this, arguments)
          }
        }(t.fn.removeClass),
        toggleClass: function(i) {
          return function(s, n, o, a, r) {
            return "boolean" == typeof n || n === e ? o ? t.effects.animateClass.call(this, n ? {
              add: s
            } : {
              remove: s
            }, o, a, r) : i.apply(this, arguments) : t.effects.animateClass.call(this, {
              toggle: s
            }, n, o, a)
          }
        }(t.fn.toggleClass),
        switchClass: function(e, i, s, n, o) {
          return t.effects.animateClass.call(this, {
            add: i,
            remove: e
          }, s, n, o)
        }
      })
    }(),
    function() {
      function s(e, i, s, n) {
        return t.isPlainObject(e) && (i = e, e = e.effect), e = {
          effect: e
        }, null == i && (i = {}), t.isFunction(i) && (n = i, s = null, i = {}), ("number" == typeof i || t.fx.speeds[i]) && (n = s, s = i, i = {}), t.isFunction(s) && (n = s, s = null), i && t.extend(e, i), s = s || i.duration, e.duration = t.fx.off ? 0 : "number" == typeof s ? s : s in t.fx.speeds ? t.fx.speeds[s] : t.fx.speeds._default, e.complete = n || i.complete, e
      }

      function n(e) {
        return !e || "number" == typeof e || t.fx.speeds[e] ? !0 : "string" != typeof e || t.effects.effect[e] ? t.isFunction(e) ? !0 : "object" != typeof e || e.effect ? !1 : !0 : !0
      }
      t.extend(t.effects, {
        version: "1.10.3",
        save: function(t, e) {
          for (var s = 0; e.length > s; s++) null !== e[s] && t.data(i + e[s], t[0].style[e[s]])
        },
        restore: function(t, s) {
          var n, o;
          for (o = 0; s.length > o; o++) null !== s[o] && (n = t.data(i + s[o]), n === e && (n = ""), t.css(s[o], n))
        },
        setMode: function(t, e) {
          return "toggle" === e && (e = t.is(":hidden") ? "show" : "hide"), e
        },
        getBaseline: function(t, e) {
          var i, s;
          switch (t[0]) {
            case "top":
              i = 0;
              break;
            case "middle":
              i = .5;
              break;
            case "bottom":
              i = 1;
              break;
            default:
              i = t[0] / e.height
          }
          switch (t[1]) {
            case "left":
              s = 0;
              break;
            case "center":
              s = .5;
              break;
            case "right":
              s = 1;
              break;
            default:
              s = t[1] / e.width
          }
          return {
            x: s,
            y: i
          }
        },
        createWrapper: function(e) {
          if (e.parent().is(".ui-effects-wrapper")) return e.parent();
          var i = {
              width: e.outerWidth(!0),
              height: e.outerHeight(!0),
              "float": e.css("float")
            },
            s = t("<div></div>").addClass("ui-effects-wrapper").css({
              fontSize: "100%",
              background: "transparent",
              border: "none",
              margin: 0,
              padding: 0
            }),
            n = {
              width: e.width(),
              height: e.height()
            },
            o = document.activeElement;
          try {
            o.id
          } catch (a) {
            o = document.body
          }
          return e.wrap(s), (e[0] === o || t.contains(e[0], o)) && t(o).focus(), s = e.parent(), "static" === e.css("position") ? (s.css({
            position: "relative"
          }), e.css({
            position: "relative"
          })) : (t.extend(i, {
            position: e.css("position"),
            zIndex: e.css("z-index")
          }), t.each(["top", "left", "bottom", "right"], function(t, s) {
            i[s] = e.css(s), isNaN(parseInt(i[s], 10)) && (i[s] = "auto")
          }), e.css({
            position: "relative",
            top: 0,
            left: 0,
            right: "auto",
            bottom: "auto"
          })), e.css(n), s.css(i).show()
        },
        removeWrapper: function(e) {
          var i = document.activeElement;
          return e.parent().is(".ui-effects-wrapper") && (e.parent().replaceWith(e), (e[0] === i || t.contains(e[0], i)) && t(i).focus()), e
        },
        setTransition: function(e, i, s, n) {
          return n = n || {}, t.each(i, function(t, i) {
            var o = e.cssUnit(i);
            o[0] > 0 && (n[i] = o[0] * s + o[1])
          }), n
        }
      }), t.fn.extend({
        effect: function() {
          function e(e) {
            function s() {
              t.isFunction(o) && o.call(n[0]), t.isFunction(e) && e()
            }
            var n = t(this),
              o = i.complete,
              r = i.mode;
            (n.is(":hidden") ? "hide" === r : "show" === r) ? (n[r](), s()) : a.call(n[0], i, s)
          }
          var i = s.apply(this, arguments),
            n = i.mode,
            o = i.queue,
            a = t.effects.effect[i.effect];
          return t.fx.off || !a ? n ? this[n](i.duration, i.complete) : this.each(function() {
            i.complete && i.complete.call(this)
          }) : o === !1 ? this.each(e) : this.queue(o || "fx", e)
        },
        show: function(t) {
          return function(e) {
            if (n(e)) return t.apply(this, arguments);
            var i = s.apply(this, arguments);
            return i.mode = "show", this.effect.call(this, i)
          }
        }(t.fn.show),
        hide: function(t) {
          return function(e) {
            if (n(e)) return t.apply(this, arguments);
            var i = s.apply(this, arguments);
            return i.mode = "hide", this.effect.call(this, i)
          }
        }(t.fn.hide),
        toggle: function(t) {
          return function(e) {
            if (n(e) || "boolean" == typeof e) return t.apply(this, arguments);
            var i = s.apply(this, arguments);
            return i.mode = "toggle", this.effect.call(this, i)
          }
        }(t.fn.toggle),
        cssUnit: function(e) {
          var i = this.css(e),
            s = [];
          return t.each(["em", "px", "%", "pt"], function(t, e) {
            i.indexOf(e) > 0 && (s = [parseFloat(i), e])
          }), s
        }
      })
    }(),
    function() {
      var e = {};
      t.each(["Quad", "Cubic", "Quart", "Quint", "Expo"], function(t, i) {
        e[i] = function(e) {
          return Math.pow(e, t + 2)
        }
      }), t.extend(e, {
        Sine: function(t) {
          return 1 - Math.cos(t * Math.PI / 2)
        },
        Circ: function(t) {
          return 1 - Math.sqrt(1 - t * t)
        },
        Elastic: function(t) {
          return 0 === t || 1 === t ? t : -Math.pow(2, 8 * (t - 1)) * Math.sin((80 * (t - 1) - 7.5) * Math.PI / 15)
        },
        Back: function(t) {
          return t * t * (3 * t - 2)
        },
        Bounce: function(t) {
          for (var e, i = 4;
            ((e = Math.pow(2, --i)) - 1) / 11 > t;);
          return 1 / Math.pow(4, 3 - i) - 7.5625 * Math.pow((3 * e - 2) / 22 - t, 2)
        }
      }), t.each(e, function(e, i) {
        t.easing["easeIn" + e] = i, t.easing["easeOut" + e] = function(t) {
          return 1 - i(1 - t)
        }, t.easing["easeInOut" + e] = function(t) {
          return .5 > t ? i(2 * t) / 2 : 1 - i(-2 * t + 2) / 2
        }
      })
    }()
}(jQuery),
function(t) {
  var e = 0,
    i = {},
    s = {};
  i.height = i.paddingTop = i.paddingBottom = i.borderTopWidth = i.borderBottomWidth = "hide", s.height = s.paddingTop = s.paddingBottom = s.borderTopWidth = s.borderBottomWidth = "show", t.widget("ui.accordion", {
    version: "1.10.3",
    options: {
      active: 0,
      animate: {},
      collapsible: !1,
      event: "click",
      header: "> li > :first-child,> :not(li):even",
      heightStyle: "auto",
      icons: {
        activeHeader: "ui-icon-triangle-1-s",
        header: "ui-icon-triangle-1-e"
      },
      activate: null,
      beforeActivate: null
    },
    _create: function() {
      var e = this.options;
      this.prevShow = this.prevHide = t(), this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role", "tablist"), e.collapsible || e.active !== !1 && null != e.active || (e.active = 0), this._processPanels(), 0 > e.active && (e.active += this.headers.length), this._refresh()
    },
    _getCreateEventData: function() {
      return {
        header: this.active,
        panel: this.active.length ? this.active.next() : t(),
        content: this.active.length ? this.active.next() : t()
      }
    },
    _createIcons: function() {
      var e = this.options.icons;
      e && (t("<span>").addClass("ui-accordion-header-icon ui-icon " + e.header).prependTo(this.headers), this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader), this.headers.addClass("ui-accordion-icons"))
    },
    _destroyIcons: function() {
      this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()
    },
    _destroy: function() {
      var t;
      this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"), this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function() {
        /^ui-accordion/.test(this.id) && this.removeAttribute("id")
      }), this._destroyIcons(), t = this.headers.next().css("display", "").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function() {
        /^ui-accordion/.test(this.id) && this.removeAttribute("id")
      }), "content" !== this.options.heightStyle && t.css("height", "")
    },
    _setOption: function(t, e) {
      return "active" === t ? (this._activate(e), undefined) : ("event" === t && (this.options.event && this._off(this.headers, this.options.event), this._setupEvents(e)), this._super(t, e), "collapsible" !== t || e || this.options.active !== !1 || this._activate(0), "icons" === t && (this._destroyIcons(), e && this._createIcons()), "disabled" === t && this.headers.add(this.headers.next()).toggleClass("ui-state-disabled", !!e), undefined)
    },
    _keydown: function(e) {
      if (!e.altKey && !e.ctrlKey) {
        var i = t.ui.keyCode,
          s = this.headers.length,
          n = this.headers.index(e.target),
          o = !1;
        switch (e.keyCode) {
          case i.RIGHT:
          case i.DOWN:
            o = this.headers[(n + 1) % s];
            break;
          case i.LEFT:
          case i.UP:
            o = this.headers[(n - 1 + s) % s];
            break;
          case i.SPACE:
          case i.ENTER:
            this._eventHandler(e);
            break;
          case i.HOME:
            o = this.headers[0];
            break;
          case i.END:
            o = this.headers[s - 1]
        }
        o && (t(e.target).attr("tabIndex", -1), t(o).attr("tabIndex", 0), o.focus(), e.preventDefault())
      }
    },
    _panelKeyDown: function(e) {
      e.keyCode === t.ui.keyCode.UP && e.ctrlKey && t(e.currentTarget).prev().focus()
    },
    refresh: function() {
      var e = this.options;
      this._processPanels(), e.active === !1 && e.collapsible === !0 || !this.headers.length ? (e.active = !1, this.active = t()) : e.active === !1 ? this._activate(0) : this.active.length && !t.contains(this.element[0], this.active[0]) ? this.headers.length === this.headers.find(".ui-state-disabled").length ? (e.active = !1, this.active = t()) : this._activate(Math.max(0, e.active - 1)) : e.active = this.headers.index(this.active), this._destroyIcons(), this._refresh()
    },
    _processPanels: function() {
      this.headers = this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"), this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()
    },
    _refresh: function() {
      var i, s = this.options,
        n = s.heightStyle,
        o = this.element.parent(),
        a = this.accordionId = "ui-accordion-" + (this.element.attr("id") || ++e);
      this.active = this._findActive(s.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"), this.active.next().addClass("ui-accordion-content-active").show(), this.headers.attr("role", "tab").each(function(e) {
        var i = t(this),
          s = i.attr("id"),
          n = i.next(),
          o = n.attr("id");
        s || (s = a + "-header-" + e, i.attr("id", s)), o || (o = a + "-panel-" + e, n.attr("id", o)), i.attr("aria-controls", o), n.attr("aria-labelledby", s)
      }).next().attr("role", "tabpanel"), this.headers.not(this.active).attr({
        "aria-selected": "false",
        tabIndex: -1
      }).next().attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }).hide(), this.active.length ? this.active.attr({
        "aria-selected": "true",
        tabIndex: 0
      }).next().attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      }) : this.headers.eq(0).attr("tabIndex", 0), this._createIcons(), this._setupEvents(s.event), "fill" === n ? (i = o.height(), this.element.siblings(":visible").each(function() {
        var e = t(this),
          s = e.css("position");
        "absolute" !== s && "fixed" !== s && (i -= e.outerHeight(!0))
      }), this.headers.each(function() {
        i -= t(this).outerHeight(!0)
      }), this.headers.next().each(function() {
        t(this).height(Math.max(0, i - t(this).innerHeight() + t(this).height()))
      }).css("overflow", "auto")) : "auto" === n && (i = 0, this.headers.next().each(function() {
        i = Math.max(i, t(this).css("height", "").height())
      }).height(i))
    },
    _activate: function(e) {
      var i = this._findActive(e)[0];
      i !== this.active[0] && (i = i || this.active[0], this._eventHandler({
        target: i,
        currentTarget: i,
        preventDefault: t.noop
      }))
    },
    _findActive: function(e) {
      return "number" == typeof e ? this.headers.eq(e) : t()
    },
    _setupEvents: function(e) {
      var i = {
        keydown: "_keydown"
      };
      e && t.each(e.split(" "), function(t, e) {
        i[e] = "_eventHandler"
      }), this._off(this.headers.add(this.headers.next())), this._on(this.headers, i), this._on(this.headers.next(), {
        keydown: "_panelKeyDown"
      }), this._hoverable(this.headers), this._focusable(this.headers)
    },
    _eventHandler: function(e) {
      var i = this.options,
        s = this.active,
        n = t(e.currentTarget),
        o = n[0] === s[0],
        a = o && i.collapsible,
        r = a ? t() : n.next(),
        h = s.next(),
        l = {
          oldHeader: s,
          oldPanel: h,
          newHeader: a ? t() : n,
          newPanel: r
        };
      e.preventDefault(), o && !i.collapsible || this._trigger("beforeActivate", e, l) === !1 || (i.active = a ? !1 : this.headers.index(n), this.active = o ? t() : n, this._toggle(l), s.removeClass("ui-accordion-header-active ui-state-active"), i.icons && s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header), o || (n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"), i.icons && n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader), n.next().addClass("ui-accordion-content-active")))
    },
    _toggle: function(e) {
      var i = e.newPanel,
        s = this.prevShow.length ? this.prevShow : e.oldPanel;
      this.prevShow.add(this.prevHide).stop(!0, !0), this.prevShow = i, this.prevHide = s, this.options.animate ? this._animate(i, s, e) : (s.hide(), i.show(), this._toggleComplete(e)), s.attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }), s.prev().attr("aria-selected", "false"), i.length && s.length ? s.prev().attr("tabIndex", -1) : i.length && this.headers.filter(function() {
        return 0 === t(this).attr("tabIndex")
      }).attr("tabIndex", -1), i.attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      }).prev().attr({
        "aria-selected": "true",
        tabIndex: 0
      })
    },
    _animate: function(t, e, n) {
      var o, a, r, h = this,
        l = 0,
        c = t.length && (!e.length || t.index() < e.index()),
        u = this.options.animate || {},
        d = c && u.down || u,
        p = function() {
          h._toggleComplete(n)
        };
      return "number" == typeof d && (r = d), "string" == typeof d && (a = d), a = a || d.easing || u.easing, r = r || d.duration || u.duration, e.length ? t.length ? (o = t.show().outerHeight(), e.animate(i, {
        duration: r,
        easing: a,
        step: function(t, e) {
          e.now = Math.round(t)
        }
      }), t.hide().animate(s, {
        duration: r,
        easing: a,
        complete: p,
        step: function(t, i) {
          i.now = Math.round(t), "height" !== i.prop ? l += i.now : "content" !== h.options.heightStyle && (i.now = Math.round(o - e.outerHeight() - l), l = 0)
        }
      }), undefined) : e.animate(i, r, a, p) : t.animate(s, r, a, p)
    },
    _toggleComplete: function(t) {
      var e = t.oldPanel;
      e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"), e.length && (e.parent()[0].className = e.parent()[0].className), this._trigger("activate", null, t)
    }
  })
}(jQuery),
function(t) {
  var e = 0;
  t.widget("ui.autocomplete", {
    version: "1.10.3",
    defaultElement: "<input>",
    options: {
      appendTo: null,
      autoFocus: !1,
      delay: 300,
      minLength: 1,
      position: {
        my: "left top",
        at: "left bottom",
        collision: "none"
      },
      source: null,
      change: null,
      close: null,
      focus: null,
      open: null,
      response: null,
      search: null,
      select: null
    },
    pending: 0,
    _create: function() {
      var e, i, s, n = this.element[0].nodeName.toLowerCase(),
        o = "textarea" === n,
        a = "input" === n;
      this.isMultiLine = o ? !0 : a ? !1 : this.element.prop("isContentEditable"), this.valueMethod = this.element[o || a ? "val" : "text"], this.isNewMenu = !0, this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"), this._on(this.element, {
        keydown: function(n) {
          if (this.element.prop("readOnly")) return e = !0, s = !0, i = !0, undefined;
          e = !1, s = !1, i = !1;
          var o = t.ui.keyCode;
          switch (n.keyCode) {
            case o.PAGE_UP:
              e = !0, this._move("previousPage", n);
              break;
            case o.PAGE_DOWN:
              e = !0, this._move("nextPage", n);
              break;
            case o.UP:
              e = !0, this._keyEvent("previous", n);
              break;
            case o.DOWN:
              e = !0, this._keyEvent("next", n);
              break;
            case o.ENTER:
            case o.NUMPAD_ENTER:
              this.menu.active && (e = !0, n.preventDefault(), this.menu.select(n));
              break;
            case o.TAB:
              this.menu.active && this.menu.select(n);
              break;
            case o.ESCAPE:
              this.menu.element.is(":visible") && (this._value(this.term), this.close(n), n.preventDefault());
              break;
            default:
              i = !0, this._searchTimeout(n)
          }
        },
        keypress: function(s) {
          if (e) return e = !1, (!this.isMultiLine || this.menu.element.is(":visible")) && s.preventDefault(), undefined;
          if (!i) {
            var n = t.ui.keyCode;
            switch (s.keyCode) {
              case n.PAGE_UP:
                this._move("previousPage", s);
                break;
              case n.PAGE_DOWN:
                this._move("nextPage", s);
                break;
              case n.UP:
                this._keyEvent("previous", s);
                break;
              case n.DOWN:
                this._keyEvent("next", s)
            }
          }
        },
        input: function(t) {
          return s ? (s = !1, t.preventDefault(), undefined) : (this._searchTimeout(t), undefined)
        },
        focus: function() {
          this.selectedItem = null, this.previous = this._value()
        },
        blur: function(t) {
          return this.cancelBlur ? (delete this.cancelBlur, undefined) : (clearTimeout(this.searching), this.close(t), this._change(t), undefined)
        }
      }), this._initSource(), this.menu = t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({
        role: null
      }).hide().data("ui-menu"), this._on(this.menu.element, {
        mousedown: function(e) {
          e.preventDefault(), this.cancelBlur = !0, this._delay(function() {
            delete this.cancelBlur
          });
          var i = this.menu.element[0];
          t(e.target).closest(".ui-menu-item").length || this._delay(function() {
            var e = this;
            this.document.one("mousedown", function(s) {
              s.target === e.element[0] || s.target === i || t.contains(i, s.target) || e.close()
            })
          })
        },
        menufocus: function(e, i) {
          if (this.isNewMenu && (this.isNewMenu = !1, e.originalEvent && /^mouse/.test(e.originalEvent.type))) return this.menu.blur(), this.document.one("mousemove", function() {
            t(e.target).trigger(e.originalEvent)
          }), undefined;
          var s = i.item.data("ui-autocomplete-item");
          !1 !== this._trigger("focus", e, {
            item: s
          }) ? e.originalEvent && /^key/.test(e.originalEvent.type) && this._value(s.value) : this.liveRegion.text(s.value)
        },
        menuselect: function(t, e) {
          var i = e.item.data("ui-autocomplete-item"),
            s = this.previous;
          this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = s, this._delay(function() {
            this.previous = s, this.selectedItem = i
          })), !1 !== this._trigger("select", t, {
            item: i
          }) && this._value(i.value), this.term = this._value(), this.close(t), this.selectedItem = i
        }
      }), this.liveRegion = t("<span>", {
        role: "status",
        "aria-live": "polite"
      }).addClass("ui-helper-hidden-accessible").insertBefore(this.element), this._on(this.window, {
        beforeunload: function() {
          this.element.removeAttr("autocomplete")
        }
      })
    },
    _destroy: function() {
      clearTimeout(this.searching), this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"), this.menu.element.remove(), this.liveRegion.remove()
    },
    _setOption: function(t, e) {
      this._super(t, e), "source" === t && this._initSource(), "appendTo" === t && this.menu.element.appendTo(this._appendTo()), "disabled" === t && e && this.xhr && this.xhr.abort()
    },
    _appendTo: function() {
      var e = this.options.appendTo;
      return e && (e = e.jquery || e.nodeType ? t(e) : this.document.find(e).eq(0)), e || (e = this.element.closest(".ui-front")), e.length || (e = this.document[0].body), e
    },
    _initSource: function() {
      var e, i, s = this;
      t.isArray(this.options.source) ? (e = this.options.source, this.source = function(i, s) {
        s(t.ui.autocomplete.filter(e, i.term))
      }) : "string" == typeof this.options.source ? (i = this.options.source, this.source = function(e, n) {
        s.xhr && s.xhr.abort(), s.xhr = t.ajax({
          url: i,
          data: e,
          dataType: "json",
          success: function(t) {
            n(t)
          },
          error: function() {
            n([])
          }
        })
      }) : this.source = this.options.source
    },
    _searchTimeout: function(t) {
      clearTimeout(this.searching), this.searching = this._delay(function() {
        this.term !== this._value() && (this.selectedItem = null, this.search(null, t))
      }, this.options.delay)
    },
    search: function(t, e) {
      return t = null != t ? t : this._value(), this.term = this._value(), t.length < this.options.minLength ? this.close(e) : this._trigger("search", e) !== !1 ? this._search(t) : undefined
    },
    _search: function(t) {
      this.pending++, this.element.addClass("ui-autocomplete-loading"), this.cancelSearch = !1, this.source({
        term: t
      }, this._response())
    },
    _response: function() {
      var t = this,
        i = ++e;
      return function(s) {
        i === e && t.__response(s), t.pending--, t.pending || t.element.removeClass("ui-autocomplete-loading")
      }
    },
    __response: function(t) {
      t && (t = this._normalize(t)), this._trigger("response", null, {
        content: t
      }), !this.options.disabled && t && t.length && !this.cancelSearch ? (this._suggest(t), this._trigger("open")) : this._close()
    },
    close: function(t) {
      this.cancelSearch = !0, this._close(t)
    },
    _close: function(t) {
      this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", t))
    },
    _change: function(t) {
      this.previous !== this._value() && this._trigger("change", t, {
        item: this.selectedItem
      })
    },
    _normalize: function(e) {
      return e.length && e[0].label && e[0].value ? e : t.map(e, function(e) {
        return "string" == typeof e ? {
          label: e,
          value: e
        } : t.extend({
          label: e.label || e.value,
          value: e.value || e.label
        }, e)
      })
    },
    _suggest: function(e) {
      var i = this.menu.element.empty();
      this._renderMenu(i, e), this.isNewMenu = !0, this.menu.refresh(), i.show(), this._resizeMenu(), i.position(t.extend({
        of: this.element
      }, this.options.position)), this.options.autoFocus && this.menu.next()
    },
    _resizeMenu: function() {
      var t = this.menu.element;
      t.outerWidth(Math.max(t.width("").outerWidth() + 1, this.element.outerWidth()))
    },
    _renderMenu: function(e, i) {
      var s = this;
      t.each(i, function(t, i) {
        s._renderItemData(e, i)
      })
    },
    _renderItemData: function(t, e) {
      return this._renderItem(t, e).data("ui-autocomplete-item", e)
    },
    _renderItem: function(e, i) {
      return t("<li>").append(t("<a>").text(i.label)).appendTo(e)
    },
    _move: function(t, e) {
      return this.menu.element.is(":visible") ? this.menu.isFirstItem() && /^previous/.test(t) || this.menu.isLastItem() && /^next/.test(t) ? (this._value(this.term), this.menu.blur(), undefined) : (this.menu[t](e), undefined) : (this.search(null, e), undefined)
    },
    widget: function() {
      return this.menu.element
    },
    _value: function() {
      return this.valueMethod.apply(this.element, arguments)
    },
    _keyEvent: function(t, e) {
      (!this.isMultiLine || this.menu.element.is(":visible")) && (this._move(t, e), e.preventDefault())
    }
  }), t.extend(t.ui.autocomplete, {
    escapeRegex: function(t) {
      return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
    },
    filter: function(e, i) {
      var s = RegExp(t.ui.autocomplete.escapeRegex(i), "i");
      return t.grep(e, function(t) {
        return s.test(t.label || t.value || t)
      })
    }
  }), t.widget("ui.autocomplete", t.ui.autocomplete, {
    options: {
      messages: {
        noResults: "No search results.",
        results: function(t) {
          return t + (t > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate."
        }
      }
    },
    __response: function(t) {
      var e;
      this._superApply(arguments), this.options.disabled || this.cancelSearch || (e = t && t.length ? this.options.messages.results(t.length) : this.options.messages.noResults, this.liveRegion.text(e))
    }
  })
}(jQuery),
function(t) {
  var e, i, s, n, o = "ui-button ui-widget ui-state-default ui-corner-all",
    a = "ui-state-hover ui-state-active ",
    r = "ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",
    h = function() {
      var e = t(this);
      setTimeout(function() {
        e.find(":ui-button").button("refresh")
      }, 1)
    },
    l = function(e) {
      var i = e.name,
        s = e.form,
        n = t([]);
      return i && (i = i.replace(/'/g, "\\'"), n = s ? t(s).find("[name='" + i + "']") : t("[name='" + i + "']", e.ownerDocument).filter(function() {
        return !this.form
      })), n
    };
  t.widget("ui.button", {
    version: "1.10.3",
    defaultElement: "<button>",
    options: {
      disabled: null,
      text: !0,
      label: null,
      icons: {
        primary: null,
        secondary: null
      }
    },
    _create: function() {
      this.element.closest("form").unbind("reset" + this.eventNamespace).bind("reset" + this.eventNamespace, h), "boolean" != typeof this.options.disabled ? this.options.disabled = !!this.element.prop("disabled") : this.element.prop("disabled", this.options.disabled), this._determineButtonType(), this.hasTitle = !!this.buttonElement.attr("title");
      var a = this,
        r = this.options,
        c = "checkbox" === this.type || "radio" === this.type,
        u = c ? "" : "ui-state-active",
        d = "ui-state-focus";
      null === r.label && (r.label = "input" === this.type ? this.buttonElement.val() : this.buttonElement.html()), this._hoverable(this.buttonElement), this.buttonElement.addClass(o).attr("role", "button").bind("mouseenter" + this.eventNamespace, function() {
        r.disabled || this === e && t(this).addClass("ui-state-active")
      }).bind("mouseleave" + this.eventNamespace, function() {
        r.disabled || t(this).removeClass(u)
      }).bind("click" + this.eventNamespace, function(t) {
        r.disabled && (t.preventDefault(), t.stopImmediatePropagation())
      }), this.element.bind("focus" + this.eventNamespace, function() {
        a.buttonElement.addClass(d)
      }).bind("blur" + this.eventNamespace, function() {
        a.buttonElement.removeClass(d)
      }), c && (this.element.bind("change" + this.eventNamespace, function() {
        n || a.refresh()
      }), this.buttonElement.bind("mousedown" + this.eventNamespace, function(t) {
        r.disabled || (n = !1, i = t.pageX, s = t.pageY)
      }).bind("mouseup" + this.eventNamespace, function(t) {
        r.disabled || (i !== t.pageX || s !== t.pageY) && (n = !0)
      })), "checkbox" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, function() {
        return r.disabled || n ? !1 : undefined
      }) : "radio" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, function() {
        if (r.disabled || n) return !1;
        t(this).addClass("ui-state-active"), a.buttonElement.attr("aria-pressed", "true");
        var e = a.element[0];
        l(e).not(e).map(function() {
          return t(this).button("widget")[0]
        }).removeClass("ui-state-active").attr("aria-pressed", "false")
      }) : (this.buttonElement.bind("mousedown" + this.eventNamespace, function() {
        return r.disabled ? !1 : (t(this).addClass("ui-state-active"), e = this, a.document.one("mouseup", function() {
          e = null
        }), undefined)
      }).bind("mouseup" + this.eventNamespace, function() {
        return r.disabled ? !1 : (t(this).removeClass("ui-state-active"), undefined)
      }).bind("keydown" + this.eventNamespace, function(e) {
        return r.disabled ? !1 : ((e.keyCode === t.ui.keyCode.SPACE || e.keyCode === t.ui.keyCode.ENTER) && t(this).addClass("ui-state-active"), undefined)
      }).bind("keyup" + this.eventNamespace + " blur" + this.eventNamespace, function() {
        t(this).removeClass("ui-state-active")
      }), this.buttonElement.is("a") && this.buttonElement.keyup(function(e) {
        e.keyCode === t.ui.keyCode.SPACE && t(this).click()
      })), this._setOption("disabled", r.disabled), this._resetButton()
    },
    _determineButtonType: function() {
      var t, e, i;
      this.type = this.element.is("[type=checkbox]") ? "checkbox" : this.element.is("[type=radio]") ? "radio" : this.element.is("input") ? "input" : "button", "checkbox" === this.type || "radio" === this.type ? (t = this.element.parents().last(), e = "label[for='" + this.element.attr("id") + "']", this.buttonElement = t.find(e), this.buttonElement.length || (t = t.length ? t.siblings() : this.element.siblings(), this.buttonElement = t.filter(e), this.buttonElement.length || (this.buttonElement = t.find(e))), this.element.addClass("ui-helper-hidden-accessible"), i = this.element.is(":checked"), i && this.buttonElement.addClass("ui-state-active"), this.buttonElement.prop("aria-pressed", i)) : this.buttonElement = this.element
    },
    widget: function() {
      return this.buttonElement
    },
    _destroy: function() {
      this.element.removeClass("ui-helper-hidden-accessible"), this.buttonElement.removeClass(o + " " + a + " " + r).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()), this.hasTitle || this.buttonElement.removeAttr("title")
    },
    _setOption: function(t, e) {
      return this._super(t, e), "disabled" === t ? (e ? this.element.prop("disabled", !0) : this.element.prop("disabled", !1), undefined) : (this._resetButton(), undefined)
    },
    refresh: function() {
      var e = this.element.is("input, button") ? this.element.is(":disabled") : this.element.hasClass("ui-button-disabled");
      e !== this.options.disabled && this._setOption("disabled", e), "radio" === this.type ? l(this.element[0]).each(function() {
        t(this).is(":checked") ? t(this).button("widget").addClass("ui-state-active").attr("aria-pressed", "true") : t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed", "false")
      }) : "checkbox" === this.type && (this.element.is(":checked") ? this.buttonElement.addClass("ui-state-active").attr("aria-pressed", "true") : this.buttonElement.removeClass("ui-state-active").attr("aria-pressed", "false"))
    },
    _resetButton: function() {
      if ("input" === this.type) return this.options.label && this.element.val(this.options.label), undefined;
      var e = this.buttonElement.removeClass(r),
        i = t("<span></span>", this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),
        s = this.options.icons,
        n = s.primary && s.secondary,
        o = [];
      s.primary || s.secondary ? (this.options.text && o.push("ui-button-text-icon" + (n ? "s" : s.primary ? "-primary" : "-secondary")), s.primary && e.prepend("<span class='ui-button-icon-primary ui-icon " + s.primary + "'></span>"), s.secondary && e.append("<span class='ui-button-icon-secondary ui-icon " + s.secondary + "'></span>"), this.options.text || (o.push(n ? "ui-button-icons-only" : "ui-button-icon-only"), this.hasTitle || e.attr("title", t.trim(i)))) : o.push("ui-button-text-only"), e.addClass(o.join(" "))
    }
  }), t.widget("ui.buttonset", {
    version: "1.10.3",
    options: {
      items: "button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"
    },
    _create: function() {
      this.element.addClass("ui-buttonset")
    },
    _init: function() {
      this.refresh()
    },
    _setOption: function(t, e) {
      "disabled" === t && this.buttons.button("option", t, e), this._super(t, e)
    },
    refresh: function() {
      var e = "rtl" === this.element.css("direction");
      this.buttons = this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function() {
        return t(this).button("widget")[0]
      }).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e ? "ui-corner-right" : "ui-corner-left").end().filter(":last").addClass(e ? "ui-corner-left" : "ui-corner-right").end().end()
    },
    _destroy: function() {
      this.element.removeClass("ui-buttonset"), this.buttons.map(function() {
        return t(this).button("widget")[0]
      }).removeClass("ui-corner-left ui-corner-right").end().button("destroy")
    }
  })
}(jQuery),
function(t, e) {
  function i() {
    this._curInst = null, this._keyEvent = !1, this._disabledInputs = [], this._datepickerShowing = !1, this._inDialog = !1, this._mainDivId = "ui-datepicker-div", this._inlineClass = "ui-datepicker-inline", this._appendClass = "ui-datepicker-append", this._triggerClass = "ui-datepicker-trigger", this._dialogClass = "ui-datepicker-dialog", this._disableClass = "ui-datepicker-disabled", this._unselectableClass = "ui-datepicker-unselectable", this._currentClass = "ui-datepicker-current-day", this._dayOverClass = "ui-datepicker-days-cell-over", this.regional = [], this.regional[""] = {
      closeText: "Done",
      prevText: "Prev",
      nextText: "Next",
      currentText: "Today",
      monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
      dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
      dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
      weekHeader: "Wk",
      dateFormat: "mm/dd/yy",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }, this._defaults = {
      showOn: "focus",
      showAnim: "fadeIn",
      showOptions: {},
      defaultDate: null,
      appendText: "",
      buttonText: "...",
      buttonImage: "",
      buttonImageOnly: !1,
      hideIfNoPrevNext: !1,
      navigationAsDateFormat: !1,
      gotoCurrent: !1,
      changeMonth: !1,
      changeYear: !1,
      yearRange: "c-10:c+10",
      showOtherMonths: !1,
      selectOtherMonths: !1,
      showWeek: !1,
      calculateWeek: this.iso8601Week,
      shortYearCutoff: "+10",
      minDate: null,
      maxDate: null,
      duration: "fast",
      beforeShowDay: null,
      beforeShow: null,
      onSelect: null,
      onChangeMonthYear: null,
      onClose: null,
      numberOfMonths: 1,
      showCurrentAtPos: 0,
      stepMonths: 1,
      stepBigMonths: 12,
      altField: "",
      altFormat: "",
      constrainInput: !0,
      showButtonPanel: !1,
      autoSize: !1,
      disabled: !1
    }, t.extend(this._defaults, this.regional[""]), this.dpDiv = s(t("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
  }

  function s(e) {
    var i = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
    return e.delegate(i, "mouseout", function() {
      t(this).removeClass("ui-state-hover"), -1 !== this.className.indexOf("ui-datepicker-prev") && t(this).removeClass("ui-datepicker-prev-hover"), -1 !== this.className.indexOf("ui-datepicker-next") && t(this).removeClass("ui-datepicker-next-hover")
    }).delegate(i, "mouseover", function() {
      t.datepicker._isDisabledDatepicker(o.inline ? e.parent()[0] : o.input[0]) || (t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), t(this).addClass("ui-state-hover"), -1 !== this.className.indexOf("ui-datepicker-prev") && t(this).addClass("ui-datepicker-prev-hover"), -1 !== this.className.indexOf("ui-datepicker-next") && t(this).addClass("ui-datepicker-next-hover"))
    })
  }

  function n(e, i) {
    t.extend(e, i);
    for (var s in i) null == i[s] && (e[s] = i[s]);
    return e
  }
  t.extend(t.ui, {
    datepicker: {
      version: "1.10.3"
    }
  });
  var o, a = "datepicker";
  t.extend(i.prototype, {
    markerClassName: "hasDatepicker",
    maxRows: 4,
    _widgetDatepicker: function() {
      return this.dpDiv
    },
    setDefaults: function(t) {
      return n(this._defaults, t || {}), this
    },
    _attachDatepicker: function(e, i) {
      var s, n, o;
      s = e.nodeName.toLowerCase(), n = "div" === s || "span" === s, e.id || (this.uuid += 1, e.id = "dp" + this.uuid), o = this._newInst(t(e), n), o.settings = t.extend({}, i || {}), "input" === s ? this._connectDatepicker(e, o) : n && this._inlineDatepicker(e, o)
    },
    _newInst: function(e, i) {
      var n = e[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1");
      return {
        id: n,
        input: e,
        selectedDay: 0,
        selectedMonth: 0,
        selectedYear: 0,
        drawMonth: 0,
        drawYear: 0,
        inline: i,
        dpDiv: i ? s(t("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) : this.dpDiv
      }
    },
    _connectDatepicker: function(e, i) {
      var s = t(e);
      i.append = t([]), i.trigger = t([]), s.hasClass(this.markerClassName) || (this._attachments(s, i), s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp), this._autoSize(i), t.data(e, a, i), i.settings.disabled && this._disableDatepicker(e))
    },
    _attachments: function(e, i) {
      var s, n, o, a = this._get(i, "appendText"),
        r = this._get(i, "isRTL");
      i.append && i.append.remove(), a && (i.append = t("<span class='" + this._appendClass + "'>" + a + "</span>"), e[r ? "before" : "after"](i.append)), e.unbind("focus", this._showDatepicker), i.trigger && i.trigger.remove(), s = this._get(i, "showOn"), ("focus" === s || "both" === s) && e.focus(this._showDatepicker), ("button" === s || "both" === s) && (n = this._get(i, "buttonText"), o = this._get(i, "buttonImage"), i.trigger = t(this._get(i, "buttonImageOnly") ? t("<img/>").addClass(this._triggerClass).attr({
        src: o,
        alt: n,
        title: n
      }) : t("<button type='button'></button>").addClass(this._triggerClass).html(o ? t("<img/>").attr({
        src: o,
        alt: n,
        title: n
      }) : n)), e[r ? "before" : "after"](i.trigger), i.trigger.click(function() {
        return t.datepicker._datepickerShowing && t.datepicker._lastInput === e[0] ? t.datepicker._hideDatepicker() : t.datepicker._datepickerShowing && t.datepicker._lastInput !== e[0] ? (t.datepicker._hideDatepicker(), t.datepicker._showDatepicker(e[0])) : t.datepicker._showDatepicker(e[0]), !1
      }))
    },
    _autoSize: function(t) {
      if (this._get(t, "autoSize") && !t.inline) {
        var e, i, s, n, o = new Date(2009, 11, 20),
          a = this._get(t, "dateFormat");
        a.match(/[DM]/) && (e = function(t) {
          for (i = 0, s = 0, n = 0; t.length > n; n++) t[n].length > i && (i = t[n].length, s = n);
          return s
        }, o.setMonth(e(this._get(t, a.match(/MM/) ? "monthNames" : "monthNamesShort"))), o.setDate(e(this._get(t, a.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - o.getDay())), t.input.attr("size", this._formatDate(t, o).length)
      }
    },
    _inlineDatepicker: function(e, i) {
      var s = t(e);
      s.hasClass(this.markerClassName) || (s.addClass(this.markerClassName).append(i.dpDiv), t.data(e, a, i), this._setDate(i, this._getDefaultDate(i), !0), this._updateDatepicker(i), this._updateAlternate(i), i.settings.disabled && this._disableDatepicker(e), i.dpDiv.css("display", "block"))
    },
    _dialogDatepicker: function(e, i, s, o, r) {
      var h, l, c, u, d, p = this._dialogInst;
      return p || (this.uuid += 1, h = "dp" + this.uuid, this._dialogInput = t("<input type='text' id='" + h + "' style='position: absolute; top: -100px; width: 0px;'/>"), this._dialogInput.keydown(this._doKeyDown), t("body").append(this._dialogInput), p = this._dialogInst = this._newInst(this._dialogInput, !1), p.settings = {}, t.data(this._dialogInput[0], a, p)), n(p.settings, o || {}), i = i && i.constructor === Date ? this._formatDate(p, i) : i, this._dialogInput.val(i), this._pos = r ? r.length ? r : [r.pageX, r.pageY] : null, this._pos || (l = document.documentElement.clientWidth, c = document.documentElement.clientHeight, u = document.documentElement.scrollLeft || document.body.scrollLeft, d = document.documentElement.scrollTop || document.body.scrollTop, this._pos = [l / 2 - 100 + u, c / 2 - 150 + d]), this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), p.settings.onSelect = s, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), t.blockUI && t.blockUI(this.dpDiv), t.data(this._dialogInput[0], a, p), this
    },
    _destroyDatepicker: function(e) {
      var i, s = t(e),
        n = t.data(e, a);
      s.hasClass(this.markerClassName) && (i = e.nodeName.toLowerCase(), t.removeData(e, a), "input" === i ? (n.append.remove(), n.trigger.remove(), s.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : ("div" === i || "span" === i) && s.removeClass(this.markerClassName).empty())
    },
    _enableDatepicker: function(e) {
      var i, s, n = t(e),
        o = t.data(e, a);
      n.hasClass(this.markerClassName) && (i = e.nodeName.toLowerCase(), "input" === i ? (e.disabled = !1, o.trigger.filter("button").each(function() {
        this.disabled = !1
      }).end().filter("img").css({
        opacity: "1.0",
        cursor: ""
      })) : ("div" === i || "span" === i) && (s = n.children("." + this._inlineClass), s.children().removeClass("ui-state-disabled"), s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1)), this._disabledInputs = t.map(this._disabledInputs, function(t) {
        return t === e ? null : t
      }))
    },
    _disableDatepicker: function(e) {
      var i, s, n = t(e),
        o = t.data(e, a);
      n.hasClass(this.markerClassName) && (i = e.nodeName.toLowerCase(), "input" === i ? (e.disabled = !0, o.trigger.filter("button").each(function() {
        this.disabled = !0
      }).end().filter("img").css({
        opacity: "0.5",
        cursor: "default"
      })) : ("div" === i || "span" === i) && (s = n.children("." + this._inlineClass), s.children().addClass("ui-state-disabled"), s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0)), this._disabledInputs = t.map(this._disabledInputs, function(t) {
        return t === e ? null : t
      }), this._disabledInputs[this._disabledInputs.length] = e)
    },
    _isDisabledDatepicker: function(t) {
      if (!t) return !1;
      for (var e = 0; this._disabledInputs.length > e; e++)
        if (this._disabledInputs[e] === t) return !0;
      return !1
    },
    _getInst: function(e) {
      try {
        return t.data(e, a)
      } catch (i) {
        throw "Missing instance data for this datepicker"
      }
    },
    _optionDatepicker: function(i, s, o) {
      var a, r, h, l, c = this._getInst(i);
      return 2 === arguments.length && "string" == typeof s ? "defaults" === s ? t.extend({}, t.datepicker._defaults) : c ? "all" === s ? t.extend({}, c.settings) : this._get(c, s) : null : (a = s || {}, "string" == typeof s && (a = {}, a[s] = o), c && (this._curInst === c && this._hideDatepicker(), r = this._getDateDatepicker(i, !0), h = this._getMinMaxDate(c, "min"), l = this._getMinMaxDate(c, "max"), n(c.settings, a), null !== h && a.dateFormat !== e && a.minDate === e && (c.settings.minDate = this._formatDate(c, h)), null !== l && a.dateFormat !== e && a.maxDate === e && (c.settings.maxDate = this._formatDate(c, l)), "disabled" in a && (a.disabled ? this._disableDatepicker(i) : this._enableDatepicker(i)), this._attachments(t(i), c), this._autoSize(c), this._setDate(c, r), this._updateAlternate(c), this._updateDatepicker(c)), e)
    },
    _changeDatepicker: function(t, e, i) {
      this._optionDatepicker(t, e, i)
    },
    _refreshDatepicker: function(t) {
      var e = this._getInst(t);
      e && this._updateDatepicker(e)
    },
    _setDateDatepicker: function(t, e) {
      var i = this._getInst(t);
      i && (this._setDate(i, e), this._updateDatepicker(i), this._updateAlternate(i))
    },
    _getDateDatepicker: function(t, e) {
      var i = this._getInst(t);
      return i && !i.inline && this._setDateFromField(i, e), i ? this._getDate(i) : null
    },
    _doKeyDown: function(e) {
      var i, s, n, o = t.datepicker._getInst(e.target),
        a = !0,
        r = o.dpDiv.is(".ui-datepicker-rtl");
      if (o._keyEvent = !0, t.datepicker._datepickerShowing) switch (e.keyCode) {
        case 9:
          t.datepicker._hideDatepicker(), a = !1;
          break;
        case 13:
          return n = t("td." + t.datepicker._dayOverClass + ":not(." + t.datepicker._currentClass + ")", o.dpDiv), n[0] && t.datepicker._selectDay(e.target, o.selectedMonth, o.selectedYear, n[0]), i = t.datepicker._get(o, "onSelect"), i ? (s = t.datepicker._formatDate(o), i.apply(o.input ? o.input[0] : null, [s, o])) : t.datepicker._hideDatepicker(), !1;
        case 27:
          t.datepicker._hideDatepicker();
          break;
        case 33:
          t.datepicker._adjustDate(e.target, e.ctrlKey ? -t.datepicker._get(o, "stepBigMonths") : -t.datepicker._get(o, "stepMonths"), "M");
          break;
        case 34:
          t.datepicker._adjustDate(e.target, e.ctrlKey ? +t.datepicker._get(o, "stepBigMonths") : +t.datepicker._get(o, "stepMonths"), "M");
          break;
        case 35:
          (e.ctrlKey || e.metaKey) && t.datepicker._clearDate(e.target), a = e.ctrlKey || e.metaKey;
          break;
        case 36:
          (e.ctrlKey || e.metaKey) && t.datepicker._gotoToday(e.target), a = e.ctrlKey || e.metaKey;
          break;
        case 37:
          (e.ctrlKey || e.metaKey) && t.datepicker._adjustDate(e.target, r ? 1 : -1, "D"), a = e.ctrlKey || e.metaKey, e.originalEvent.altKey && t.datepicker._adjustDate(e.target, e.ctrlKey ? -t.datepicker._get(o, "stepBigMonths") : -t.datepicker._get(o, "stepMonths"), "M");
          break;
        case 38:
          (e.ctrlKey || e.metaKey) && t.datepicker._adjustDate(e.target, -7, "D"), a = e.ctrlKey || e.metaKey;
          break;
        case 39:
          (e.ctrlKey || e.metaKey) && t.datepicker._adjustDate(e.target, r ? -1 : 1, "D"), a = e.ctrlKey || e.metaKey, e.originalEvent.altKey && t.datepicker._adjustDate(e.target, e.ctrlKey ? +t.datepicker._get(o, "stepBigMonths") : +t.datepicker._get(o, "stepMonths"), "M");
          break;
        case 40:
          (e.ctrlKey || e.metaKey) && t.datepicker._adjustDate(e.target, 7, "D"), a = e.ctrlKey || e.metaKey;
          break;
        default:
          a = !1
      } else 36 === e.keyCode && e.ctrlKey ? t.datepicker._showDatepicker(this) : a = !1;
      a && (e.preventDefault(), e.stopPropagation())
    },
    _doKeyPress: function(i) {
      var s, n, o = t.datepicker._getInst(i.target);
      return t.datepicker._get(o, "constrainInput") ? (s = t.datepicker._possibleChars(t.datepicker._get(o, "dateFormat")), n = String.fromCharCode(null == i.charCode ? i.keyCode : i.charCode), i.ctrlKey || i.metaKey || " " > n || !s || s.indexOf(n) > -1) : e
    },
    _doKeyUp: function(e) {
      var i, s = t.datepicker._getInst(e.target);
      if (s.input.val() !== s.lastVal) try {
        i = t.datepicker.parseDate(t.datepicker._get(s, "dateFormat"), s.input ? s.input.val() : null, t.datepicker._getFormatConfig(s)), i && (t.datepicker._setDateFromField(s), t.datepicker._updateAlternate(s), t.datepicker._updateDatepicker(s))
      } catch (n) {}
      return !0
    },
    _showDatepicker: function(e) {
      if (e = e.target || e, "input" !== e.nodeName.toLowerCase() && (e = t("input", e.parentNode)[0]), !t.datepicker._isDisabledDatepicker(e) && t.datepicker._lastInput !== e) {
        var i, s, o, a, r, h, l;
        i = t.datepicker._getInst(e), t.datepicker._curInst && t.datepicker._curInst !== i && (t.datepicker._curInst.dpDiv.stop(!0, !0), i && t.datepicker._datepickerShowing && t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])), s = t.datepicker._get(i, "beforeShow"), o = s ? s.apply(e, [e, i]) : {}, o !== !1 && (n(i.settings, o), i.lastVal = null, t.datepicker._lastInput = e, t.datepicker._setDateFromField(i), t.datepicker._inDialog && (e.value = ""), t.datepicker._pos || (t.datepicker._pos = t.datepicker._findPos(e), t.datepicker._pos[1] += e.offsetHeight), a = !1, t(e).parents().each(function() {
          return a |= "fixed" === t(this).css("position"), !a
        }), r = {
          left: t.datepicker._pos[0],
          top: t.datepicker._pos[1]
        }, t.datepicker._pos = null, i.dpDiv.empty(), i.dpDiv.css({
          position: "absolute",
          display: "block",
          top: "-1000px"
        }), t.datepicker._updateDatepicker(i), r = t.datepicker._checkOffset(i, r, a), i.dpDiv.css({
          position: t.datepicker._inDialog && t.blockUI ? "static" : a ? "fixed" : "absolute",
          display: "none",
          left: r.left + "px",
          top: r.top + "px"
        }), i.inline || (h = t.datepicker._get(i, "showAnim"), l = t.datepicker._get(i, "duration"), i.dpDiv.zIndex(t(e).zIndex() + 1), t.datepicker._datepickerShowing = !0, t.effects && t.effects.effect[h] ? i.dpDiv.show(h, t.datepicker._get(i, "showOptions"), l) : i.dpDiv[h || "show"](h ? l : null), t.datepicker._shouldFocusInput(i) && i.input.focus(), t.datepicker._curInst = i))
      }
    },
    _updateDatepicker: function(e) {
      this.maxRows = 4, o = e, e.dpDiv.empty().append(this._generateHTML(e)), this._attachHandlers(e), e.dpDiv.find("." + this._dayOverClass + " a").mouseover();
      var i, s = this._getNumberOfMonths(e),
        n = s[1],
        a = 17;
      e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""), n > 1 && e.dpDiv.addClass("ui-datepicker-multi-" + n).css("width", a * n + "em"), e.dpDiv[(1 !== s[0] || 1 !== s[1] ? "add" : "remove") + "Class"]("ui-datepicker-multi"), e.dpDiv[(this._get(e, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"), e === t.datepicker._curInst && t.datepicker._datepickerShowing && t.datepicker._shouldFocusInput(e) && e.input.focus(), e.yearshtml && (i = e.yearshtml, setTimeout(function() {
        i === e.yearshtml && e.yearshtml && e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml), i = e.yearshtml = null
      }, 0))
    },
    _shouldFocusInput: function(t) {
      return t.input && t.input.is(":visible") && !t.input.is(":disabled") && !t.input.is(":focus")
    },
    _checkOffset: function(e, i, s) {
      var n = e.dpDiv.outerWidth(),
        o = e.dpDiv.outerHeight(),
        a = e.input ? e.input.outerWidth() : 0,
        r = e.input ? e.input.outerHeight() : 0,
        h = document.documentElement.clientWidth + (s ? 0 : t(document).scrollLeft()),
        l = document.documentElement.clientHeight + (s ? 0 : t(document).scrollTop());
      return i.left -= this._get(e, "isRTL") ? n - a : 0, i.left -= s && i.left === e.input.offset().left ? t(document).scrollLeft() : 0, i.top -= s && i.top === e.input.offset().top + r ? t(document).scrollTop() : 0, i.left -= Math.min(i.left, i.left + n > h && h > n ? Math.abs(i.left + n - h) : 0), i.top -= Math.min(i.top, i.top + o > l && l > o ? Math.abs(o + r) : 0), i
    },
    _findPos: function(e) {
      for (var i, s = this._getInst(e), n = this._get(s, "isRTL"); e && ("hidden" === e.type || 1 !== e.nodeType || t.expr.filters.hidden(e));) e = e[n ? "previousSibling" : "nextSibling"];
      return i = t(e).offset(), [i.left, i.top]
    },
    _hideDatepicker: function(e) {
      var i, s, n, o, r = this._curInst;
      !r || e && r !== t.data(e, a) || this._datepickerShowing && (i = this._get(r, "showAnim"), s = this._get(r, "duration"), n = function() {
        t.datepicker._tidyDialog(r)
      }, t.effects && (t.effects.effect[i] || t.effects[i]) ? r.dpDiv.hide(i, t.datepicker._get(r, "showOptions"), s, n) : r.dpDiv["slideDown" === i ? "slideUp" : "fadeIn" === i ? "fadeOut" : "hide"](i ? s : null, n), i || n(), this._datepickerShowing = !1, o = this._get(r, "onClose"), o && o.apply(r.input ? r.input[0] : null, [r.input ? r.input.val() : "", r]), this._lastInput = null, this._inDialog && (this._dialogInput.css({
        position: "absolute",
        left: "0",
        top: "-100px"
      }), t.blockUI && (t.unblockUI(), t("body").append(this.dpDiv))), this._inDialog = !1)
    },
    _tidyDialog: function(t) {
      t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")
    },
    _checkExternalClick: function(e) {
      if (t.datepicker._curInst) {
        var i = t(e.target),
          s = t.datepicker._getInst(i[0]);
        (i[0].id !== t.datepicker._mainDivId && 0 === i.parents("#" + t.datepicker._mainDivId).length && !i.hasClass(t.datepicker.markerClassName) && !i.closest("." + t.datepicker._triggerClass).length && t.datepicker._datepickerShowing && (!t.datepicker._inDialog || !t.blockUI) || i.hasClass(t.datepicker.markerClassName) && t.datepicker._curInst !== s) && t.datepicker._hideDatepicker()
      }
    },
    _adjustDate: function(e, i, s) {
      var n = t(e),
        o = this._getInst(n[0]);
      this._isDisabledDatepicker(n[0]) || (this._adjustInstDate(o, i + ("M" === s ? this._get(o, "showCurrentAtPos") : 0), s), this._updateDatepicker(o))
    },
    _gotoToday: function(e) {
      var i, s = t(e),
        n = this._getInst(s[0]);
      this._get(n, "gotoCurrent") && n.currentDay ? (n.selectedDay = n.currentDay, n.drawMonth = n.selectedMonth = n.currentMonth, n.drawYear = n.selectedYear = n.currentYear) : (i = new Date, n.selectedDay = i.getDate(), n.drawMonth = n.selectedMonth = i.getMonth(), n.drawYear = n.selectedYear = i.getFullYear()), this._notifyChange(n), this._adjustDate(s)
    },
    _selectMonthYear: function(e, i, s) {
      var n = t(e),
        o = this._getInst(n[0]);
      o["selected" + ("M" === s ? "Month" : "Year")] = o["draw" + ("M" === s ? "Month" : "Year")] = parseInt(i.options[i.selectedIndex].value, 10), this._notifyChange(o), this._adjustDate(n)
    },
    _selectDay: function(e, i, s, n) {
      var o, a = t(e);
      t(n).hasClass(this._unselectableClass) || this._isDisabledDatepicker(a[0]) || (o = this._getInst(a[0]), o.selectedDay = o.currentDay = t("a", n).html(), o.selectedMonth = o.currentMonth = i, o.selectedYear = o.currentYear = s, this._selectDate(e, this._formatDate(o, o.currentDay, o.currentMonth, o.currentYear)))
    },
    _clearDate: function(e) {
      var i = t(e);
      this._selectDate(i, "")
    },
    _selectDate: function(e, i) {
      var s, n = t(e),
        o = this._getInst(n[0]);
      i = null != i ? i : this._formatDate(o), o.input && o.input.val(i), this._updateAlternate(o), s = this._get(o, "onSelect"), s ? s.apply(o.input ? o.input[0] : null, [i, o]) : o.input && o.input.trigger("change"), o.inline ? this._updateDatepicker(o) : (this._hideDatepicker(), this._lastInput = o.input[0], "object" != typeof o.input[0] && o.input.focus(), this._lastInput = null)
    },
    _updateAlternate: function(e) {
      var i, s, n, o = this._get(e, "altField");
      o && (i = this._get(e, "altFormat") || this._get(e, "dateFormat"), s = this._getDate(e), n = this.formatDate(i, s, this._getFormatConfig(e)), t(o).each(function() {
        t(this).val(n)
      }))
    },
    noWeekends: function(t) {
      var e = t.getDay();
      return [e > 0 && 6 > e, ""]
    },
    iso8601Week: function(t) {
      var e, i = new Date(t.getTime());
      return i.setDate(i.getDate() + 4 - (i.getDay() || 7)), e = i.getTime(), i.setMonth(0), i.setDate(1), Math.floor(Math.round((e - i) / 864e5) / 7) + 1
    },
    parseDate: function(i, s, n) {
      if (null == i || null == s) throw "Invalid arguments";
      if (s = "object" == typeof s ? "" + s : s + "", "" === s) return null;
      var o, a, r, h, l = 0,
        c = (n ? n.shortYearCutoff : null) || this._defaults.shortYearCutoff,
        u = "string" != typeof c ? c : (new Date).getFullYear() % 100 + parseInt(c, 10),
        d = (n ? n.dayNamesShort : null) || this._defaults.dayNamesShort,
        p = (n ? n.dayNames : null) || this._defaults.dayNames,
        f = (n ? n.monthNamesShort : null) || this._defaults.monthNamesShort,
        g = (n ? n.monthNames : null) || this._defaults.monthNames,
        m = -1,
        v = -1,
        _ = -1,
        b = -1,
        y = !1,
        w = function(t) {
          var e = i.length > o + 1 && i.charAt(o + 1) === t;
          return e && o++, e
        },
        k = function(t) {
          var e = w(t),
            i = "@" === t ? 14 : "!" === t ? 20 : "y" === t && e ? 4 : "o" === t ? 3 : 2,
            n = RegExp("^\\d{1," + i + "}"),
            o = s.substring(l).match(n);
          if (!o) throw "Missing number at position " + l;
          return l += o[0].length, parseInt(o[0], 10)
        },
        x = function(i, n, o) {
          var a = -1,
            r = t.map(w(i) ? o : n, function(t, e) {
              return [
                [e, t]
              ]
            }).sort(function(t, e) {
              return -(t[1].length - e[1].length)
            });
          if (t.each(r, function(t, i) {
              var n = i[1];
              return s.substr(l, n.length).toLowerCase() === n.toLowerCase() ? (a = i[0], l += n.length, !1) : e
            }), -1 !== a) return a + 1;
          throw "Unknown name at position " + l
        },
        D = function() {
          if (s.charAt(l) !== i.charAt(o)) throw "Unexpected literal at position " + l;
          l++
        };
      for (o = 0; i.length > o; o++)
        if (y) "'" !== i.charAt(o) || w("'") ? D() : y = !1;
        else switch (i.charAt(o)) {
          case "d":
            _ = k("d");
            break;
          case "D":
            x("D", d, p);
            break;
          case "o":
            b = k("o");
            break;
          case "m":
            v = k("m");
            break;
          case "M":
            v = x("M", f, g);
            break;
          case "y":
            m = k("y");
            break;
          case "@":
            h = new Date(k("@")), m = h.getFullYear(), v = h.getMonth() + 1, _ = h.getDate();
            break;
          case "!":
            h = new Date((k("!") - this._ticksTo1970) / 1e4), m = h.getFullYear(), v = h.getMonth() + 1, _ = h.getDate();
            break;
          case "'":
            w("'") ? D() : y = !0;
            break;
          default:
            D()
        }
        if (s.length > l && (r = s.substr(l), !/^\s+/.test(r))) throw "Extra/unparsed characters found in date: " + r;
      if (-1 === m ? m = (new Date).getFullYear() : 100 > m && (m += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (u >= m ? 0 : -100)), b > -1)
        for (v = 1, _ = b;;) {
          if (a = this._getDaysInMonth(m, v - 1), a >= _) break;
          v++, _ -= a
        }
      if (h = this._daylightSavingAdjust(new Date(m, v - 1, _)), h.getFullYear() !== m || h.getMonth() + 1 !== v || h.getDate() !== _) throw "Invalid date";
      return h
    },
    ATOM: "yy-mm-dd",
    COOKIE: "D, dd M yy",
    ISO_8601: "yy-mm-dd",
    RFC_822: "D, d M y",
    RFC_850: "DD, dd-M-y",
    RFC_1036: "D, d M y",
    RFC_1123: "D, d M yy",
    RFC_2822: "D, d M yy",
    RSS: "D, d M y",
    TICKS: "!",
    TIMESTAMP: "@",
    W3C: "yy-mm-dd",
    _ticksTo1970: 1e7 * 60 * 60 * 24 * (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)),
    formatDate: function(t, e, i) {
      if (!e) return "";
      var s, n = (i ? i.dayNamesShort : null) || this._defaults.dayNamesShort,
        o = (i ? i.dayNames : null) || this._defaults.dayNames,
        a = (i ? i.monthNamesShort : null) || this._defaults.monthNamesShort,
        r = (i ? i.monthNames : null) || this._defaults.monthNames,
        h = function(e) {
          var i = t.length > s + 1 && t.charAt(s + 1) === e;
          return i && s++, i
        },
        l = function(t, e, i) {
          var s = "" + e;
          if (h(t))
            for (; i > s.length;) s = "0" + s;
          return s
        },
        c = function(t, e, i, s) {
          return h(t) ? s[e] : i[e]
        },
        u = "",
        d = !1;
      if (e)
        for (s = 0; t.length > s; s++)
          if (d) "'" !== t.charAt(s) || h("'") ? u += t.charAt(s) : d = !1;
          else switch (t.charAt(s)) {
            case "d":
              u += l("d", e.getDate(), 2);
              break;
            case "D":
              u += c("D", e.getDay(), n, o);
              break;
            case "o":
              u += l("o", Math.round((new Date(e.getFullYear(), e.getMonth(), e.getDate()).getTime() - new Date(e.getFullYear(), 0, 0).getTime()) / 864e5), 3);
              break;
            case "m":
              u += l("m", e.getMonth() + 1, 2);
              break;
            case "M":
              u += c("M", e.getMonth(), a, r);
              break;
            case "y":
              u += h("y") ? e.getFullYear() : (10 > e.getYear() % 100 ? "0" : "") + e.getYear() % 100;
              break;
            case "@":
              u += e.getTime();
              break;
            case "!":
              u += 1e4 * e.getTime() + this._ticksTo1970;
              break;
            case "'":
              h("'") ? u += "'" : d = !0;
              break;
            default:
              u += t.charAt(s)
          }
          return u
    },
    _possibleChars: function(t) {
      var e, i = "",
        s = !1,
        n = function(i) {
          var s = t.length > e + 1 && t.charAt(e + 1) === i;
          return s && e++, s
        };
      for (e = 0; t.length > e; e++)
        if (s) "'" !== t.charAt(e) || n("'") ? i += t.charAt(e) : s = !1;
        else switch (t.charAt(e)) {
          case "d":
          case "m":
          case "y":
          case "@":
            i += "0123456789";
            break;
          case "D":
          case "M":
            return null;
          case "'":
            n("'") ? i += "'" : s = !0;
            break;
          default:
            i += t.charAt(e)
        }
        return i
    },
    _get: function(t, i) {
      return t.settings[i] !== e ? t.settings[i] : this._defaults[i]
    },
    _setDateFromField: function(t, e) {
      if (t.input.val() !== t.lastVal) {
        var i = this._get(t, "dateFormat"),
          s = t.lastVal = t.input ? t.input.val() : null,
          n = this._getDefaultDate(t),
          o = n,
          a = this._getFormatConfig(t);
        try {
          o = this.parseDate(i, s, a) || n
        } catch (r) {
          s = e ? "" : s
        }
        t.selectedDay = o.getDate(), t.drawMonth = t.selectedMonth = o.getMonth(), t.drawYear = t.selectedYear = o.getFullYear(), t.currentDay = s ? o.getDate() : 0, t.currentMonth = s ? o.getMonth() : 0, t.currentYear = s ? o.getFullYear() : 0, this._adjustInstDate(t)
      }
    },
    _getDefaultDate: function(t) {
      return this._restrictMinMax(t, this._determineDate(t, this._get(t, "defaultDate"), new Date))
    },
    _determineDate: function(e, i, s) {
      var n = function(t) {
          var e = new Date;
          return e.setDate(e.getDate() + t), e
        },
        o = function(i) {
          try {
            return t.datepicker.parseDate(t.datepicker._get(e, "dateFormat"), i, t.datepicker._getFormatConfig(e))
          } catch (s) {}
          for (var n = (i.toLowerCase().match(/^c/) ? t.datepicker._getDate(e) : null) || new Date, o = n.getFullYear(), a = n.getMonth(), r = n.getDate(), h = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g, l = h.exec(i); l;) {
            switch (l[2] || "d") {
              case "d":
              case "D":
                r += parseInt(l[1], 10);
                break;
              case "w":
              case "W":
                r += 7 * parseInt(l[1], 10);
                break;
              case "m":
              case "M":
                a += parseInt(l[1], 10), r = Math.min(r, t.datepicker._getDaysInMonth(o, a));
                break;
              case "y":
              case "Y":
                o += parseInt(l[1], 10), r = Math.min(r, t.datepicker._getDaysInMonth(o, a))
            }
            l = h.exec(i)
          }
          return new Date(o, a, r)
        },
        a = null == i || "" === i ? s : "string" == typeof i ? o(i) : "number" == typeof i ? isNaN(i) ? s : n(i) : new Date(i.getTime());
      return a = a && "Invalid Date" == "" + a ? s : a, a && (a.setHours(0), a.setMinutes(0), a.setSeconds(0), a.setMilliseconds(0)), this._daylightSavingAdjust(a)
    },
    _daylightSavingAdjust: function(t) {
      return t ? (t.setHours(t.getHours() > 12 ? t.getHours() + 2 : 0), t) : null
    },
    _setDate: function(t, e, i) {
      var s = !e,
        n = t.selectedMonth,
        o = t.selectedYear,
        a = this._restrictMinMax(t, this._determineDate(t, e, new Date));
      t.selectedDay = t.currentDay = a.getDate(), t.drawMonth = t.selectedMonth = t.currentMonth = a.getMonth(), t.drawYear = t.selectedYear = t.currentYear = a.getFullYear(), n === t.selectedMonth && o === t.selectedYear || i || this._notifyChange(t), this._adjustInstDate(t), t.input && t.input.val(s ? "" : this._formatDate(t))
    },
    _getDate: function(t) {
      var e = !t.currentYear || t.input && "" === t.input.val() ? null : this._daylightSavingAdjust(new Date(t.currentYear, t.currentMonth, t.currentDay));
      return e
    },
    _attachHandlers: function(e) {
      var i = this._get(e, "stepMonths"),
        s = "#" + e.id.replace(/\\\\/g, "\\");
      e.dpDiv.find("[data-handler]").map(function() {
        var e = {
          prev: function() {
            t.datepicker._adjustDate(s, -i, "M")
          },
          next: function() {
            t.datepicker._adjustDate(s, +i, "M")
          },
          hide: function() {
            t.datepicker._hideDatepicker()
          },
          today: function() {
            t.datepicker._gotoToday(s)
          },
          selectDay: function() {
            return t.datepicker._selectDay(s, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this), !1
          },
          selectMonth: function() {
            return t.datepicker._selectMonthYear(s, this, "M"), !1
          },
          selectYear: function() {
            return t.datepicker._selectMonthYear(s, this, "Y"), !1
          }
        };
        t(this).bind(this.getAttribute("data-event"), e[this.getAttribute("data-handler")])
      })
    },
    _generateHTML: function(t) {
      var e, i, s, n, o, a, r, h, l, c, u, d, p, f, g, m, v, _, b, y, w, k, x, D, C, I, P, T, M, S, z, A, H, E, N, W, O, F, R, L = new Date,
        j = this._daylightSavingAdjust(new Date(L.getFullYear(), L.getMonth(), L.getDate())),
        Y = this._get(t, "isRTL"),
        B = this._get(t, "showButtonPanel"),
        V = this._get(t, "hideIfNoPrevNext"),
        K = this._get(t, "navigationAsDateFormat"),
        U = this._getNumberOfMonths(t),
        q = this._get(t, "showCurrentAtPos"),
        Q = this._get(t, "stepMonths"),
        X = 1 !== U[0] || 1 !== U[1],
        $ = this._daylightSavingAdjust(t.currentDay ? new Date(t.currentYear, t.currentMonth, t.currentDay) : new Date(9999, 9, 9)),
        G = this._getMinMaxDate(t, "min"),
        J = this._getMinMaxDate(t, "max"),
        Z = t.drawMonth - q,
        te = t.drawYear;
      if (0 > Z && (Z += 12, te--), J)
        for (e = this._daylightSavingAdjust(new Date(J.getFullYear(), J.getMonth() - U[0] * U[1] + 1, J.getDate())), e = G && G > e ? G : e; this._daylightSavingAdjust(new Date(te, Z, 1)) > e;) Z--, 0 > Z && (Z = 11, te--);
      for (t.drawMonth = Z, t.drawYear = te, i = this._get(t, "prevText"), i = K ? this.formatDate(i, this._daylightSavingAdjust(new Date(te, Z - Q, 1)), this._getFormatConfig(t)) : i, s = this._canAdjustMonth(t, -1, te, Z) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "e" : "w") + "'>" + i + "</span></a>" : V ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "e" : "w") + "'>" + i + "</span></a>", n = this._get(t, "nextText"), n = K ? this.formatDate(n, this._daylightSavingAdjust(new Date(te, Z + Q, 1)), this._getFormatConfig(t)) : n, o = this._canAdjustMonth(t, 1, te, Z) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "w" : "e") + "'>" + n + "</span></a>" : V ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "w" : "e") + "'>" + n + "</span></a>", a = this._get(t, "currentText"), r = this._get(t, "gotoCurrent") && t.currentDay ? $ : j, a = K ? this.formatDate(a, r, this._getFormatConfig(t)) : a, h = t.inline ? "" : "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(t, "closeText") + "</button>", l = B ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (Y ? h : "") + (this._isInRange(t, r) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>" + a + "</button>" : "") + (Y ? "" : h) + "</div>" : "", c = parseInt(this._get(t, "firstDay"), 10), c = isNaN(c) ? 0 : c, u = this._get(t, "showWeek"), d = this._get(t, "dayNames"), p = this._get(t, "dayNamesMin"), f = this._get(t, "monthNames"), g = this._get(t, "monthNamesShort"), m = this._get(t, "beforeShowDay"), v = this._get(t, "showOtherMonths"), _ = this._get(t, "selectOtherMonths"), b = this._getDefaultDate(t), y = "", k = 0; U[0] > k; k++) {
        for (x = "", this.maxRows = 4, D = 0; U[1] > D; D++) {
          if (C = this._daylightSavingAdjust(new Date(te, Z, t.selectedDay)), I = " ui-corner-all", P = "", X) {
            if (P += "<div class='ui-datepicker-group", U[1] > 1) switch (D) {
              case 0:
                P += " ui-datepicker-group-first", I = " ui-corner-" + (Y ? "right" : "left");
                break;
              case U[1] - 1:
                P += " ui-datepicker-group-last", I = " ui-corner-" + (Y ? "left" : "right");
                break;
              default:
                P += " ui-datepicker-group-middle", I = ""
            }
            P += "'>"
          }
          for (P += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + I + "'>" + (/all|left/.test(I) && 0 === k ? Y ? o : s : "") + (/all|right/.test(I) && 0 === k ? Y ? s : o : "") + this._generateMonthYearHeader(t, Z, te, G, J, k > 0 || D > 0, f, g) + "</div><table class='ui-datepicker-calendar'><thead>" + "<tr>", T = u ? "<th class='ui-datepicker-week-col'>" + this._get(t, "weekHeader") + "</th>" : "", w = 0; 7 > w; w++) M = (w + c) % 7, T += "<th" + ((w + c + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + ">" + "<span title='" + d[M] + "'>" + p[M] + "</span></th>";
          for (P += T + "</tr></thead><tbody>", S = this._getDaysInMonth(te, Z), te === t.selectedYear && Z === t.selectedMonth && (t.selectedDay = Math.min(t.selectedDay, S)), z = (this._getFirstDayOfMonth(te, Z) - c + 7) % 7, A = Math.ceil((z + S) / 7), H = X ? this.maxRows > A ? this.maxRows : A : A, this.maxRows = H, E = this._daylightSavingAdjust(new Date(te, Z, 1 - z)), N = 0; H > N; N++) {
            for (P += "<tr>", W = u ? "<td class='ui-datepicker-week-col'>" + this._get(t, "calculateWeek")(E) + "</td>" : "", w = 0; 7 > w; w++) O = m ? m.apply(t.input ? t.input[0] : null, [E]) : [!0, ""], F = E.getMonth() !== Z, R = F && !_ || !O[0] || G && G > E || J && E > J, W += "<td class='" + ((w + c + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (F ? " ui-datepicker-other-month" : "") + (E.getTime() === C.getTime() && Z === t.selectedMonth && t._keyEvent || b.getTime() === E.getTime() && b.getTime() === C.getTime() ? " " + this._dayOverClass : "") + (R ? " " + this._unselectableClass + " ui-state-disabled" : "") + (F && !v ? "" : " " + O[1] + (E.getTime() === $.getTime() ? " " + this._currentClass : "") + (E.getTime() === j.getTime() ? " ui-datepicker-today" : "")) + "'" + (F && !v || !O[2] ? "" : " title='" + O[2].replace(/'/g, "&#39;") + "'") + (R ? "" : " data-handler='selectDay' data-event='click' data-month='" + E.getMonth() + "' data-year='" + E.getFullYear() + "'") + ">" + (F && !v ? "&#xa0;" : R ? "<span class='ui-state-default'>" + E.getDate() + "</span>" : "<a class='ui-state-default" + (E.getTime() === j.getTime() ? " ui-state-highlight" : "") + (E.getTime() === $.getTime() ? " ui-state-active" : "") + (F ? " ui-priority-secondary" : "") + "' href='#'>" + E.getDate() + "</a>") + "</td>", E.setDate(E.getDate() + 1), E = this._daylightSavingAdjust(E);
            P += W + "</tr>"
          }
          Z++, Z > 11 && (Z = 0, te++), P += "</tbody></table>" + (X ? "</div>" + (U[0] > 0 && D === U[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : ""), x += P
        }
        y += x
      }
      return y += l, t._keyEvent = !1, y
    },
    _generateMonthYearHeader: function(t, e, i, s, n, o, a, r) {
      var h, l, c, u, d, p, f, g, m = this._get(t, "changeMonth"),
        v = this._get(t, "changeYear"),
        _ = this._get(t, "showMonthAfterYear"),
        b = "<div class='ui-datepicker-title'>",
        y = "";
      if (o || !m) y += "<span class='ui-datepicker-month'>" + a[e] + "</span>";
      else {
        for (h = s && s.getFullYear() === i, l = n && n.getFullYear() === i, y += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>", c = 0; 12 > c; c++)(!h || c >= s.getMonth()) && (!l || n.getMonth() >= c) && (y += "<option value='" + c + "'" + (c === e ? " selected='selected'" : "") + ">" + r[c] + "</option>");
        y += "</select>"
      }
      if (_ || (b += y + (!o && m && v ? "" : "&#xa0;")), !t.yearshtml)
        if (t.yearshtml = "", o || !v) b += "<span class='ui-datepicker-year'>" + i + "</span>";
        else {
          for (u = this._get(t, "yearRange").split(":"), d = (new Date).getFullYear(), p = function(t) {
              var e = t.match(/c[+\-].*/) ? i + parseInt(t.substring(1), 10) : t.match(/[+\-].*/) ? d + parseInt(t, 10) : parseInt(t, 10);
              return isNaN(e) ? d : e
            }, f = p(u[0]), g = Math.max(f, p(u[1] || "")), f = s ? Math.max(f, s.getFullYear()) : f, g = n ? Math.min(g, n.getFullYear()) : g, t.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>"; g >= f; f++) t.yearshtml += "<option value='" + f + "'" + (f === i ? " selected='selected'" : "") + ">" + f + "</option>";
          t.yearshtml += "</select>", b += t.yearshtml, t.yearshtml = null
        }
      return b += this._get(t, "yearSuffix"), _ && (b += (!o && m && v ? "" : "&#xa0;") + y), b += "</div>"
    },
    _adjustInstDate: function(t, e, i) {
      var s = t.drawYear + ("Y" === i ? e : 0),
        n = t.drawMonth + ("M" === i ? e : 0),
        o = Math.min(t.selectedDay, this._getDaysInMonth(s, n)) + ("D" === i ? e : 0),
        a = this._restrictMinMax(t, this._daylightSavingAdjust(new Date(s, n, o)));
      t.selectedDay = a.getDate(), t.drawMonth = t.selectedMonth = a.getMonth(), t.drawYear = t.selectedYear = a.getFullYear(), ("M" === i || "Y" === i) && this._notifyChange(t)
    },
    _restrictMinMax: function(t, e) {
      var i = this._getMinMaxDate(t, "min"),
        s = this._getMinMaxDate(t, "max"),
        n = i && i > e ? i : e;
      return s && n > s ? s : n
    },
    _notifyChange: function(t) {
      var e = this._get(t, "onChangeMonthYear");
      e && e.apply(t.input ? t.input[0] : null, [t.selectedYear, t.selectedMonth + 1, t])
    },
    _getNumberOfMonths: function(t) {
      var e = this._get(t, "numberOfMonths");
      return null == e ? [1, 1] : "number" == typeof e ? [1, e] : e
    },
    _getMinMaxDate: function(t, e) {
      return this._determineDate(t, this._get(t, e + "Date"), null)
    },
    _getDaysInMonth: function(t, e) {
      return 32 - this._daylightSavingAdjust(new Date(t, e, 32)).getDate()
    },
    _getFirstDayOfMonth: function(t, e) {
      return new Date(t, e, 1).getDay()
    },
    _canAdjustMonth: function(t, e, i, s) {
      var n = this._getNumberOfMonths(t),
        o = this._daylightSavingAdjust(new Date(i, s + (0 > e ? e : n[0] * n[1]), 1));
      return 0 > e && o.setDate(this._getDaysInMonth(o.getFullYear(), o.getMonth())), this._isInRange(t, o)
    },
    _isInRange: function(t, e) {
      var i, s, n = this._getMinMaxDate(t, "min"),
        o = this._getMinMaxDate(t, "max"),
        a = null,
        r = null,
        h = this._get(t, "yearRange");
      return h && (i = h.split(":"), s = (new Date).getFullYear(), a = parseInt(i[0], 10), r = parseInt(i[1], 10), i[0].match(/[+\-].*/) && (a += s), i[1].match(/[+\-].*/) && (r += s)), (!n || e.getTime() >= n.getTime()) && (!o || e.getTime() <= o.getTime()) && (!a || e.getFullYear() >= a) && (!r || r >= e.getFullYear())
    },
    _getFormatConfig: function(t) {
      var e = this._get(t, "shortYearCutoff");
      return e = "string" != typeof e ? e : (new Date).getFullYear() % 100 + parseInt(e, 10), {
        shortYearCutoff: e,
        dayNamesShort: this._get(t, "dayNamesShort"),
        dayNames: this._get(t, "dayNames"),
        monthNamesShort: this._get(t, "monthNamesShort"),
        monthNames: this._get(t, "monthNames")
      }
    },
    _formatDate: function(t, e, i, s) {
      e || (t.currentDay = t.selectedDay, t.currentMonth = t.selectedMonth, t.currentYear = t.selectedYear);
      var n = e ? "object" == typeof e ? e : this._daylightSavingAdjust(new Date(s, i, e)) : this._daylightSavingAdjust(new Date(t.currentYear, t.currentMonth, t.currentDay));
      return this.formatDate(this._get(t, "dateFormat"), n, this._getFormatConfig(t))
    }
  }), t.fn.datepicker = function(e) {
    if (!this.length) return this;
    t.datepicker.initialized || (t(document).mousedown(t.datepicker._checkExternalClick), t.datepicker.initialized = !0), 0 === t("#" + t.datepicker._mainDivId).length && t("body").append(t.datepicker.dpDiv);
    var i = Array.prototype.slice.call(arguments, 1);
    return "string" != typeof e || "isDisabled" !== e && "getDate" !== e && "widget" !== e ? "option" === e && 2 === arguments.length && "string" == typeof arguments[1] ? t.datepicker["_" + e + "Datepicker"].apply(t.datepicker, [this[0]].concat(i)) : this.each(function() {
      "string" == typeof e ? t.datepicker["_" + e + "Datepicker"].apply(t.datepicker, [this].concat(i)) : t.datepicker._attachDatepicker(this, e)
    }) : t.datepicker["_" + e + "Datepicker"].apply(t.datepicker, [this[0]].concat(i))
  }, t.datepicker = new i, t.datepicker.initialized = !1, t.datepicker.uuid = (new Date).getTime(), t.datepicker.version = "1.10.3"
}(jQuery),
function(t) {
  var e = {
      buttons: !0,
      height: !0,
      maxHeight: !0,
      maxWidth: !0,
      minHeight: !0,
      minWidth: !0,
      width: !0
    },
    i = {
      maxHeight: !0,
      maxWidth: !0,
      minHeight: !0,
      minWidth: !0
    };
  t.widget("ui.dialog", {
    version: "1.10.3",
    options: {
      appendTo: "body",
      autoOpen: !0,
      buttons: [],
      closeOnEscape: !0,
      closeText: "close",
      dialogClass: "",
      draggable: !0,
      hide: null,
      height: "auto",
      maxHeight: null,
      maxWidth: null,
      minHeight: 150,
      minWidth: 150,
      modal: !1,
      position: {
        my: "center",
        at: "center",
        of: window,
        collision: "fit",
        using: function(e) {
          var i = t(this).css(e).offset().top;
          0 > i && t(this).css("top", e.top - i)
        }
      },
      resizable: !0,
      show: null,
      title: null,
      width: 300,
      beforeClose: null,
      close: null,
      drag: null,
      dragStart: null,
      dragStop: null,
      focus: null,
      open: null,
      resize: null,
      resizeStart: null,
      resizeStop: null
    },
    _create: function() {
      this.originalCss = {
        display: this.element[0].style.display,
        width: this.element[0].style.width,
        minHeight: this.element[0].style.minHeight,
        maxHeight: this.element[0].style.maxHeight,
        height: this.element[0].style.height
      }, this.originalPosition = {
        parent: this.element.parent(),
        index: this.element.parent().children().index(this.element)
      }, this.originalTitle = this.element.attr("title"), this.options.title = this.options.title || this.originalTitle, this._createWrapper(), this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog), this._createTitlebar(), this._createButtonPane(), this.options.draggable && t.fn.draggable && this._makeDraggable(), this.options.resizable && t.fn.resizable && this._makeResizable(), this._isOpen = !1
    },
    _init: function() {
      this.options.autoOpen && this.open()
    },
    _appendTo: function() {
      var e = this.options.appendTo;
      return e && (e.jquery || e.nodeType) ? t(e) : this.document.find(e || "body").eq(0)
    },
    _destroy: function() {
      var t, e = this.originalPosition;
      this._destroyOverlay(), this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(), this.uiDialog.stop(!0, !0).remove(), this.originalTitle && this.element.attr("title", this.originalTitle), t = e.parent.children().eq(e.index), t.length && t[0] !== this.element[0] ? t.before(this.element) : e.parent.append(this.element)
    },
    widget: function() {
      return this.uiDialog
    },
    disable: t.noop,
    enable: t.noop,
    close: function(e) {
      var i = this;
      this._isOpen && this._trigger("beforeClose", e) !== !1 && (this._isOpen = !1, this._destroyOverlay(), this.opener.filter(":focusable").focus().length || t(this.document[0].activeElement).blur(), this._hide(this.uiDialog, this.options.hide, function() {
        i._trigger("close", e)
      }))
    },
    isOpen: function() {
      return this._isOpen
    },
    moveToTop: function() {
      this._moveToTop()
    },
    _moveToTop: function(t, e) {
      var i = !!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;
      return i && !e && this._trigger("focus", t), i
    },
    open: function() {
      var e = this;
      return this._isOpen ? (this._moveToTop() && this._focusTabbable(), undefined) : (this._isOpen = !0, this.opener = t(this.document[0].activeElement), this._size(), this._position(), this._createOverlay(), this._moveToTop(null, !0), this._show(this.uiDialog, this.options.show, function() {
        e._focusTabbable(), e._trigger("focus")
      }), this._trigger("open"), undefined)
    },
    _focusTabbable: function() {
      var t = this.element.find("[autofocus]");
      t.length || (t = this.element.find(":tabbable")), t.length || (t = this.uiDialogButtonPane.find(":tabbable")), t.length || (t = this.uiDialogTitlebarClose.filter(":tabbable")), t.length || (t = this.uiDialog), t.eq(0).focus()
    },
    _keepFocus: function(e) {
      function i() {
        var e = this.document[0].activeElement,
          i = this.uiDialog[0] === e || t.contains(this.uiDialog[0], e);
        i || this._focusTabbable()
      }
      e.preventDefault(), i.call(this), this._delay(i)
    },
    _createWrapper: function() {
      this.uiDialog = t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front " + this.options.dialogClass).hide().attr({
        tabIndex: -1,
        role: "dialog"
      }).appendTo(this._appendTo()), this._on(this.uiDialog, {
        keydown: function(e) {
          if (this.options.closeOnEscape && !e.isDefaultPrevented() && e.keyCode && e.keyCode === t.ui.keyCode.ESCAPE) return e.preventDefault(), this.close(e), undefined;
          if (e.keyCode === t.ui.keyCode.TAB) {
            var i = this.uiDialog.find(":tabbable"),
              s = i.filter(":first"),
              n = i.filter(":last");
            e.target !== n[0] && e.target !== this.uiDialog[0] || e.shiftKey ? e.target !== s[0] && e.target !== this.uiDialog[0] || !e.shiftKey || (n.focus(1), e.preventDefault()) : (s.focus(1), e.preventDefault())
          }
        },
        mousedown: function(t) {
          this._moveToTop(t) && this._focusTabbable()
        }
      }), this.element.find("[aria-describedby]").length || this.uiDialog.attr({
        "aria-describedby": this.element.uniqueId().attr("id")
      })
    },
    _createTitlebar: function() {
      var e;
      this.uiDialogTitlebar = t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog), this._on(this.uiDialogTitlebar, {
        mousedown: function(e) {
          t(e.target).closest(".ui-dialog-titlebar-close") || this.uiDialog.focus()
        }
      }), this.uiDialogTitlebarClose = t("<button></button>").button({
        label: this.options.closeText,
        icons: {
          primary: "ui-icon-closethick"
        },
        text: !1
      }).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar), this._on(this.uiDialogTitlebarClose, {
        click: function(t) {
          t.preventDefault(), this.close(t)
        }
      }), e = t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar), this._title(e), this.uiDialog.attr({
        "aria-labelledby": e.attr("id")
      })
    },
    _title: function(t) {
      this.options.title || t.html("&#160;"), t.text(this.options.title)
    },
    _createButtonPane: function() {
      this.uiDialogButtonPane = t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"), this.uiButtonSet = t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane), this._createButtons()
    },
    _createButtons: function() {
      var e = this,
        i = this.options.buttons;
      return this.uiDialogButtonPane.remove(), this.uiButtonSet.empty(), t.isEmptyObject(i) || t.isArray(i) && !i.length ? (this.uiDialog.removeClass("ui-dialog-buttons"), undefined) : (t.each(i, function(i, s) {
        var n, o;
        s = t.isFunction(s) ? {
          click: s,
          text: i
        } : s, s = t.extend({
          type: "button"
        }, s), n = s.click, s.click = function() {
          n.apply(e.element[0], arguments)
        }, o = {
          icons: s.icons,
          text: s.showText
        }, delete s.icons, delete s.showText, t("<button></button>", s).button(o).appendTo(e.uiButtonSet)
      }), this.uiDialog.addClass("ui-dialog-buttons"), this.uiDialogButtonPane.appendTo(this.uiDialog), undefined)
    },
    _makeDraggable: function() {
      function e(t) {
        return {
          position: t.position,
          offset: t.offset
        }
      }
      var i = this,
        s = this.options;
      this.uiDialog.draggable({
        cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
        handle: ".ui-dialog-titlebar",
        containment: "document",
        start: function(s, n) {
          t(this).addClass("ui-dialog-dragging"), i._blockFrames(), i._trigger("dragStart", s, e(n))
        },
        drag: function(t, s) {
          i._trigger("drag", t, e(s))
        },
        stop: function(n, o) {
          s.position = [o.position.left - i.document.scrollLeft(), o.position.top - i.document.scrollTop()], t(this).removeClass("ui-dialog-dragging"), i._unblockFrames(), i._trigger("dragStop", n, e(o))
        }
      })
    },
    _makeResizable: function() {
      function e(t) {
        return {
          originalPosition: t.originalPosition,
          originalSize: t.originalSize,
          position: t.position,
          size: t.size
        }
      }
      var i = this,
        s = this.options,
        n = s.resizable,
        o = this.uiDialog.css("position"),
        a = "string" == typeof n ? n : "n,e,s,w,se,sw,ne,nw";
      this.uiDialog.resizable({
        cancel: ".ui-dialog-content",
        containment: "document",
        alsoResize: this.element,
        maxWidth: s.maxWidth,
        maxHeight: s.maxHeight,
        minWidth: s.minWidth,
        minHeight: this._minHeight(),
        handles: a,
        start: function(s, n) {
          t(this).addClass("ui-dialog-resizing"), i._blockFrames(), i._trigger("resizeStart", s, e(n))
        },
        resize: function(t, s) {
          i._trigger("resize", t, e(s))
        },
        stop: function(n, o) {
          s.height = t(this).height(), s.width = t(this).width(), t(this).removeClass("ui-dialog-resizing"), i._unblockFrames(), i._trigger("resizeStop", n, e(o))
        }
      }).css("position", o)
    },
    _minHeight: function() {
      var t = this.options;
      return "auto" === t.height ? t.minHeight : Math.min(t.minHeight, t.height)
    },
    _position: function() {
      var t = this.uiDialog.is(":visible");
      t || this.uiDialog.show(), this.uiDialog.position(this.options.position), t || this.uiDialog.hide()
    },
    _setOptions: function(s) {
      var n = this,
        o = !1,
        a = {};
      t.each(s, function(t, s) {
        n._setOption(t, s), t in e && (o = !0), t in i && (a[t] = s)
      }), o && (this._size(), this._position()), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", a)
    },
    _setOption: function(t, e) {
      var i, s, n = this.uiDialog;
      "dialogClass" === t && n.removeClass(this.options.dialogClass).addClass(e), "disabled" !== t && (this._super(t, e), "appendTo" === t && this.uiDialog.appendTo(this._appendTo()), "buttons" === t && this._createButtons(), "closeText" === t && this.uiDialogTitlebarClose.button({
        label: "" + e
      }), "draggable" === t && (i = n.is(":data(ui-draggable)"), i && !e && n.draggable("destroy"), !i && e && this._makeDraggable()), "position" === t && this._position(), "resizable" === t && (s = n.is(":data(ui-resizable)"), s && !e && n.resizable("destroy"), s && "string" == typeof e && n.resizable("option", "handles", e), s || e === !1 || this._makeResizable()), "title" === t && this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))
    },
    _size: function() {
      var t, e, i, s = this.options;
      this.element.show().css({
        width: "auto",
        minHeight: 0,
        maxHeight: "none",
        height: 0
      }), s.minWidth > s.width && (s.width = s.minWidth), t = this.uiDialog.css({
        height: "auto",
        width: s.width
      }).outerHeight(), e = Math.max(0, s.minHeight - t), i = "number" == typeof s.maxHeight ? Math.max(0, s.maxHeight - t) : "none", "auto" === s.height ? this.element.css({
        minHeight: e,
        maxHeight: i,
        height: "auto"
      }) : this.element.height(Math.max(0, s.height - t)), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight())
    },
    _blockFrames: function() {
      this.iframeBlocks = this.document.find("iframe").map(function() {
        var e = t(this);
        return t("<div>").css({
          position: "absolute",
          width: e.outerWidth(),
          height: e.outerHeight()
        }).appendTo(e.parent()).offset(e.offset())[0]
      })
    },
    _unblockFrames: function() {
      this.iframeBlocks && (this.iframeBlocks.remove(), delete this.iframeBlocks)
    },
    _allowInteraction: function(e) {
      return t(e.target).closest(".ui-dialog").length ? !0 : !!t(e.target).closest(".ui-datepicker").length
    },
    _createOverlay: function() {
      if (this.options.modal) {
        var e = this,
          i = this.widgetFullName;
        t.ui.dialog.overlayInstances || this._delay(function() {
          t.ui.dialog.overlayInstances && this.document.bind("focusin.dialog", function(s) {
            e._allowInteraction(s) || (s.preventDefault(), t(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())
          })
        }), this.overlay = t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()), this._on(this.overlay, {
          mousedown: "_keepFocus"
        }), t.ui.dialog.overlayInstances++
      }
    },
    _destroyOverlay: function() {
      this.options.modal && this.overlay && (t.ui.dialog.overlayInstances--, t.ui.dialog.overlayInstances || this.document.unbind("focusin.dialog"), this.overlay.remove(), this.overlay = null)
    }
  }), t.ui.dialog.overlayInstances = 0, t.uiBackCompat !== !1 && t.widget("ui.dialog", t.ui.dialog, {
    _position: function() {
      var e, i = this.options.position,
        s = [],
        n = [0, 0];
      i ? (("string" == typeof i || "object" == typeof i && "0" in i) && (s = i.split ? i.split(" ") : [i[0], i[1]], 1 === s.length && (s[1] = s[0]), t.each(["left", "top"], function(t, e) {
        +s[t] === s[t] && (n[t] = s[t], s[t] = e)
      }), i = {
        my: s[0] + (0 > n[0] ? n[0] : "+" + n[0]) + " " + s[1] + (0 > n[1] ? n[1] : "+" + n[1]),
        at: s.join(" ")
      }), i = t.extend({}, t.ui.dialog.prototype.options.position, i)) : i = t.ui.dialog.prototype.options.position, e = this.uiDialog.is(":visible"), e || this.uiDialog.show(), this.uiDialog.position(i), e || this.uiDialog.hide()
    }
  })
}(jQuery),
function(t) {
  var e = /up|down|vertical/,
    i = /up|left|vertical|horizontal/;
  t.effects.effect.blind = function(s, n) {
    var o, a, r, h = t(this),
      l = ["position", "top", "bottom", "left", "right", "height", "width"],
      c = t.effects.setMode(h, s.mode || "hide"),
      u = s.direction || "up",
      d = e.test(u),
      p = d ? "height" : "width",
      f = d ? "top" : "left",
      g = i.test(u),
      m = {},
      v = "show" === c;
    h.parent().is(".ui-effects-wrapper") ? t.effects.save(h.parent(), l) : t.effects.save(h, l), h.show(), o = t.effects.createWrapper(h).css({
      overflow: "hidden"
    }), a = o[p](), r = parseFloat(o.css(f)) || 0, m[p] = v ? a : 0, g || (h.css(d ? "bottom" : "right", 0).css(d ? "top" : "left", "auto").css({
      position: "absolute"
    }), m[f] = v ? r : a + r), v && (o.css(p, 0), g || o.css(f, r + a)), o.animate(m, {
      duration: s.duration,
      easing: s.easing,
      queue: !1,
      complete: function() {
        "hide" === c && h.hide(), t.effects.restore(h, l), t.effects.removeWrapper(h), n()
      }
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.bounce = function(e, i) {
    var s, n, o, a = t(this),
      r = ["position", "top", "bottom", "left", "right", "height", "width"],
      h = t.effects.setMode(a, e.mode || "effect"),
      l = "hide" === h,
      c = "show" === h,
      u = e.direction || "up",
      d = e.distance,
      p = e.times || 5,
      f = 2 * p + (c || l ? 1 : 0),
      g = e.duration / f,
      m = e.easing,
      v = "up" === u || "down" === u ? "top" : "left",
      _ = "up" === u || "left" === u,
      b = a.queue(),
      y = b.length;
    for ((c || l) && r.push("opacity"), t.effects.save(a, r), a.show(), t.effects.createWrapper(a), d || (d = a["top" === v ? "outerHeight" : "outerWidth"]() / 3), c && (o = {
        opacity: 1
      }, o[v] = 0, a.css("opacity", 0).css(v, _ ? 2 * -d : 2 * d).animate(o, g, m)), l && (d /= Math.pow(2, p - 1)), o = {}, o[v] = 0, s = 0; p > s; s++) n = {}, n[v] = (_ ? "-=" : "+=") + d, a.animate(n, g, m).animate(o, g, m), d = l ? 2 * d : d / 2;
    l && (n = {
      opacity: 0
    }, n[v] = (_ ? "-=" : "+=") + d, a.animate(n, g, m)), a.queue(function() {
      l && a.hide(), t.effects.restore(a, r), t.effects.removeWrapper(a), i()
    }), y > 1 && b.splice.apply(b, [1, 0].concat(b.splice(y, f + 1))), a.dequeue()
  }
}(jQuery),
function(t) {
  t.effects.effect.clip = function(e, i) {
    var s, n, o, a = t(this),
      r = ["position", "top", "bottom", "left", "right", "height", "width"],
      h = t.effects.setMode(a, e.mode || "hide"),
      l = "show" === h,
      c = e.direction || "vertical",
      u = "vertical" === c,
      d = u ? "height" : "width",
      p = u ? "top" : "left",
      f = {};
    t.effects.save(a, r), a.show(), s = t.effects.createWrapper(a).css({
      overflow: "hidden"
    }), n = "IMG" === a[0].tagName ? s : a, o = n[d](), l && (n.css(d, 0), n.css(p, o / 2)), f[d] = l ? o : 0, f[p] = l ? 0 : o / 2, n.animate(f, {
      queue: !1,
      duration: e.duration,
      easing: e.easing,
      complete: function() {
        l || a.hide(), t.effects.restore(a, r), t.effects.removeWrapper(a), i()
      }
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.drop = function(e, i) {
    var s, n = t(this),
      o = ["position", "top", "bottom", "left", "right", "opacity", "height", "width"],
      a = t.effects.setMode(n, e.mode || "hide"),
      r = "show" === a,
      h = e.direction || "left",
      l = "up" === h || "down" === h ? "top" : "left",
      c = "up" === h || "left" === h ? "pos" : "neg",
      u = {
        opacity: r ? 1 : 0
      };
    t.effects.save(n, o), n.show(), t.effects.createWrapper(n), s = e.distance || n["top" === l ? "outerHeight" : "outerWidth"](!0) / 2, r && n.css("opacity", 0).css(l, "pos" === c ? -s : s), u[l] = (r ? "pos" === c ? "+=" : "-=" : "pos" === c ? "-=" : "+=") + s, n.animate(u, {
      queue: !1,
      duration: e.duration,
      easing: e.easing,
      complete: function() {
        "hide" === a && n.hide(), t.effects.restore(n, o), t.effects.removeWrapper(n), i()
      }
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.explode = function(e, i) {
    function s() {
      b.push(this), b.length === u * d && n()
    }

    function n() {
      p.css({
        visibility: "visible"
      }), t(b).remove(), g || p.hide(), i()
    }
    var o, a, r, h, l, c, u = e.pieces ? Math.round(Math.sqrt(e.pieces)) : 3,
      d = u,
      p = t(this),
      f = t.effects.setMode(p, e.mode || "hide"),
      g = "show" === f,
      m = p.show().css("visibility", "hidden").offset(),
      v = Math.ceil(p.outerWidth() / d),
      _ = Math.ceil(p.outerHeight() / u),
      b = [];
    for (o = 0; u > o; o++)
      for (h = m.top + o * _, c = o - (u - 1) / 2, a = 0; d > a; a++) r = m.left + a * v, l = a - (d - 1) / 2, p.clone().appendTo("body").wrap("<div></div>").css({
        position: "absolute",
        visibility: "visible",
        left: -a * v,
        top: -o * _
      }).parent().addClass("ui-effects-explode").css({
        position: "absolute",
        overflow: "hidden",
        width: v,
        height: _,
        left: r + (g ? l * v : 0),
        top: h + (g ? c * _ : 0),
        opacity: g ? 0 : 1
      }).animate({
        left: r + (g ? 0 : l * v),
        top: h + (g ? 0 : c * _),
        opacity: g ? 1 : 0
      }, e.duration || 500, e.easing, s)
  }
}(jQuery),
function(t) {
  t.effects.effect.fade = function(e, i) {
    var s = t(this),
      n = t.effects.setMode(s, e.mode || "toggle");
    s.animate({
      opacity: n
    }, {
      queue: !1,
      duration: e.duration,
      easing: e.easing,
      complete: i
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.fold = function(e, i) {
    var s, n, o = t(this),
      a = ["position", "top", "bottom", "left", "right", "height", "width"],
      r = t.effects.setMode(o, e.mode || "hide"),
      h = "show" === r,
      l = "hide" === r,
      c = e.size || 15,
      u = /([0-9]+)%/.exec(c),
      d = !!e.horizFirst,
      p = h !== d,
      f = p ? ["width", "height"] : ["height", "width"],
      g = e.duration / 2,
      m = {},
      v = {};
    t.effects.save(o, a), o.show(), s = t.effects.createWrapper(o).css({
      overflow: "hidden"
    }), n = p ? [s.width(), s.height()] : [s.height(), s.width()], u && (c = parseInt(u[1], 10) / 100 * n[l ? 0 : 1]), h && s.css(d ? {
      height: 0,
      width: c
    } : {
      height: c,
      width: 0
    }), m[f[0]] = h ? n[0] : c, v[f[1]] = h ? n[1] : 0, s.animate(m, g, e.easing).animate(v, g, e.easing, function() {
      l && o.hide(), t.effects.restore(o, a), t.effects.removeWrapper(o), i()
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.highlight = function(e, i) {
    var s = t(this),
      n = ["backgroundImage", "backgroundColor", "opacity"],
      o = t.effects.setMode(s, e.mode || "show"),
      a = {
        backgroundColor: s.css("backgroundColor")
      };
    "hide" === o && (a.opacity = 0), t.effects.save(s, n), s.show().css({
      backgroundImage: "none",
      backgroundColor: e.color || "#ffff99"
    }).animate(a, {
      queue: !1,
      duration: e.duration,
      easing: e.easing,
      complete: function() {
        "hide" === o && s.hide(), t.effects.restore(s, n), i()
      }
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.pulsate = function(e, i) {
    var s, n = t(this),
      o = t.effects.setMode(n, e.mode || "show"),
      a = "show" === o,
      r = "hide" === o,
      h = a || "hide" === o,
      l = 2 * (e.times || 5) + (h ? 1 : 0),
      c = e.duration / l,
      u = 0,
      d = n.queue(),
      p = d.length;
    for ((a || !n.is(":visible")) && (n.css("opacity", 0).show(), u = 1), s = 1; l > s; s++) n.animate({
      opacity: u
    }, c, e.easing), u = 1 - u;
    n.animate({
      opacity: u
    }, c, e.easing), n.queue(function() {
      r && n.hide(), i()
    }), p > 1 && d.splice.apply(d, [1, 0].concat(d.splice(p, l + 1))), n.dequeue()
  }
}(jQuery),
function(t) {
  t.effects.effect.puff = function(e, i) {
    var s = t(this),
      n = t.effects.setMode(s, e.mode || "hide"),
      o = "hide" === n,
      a = parseInt(e.percent, 10) || 150,
      r = a / 100,
      h = {
        height: s.height(),
        width: s.width(),
        outerHeight: s.outerHeight(),
        outerWidth: s.outerWidth()
      };
    t.extend(e, {
      effect: "scale",
      queue: !1,
      fade: !0,
      mode: n,
      complete: i,
      percent: o ? a : 100,
      from: o ? h : {
        height: h.height * r,
        width: h.width * r,
        outerHeight: h.outerHeight * r,
        outerWidth: h.outerWidth * r
      }
    }), s.effect(e)
  }, t.effects.effect.scale = function(e, i) {
    var s = t(this),
      n = t.extend(!0, {}, e),
      o = t.effects.setMode(s, e.mode || "effect"),
      a = parseInt(e.percent, 10) || (0 === parseInt(e.percent, 10) ? 0 : "hide" === o ? 0 : 100),
      r = e.direction || "both",
      h = e.origin,
      l = {
        height: s.height(),
        width: s.width(),
        outerHeight: s.outerHeight(),
        outerWidth: s.outerWidth()
      },
      c = {
        y: "horizontal" !== r ? a / 100 : 1,
        x: "vertical" !== r ? a / 100 : 1
      };
    n.effect = "size", n.queue = !1, n.complete = i, "effect" !== o && (n.origin = h || ["middle", "center"], n.restore = !0), n.from = e.from || ("show" === o ? {
      height: 0,
      width: 0,
      outerHeight: 0,
      outerWidth: 0
    } : l), n.to = {
      height: l.height * c.y,
      width: l.width * c.x,
      outerHeight: l.outerHeight * c.y,
      outerWidth: l.outerWidth * c.x
    }, n.fade && ("show" === o && (n.from.opacity = 0, n.to.opacity = 1), "hide" === o && (n.from.opacity = 1, n.to.opacity = 0)), s.effect(n)
  }, t.effects.effect.size = function(e, i) {
    var s, n, o, a = t(this),
      r = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"],
      h = ["position", "top", "bottom", "left", "right", "overflow", "opacity"],
      l = ["width", "height", "overflow"],
      c = ["fontSize"],
      u = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"],
      d = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"],
      p = t.effects.setMode(a, e.mode || "effect"),
      f = e.restore || "effect" !== p,
      g = e.scale || "both",
      m = e.origin || ["middle", "center"],
      v = a.css("position"),
      _ = f ? r : h,
      b = {
        height: 0,
        width: 0,
        outerHeight: 0,
        outerWidth: 0
      };
    "show" === p && a.show(), s = {
      height: a.height(),
      width: a.width(),
      outerHeight: a.outerHeight(),
      outerWidth: a.outerWidth()
    }, "toggle" === e.mode && "show" === p ? (a.from = e.to || b, a.to = e.from || s) : (a.from = e.from || ("show" === p ? b : s), a.to = e.to || ("hide" === p ? b : s)), o = {
      from: {
        y: a.from.height / s.height,
        x: a.from.width / s.width
      },
      to: {
        y: a.to.height / s.height,
        x: a.to.width / s.width
      }
    }, ("box" === g || "both" === g) && (o.from.y !== o.to.y && (_ = _.concat(u), a.from = t.effects.setTransition(a, u, o.from.y, a.from), a.to = t.effects.setTransition(a, u, o.to.y, a.to)), o.from.x !== o.to.x && (_ = _.concat(d), a.from = t.effects.setTransition(a, d, o.from.x, a.from), a.to = t.effects.setTransition(a, d, o.to.x, a.to))), ("content" === g || "both" === g) && o.from.y !== o.to.y && (_ = _.concat(c).concat(l), a.from = t.effects.setTransition(a, c, o.from.y, a.from), a.to = t.effects.setTransition(a, c, o.to.y, a.to)), t.effects.save(a, _), a.show(), t.effects.createWrapper(a), a.css("overflow", "hidden").css(a.from), m && (n = t.effects.getBaseline(m, s), a.from.top = (s.outerHeight - a.outerHeight()) * n.y, a.from.left = (s.outerWidth - a.outerWidth()) * n.x, a.to.top = (s.outerHeight - a.to.outerHeight) * n.y, a.to.left = (s.outerWidth - a.to.outerWidth) * n.x), a.css(a.from), ("content" === g || "both" === g) && (u = u.concat(["marginTop", "marginBottom"]).concat(c), d = d.concat(["marginLeft", "marginRight"]), l = r.concat(u).concat(d), a.find("*[width]").each(function() {
      var i = t(this),
        s = {
          height: i.height(),
          width: i.width(),
          outerHeight: i.outerHeight(),
          outerWidth: i.outerWidth()
        };
      f && t.effects.save(i, l), i.from = {
        height: s.height * o.from.y,
        width: s.width * o.from.x,
        outerHeight: s.outerHeight * o.from.y,
        outerWidth: s.outerWidth * o.from.x
      }, i.to = {
        height: s.height * o.to.y,
        width: s.width * o.to.x,
        outerHeight: s.height * o.to.y,
        outerWidth: s.width * o.to.x
      }, o.from.y !== o.to.y && (i.from = t.effects.setTransition(i, u, o.from.y, i.from), i.to = t.effects.setTransition(i, u, o.to.y, i.to)), o.from.x !== o.to.x && (i.from = t.effects.setTransition(i, d, o.from.x, i.from), i.to = t.effects.setTransition(i, d, o.to.x, i.to)), i.css(i.from), i.animate(i.to, e.duration, e.easing, function() {
        f && t.effects.restore(i, l)
      })
    })), a.animate(a.to, {
      queue: !1,
      duration: e.duration,
      easing: e.easing,
      complete: function() {
        0 === a.to.opacity && a.css("opacity", a.from.opacity), "hide" === p && a.hide(), t.effects.restore(a, _), f || ("static" === v ? a.css({
          position: "relative",
          top: a.to.top,
          left: a.to.left
        }) : t.each(["top", "left"], function(t, e) {
          a.css(e, function(e, i) {
            var s = parseInt(i, 10),
              n = t ? a.to.left : a.to.top;
            return "auto" === i ? n + "px" : s + n + "px"
          })
        })), t.effects.removeWrapper(a), i()
      }
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.shake = function(e, i) {
    var s, n = t(this),
      o = ["position", "top", "bottom", "left", "right", "height", "width"],
      a = t.effects.setMode(n, e.mode || "effect"),
      r = e.direction || "left",
      h = e.distance || 20,
      l = e.times || 3,
      c = 2 * l + 1,
      u = Math.round(e.duration / c),
      d = "up" === r || "down" === r ? "top" : "left",
      p = "up" === r || "left" === r,
      f = {},
      g = {},
      m = {},
      v = n.queue(),
      _ = v.length;
    for (t.effects.save(n, o), n.show(), t.effects.createWrapper(n), f[d] = (p ? "-=" : "+=") + h, g[d] = (p ? "+=" : "-=") + 2 * h, m[d] = (p ? "-=" : "+=") + 2 * h, n.animate(f, u, e.easing), s = 1; l > s; s++) n.animate(g, u, e.easing).animate(m, u, e.easing);
    n.animate(g, u, e.easing).animate(f, u / 2, e.easing).queue(function() {
      "hide" === a && n.hide(), t.effects.restore(n, o), t.effects.removeWrapper(n), i()
    }), _ > 1 && v.splice.apply(v, [1, 0].concat(v.splice(_, c + 1))), n.dequeue()
  }
}(jQuery),
function(t) {
  t.effects.effect.slide = function(e, i) {
    var s, n = t(this),
      o = ["position", "top", "bottom", "left", "right", "width", "height"],
      a = t.effects.setMode(n, e.mode || "show"),
      r = "show" === a,
      h = e.direction || "left",
      l = "up" === h || "down" === h ? "top" : "left",
      c = "up" === h || "left" === h,
      u = {};
    t.effects.save(n, o), n.show(), s = e.distance || n["top" === l ? "outerHeight" : "outerWidth"](!0), t.effects.createWrapper(n).css({
      overflow: "hidden"
    }), r && n.css(l, c ? isNaN(s) ? "-" + s : -s : s), u[l] = (r ? c ? "+=" : "-=" : c ? "-=" : "+=") + s, n.animate(u, {
      queue: !1,
      duration: e.duration,
      easing: e.easing,
      complete: function() {
        "hide" === a && n.hide(), t.effects.restore(n, o), t.effects.removeWrapper(n), i()
      }
    })
  }
}(jQuery),
function(t) {
  t.effects.effect.transfer = function(e, i) {
    var s = t(this),
      n = t(e.to),
      o = "fixed" === n.css("position"),
      a = t("body"),
      r = o ? a.scrollTop() : 0,
      h = o ? a.scrollLeft() : 0,
      l = n.offset(),
      c = {
        top: l.top - r,
        left: l.left - h,
        height: n.innerHeight(),
        width: n.innerWidth()
      },
      u = s.offset(),
      d = t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({
        top: u.top - r,
        left: u.left - h,
        height: s.innerHeight(),
        width: s.innerWidth(),
        position: o ? "fixed" : "absolute"
      }).animate(c, e.duration, e.easing, function() {
        d.remove(), i()
      })
  }
}(jQuery),
function(t) {
  t.widget("ui.menu", {
    version: "1.10.3",
    defaultElement: "<ul>",
    delay: 300,
    options: {
      icons: {
        submenu: "ui-icon-carat-1-e"
      },
      menus: "ul",
      position: {
        my: "left top",
        at: "right top"
      },
      role: "menu",
      blur: null,
      focus: null,
      select: null
    },
    _create: function() {
      this.activeMenu = this.element, this.mouseHandled = !1, this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({
        role: this.options.role,
        tabIndex: 0
      }).bind("click" + this.eventNamespace, t.proxy(function(t) {
        this.options.disabled && t.preventDefault()
      }, this)), this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"), this._on({
        "mousedown .ui-menu-item > a": function(t) {
          t.preventDefault()
        },
        "click .ui-state-disabled > a": function(t) {
          t.preventDefault()
        },
        "click .ui-menu-item:has(a)": function(e) {
          var i = t(e.target).closest(".ui-menu-item");
          !this.mouseHandled && i.not(".ui-state-disabled").length && (this.mouseHandled = !0, this.select(e), i.has(".ui-menu").length ? this.expand(e) : this.element.is(":focus") || (this.element.trigger("focus", [!0]), this.active && 1 === this.active.parents(".ui-menu").length && clearTimeout(this.timer)))
        },
        "mouseenter .ui-menu-item": function(e) {
          var i = t(e.currentTarget);
          i.siblings().children(".ui-state-active").removeClass("ui-state-active"), this.focus(e, i)
        },
        mouseleave: "collapseAll",
        "mouseleave .ui-menu": "collapseAll",
        focus: function(t, e) {
          var i = this.active || this.element.children(".ui-menu-item").eq(0);
          e || this.focus(t, i)
        },
        blur: function(e) {
          this._delay(function() {
            t.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(e)
          })
        },
        keydown: "_keydown"
      }), this.refresh(), this._on(this.document, {
        click: function(e) {
          t(e.target).closest(".ui-menu").length || this.collapseAll(e), this.mouseHandled = !1
        }
      })
    },
    _destroy: function() {
      this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(), this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function() {
        var e = t(this);
        e.data("ui-menu-submenu-carat") && e.remove()
      }), this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")
    },
    _keydown: function(e) {
      function i(t) {
        return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
      }
      var s, n, o, a, r, h = !0;
      switch (e.keyCode) {
        case t.ui.keyCode.PAGE_UP:
          this.previousPage(e);
          break;
        case t.ui.keyCode.PAGE_DOWN:
          this.nextPage(e);
          break;
        case t.ui.keyCode.HOME:
          this._move("first", "first", e);
          break;
        case t.ui.keyCode.END:
          this._move("last", "last", e);
          break;
        case t.ui.keyCode.UP:
          this.previous(e);
          break;
        case t.ui.keyCode.DOWN:
          this.next(e);
          break;
        case t.ui.keyCode.LEFT:
          this.collapse(e);
          break;
        case t.ui.keyCode.RIGHT:
          this.active && !this.active.is(".ui-state-disabled") && this.expand(e);
          break;
        case t.ui.keyCode.ENTER:
        case t.ui.keyCode.SPACE:
          this._activate(e);
          break;
        case t.ui.keyCode.ESCAPE:
          this.collapse(e);
          break;
        default:
          h = !1, n = this.previousFilter || "", o = String.fromCharCode(e.keyCode), a = !1, clearTimeout(this.filterTimer), o === n ? a = !0 : o = n + o, r = RegExp("^" + i(o), "i"), s = this.activeMenu.children(".ui-menu-item").filter(function() {
            return r.test(t(this).children("a").text())
          }), s = a && -1 !== s.index(this.active.next()) ? this.active.nextAll(".ui-menu-item") : s, s.length || (o = String.fromCharCode(e.keyCode), r = RegExp("^" + i(o), "i"), s = this.activeMenu.children(".ui-menu-item").filter(function() {
            return r.test(t(this).children("a").text())
          })), s.length ? (this.focus(e, s), s.length > 1 ? (this.previousFilter = o, this.filterTimer = this._delay(function() {
            delete this.previousFilter
          }, 1e3)) : delete this.previousFilter) : delete this.previousFilter
      }
      h && e.preventDefault()
    },
    _activate: function(t) {
      this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(t) : this.select(t))
    },
    refresh: function() {
      var e, i = this.options.icons.submenu,
        s = this.element.find(this.options.menus);
      s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({
        role: this.options.role,
        "aria-hidden": "true",
        "aria-expanded": "false"
      }).each(function() {
        var e = t(this),
          s = e.prev("a"),
          n = t("<span>").addClass("ui-menu-icon ui-icon " + i).data("ui-menu-submenu-carat", !0);
        s.attr("aria-haspopup", "true").prepend(n), e.attr("aria-labelledby", s.attr("id"))
      }), e = s.add(this.element), e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({
        tabIndex: -1,
        role: this._itemRole()
      }), e.children(":not(.ui-menu-item)").each(function() {
        var e = t(this);
        /[^\-\u2014\u2013\s]/.test(e.text()) || e.addClass("ui-widget-content ui-menu-divider")
      }), e.children(".ui-state-disabled").attr("aria-disabled", "true"), this.active && !t.contains(this.element[0], this.active[0]) && this.blur()
    },
    _itemRole: function() {
      return {
        menu: "menuitem",
        listbox: "option"
      }[this.options.role]
    },
    _setOption: function(t, e) {
      "icons" === t && this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu), this._super(t, e)
    },
    focus: function(t, e) {
      var i, s;
      this.blur(t, t && "focus" === t.type), this._scrollIntoView(e), this.active = e.first(), s = this.active.children("a").addClass("ui-state-focus"), this.options.role && this.element.attr("aria-activedescendant", s.attr("id")), this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"), t && "keydown" === t.type ? this._close() : this.timer = this._delay(function() {
        this._close()
      }, this.delay), i = e.children(".ui-menu"), i.length && /^mouse/.test(t.type) && this._startOpening(i), this.activeMenu = e.parent(), this._trigger("focus", t, {
        item: e
      })
    },
    _scrollIntoView: function(e) {
      var i, s, n, o, a, r;
      this._hasScroll() && (i = parseFloat(t.css(this.activeMenu[0], "borderTopWidth")) || 0, s = parseFloat(t.css(this.activeMenu[0], "paddingTop")) || 0, n = e.offset().top - this.activeMenu.offset().top - i - s, o = this.activeMenu.scrollTop(), a = this.activeMenu.height(), r = e.height(), 0 > n ? this.activeMenu.scrollTop(o + n) : n + r > a && this.activeMenu.scrollTop(o + n - a + r))
    },
    blur: function(t, e) {
      e || clearTimeout(this.timer), this.active && (this.active.children("a").removeClass("ui-state-focus"), this.active = null, this._trigger("blur", t, {
        item: this.active
      }))
    },
    _startOpening: function(t) {
      clearTimeout(this.timer), "true" === t.attr("aria-hidden") && (this.timer = this._delay(function() {
        this._close(), this._open(t)
      }, this.delay))
    },
    _open: function(e) {
      var i = t.extend({
        of: this.active
      }, this.options.position);
      clearTimeout(this.timer), this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden", "true"), e.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(i)
    },
    collapseAll: function(e, i) {
      clearTimeout(this.timer), this.timer = this._delay(function() {
        var s = i ? this.element : t(e && e.target).closest(this.element.find(".ui-menu"));
        s.length || (s = this.element), this._close(s), this.blur(e), this.activeMenu = s
      }, this.delay)
    },
    _close: function(t) {
      t || (t = this.active ? this.active.parent() : this.element), t.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active")
    },
    collapse: function(t) {
      var e = this.active && this.active.parent().closest(".ui-menu-item", this.element);
      e && e.length && (this._close(), this.focus(t, e))
    },
    expand: function(t) {
      var e = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
      e && e.length && (this._open(e.parent()), this._delay(function() {
        this.focus(t, e)
      }))
    },
    next: function(t) {
      this._move("next", "first", t)
    },
    previous: function(t) {
      this._move("prev", "last", t)
    },
    isFirstItem: function() {
      return this.active && !this.active.prevAll(".ui-menu-item").length
    },
    isLastItem: function() {
      return this.active && !this.active.nextAll(".ui-menu-item").length
    },
    _move: function(t, e, i) {
      var s;
      this.active && (s = "first" === t || "last" === t ? this.active["first" === t ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : this.active[t + "All"](".ui-menu-item").eq(0)), s && s.length && this.active || (s = this.activeMenu.children(".ui-menu-item")[e]()), this.focus(i, s)
    },
    nextPage: function(e) {
      var i, s, n;
      return this.active ? (this.isLastItem() || (this._hasScroll() ? (s = this.active.offset().top, n = this.element.height(), this.active.nextAll(".ui-menu-item").each(function() {
        return i = t(this), 0 > i.offset().top - s - n
      }), this.focus(e, i)) : this.focus(e, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]())), undefined) : (this.next(e), undefined)
    },
    previousPage: function(e) {
      var i, s, n;
      return this.active ? (this.isFirstItem() || (this._hasScroll() ? (s = this.active.offset().top, n = this.element.height(), this.active.prevAll(".ui-menu-item").each(function() {
        return i = t(this), i.offset().top - s + n > 0
      }), this.focus(e, i)) : this.focus(e, this.activeMenu.children(".ui-menu-item").first())), undefined) : (this.next(e), undefined)
    },
    _hasScroll: function() {
      return this.element.outerHeight() < this.element.prop("scrollHeight")
    },
    select: function(e) {
      this.active = this.active || t(e.target).closest(".ui-menu-item");
      var i = {
        item: this.active
      };
      this.active.has(".ui-menu").length || this.collapseAll(e, !0), this._trigger("select", e, i)
    }
  })
}(jQuery),
function(t, e) {
  function i(t, e, i) {
    return [parseFloat(t[0]) * (p.test(t[0]) ? e / 100 : 1), parseFloat(t[1]) * (p.test(t[1]) ? i / 100 : 1)]
  }

  function s(e, i) {
    return parseInt(t.css(e, i), 10) || 0
  }

  function n(e) {
    var i = e[0];
    return 9 === i.nodeType ? {
      width: e.width(),
      height: e.height(),
      offset: {
        top: 0,
        left: 0
      }
    } : t.isWindow(i) ? {
      width: e.width(),
      height: e.height(),
      offset: {
        top: e.scrollTop(),
        left: e.scrollLeft()
      }
    } : i.preventDefault ? {
      width: 0,
      height: 0,
      offset: {
        top: i.pageY,
        left: i.pageX
      }
    } : {
      width: e.outerWidth(),
      height: e.outerHeight(),
      offset: e.offset()
    }
  }
  t.ui = t.ui || {};
  var o, a = Math.max,
    r = Math.abs,
    h = Math.round,
    l = /left|center|right/,
    c = /top|center|bottom/,
    u = /[\+\-]\d+(\.[\d]+)?%?/,
    d = /^\w+/,
    p = /%$/,
    f = t.fn.position;
  t.position = {
      scrollbarWidth: function() {
        if (o !== e) return o;
        var i, s, n = t("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),
          a = n.children()[0];
        return t("body").append(n), i = a.offsetWidth, n.css("overflow", "scroll"), s = a.offsetWidth, i === s && (s = n[0].clientWidth), n.remove(), o = i - s
      },
      getScrollInfo: function(e) {
        var i = e.isWindow ? "" : e.element.css("overflow-x"),
          s = e.isWindow ? "" : e.element.css("overflow-y"),
          n = "scroll" === i || "auto" === i && e.width < e.element[0].scrollWidth,
          o = "scroll" === s || "auto" === s && e.height < e.element[0].scrollHeight;
        return {
          width: o ? t.position.scrollbarWidth() : 0,
          height: n ? t.position.scrollbarWidth() : 0
        }
      },
      getWithinInfo: function(e) {
        var i = t(e || window),
          s = t.isWindow(i[0]);
        return {
          element: i,
          isWindow: s,
          offset: i.offset() || {
            left: 0,
            top: 0
          },
          scrollLeft: i.scrollLeft(),
          scrollTop: i.scrollTop(),
          width: s ? i.width() : i.outerWidth(),
          height: s ? i.height() : i.outerHeight()
        }
      }
    }, t.fn.position = function(e) {
      if (!e || !e.of) return f.apply(this, arguments);
      e = t.extend({}, e);
      var o, p, g, m, v, _, b = t(e.of),
        y = t.position.getWithinInfo(e.within),
        w = t.position.getScrollInfo(y),
        k = (e.collision || "flip").split(" "),
        x = {};
      return _ = n(b), b[0].preventDefault && (e.at = "left top"), p = _.width, g = _.height, m = _.offset, v = t.extend({}, m), t.each(["my", "at"], function() {
        var t, i, s = (e[this] || "").split(" ");
        1 === s.length && (s = l.test(s[0]) ? s.concat(["center"]) : c.test(s[0]) ? ["center"].concat(s) : ["center", "center"]), s[0] = l.test(s[0]) ? s[0] : "center", s[1] = c.test(s[1]) ? s[1] : "center", t = u.exec(s[0]), i = u.exec(s[1]), x[this] = [t ? t[0] : 0, i ? i[0] : 0], e[this] = [d.exec(s[0])[0], d.exec(s[1])[0]]
      }), 1 === k.length && (k[1] = k[0]), "right" === e.at[0] ? v.left += p : "center" === e.at[0] && (v.left += p / 2), "bottom" === e.at[1] ? v.top += g : "center" === e.at[1] && (v.top += g / 2), o = i(x.at, p, g), v.left += o[0], v.top += o[1], this.each(function() {
        var n, l, c = t(this),
          u = c.outerWidth(),
          d = c.outerHeight(),
          f = s(this, "marginLeft"),
          _ = s(this, "marginTop"),
          D = u + f + s(this, "marginRight") + w.width,
          C = d + _ + s(this, "marginBottom") + w.height,
          I = t.extend({}, v),
          P = i(x.my, c.outerWidth(), c.outerHeight());
        "right" === e.my[0] ? I.left -= u : "center" === e.my[0] && (I.left -= u / 2), "bottom" === e.my[1] ? I.top -= d : "center" === e.my[1] && (I.top -= d / 2), I.left += P[0], I.top += P[1], t.support.offsetFractions || (I.left = h(I.left), I.top = h(I.top)), n = {
          marginLeft: f,
          marginTop: _
        }, t.each(["left", "top"], function(i, s) {
          t.ui.position[k[i]] && t.ui.position[k[i]][s](I, {
            targetWidth: p,
            targetHeight: g,
            elemWidth: u,
            elemHeight: d,
            collisionPosition: n,
            collisionWidth: D,
            collisionHeight: C,
            offset: [o[0] + P[0], o[1] + P[1]],
            my: e.my,
            at: e.at,
            within: y,
            elem: c
          })
        }), e.using && (l = function(t) {
          var i = m.left - I.left,
            s = i + p - u,
            n = m.top - I.top,
            o = n + g - d,
            h = {
              target: {
                element: b,
                left: m.left,
                top: m.top,
                width: p,
                height: g
              },
              element: {
                element: c,
                left: I.left,
                top: I.top,
                width: u,
                height: d
              },
              horizontal: 0 > s ? "left" : i > 0 ? "right" : "center",
              vertical: 0 > o ? "top" : n > 0 ? "bottom" : "middle"
            };
          u > p && p > r(i + s) && (h.horizontal = "center"), d > g && g > r(n + o) && (h.vertical = "middle"), h.important = a(r(i), r(s)) > a(r(n), r(o)) ? "horizontal" : "vertical", e.using.call(this, t, h)
        }), c.offset(t.extend(I, {
          using: l
        }))
      })
    }, t.ui.position = {
      fit: {
        left: function(t, e) {
          var i, s = e.within,
            n = s.isWindow ? s.scrollLeft : s.offset.left,
            o = s.width,
            r = t.left - e.collisionPosition.marginLeft,
            h = n - r,
            l = r + e.collisionWidth - o - n;
          e.collisionWidth > o ? h > 0 && 0 >= l ? (i = t.left + h + e.collisionWidth - o - n, t.left += h - i) : t.left = l > 0 && 0 >= h ? n : h > l ? n + o - e.collisionWidth : n : h > 0 ? t.left += h : l > 0 ? t.left -= l : t.left = a(t.left - r, t.left)
        },
        top: function(t, e) {
          var i, s = e.within,
            n = s.isWindow ? s.scrollTop : s.offset.top,
            o = e.within.height,
            r = t.top - e.collisionPosition.marginTop,
            h = n - r,
            l = r + e.collisionHeight - o - n;
          e.collisionHeight > o ? h > 0 && 0 >= l ? (i = t.top + h + e.collisionHeight - o - n, t.top += h - i) : t.top = l > 0 && 0 >= h ? n : h > l ? n + o - e.collisionHeight : n : h > 0 ? t.top += h : l > 0 ? t.top -= l : t.top = a(t.top - r, t.top)
        }
      },
      flip: {
        left: function(t, e) {
          var i, s, n = e.within,
            o = n.offset.left + n.scrollLeft,
            a = n.width,
            h = n.isWindow ? n.scrollLeft : n.offset.left,
            l = t.left - e.collisionPosition.marginLeft,
            c = l - h,
            u = l + e.collisionWidth - a - h,
            d = "left" === e.my[0] ? -e.elemWidth : "right" === e.my[0] ? e.elemWidth : 0,
            p = "left" === e.at[0] ? e.targetWidth : "right" === e.at[0] ? -e.targetWidth : 0,
            f = -2 * e.offset[0];
          0 > c ? (i = t.left + d + p + f + e.collisionWidth - a - o, (0 > i || r(c) > i) && (t.left += d + p + f)) : u > 0 && (s = t.left - e.collisionPosition.marginLeft + d + p + f - h, (s > 0 || u > r(s)) && (t.left += d + p + f))
        },
        top: function(t, e) {
          var i, s, n = e.within,
            o = n.offset.top + n.scrollTop,
            a = n.height,
            h = n.isWindow ? n.scrollTop : n.offset.top,
            l = t.top - e.collisionPosition.marginTop,
            c = l - h,
            u = l + e.collisionHeight - a - h,
            d = "top" === e.my[1],
            p = d ? -e.elemHeight : "bottom" === e.my[1] ? e.elemHeight : 0,
            f = "top" === e.at[1] ? e.targetHeight : "bottom" === e.at[1] ? -e.targetHeight : 0,
            g = -2 * e.offset[1];
          0 > c ? (s = t.top + p + f + g + e.collisionHeight - a - o, t.top + p + f + g > c && (0 > s || r(c) > s) && (t.top += p + f + g)) : u > 0 && (i = t.top - e.collisionPosition.marginTop + p + f + g - h, t.top + p + f + g > u && (i > 0 || u > r(i)) && (t.top += p + f + g))
        }
      },
      flipfit: {
        left: function() {
          t.ui.position.flip.left.apply(this, arguments), t.ui.position.fit.left.apply(this, arguments)
        },
        top: function() {
          t.ui.position.flip.top.apply(this, arguments), t.ui.position.fit.top.apply(this, arguments)
        }
      }
    },
    function() {
      var e, i, s, n, o, a = document.getElementsByTagName("body")[0],
        r = document.createElement("div");
      e = document.createElement(a ? "div" : "body"), s = {
        visibility: "hidden",
        width: 0,
        height: 0,
        border: 0,
        margin: 0,
        background: "none"
      }, a && t.extend(s, {
        position: "absolute",
        left: "-1000px",
        top: "-1000px"
      });
      for (o in s) e.style[o] = s[o];
      e.appendChild(r), i = a || document.documentElement, i.insertBefore(e, i.firstChild), r.style.cssText = "position: absolute; left: 10.7432222px;", n = t(r).offset().left, t.support.offsetFractions = n > 10 && 11 > n, e.innerHTML = "", i.removeChild(e)
    }()
}(jQuery),
function(t, e) {
  t.widget("ui.progressbar", {
    version: "1.10.3",
    options: {
      max: 100,
      value: 0,
      change: null,
      complete: null
    },
    min: 0,
    _create: function() {
      this.oldValue = this.options.value = this._constrainedValue(), this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({
        role: "progressbar",
        "aria-valuemin": this.min
      }), this.valueDiv = t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element), this._refreshValue()
    },
    _destroy: function() {
      this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.valueDiv.remove()
    },
    value: function(t) {
      return t === e ? this.options.value : (this.options.value = this._constrainedValue(t), this._refreshValue(), e)
    },
    _constrainedValue: function(t) {
      return t === e && (t = this.options.value), this.indeterminate = t === !1, "number" != typeof t && (t = 0), this.indeterminate ? !1 : Math.min(this.options.max, Math.max(this.min, t))
    },
    _setOptions: function(t) {
      var e = t.value;
      delete t.value, this._super(t), this.options.value = this._constrainedValue(e), this._refreshValue()
    },
    _setOption: function(t, e) {
      "max" === t && (e = Math.max(this.min, e)), this._super(t, e)
    },
    _percentage: function() {
      return this.indeterminate ? 100 : 100 * (this.options.value - this.min) / (this.options.max - this.min)
    },
    _refreshValue: function() {
      var e = this.options.value,
        i = this._percentage();
      this.valueDiv.toggle(this.indeterminate || e > this.min).toggleClass("ui-corner-right", e === this.options.max).width(i.toFixed(0) + "%"), this.element.toggleClass("ui-progressbar-indeterminate", this.indeterminate), this.indeterminate ? (this.element.removeAttr("aria-valuenow"), this.overlayDiv || (this.overlayDiv = t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))) : (this.element.attr({
        "aria-valuemax": this.options.max,
        "aria-valuenow": e
      }), this.overlayDiv && (this.overlayDiv.remove(), this.overlayDiv = null)), this.oldValue !== e && (this.oldValue = e, this._trigger("change")), e === this.options.max && this._trigger("complete")
    }
  })
}(jQuery),
function(t) {
  var e = 5;
  t.widget("ui.slider", t.ui.mouse, {
    version: "1.10.3",
    widgetEventPrefix: "slide",
    options: {
      animate: !1,
      distance: 0,
      max: 100,
      min: 0,
      orientation: "horizontal",
      range: !1,
      step: 1,
      value: 0,
      values: null,
      change: null,
      slide: null,
      start: null,
      stop: null
    },
    _create: function() {
      this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget" + " ui-widget-content" + " ui-corner-all"), this._refresh(), this._setOption("disabled", this.options.disabled), this._animateOff = !1
    },
    _refresh: function() {
      this._createRange(), this._createHandles(), this._setupEvents(), this._refreshValue()
    },
    _createHandles: function() {
      var e, i, s = this.options,
        n = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),
        o = "<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",
        a = [];
      for (i = s.values && s.values.length || 1, n.length > i && (n.slice(i).remove(), n = n.slice(0, i)), e = n.length; i > e; e++) a.push(o);
      this.handles = n.add(t(a.join("")).appendTo(this.element)), this.handle = this.handles.eq(0), this.handles.each(function(e) {
        t(this).data("ui-slider-handle-index", e)
      })
    },
    _createRange: function() {
      var e = this.options,
        i = "";
      e.range ? (e.range === !0 && (e.values ? e.values.length && 2 !== e.values.length ? e.values = [e.values[0], e.values[0]] : t.isArray(e.values) && (e.values = e.values.slice(0)) : e.values = [this._valueMin(), this._valueMin()]), this.range && this.range.length ? this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({
        left: "",
        bottom: ""
      }) : (this.range = t("<div></div>").appendTo(this.element), i = "ui-slider-range ui-widget-header ui-corner-all"), this.range.addClass(i + ("min" === e.range || "max" === e.range ? " ui-slider-range-" + e.range : ""))) : this.range = t([])
    },
    _setupEvents: function() {
      var t = this.handles.add(this.range).filter("a");
      this._off(t), this._on(t, this._handleEvents), this._hoverable(t), this._focusable(t)
    },
    _destroy: function() {
      this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"), this._mouseDestroy()
    },
    _mouseCapture: function(e) {
      var i, s, n, o, a, r, h, l, c = this,
        u = this.options;
      return u.disabled ? !1 : (this.elementSize = {
        width: this.element.outerWidth(),
        height: this.element.outerHeight()
      }, this.elementOffset = this.element.offset(), i = {
        x: e.pageX,
        y: e.pageY
      }, s = this._normValueFromMouse(i), n = this._valueMax() - this._valueMin() + 1, this.handles.each(function(e) {
        var i = Math.abs(s - c.values(e));
        (n > i || n === i && (e === c._lastChangedValue || c.values(e) === u.min)) && (n = i, o = t(this), a = e)
      }), r = this._start(e, a), r === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = a, o.addClass("ui-state-active").focus(), h = o.offset(), l = !t(e.target).parents().addBack().is(".ui-slider-handle"), this._clickOffset = l ? {
        left: 0,
        top: 0
      } : {
        left: e.pageX - h.left - o.width() / 2,
        top: e.pageY - h.top - o.height() / 2 - (parseInt(o.css("borderTopWidth"), 10) || 0) - (parseInt(o.css("borderBottomWidth"), 10) || 0) + (parseInt(o.css("marginTop"), 10) || 0)
      }, this.handles.hasClass("ui-state-hover") || this._slide(e, a, s), this._animateOff = !0, !0))
    },
    _mouseStart: function() {
      return !0
    },
    _mouseDrag: function(t) {
      var e = {
          x: t.pageX,
          y: t.pageY
        },
        i = this._normValueFromMouse(e);
      return this._slide(t, this._handleIndex, i), !1
    },
    _mouseStop: function(t) {
      return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(t, this._handleIndex), this._change(t, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1
    },
    _detectOrientation: function() {
      this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal"
    },
    _normValueFromMouse: function(t) {
      var e, i, s, n, o;
      return "horizontal" === this.orientation ? (e = this.elementSize.width, i = t.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (e = this.elementSize.height, i = t.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), s = i / e, s > 1 && (s = 1), 0 > s && (s = 0), "vertical" === this.orientation && (s = 1 - s), n = this._valueMax() - this._valueMin(), o = this._valueMin() + s * n, this._trimAlignValue(o)
    },
    _start: function(t, e) {
      var i = {
        handle: this.handles[e],
        value: this.value()
      };
      return this.options.values && this.options.values.length && (i.value = this.values(e), i.values = this.values()), this._trigger("start", t, i)
    },
    _slide: function(t, e, i) {
      var s, n, o;
      this.options.values && this.options.values.length ? (s = this.values(e ? 0 : 1), 2 === this.options.values.length && this.options.range === !0 && (0 === e && i > s || 1 === e && s > i) && (i = s), i !== this.values(e) && (n = this.values(), n[e] = i, o = this._trigger("slide", t, {
        handle: this.handles[e],
        value: i,
        values: n
      }), s = this.values(e ? 0 : 1), o !== !1 && this.values(e, i, !0))) : i !== this.value() && (o = this._trigger("slide", t, {
        handle: this.handles[e],
        value: i
      }), o !== !1 && this.value(i))
    },
    _stop: function(t, e) {
      var i = {
        handle: this.handles[e],
        value: this.value()
      };
      this.options.values && this.options.values.length && (i.value = this.values(e), i.values = this.values()), this._trigger("stop", t, i)
    },
    _change: function(t, e) {
      if (!this._keySliding && !this._mouseSliding) {
        var i = {
          handle: this.handles[e],
          value: this.value()
        };
        this.options.values && this.options.values.length && (i.value = this.values(e), i.values = this.values()), this._lastChangedValue = e, this._trigger("change", t, i)
      }
    },
    value: function(t) {
      return arguments.length ? (this.options.value = this._trimAlignValue(t), this._refreshValue(), this._change(null, 0), undefined) : this._value()
    },
    values: function(e, i) {
      var s, n, o;
      if (arguments.length > 1) return this.options.values[e] = this._trimAlignValue(i), this._refreshValue(), this._change(null, e), undefined;
      if (!arguments.length) return this._values();
      if (!t.isArray(arguments[0])) return this.options.values && this.options.values.length ? this._values(e) : this.value();
      for (s = this.options.values, n = arguments[0], o = 0; s.length > o; o += 1) s[o] = this._trimAlignValue(n[o]), this._change(null, o);
      this._refreshValue()
    },
    _setOption: function(e, i) {
      var s, n = 0;
      switch ("range" === e && this.options.range === !0 && ("min" === i ? (this.options.value = this._values(0), this.options.values = null) : "max" === i && (this.options.value = this._values(this.options.values.length - 1), this.options.values = null)), t.isArray(this.options.values) && (n = this.options.values.length), t.Widget.prototype._setOption.apply(this, arguments), e) {
        case "orientation":
          this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
          break;
        case "value":
          this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
          break;
        case "values":
          for (this._animateOff = !0, this._refreshValue(), s = 0; n > s; s += 1) this._change(null, s);
          this._animateOff = !1;
          break;
        case "min":
        case "max":
          this._animateOff = !0, this._refreshValue(), this._animateOff = !1;
          break;
        case "range":
          this._animateOff = !0, this._refresh(), this._animateOff = !1
      }
    },
    _value: function() {
      var t = this.options.value;
      return t = this._trimAlignValue(t)
    },
    _values: function(t) {
      var e, i, s;
      if (arguments.length) return e = this.options.values[t], e = this._trimAlignValue(e);
      if (this.options.values && this.options.values.length) {
        for (i = this.options.values.slice(), s = 0; i.length > s; s += 1) i[s] = this._trimAlignValue(i[s]);
        return i
      }
      return []
    },
    _trimAlignValue: function(t) {
      if (this._valueMin() >= t) return this._valueMin();
      if (t >= this._valueMax()) return this._valueMax();
      var e = this.options.step > 0 ? this.options.step : 1,
        i = (t - this._valueMin()) % e,
        s = t - i;
      return 2 * Math.abs(i) >= e && (s += i > 0 ? e : -e), parseFloat(s.toFixed(5))
    },
    _valueMin: function() {
      return this.options.min
    },
    _valueMax: function() {
      return this.options.max
    },
    _refreshValue: function() {
      var e, i, s, n, o, a = this.options.range,
        r = this.options,
        h = this,
        l = this._animateOff ? !1 : r.animate,
        c = {};
      this.options.values && this.options.values.length ? this.handles.each(function(s) {
        i = 100 * ((h.values(s) - h._valueMin()) / (h._valueMax() - h._valueMin())), c["horizontal" === h.orientation ? "left" : "bottom"] = i + "%", t(this).stop(1, 1)[l ? "animate" : "css"](c, r.animate), h.options.range === !0 && ("horizontal" === h.orientation ? (0 === s && h.range.stop(1, 1)[l ? "animate" : "css"]({
          left: i + "%"
        }, r.animate), 1 === s && h.range[l ? "animate" : "css"]({
          width: i - e + "%"
        }, {
          queue: !1,
          duration: r.animate
        })) : (0 === s && h.range.stop(1, 1)[l ? "animate" : "css"]({
          bottom: i + "%"
        }, r.animate), 1 === s && h.range[l ? "animate" : "css"]({
          height: i - e + "%"
        }, {
          queue: !1,
          duration: r.animate
        }))), e = i
      }) : (s = this.value(), n = this._valueMin(), o = this._valueMax(), i = o !== n ? 100 * ((s - n) / (o - n)) : 0, c["horizontal" === this.orientation ? "left" : "bottom"] = i + "%", this.handle.stop(1, 1)[l ? "animate" : "css"](c, r.animate), "min" === a && "horizontal" === this.orientation && this.range.stop(1, 1)[l ? "animate" : "css"]({
        width: i + "%"
      }, r.animate), "max" === a && "horizontal" === this.orientation && this.range[l ? "animate" : "css"]({
        width: 100 - i + "%"
      }, {
        queue: !1,
        duration: r.animate
      }), "min" === a && "vertical" === this.orientation && this.range.stop(1, 1)[l ? "animate" : "css"]({
        height: i + "%"
      }, r.animate), "max" === a && "vertical" === this.orientation && this.range[l ? "animate" : "css"]({
        height: 100 - i + "%"
      }, {
        queue: !1,
        duration: r.animate
      }))
    },
    _handleEvents: {
      keydown: function(i) {
        var s, n, o, a, r = t(i.target).data("ui-slider-handle-index");
        switch (i.keyCode) {
          case t.ui.keyCode.HOME:
          case t.ui.keyCode.END:
          case t.ui.keyCode.PAGE_UP:
          case t.ui.keyCode.PAGE_DOWN:
          case t.ui.keyCode.UP:
          case t.ui.keyCode.RIGHT:
          case t.ui.keyCode.DOWN:
          case t.ui.keyCode.LEFT:
            if (i.preventDefault(), !this._keySliding && (this._keySliding = !0, t(i.target).addClass("ui-state-active"), s = this._start(i, r), s === !1)) return
        }
        switch (a = this.options.step, n = o = this.options.values && this.options.values.length ? this.values(r) : this.value(), i.keyCode) {
          case t.ui.keyCode.HOME:
            o = this._valueMin();
            break;
          case t.ui.keyCode.END:
            o = this._valueMax();
            break;
          case t.ui.keyCode.PAGE_UP:
            o = this._trimAlignValue(n + (this._valueMax() - this._valueMin()) / e);
            break;
          case t.ui.keyCode.PAGE_DOWN:
            o = this._trimAlignValue(n - (this._valueMax() - this._valueMin()) / e);
            break;
          case t.ui.keyCode.UP:
          case t.ui.keyCode.RIGHT:
            if (n === this._valueMax()) return;
            o = this._trimAlignValue(n + a);
            break;
          case t.ui.keyCode.DOWN:
          case t.ui.keyCode.LEFT:
            if (n === this._valueMin()) return;
            o = this._trimAlignValue(n - a)
        }
        this._slide(i, r, o)
      },
      click: function(t) {
        t.preventDefault()
      },
      keyup: function(e) {
        var i = t(e.target).data("ui-slider-handle-index");
        this._keySliding && (this._keySliding = !1, this._stop(e, i), this._change(e, i), t(e.target).removeClass("ui-state-active"))
      }
    }
  })
}(jQuery),
function(t) {
  function e(t) {
    return function() {
      var e = this.element.val();
      t.apply(this, arguments), this._refresh(), e !== this.element.val() && this._trigger("change")
    }
  }
  t.widget("ui.spinner", {
    version: "1.10.3",
    defaultElement: "<input>",
    widgetEventPrefix: "spin",
    options: {
      culture: null,
      icons: {
        down: "ui-icon-triangle-1-s",
        up: "ui-icon-triangle-1-n"
      },
      incremental: !0,
      max: null,
      min: null,
      numberFormat: null,
      page: 10,
      step: 1,
      change: null,
      spin: null,
      start: null,
      stop: null
    },
    _create: function() {
      this._setOption("max", this.options.max), this._setOption("min", this.options.min), this._setOption("step", this.options.step), this._value(this.element.val(), !0), this._draw(), this._on(this._events), this._refresh(), this._on(this.window, {
        beforeunload: function() {
          this.element.removeAttr("autocomplete")
        }
      })
    },
    _getCreateOptions: function() {
      var e = {},
        i = this.element;
      return t.each(["min", "max", "step"], function(t, s) {
        var n = i.attr(s);
        void 0 !== n && n.length && (e[s] = n)
      }), e
    },
    _events: {
      keydown: function(t) {
        this._start(t) && this._keydown(t) && t.preventDefault()
      },
      keyup: "_stop",
      focus: function() {
        this.previous = this.element.val()
      },
      blur: function(t) {
        return this.cancelBlur ? (delete this.cancelBlur, void 0) : (this._stop(), this._refresh(), this.previous !== this.element.val() && this._trigger("change", t), void 0)
      },
      mousewheel: function(t, e) {
        if (e) {
          if (!this.spinning && !this._start(t)) return !1;
          this._spin((e > 0 ? 1 : -1) * this.options.step, t), clearTimeout(this.mousewheelTimer), this.mousewheelTimer = this._delay(function() {
            this.spinning && this._stop(t)
          }, 100), t.preventDefault()
        }
      },
      "mousedown .ui-spinner-button": function(e) {
        function i() {
          var t = this.element[0] === this.document[0].activeElement;
          t || (this.element.focus(), this.previous = s, this._delay(function() {
            this.previous = s
          }))
        }
        var s;
        s = this.element[0] === this.document[0].activeElement ? this.previous : this.element.val(), e.preventDefault(), i.call(this), this.cancelBlur = !0, this._delay(function() {
          delete this.cancelBlur, i.call(this)
        }), this._start(e) !== !1 && this._repeat(null, t(e.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, e)
      },
      "mouseup .ui-spinner-button": "_stop",
      "mouseenter .ui-spinner-button": function(e) {
        return t(e.currentTarget).hasClass("ui-state-active") ? this._start(e) === !1 ? !1 : (this._repeat(null, t(e.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, e), void 0) : void 0
      },
      "mouseleave .ui-spinner-button": "_stop"
    },
    _draw: function() {
      var t = this.uiSpinner = this.element.addClass("ui-spinner-input").attr("autocomplete", "off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());
      this.element.attr("role", "spinbutton"), this.buttons = t.find(".ui-spinner-button").attr("tabIndex", -1).button().removeClass("ui-corner-all"), this.buttons.height() > Math.ceil(.5 * t.height()) && t.height() > 0 && t.height(t.height()), this.options.disabled && this.disable()
    },
    _keydown: function(e) {
      var i = this.options,
        s = t.ui.keyCode;
      switch (e.keyCode) {
        case s.UP:
          return this._repeat(null, 1, e), !0;
        case s.DOWN:
          return this._repeat(null, -1, e), !0;
        case s.PAGE_UP:
          return this._repeat(null, i.page, e), !0;
        case s.PAGE_DOWN:
          return this._repeat(null, -i.page, e), !0
      }
      return !1
    },
    _uiSpinnerHtml: function() {
      return "<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"
    },
    _buttonHtml: function() {
      return "<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon " + this.options.icons.up + "'>&#9650;</span>" + "</a>" + "<a class='ui-spinner-button ui-spinner-down ui-corner-br'>" + "<span class='ui-icon " + this.options.icons.down + "'>&#9660;</span>" + "</a>"
    },
    _start: function(t) {
      return this.spinning || this._trigger("start", t) !== !1 ? (this.counter || (this.counter = 1), this.spinning = !0, !0) : !1
    },
    _repeat: function(t, e, i) {
      t = t || 500, clearTimeout(this.timer), this.timer = this._delay(function() {
        this._repeat(40, e, i)
      }, t), this._spin(e * this.options.step, i)
    },
    _spin: function(t, e) {
      var i = this.value() || 0;
      this.counter || (this.counter = 1), i = this._adjustValue(i + t * this._increment(this.counter)), this.spinning && this._trigger("spin", e, {
        value: i
      }) === !1 || (this._value(i), this.counter++)
    },
    _increment: function(e) {
      var i = this.options.incremental;
      return i ? t.isFunction(i) ? i(e) : Math.floor(e * e * e / 5e4 - e * e / 500 + 17 * e / 200 + 1) : 1
    },
    _precision: function() {
      var t = this._precisionOf(this.options.step);
      return null !== this.options.min && (t = Math.max(t, this._precisionOf(this.options.min))), t
    },
    _precisionOf: function(t) {
      var e = "" + t,
        i = e.indexOf(".");
      return -1 === i ? 0 : e.length - i - 1
    },
    _adjustValue: function(t) {
      var e, i, s = this.options;
      return e = null !== s.min ? s.min : 0, i = t - e, i = Math.round(i / s.step) * s.step, t = e + i, t = parseFloat(t.toFixed(this._precision())), null !== s.max && t > s.max ? s.max : null !== s.min && s.min > t ? s.min : t
    },
    _stop: function(t) {
      this.spinning && (clearTimeout(this.timer), clearTimeout(this.mousewheelTimer), this.counter = 0, this.spinning = !1, this._trigger("stop", t))
    },
    _setOption: function(t, e) {
      if ("culture" === t || "numberFormat" === t) {
        var i = this._parse(this.element.val());
        return this.options[t] = e, this.element.val(this._format(i)), void 0
      }("max" === t || "min" === t || "step" === t) && "string" == typeof e && (e = this._parse(e)), "icons" === t && (this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up), this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)), this._super(t, e), "disabled" === t && (e ? (this.element.prop("disabled", !0), this.buttons.button("disable")) : (this.element.prop("disabled", !1), this.buttons.button("enable")))
    },
    _setOptions: e(function(t) {
      this._super(t), this._value(this.element.val())
    }),
    _parse: function(t) {
      return "string" == typeof t && "" !== t && (t = window.Globalize && this.options.numberFormat ? Globalize.parseFloat(t, 10, this.options.culture) : +t), "" === t || isNaN(t) ? null : t
    },
    _format: function(t) {
      return "" === t ? "" : window.Globalize && this.options.numberFormat ? Globalize.format(t, this.options.numberFormat, this.options.culture) : t
    },
    _refresh: function() {
      this.element.attr({
        "aria-valuemin": this.options.min,
        "aria-valuemax": this.options.max,
        "aria-valuenow": this._parse(this.element.val())
      })
    },
    _value: function(t, e) {
      var i;
      "" !== t && (i = this._parse(t), null !== i && (e || (i = this._adjustValue(i)), t = this._format(i))), this.element.val(t), this._refresh()
    },
    _destroy: function() {
      this.element.removeClass("ui-spinner-input").prop("disabled", !1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.uiSpinner.replaceWith(this.element)
    },
    stepUp: e(function(t) {
      this._stepUp(t)
    }),
    _stepUp: function(t) {
      this._start() && (this._spin((t || 1) * this.options.step), this._stop())
    },
    stepDown: e(function(t) {
      this._stepDown(t)
    }),
    _stepDown: function(t) {
      this._start() && (this._spin((t || 1) * -this.options.step), this._stop())
    },
    pageUp: e(function(t) {
      this._stepUp((t || 1) * this.options.page)
    }),
    pageDown: e(function(t) {
      this._stepDown((t || 1) * this.options.page)
    }),
    value: function(t) {
      return arguments.length ? (e(this._value).call(this, t), void 0) : this._parse(this.element.val())
    },
    widget: function() {
      return this.uiSpinner
    }
  })
}(jQuery),
function(t, e) {
  function i() {
    return ++n
  }

  function s(t) {
    return t.hash.length > 1 && decodeURIComponent(t.href.replace(o, "")) === decodeURIComponent(location.href.replace(o, ""))
  }
  var n = 0,
    o = /#.*$/;
  t.widget("ui.tabs", {
    version: "1.10.3",
    delay: 300,
    options: {
      active: null,
      collapsible: !1,
      event: "click",
      heightStyle: "content",
      hide: null,
      show: null,
      activate: null,
      beforeActivate: null,
      beforeLoad: null,
      load: null
    },
    _create: function() {
      var e = this,
        i = this.options;
      this.running = !1, this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible", i.collapsible).delegate(".ui-tabs-nav > li", "mousedown" + this.eventNamespace, function(e) {
        t(this).is(".ui-state-disabled") && e.preventDefault()
      }).delegate(".ui-tabs-anchor", "focus" + this.eventNamespace, function() {
        t(this).closest("li").is(".ui-state-disabled") && this.blur()
      }), this._processTabs(), i.active = this._initialActive(), t.isArray(i.disabled) && (i.disabled = t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"), function(t) {
        return e.tabs.index(t)
      }))).sort()), this.active = this.options.active !== !1 && this.anchors.length ? this._findActive(i.active) : t(), this._refresh(), this.active.length && this.load(i.active)
    },
    _initialActive: function() {
      var i = this.options.active,
        s = this.options.collapsible,
        n = location.hash.substring(1);
      return null === i && (n && this.tabs.each(function(s, o) {
        return t(o).attr("aria-controls") === n ? (i = s, !1) : e
      }), null === i && (i = this.tabs.index(this.tabs.filter(".ui-tabs-active"))), (null === i || -1 === i) && (i = this.tabs.length ? 0 : !1)), i !== !1 && (i = this.tabs.index(this.tabs.eq(i)), -1 === i && (i = s ? !1 : 0)), !s && i === !1 && this.anchors.length && (i = 0), i
    },
    _getCreateEventData: function() {
      return {
        tab: this.active,
        panel: this.active.length ? this._getPanelForTab(this.active) : t()
      }
    },
    _tabKeydown: function(i) {
      var s = t(this.document[0].activeElement).closest("li"),
        n = this.tabs.index(s),
        o = !0;
      if (!this._handlePageNav(i)) {
        switch (i.keyCode) {
          case t.ui.keyCode.RIGHT:
          case t.ui.keyCode.DOWN:
            n++;
            break;
          case t.ui.keyCode.UP:
          case t.ui.keyCode.LEFT:
            o = !1, n--;
            break;
          case t.ui.keyCode.END:
            n = this.anchors.length - 1;
            break;
          case t.ui.keyCode.HOME:
            n = 0;
            break;
          case t.ui.keyCode.SPACE:
            return i.preventDefault(), clearTimeout(this.activating), this._activate(n), e;
          case t.ui.keyCode.ENTER:
            return i.preventDefault(), clearTimeout(this.activating), this._activate(n === this.options.active ? !1 : n), e;
          default:
            return
        }
        i.preventDefault(), clearTimeout(this.activating), n = this._focusNextTab(n, o), i.ctrlKey || (s.attr("aria-selected", "false"), this.tabs.eq(n).attr("aria-selected", "true"), this.activating = this._delay(function() {
          this.option("active", n)
        }, this.delay))
      }
    },
    _panelKeydown: function(e) {
      this._handlePageNav(e) || e.ctrlKey && e.keyCode === t.ui.keyCode.UP && (e.preventDefault(), this.active.focus())
    },
    _handlePageNav: function(i) {
      return i.altKey && i.keyCode === t.ui.keyCode.PAGE_UP ? (this._activate(this._focusNextTab(this.options.active - 1, !1)), !0) : i.altKey && i.keyCode === t.ui.keyCode.PAGE_DOWN ? (this._activate(this._focusNextTab(this.options.active + 1, !0)), !0) : e
    },
    _findNextTab: function(e, i) {
      function s() {
        return e > n && (e = 0), 0 > e && (e = n), e
      }
      for (var n = this.tabs.length - 1; - 1 !== t.inArray(s(), this.options.disabled);) e = i ? e + 1 : e - 1;
      return e
    },
    _focusNextTab: function(t, e) {
      return t = this._findNextTab(t, e), this.tabs.eq(t).focus(), t
    },
    _setOption: function(t, i) {
      return "active" === t ? (this._activate(i), e) : "disabled" === t ? (this._setupDisabled(i), e) : (this._super(t, i), "collapsible" === t && (this.element.toggleClass("ui-tabs-collapsible", i), i || this.options.active !== !1 || this._activate(0)), "event" === t && this._setupEvents(i), "heightStyle" === t && this._setupHeightStyle(i), e)
    },
    _tabId: function(t) {
      return t.attr("aria-controls") || "ui-tabs-" + i()
    },
    _sanitizeSelector: function(t) {
      return t ? t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g, "\\$&") : ""
    },
    refresh: function() {
      var e = this.options,
        i = this.tablist.children(":has(a[href])");
      e.disabled = t.map(i.filter(".ui-state-disabled"), function(t) {
        return i.index(t)
      }), this._processTabs(), e.active !== !1 && this.anchors.length ? this.active.length && !t.contains(this.tablist[0], this.active[0]) ? this.tabs.length === e.disabled.length ? (e.active = !1, this.active = t()) : this._activate(this._findNextTab(Math.max(0, e.active - 1), !1)) : e.active = this.tabs.index(this.active) : (e.active = !1, this.active = t()), this._refresh()
    },
    _refresh: function() {
      this._setupDisabled(this.options.disabled), this._setupEvents(this.options.event), this._setupHeightStyle(this.options.heightStyle), this.tabs.not(this.active).attr({
        "aria-selected": "false",
        tabIndex: -1
      }), this.panels.not(this._getPanelForTab(this.active)).hide().attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }), this.active.length ? (this.active.addClass("ui-tabs-active ui-state-active").attr({
        "aria-selected": "true",
        tabIndex: 0
      }), this._getPanelForTab(this.active).show().attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      })) : this.tabs.eq(0).attr("tabIndex", 0)
    },
    _processTabs: function() {
      var e = this;
      this.tablist = this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role", "tablist"), this.tabs = this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({
        role: "tab",
        tabIndex: -1
      }), this.anchors = this.tabs.map(function() {
        return t("a", this)[0]
      }).addClass("ui-tabs-anchor").attr({
        role: "presentation",
        tabIndex: -1
      }), this.panels = t(), this.anchors.each(function(i, n) {
        var o, a, r, h = t(n).uniqueId().attr("id"),
          l = t(n).closest("li"),
          c = l.attr("aria-controls");
        s(n) ? (o = n.hash, a = e.element.find(e._sanitizeSelector(o))) : (r = e._tabId(l), o = "#" + r, a = e.element.find(o), a.length || (a = e._createPanel(r), a.insertAfter(e.panels[i - 1] || e.tablist)), a.attr("aria-live", "polite")), a.length && (e.panels = e.panels.add(a)), c && l.data("ui-tabs-aria-controls", c), l.attr({
          "aria-controls": o.substring(1),
          "aria-labelledby": h
        }), a.attr("aria-labelledby", h)
      }), this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role", "tabpanel")
    },
    _getList: function() {
      return this.element.find("ol,ul").eq(0)
    },
    _createPanel: function(e) {
      return t("<div>").attr("id", e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy", !0)
    },
    _setupDisabled: function(e) {
      t.isArray(e) && (e.length ? e.length === this.anchors.length && (e = !0) : e = !1);
      for (var i, s = 0; i = this.tabs[s]; s++) e === !0 || -1 !== t.inArray(s, e) ? t(i).addClass("ui-state-disabled").attr("aria-disabled", "true") : t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");
      this.options.disabled = e
    },
    _setupEvents: function(e) {
      var i = {
        click: function(t) {
          t.preventDefault()
        }
      };
      e && t.each(e.split(" "), function(t, e) {
        i[e] = "_eventHandler"
      }), this._off(this.anchors.add(this.tabs).add(this.panels)), this._on(this.anchors, i), this._on(this.tabs, {
        keydown: "_tabKeydown"
      }), this._on(this.panels, {
        keydown: "_panelKeydown"
      }), this._focusable(this.tabs), this._hoverable(this.tabs)
    },
    _setupHeightStyle: function(e) {
      var i, s = this.element.parent();
      "fill" === e ? (i = s.height(), i -= this.element.outerHeight() - this.element.height(), this.element.siblings(":visible").each(function() {
        var e = t(this),
          s = e.css("position");
        "absolute" !== s && "fixed" !== s && (i -= e.outerHeight(!0))
      }), this.element.children().not(this.panels).each(function() {
        i -= t(this).outerHeight(!0)
      }), this.panels.each(function() {
        t(this).height(Math.max(0, i - t(this).innerHeight() + t(this).height()))
      }).css("overflow", "auto")) : "auto" === e && (i = 0, this.panels.each(function() {
        i = Math.max(i, t(this).height("").height())
      }).height(i))
    },
    _eventHandler: function(e) {
      var i = this.options,
        s = this.active,
        n = t(e.currentTarget),
        o = n.closest("li"),
        a = o[0] === s[0],
        r = a && i.collapsible,
        h = r ? t() : this._getPanelForTab(o),
        l = s.length ? this._getPanelForTab(s) : t(),
        c = {
          oldTab: s,
          oldPanel: l,
          newTab: r ? t() : o,
          newPanel: h
        };
      e.preventDefault(), o.hasClass("ui-state-disabled") || o.hasClass("ui-tabs-loading") || this.running || a && !i.collapsible || this._trigger("beforeActivate", e, c) === !1 || (i.active = r ? !1 : this.tabs.index(o), this.active = a ? t() : o, this.xhr && this.xhr.abort(), l.length || h.length || t.error("jQuery UI Tabs: Mismatching fragment identifier."), h.length && this.load(this.tabs.index(o), e), this._toggle(e, c))
    },
    _toggle: function(e, i) {
      function s() {
        o.running = !1, o._trigger("activate", e, i)
      }

      function n() {
        i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"), a.length && o.options.show ? o._show(a, o.options.show, s) : (a.show(), s())
      }
      var o = this,
        a = i.newPanel,
        r = i.oldPanel;
      this.running = !0, r.length && this.options.hide ? this._hide(r, this.options.hide, function() {
        i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), n()
      }) : (i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), r.hide(), n()), r.attr({
        "aria-expanded": "false",
        "aria-hidden": "true"
      }), i.oldTab.attr("aria-selected", "false"), a.length && r.length ? i.oldTab.attr("tabIndex", -1) : a.length && this.tabs.filter(function() {
        return 0 === t(this).attr("tabIndex")
      }).attr("tabIndex", -1), a.attr({
        "aria-expanded": "true",
        "aria-hidden": "false"
      }), i.newTab.attr({
        "aria-selected": "true",
        tabIndex: 0
      })
    },
    _activate: function(e) {
      var i, s = this._findActive(e);
      s[0] !== this.active[0] && (s.length || (s = this.active), i = s.find(".ui-tabs-anchor")[0], this._eventHandler({
        target: i,
        currentTarget: i,
        preventDefault: t.noop
      }))
    },
    _findActive: function(e) {
      return e === !1 ? t() : this.tabs.eq(e)
    },
    _getIndex: function(t) {
      return "string" == typeof t && (t = this.anchors.index(this.anchors.filter("[href$='" + t + "']"))), t
    },
    _destroy: function() {
      this.xhr && this.xhr.abort(), this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"), this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"), this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(), this.tabs.add(this.panels).each(function() {
        t.data(this, "ui-tabs-destroy") ? t(this).remove() : t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")
      }), this.tabs.each(function() {
        var e = t(this),
          i = e.data("ui-tabs-aria-controls");
        i ? e.attr("aria-controls", i).removeData("ui-tabs-aria-controls") : e.removeAttr("aria-controls")
      }), this.panels.show(), "content" !== this.options.heightStyle && this.panels.css("height", "")
    },
    enable: function(i) {
      var s = this.options.disabled;
      s !== !1 && (i === e ? s = !1 : (i = this._getIndex(i), s = t.isArray(s) ? t.map(s, function(t) {
        return t !== i ? t : null
      }) : t.map(this.tabs, function(t, e) {
        return e !== i ? e : null
      })), this._setupDisabled(s))
    },
    disable: function(i) {
      var s = this.options.disabled;
      if (s !== !0) {
        if (i === e) s = !0;
        else {
          if (i = this._getIndex(i), -1 !== t.inArray(i, s)) return;
          s = t.isArray(s) ? t.merge([i], s).sort() : [i]
        }
        this._setupDisabled(s)
      }
    },
    load: function(e, i) {
      e = this._getIndex(e);
      var n = this,
        o = this.tabs.eq(e),
        a = o.find(".ui-tabs-anchor"),
        r = this._getPanelForTab(o),
        h = {
          tab: o,
          panel: r
        };
      s(a[0]) || (this.xhr = t.ajax(this._ajaxSettings(a, i, h)), this.xhr && "canceled" !== this.xhr.statusText && (o.addClass("ui-tabs-loading"), r.attr("aria-busy", "true"), this.xhr.success(function(t) {
        setTimeout(function() {
          r.html(t), n._trigger("load", i, h)
        }, 1)
      }).complete(function(t, e) {
        setTimeout(function() {
          "abort" === e && n.panels.stop(!1, !0), o.removeClass("ui-tabs-loading"), r.removeAttr("aria-busy"), t === n.xhr && delete n.xhr
        }, 1)
      })))
    },
    _ajaxSettings: function(e, i, s) {
      var n = this;
      return {
        url: e.attr("href"),
        beforeSend: function(e, o) {
          return n._trigger("beforeLoad", i, t.extend({
            jqXHR: e,
            ajaxSettings: o
          }, s))
        }
      }
    },
    _getPanelForTab: function(e) {
      var i = t(e).attr("aria-controls");
      return this.element.find(this._sanitizeSelector("#" + i))
    }
  })
}(jQuery),
function(t) {
  function e(e, i) {
    var s = (e.attr("aria-describedby") || "").split(/\s+/);
    s.push(i), e.data("ui-tooltip-id", i).attr("aria-describedby", t.trim(s.join(" ")))
  }

  function i(e) {
    var i = e.data("ui-tooltip-id"),
      s = (e.attr("aria-describedby") || "").split(/\s+/),
      n = t.inArray(i, s); - 1 !== n && s.splice(n, 1), e.removeData("ui-tooltip-id"), s = t.trim(s.join(" ")), s ? e.attr("aria-describedby", s) : e.removeAttr("aria-describedby")
  }
  var s = 0;
  t.widget("ui.tooltip", {
    version: "1.10.3",
    options: {
      content: function() {
        var e = t(this).attr("title") || "";
        return t("<a>").text(e).html()
      },
      hide: !0,
      items: "[title]:not([disabled])",
      position: {
        my: "left top+15",
        at: "left bottom",
        collision: "flipfit flip"
      },
      show: !0,
      tooltipClass: null,
      track: !1,
      close: null,
      open: null
    },
    _create: function() {
      this._on({
        mouseover: "open",
        focusin: "open"
      }), this.tooltips = {}, this.parents = {}, this.options.disabled && this._disable()
    },
    _setOption: function(e, i) {
      var s = this;
      return "disabled" === e ? (this[i ? "_disable" : "_enable"](), this.options[e] = i, void 0) : (this._super(e, i), "content" === e && t.each(this.tooltips, function(t, e) {
        s._updateContent(e)
      }), void 0)
    },
    _disable: function() {
      var e = this;
      t.each(this.tooltips, function(i, s) {
        var n = t.Event("blur");
        n.target = n.currentTarget = s[0], e.close(n, !0)
      }), this.element.find(this.options.items).addBack().each(function() {
        var e = t(this);
        e.is("[title]") && e.data("ui-tooltip-title", e.attr("title")).attr("title", "")
      })
    },
    _enable: function() {
      this.element.find(this.options.items).addBack().each(function() {
        var e = t(this);
        e.data("ui-tooltip-title") && e.attr("title", e.data("ui-tooltip-title"))
      })
    },
    open: function(e) {
      var i = this,
        s = t(e ? e.target : this.element).closest(this.options.items);
      s.length && !s.data("ui-tooltip-id") && (s.attr("title") && s.data("ui-tooltip-title", s.attr("title")), s.data("ui-tooltip-open", !0), e && "mouseover" === e.type && s.parents().each(function() {
        var e, s = t(this);
        s.data("ui-tooltip-open") && (e = t.Event("blur"), e.target = e.currentTarget = this, i.close(e, !0)), s.attr("title") && (s.uniqueId(), i.parents[this.id] = {
          element: this,
          title: s.attr("title")
        }, s.attr("title", ""))
      }), this._updateContent(s, e))
    },
    _updateContent: function(t, e) {
      var i, s = this.options.content,
        n = this,
        o = e ? e.type : null;
      return "string" == typeof s ? this._open(e, t, s) : (i = s.call(t[0], function(i) {
        t.data("ui-tooltip-open") && n._delay(function() {
          e && (e.type = o), this._open(e, t, i)
        })
      }), i && this._open(e, t, i), void 0)
    },
    _open: function(i, s, n) {
      function o(t) {
        l.of = t, a.is(":hidden") || a.position(l)
      }
      var a, r, h, l = t.extend({}, this.options.position);
      if (n) {
        if (a = this._find(s), a.length) return a.find(".ui-tooltip-content").html(n), void 0;
        s.is("[title]") && (i && "mouseover" === i.type ? s.attr("title", "") : s.removeAttr("title")), a = this._tooltip(s), e(s, a.attr("id")), a.find(".ui-tooltip-content").html(n), this.options.track && i && /^mouse/.test(i.type) ? (this._on(this.document, {
          mousemove: o
        }), o(i)) : a.position(t.extend({
          of: s
        }, this.options.position)), a.hide(), this._show(a, this.options.show), this.options.show && this.options.show.delay && (h = this.delayedShow = setInterval(function() {
          a.is(":visible") && (o(l.of), clearInterval(h))
        }, t.fx.interval)), this._trigger("open", i, {
          tooltip: a
        }), r = {
          keyup: function(e) {
            if (e.keyCode === t.ui.keyCode.ESCAPE) {
              var i = t.Event(e);
              i.currentTarget = s[0], this.close(i, !0)
            }
          },
          remove: function() {
            this._removeTooltip(a)
          }
        }, i && "mouseover" !== i.type || (r.mouseleave = "close"), i && "focusin" !== i.type || (r.focusout = "close"), this._on(!0, s, r)
      }
    },
    close: function(e) {
      var s = this,
        n = t(e ? e.currentTarget : this.element),
        o = this._find(n);
      this.closing || (clearInterval(this.delayedShow), n.data("ui-tooltip-title") && n.attr("title", n.data("ui-tooltip-title")), i(n), o.stop(!0), this._hide(o, this.options.hide, function() {
        s._removeTooltip(t(this))
      }), n.removeData("ui-tooltip-open"), this._off(n, "mouseleave focusout keyup"), n[0] !== this.element[0] && this._off(n, "remove"), this._off(this.document, "mousemove"), e && "mouseleave" === e.type && t.each(this.parents, function(e, i) {
        t(i.element).attr("title", i.title), delete s.parents[e]
      }), this.closing = !0, this._trigger("close", e, {
        tooltip: o
      }), this.closing = !1)
    },
    _tooltip: function(e) {
      var i = "ui-tooltip-" + s++,
        n = t("<div>").attr({
          id: i,
          role: "tooltip"
        }).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content " + (this.options.tooltipClass || ""));
      return t("<div>").addClass("ui-tooltip-content").appendTo(n), n.appendTo(this.document[0].body), this.tooltips[i] = e, n
    },
    _find: function(e) {
      var i = e.data("ui-tooltip-id");
      return i ? t("#" + i) : t()
    },
    _removeTooltip: function(t) {
      t.remove(), delete this.tooltips[t.attr("id")]
    },
    _destroy: function() {
      var e = this;
      t.each(this.tooltips, function(i, s) {
        var n = t.Event("blur");
        n.target = n.currentTarget = s[0], e.close(n, !0), t("#" + i).remove(), s.data("ui-tooltip-title") && (s.attr("title", s.data("ui-tooltip-title")), s.removeData("ui-tooltip-title"))
      })
    }
  })
}(jQuery);
(function(t, e) {
  "use strict";
  var n, i = t.document;
  n = function() {
    var n, s, r, o, a, l, c, u, f, d, h, p, y = {},
      b = {},
      m = !1,
      v = {
        ENTER: 13,
        ESC: 27,
        SPACE: 32
      },
      g = [];
    return b = {
      buttons: {
        holder: '<nav class="alertify-buttons">{{buttons}}</nav>',
        submit: '<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',
        ok: '<a href="#" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</a>',
        cancel: '<a href="#" class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</a>'
      },
      input: '<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>',
      message: '<p class="alertify-message">{{message}}</p>',
      log: '<article class="alertify-log{{class}}">{{message}}</article>'
    }, p = function() {
      var t, n, s = !1,
        r = i.createElement("fakeelement"),
        o = {
          WebkitTransition: "webkitTransitionEnd",
          MozTransition: "transitionend",
          OTransition: "otransitionend",
          transition: "transitionend"
        };
      for (t in o)
        if (r.style[t] !== e) {
          n = o[t], s = !0;
          break
        }
      return {
        type: n,
        supported: s
      }
    }, n = function(t) {
      return i.getElementById(t)
    }, y = {
      labels: {
        ok: "OK",
        cancel: "Cancel"
      },
      delay: 5e3,
      buttonReverse: !1,
      buttonFocus: "ok",
      transition: e,
      addListeners: function(t) {
        var n, a, l, c, u, f = r !== e,
          p = s !== e,
          y = h !== e,
          b = "",
          m = this;
        n = function(n) {
          return n.preventDefault !== e && n.preventDefault(), l(n), h !== e && (b = h.value), "function" == typeof t && (h !== e ? t(!0, b) : t(!0)), !1
        }, a = function(n) {
          return n.preventDefault !== e && n.preventDefault(), l(n), "function" == typeof t && t(!1), !1
        }, l = function() {
          m.hide(), m.unbind(i.body, "keyup", c), m.unbind(o, "focus", u), y && m.unbind(d, "submit", n), f && m.unbind(r, "click", n), p && m.unbind(s, "click", a)
        }, c = function(t) {
          var e = t.keyCode;
          e !== v.SPACE || y || n(t), e === v.ESC && p && a(t)
        }, u = function() {
          y ? h.focus() : !p || m.buttonReverse ? r.focus() : s.focus()
        }, this.bind(o, "focus", u), f && this.bind(r, "click", n), p && this.bind(s, "click", a), this.bind(i.body, "keyup", c), y && this.bind(d, "submit", n), this.transition.supported || this.setFocus()
      },
      bind: function(t, e, n) {
        "function" == typeof t.addEventListener ? t.addEventListener(e, n, !1) : t.attachEvent && t.attachEvent("on" + e, n)
      },
      handleErrors: function() {
        if (t.onerror !== e) {
          var n = this;
          return t.onerror = function(t, e, i) {
            n.error("[" + t + " on line " + i + " of " + e + "]", 0)
          }, !0
        }
        return !1
      },
      appendButtons: function(t, e) {
        return this.buttonReverse ? e + t : t + e
      },
      build: function(t) {
        var e = "",
          n = t.type,
          i = t.message,
          s = t.cssClass || "";
        switch (e += '<div class="alertify-dialog">', "none" === y.buttonFocus && (e += '<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>'), "prompt" === n && (e += '<form id="alertify-form">'), e += '<article class="alertify-inner">', e += b.message.replace("{{message}}", i), "prompt" === n && (e += b.input), e += b.buttons.holder, e += "</article>", "prompt" === n && (e += "</form>"), e += '<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>', e += "</div>", n) {
          case "confirm":
            e = e.replace("{{buttons}}", this.appendButtons(b.buttons.cancel, b.buttons.ok)), e = e.replace("{{ok}}", this.labels.ok).replace("{{cancel}}", this.labels.cancel);
            break;
          case "prompt":
            e = e.replace("{{buttons}}", this.appendButtons(b.buttons.cancel, b.buttons.submit)), e = e.replace("{{ok}}", this.labels.ok).replace("{{cancel}}", this.labels.cancel);
            break;
          case "alert":
            e = e.replace("{{buttons}}", b.buttons.ok), e = e.replace("{{ok}}", this.labels.ok);
            break;
          default:
        }
        return u.className = "alertify alertify-" + n + " " + s, c.className = "alertify-cover", e
      },
      close: function(t, n) {
        var i, s, r = n && !isNaN(n) ? +n : this.delay,
          o = this;
        this.bind(t, "click", function() {
          i(t)
        }), s = function(t) {
          t.stopPropagation(), o.unbind(this, o.transition.type, s), f.removeChild(this), f.hasChildNodes() || (f.className += " alertify-logs-hidden")
        }, i = function(t) {
          t !== e && t.parentNode === f && (o.transition.supported ? (o.bind(t, o.transition.type, s), t.className += " alertify-log-hide") : (f.removeChild(t), f.hasChildNodes() || (f.className += " alertify-logs-hidden")))
        }, 0 !== n && setTimeout(function() {
          i(t)
        }, r)
      },
      dialog: function(t, n, s, r, o) {
        l = i.activeElement;
        var a = function() {
          f && null !== f.scrollTop && c && null !== c.scrollTop || a()
        };
        if ("string" != typeof t) throw Error("message must be a string");
        if ("string" != typeof n) throw Error("type must be a string");
        if (s !== e && "function" != typeof s) throw Error("fn must be a function");
        return "function" == typeof this.init && (this.init(), a()), g.push({
          type: n,
          message: t,
          callback: s,
          placeholder: r,
          cssClass: o
        }), m || this.setup(), this
      },
      extend: function(t) {
        if ("string" != typeof t) throw Error("extend method must have exactly one paramter");
        return function(e, n) {
          return this.log(e, t, n), this
        }
      },
      hide: function() {
        var t, e = this;
        g.splice(0, 1), g.length > 0 ? this.setup(!0) : (m = !1, t = function(n) {
          n.stopPropagation(), u.className += " alertify-isHidden", e.unbind(u, e.transition.type, t)
        }, this.transition.supported ? (this.bind(u, this.transition.type, t), u.className = "alertify alertify-hide alertify-hidden") : u.className = "alertify alertify-hide alertify-hidden alertify-isHidden", c.className = "alertify-cover alertify-cover-hidden", l.focus())
      },
      init: function() {
        i.createElement("nav"), i.createElement("article"), i.createElement("section"), c = i.createElement("div"), c.setAttribute("id", "alertify-cover"), c.className = "alertify-cover alertify-cover-hidden", i.body.appendChild(c), u = i.createElement("section"), u.setAttribute("id", "alertify"), u.className = "alertify alertify-hidden", i.body.appendChild(u), f = i.createElement("section"), f.setAttribute("id", "alertify-logs"), f.className = "alertify-logs alertify-logs-hidden", i.body.appendChild(f), i.body.setAttribute("tabindex", "0"), this.transition = p(), delete this.init
      },
      log: function(t, e, n) {
        var i = function() {
          f && null !== f.scrollTop || i()
        };
        return "function" == typeof this.init && (this.init(), i()), f.className = "alertify-logs", this.notify(t, e, n), this
      },
      notify: function(t, e, n) {
        var s = i.createElement("article");
        s.className = "alertify-log" + ("string" == typeof e && "" !== e ? " alertify-log-" + e : ""), s.innerHTML = t, f.appendChild(s), setTimeout(function() {
          s.className = s.className + " alertify-log-show"
        }, 50), this.close(s, n)
      },
      set: function(t) {
        var e;
        if ("object" != typeof t && t instanceof Array) throw Error("args must be an object");
        for (e in t) t.hasOwnProperty(e) && (this[e] = t[e])
      },
      setFocus: function() {
        h ? (h.focus(), h.select()) : a.focus()
      },
      setup: function(t) {
        var i, l = g[0],
          c = this;
        m = !0, i = function(t) {
          t.stopPropagation(), c.setFocus(), c.unbind(u, c.transition.type, i)
        }, this.transition.supported && !t && this.bind(u, this.transition.type, i), u.innerHTML = this.build(l), o = n("alertify-resetFocus"), r = n("alertify-ok") || e, s = n("alertify-cancel") || e, a = "cancel" === y.buttonFocus ? s : "none" === y.buttonFocus ? n("alertify-noneFocus") : r, h = n("alertify-text") || e, d = n("alertify-form") || e, "string" == typeof l.placeholder && "" !== l.placeholder && (h.value = l.placeholder), t && this.setFocus(), this.addListeners(l.callback)
      },
      unbind: function(t, e, n) {
        "function" == typeof t.removeEventListener ? t.removeEventListener(e, n, !1) : t.detachEvent && t.detachEvent("on" + e, n)
      }
    }, {
      alert: function(t, e, n) {
        return y.dialog(t, "alert", e, "", n), this
      },
      confirm: function(t, e, n) {
        return y.dialog(t, "confirm", e, "", n), this
      },
      extend: y.extend,
      init: y.init,
      log: function(t, e, n) {
        return y.log(t, e, n), this
      },
      prompt: function(t, e, n, i) {
        return y.dialog(t, "prompt", e, n, i), this
      },
      success: function(t, e) {
        return y.log(t, "success", e), this
      },
      error: function(t, e) {
        return y.log(t, "error", e), this
      },
      set: function(t) {
        y.set(t)
      },
      labels: y.labels,
      debug: y.handleErrors
    }
  }, "function" == typeof define ? define([], function() {
    return new n
  }) : t.alertify === e && (t.alertify = new n)
})(this);
var io = "undefined" == typeof module ? {} : module.exports;
(function() {
  (function(a, b) {
    var c = a;
    c.version = "0.9.11", c.protocol = 1, c.transports = [], c.j = [], c.sockets = {}, c.connect = function(a, d) {
      var e = c.util.parseUri(a),
        f, g;
      b && b.location && (e.protocol = e.protocol || b.location.protocol.slice(0, -1), e.host = e.host || (b.document ? b.document.domain : b.location.hostname), e.port = e.port || b.location.port), f = c.util.uniqueUri(e);
      var h = {
        host: e.host,
        secure: "https" == e.protocol,
        port: e.port || ("https" == e.protocol ? 443 : 80),
        query: e.query || ""
      };
      c.util.merge(h, d);
      if (h["force new connection"] || !c.sockets[f]) g = new c.Socket(h);
      return !h["force new connection"] && g && (c.sockets[f] = g), g = g || c.sockets[f], g.of(e.path.length > 1 ? e.path : "")
    }
  })("object" == typeof module ? module.exports : this.io = {}, this),
  function(a, b) {
    var c = a.util = {},
      d = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
      e = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"];
    c.parseUri = function(a) {
      var b = d.exec(a || ""),
        c = {},
        f = 14;
      while (f--) c[e[f]] = b[f] || "";
      return c
    }, c.uniqueUri = function(a) {
      var c = a.protocol,
        d = a.host,
        e = a.port;
      return "document" in b ? (d = d || document.domain, e = e || (c == "https" && document.location.protocol !== "https:" ? 443 : document.location.port)) : (d = d || "localhost", !e && c == "https" && (e = 443)), (c || "http") + "://" + d + ":" + (e || 80)
    }, c.query = function(a, b) {
      var d = c.chunkQuery(a || ""),
        e = [];
      c.merge(d, c.chunkQuery(b || ""));
      for (var f in d) d.hasOwnProperty(f) && e.push(f + "=" + d[f]);
      return e.length ? "?" + e.join("&") : ""
    }, c.chunkQuery = function(a) {
      var b = {},
        c = a.split("&"),
        d = 0,
        e = c.length,
        f;
      for (; d < e; ++d) f = c[d].split("="), f[0] && (b[f[0]] = f[1]);
      return b
    };
    var f = !1;
    c.load = function(a) {
      if ("document" in b && document.readyState === "complete" || f) return a();
      c.on(b, "load", a, !1)
    }, c.on = function(a, b, c, d) {
      a.attachEvent ? a.attachEvent("on" + b, c) : a.addEventListener && a.addEventListener(b, c, d)
    }, c.request = function(a) {
      if (a && "undefined" != typeof XDomainRequest && !c.ua.hasCORS) return new XDomainRequest;
      if ("undefined" != typeof XMLHttpRequest && (!a || c.ua.hasCORS)) return new XMLHttpRequest;
      if (!a) try {
        return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")
      } catch (b) {}
      return null
    }, "undefined" != typeof window && c.load(function() {
      f = !0
    }), c.defer = function(a) {
      if (!c.ua.webkit || "undefined" != typeof importScripts) return a();
      c.load(function() {
        setTimeout(a, 100)
      })
    }, c.merge = function(b, d, e, f) {
      var g = f || [],
        h = typeof e == "undefined" ? 2 : e,
        i;
      for (i in d) d.hasOwnProperty(i) && c.indexOf(g, i) < 0 && (typeof b[i] != "object" || !h ? (b[i] = d[i], g.push(d[i])) : c.merge(b[i], d[i], h - 1, g));
      return b
    }, c.mixin = function(a, b) {
      c.merge(a.prototype, b.prototype)
    }, c.inherit = function(a, b) {
      function c() {}
      c.prototype = b.prototype, a.prototype = new c
    }, c.isArray = Array.isArray || function(a) {
      return Object.prototype.toString.call(a) === "[object Array]"
    }, c.intersect = function(a, b) {
      var d = [],
        e = a.length > b.length ? a : b,
        f = a.length > b.length ? b : a;
      for (var g = 0, h = f.length; g < h; g++) ~c.indexOf(e, f[g]) && d.push(f[g]);
      return d
    }, c.indexOf = function(a, b, c) {
      for (var d = a.length, c = c < 0 ? c + d < 0 ? 0 : c + d : c || 0; c < d && a[c] !== b; c++);
      return d <= c ? -1 : c
    }, c.toArray = function(a) {
      var b = [];
      for (var c = 0, d = a.length; c < d; c++) b.push(a[c]);
      return b
    }, c.ua = {}, c.ua.hasCORS = "undefined" != typeof XMLHttpRequest && function() {
      try {
        var a = new XMLHttpRequest
      } catch (b) {
        return !1
      }
      return a.withCredentials != undefined
    }(), c.ua.webkit = "undefined" != typeof navigator && /webkit/i.test(navigator.userAgent), c.ua.iDevice = "undefined" != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent)
  }("undefined" != typeof io ? io : module.exports, this),
  function(a, b) {
    function c() {}
    a.EventEmitter = c, c.prototype.on = function(a, c) {
      return this.$events || (this.$events = {}), this.$events[a] ? b.util.isArray(this.$events[a]) ? this.$events[a].push(c) : this.$events[a] = [this.$events[a], c] : this.$events[a] = c, this
    }, c.prototype.addListener = c.prototype.on, c.prototype.once = function(a, b) {
      function d() {
        c.removeListener(a, d), b.apply(this, arguments)
      }
      var c = this;
      return d.listener = b, this.on(a, d), this
    }, c.prototype.removeListener = function(a, c) {
      if (this.$events && this.$events[a]) {
        var d = this.$events[a];
        if (b.util.isArray(d)) {
          var e = -1;
          for (var f = 0, g = d.length; f < g; f++)
            if (d[f] === c || d[f].listener && d[f].listener === c) {
              e = f;
              break
            }
          if (e < 0) return this;
          d.splice(e, 1), d.length || delete this.$events[a]
        } else(d === c || d.listener && d.listener === c) && delete this.$events[a]
      }
      return this
    }, c.prototype.removeAllListeners = function(a) {
      return a === undefined ? (this.$events = {}, this) : (this.$events && this.$events[a] && (this.$events[a] = null), this)
    }, c.prototype.listeners = function(a) {
      return this.$events || (this.$events = {}), this.$events[a] || (this.$events[a] = []), b.util.isArray(this.$events[a]) || (this.$events[a] = [this.$events[a]]), this.$events[a]
    }, c.prototype.emit = function(a) {
      if (!this.$events) return !1;
      var c = this.$events[a];
      if (!c) return !1;
      var d = Array.prototype.slice.call(arguments, 1);
      if ("function" == typeof c) c.apply(this, d);
      else {
        if (!b.util.isArray(c)) return !1;
        var e = c.slice();
        for (var f = 0, g = e.length; f < g; f++) e[f].apply(this, d)
      }
      return !0
    }
  }("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports),
  function(exports, nativeJSON) {
    function f(a) {
      return a < 10 ? "0" + a : a
    }

    function date(a, b) {
      return isFinite(a.valueOf()) ? a.getUTCFullYear() + "-" + f(a.getUTCMonth() + 1) + "-" + f(a.getUTCDate()) + "T" + f(a.getUTCHours()) + ":" + f(a.getUTCMinutes()) + ":" + f(a.getUTCSeconds()) + "Z" : null
    }

    function quote(a) {
      return escapable.lastIndex = 0, escapable.test(a) ? '"' + a.replace(escapable, function(a) {
        var b = meta[a];
        return typeof b == "string" ? b : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
      }) + '"' : '"' + a + '"'
    }

    function str(a, b) {
      var c, d, e, f, g = gap,
        h, i = b[a];
      i instanceof Date && (i = date(a)), typeof rep == "function" && (i = rep.call(b, a, i));
      switch (typeof i) {
        case "string":
          return quote(i);
        case "number":
          return isFinite(i) ? String(i) : "null";
        case "boolean":
        case "null":
          return String(i);
        case "object":
          if (!i) return "null";
          gap += indent, h = [];
          if (Object.prototype.toString.apply(i) === "[object Array]") {
            f = i.length;
            for (c = 0; c < f; c += 1) h[c] = str(c, i) || "null";
            return e = h.length === 0 ? "[]" : gap ? "[\n" + gap + h.join(",\n" + gap) + "\n" + g + "]" : "[" + h.join(",") + "]", gap = g, e
          }
          if (rep && typeof rep == "object") {
            f = rep.length;
            for (c = 0; c < f; c += 1) typeof rep[c] == "string" && (d = rep[c], e = str(d, i), e && h.push(quote(d) + (gap ? ": " : ":") + e))
          } else
            for (d in i) Object.prototype.hasOwnProperty.call(i, d) && (e = str(d, i), e && h.push(quote(d) + (gap ? ": " : ":") + e));
          return e = h.length === 0 ? "{}" : gap ? "{\n" + gap + h.join(",\n" + gap) + "\n" + g + "}" : "{" + h.join(",") + "}", gap = g, e
      }
    }
    "use strict";
    if (nativeJSON && nativeJSON.parse) return exports.JSON = {
      parse: nativeJSON.parse,
      stringify: nativeJSON.stringify
    };
    var JSON = exports.JSON = {},
      cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
      escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
      gap, indent, meta = {
        "\b": "\\b",
        "\t": "\\t",
        "\n": "\\n",
        "\f": "\\f",
        "\r": "\\r",
        '"': '\\"',
        "\\": "\\\\"
      },
      rep;
    JSON.stringify = function(a, b, c) {
      var d;
      gap = "", indent = "";
      if (typeof c == "number")
        for (d = 0; d < c; d += 1) indent += " ";
      else typeof c == "string" && (indent = c);
      rep = b;
      if (!b || typeof b == "function" || typeof b == "object" && typeof b.length == "number") return str("", {
        "": a
      });
      throw new Error("JSON.stringify")
    }, JSON.parse = function(text, reviver) {
      function walk(a, b) {
        var c, d, e = a[b];
        if (e && typeof e == "object")
          for (c in e) Object.prototype.hasOwnProperty.call(e, c) && (d = walk(e, c), d !== undefined ? e[c] = d : delete e[c]);
        return reviver.call(a, b, e)
      }
      var j;
      text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function(a) {
        return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
      }));
      if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) return j = eval("(" + text + ")"), typeof reviver == "function" ? walk({
        "": j
      }, "") : j;
      throw new SyntaxError("JSON.parse")
    }
  }("undefined" != typeof io ? io : module.exports, typeof JSON != "undefined" ? JSON : undefined),
  function(a, b) {
    var c = a.parser = {},
      d = c.packets = ["disconnect", "connect", "heartbeat", "message", "json", "event", "ack", "error", "noop"],
      e = c.reasons = ["transport not supported", "client not handshaken", "unauthorized"],
      f = c.advice = ["reconnect"],
      g = b.JSON,
      h = b.util.indexOf;
    c.encodePacket = function(a) {
      var b = h(d, a.type),
        c = a.id || "",
        i = a.endpoint || "",
        j = a.ack,
        k = null;
      switch (a.type) {
        case "error":
          var l = a.reason ? h(e, a.reason) : "",
            m = a.advice ? h(f, a.advice) : "";
          if (l !== "" || m !== "") k = l + (m !== "" ? "+" + m : "");
          break;
        case "message":
          a.data !== "" && (k = a.data);
          break;
        case "event":
          var n = {
            name: a.name
          };
          a.args && a.args.length && (n.args = a.args), k = g.stringify(n);
          break;
        case "json":
          k = g.stringify(a.data);
          break;
        case "connect":
          a.qs && (k = a.qs);
          break;
        case "ack":
          k = a.ackId + (a.args && a.args.length ? "+" + g.stringify(a.args) : "")
      }
      var o = [b, c + (j == "data" ? "+" : ""), i];
      return k !== null && k !== undefined && o.push(k), o.join(":")
    }, c.encodePayload = function(a) {
      var b = "";
      if (a.length == 1) return a[0];
      for (var c = 0, d = a.length; c < d; c++) {
        var e = a[c];
        b += "" + e.length + "" + a[c]
      }
      return b
    };
    var i = /([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;
    c.decodePacket = function(a) {
      var b = a.match(i);
      if (!b) return {};
      var c = b[2] || "",
        a = b[5] || "",
        h = {
          type: d[b[1]],
          endpoint: b[4] || ""
        };
      c && (h.id = c, b[3] ? h.ack = "data" : h.ack = !0);
      switch (h.type) {
        case "error":
          var b = a.split("+");
          h.reason = e[b[0]] || "", h.advice = f[b[1]] || "";
          break;
        case "message":
          h.data = a || "";
          break;
        case "event":
          try {
            var j = g.parse(a);
            h.name = j.name, h.args = j.args
          } catch (k) {}
          h.args = h.args || [];
          break;
        case "json":
          try {
            h.data = g.parse(a)
          } catch (k) {}
          break;
        case "connect":
          h.qs = a || "";
          break;
        case "ack":
          var b = a.match(/^([0-9]+)(\+)?(.*)/);
          if (b) {
            h.ackId = b[1], h.args = [];
            if (b[3]) try {
              h.args = b[3] ? g.parse(b[3]) : []
            } catch (k) {}
          }
          break;
        case "disconnect":
        case "heartbeat":
      }
      return h
    }, c.decodePayload = function(a) {
      if (a.charAt(0) == "") {
        var b = [];
        for (var d = 1, e = ""; d < a.length; d++) a.charAt(d) == "" ? (b.push(c.decodePacket(a.substr(d + 1).substr(0, e))), d += Number(e) + 1, e = "") : e += a.charAt(d);
        return b
      }
      return [c.decodePacket(a)]
    }
  }("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports),
  function(a, b) {
    function c(a, b) {
      this.socket = a, this.sessid = b
    }
    a.Transport = c, b.util.mixin(c, b.EventEmitter), c.prototype.heartbeats = function() {
      return !0
    }, c.prototype.onData = function(a) {
      this.clearCloseTimeout(), (this.socket.connected || this.socket.connecting || this.socket.reconnecting) && this.setCloseTimeout();
      if (a !== "") {
        var c = b.parser.decodePayload(a);
        if (c && c.length)
          for (var d = 0, e = c.length; d < e; d++) this.onPacket(c[d])
      }
      return this
    }, c.prototype.onPacket = function(a) {
      return this.socket.setHeartbeatTimeout(), a.type == "heartbeat" ? this.onHeartbeat() : (a.type == "connect" && a.endpoint == "" && this.onConnect(), a.type == "error" && a.advice == "reconnect" && (this.isOpen = !1), this.socket.onPacket(a), this)
    }, c.prototype.setCloseTimeout = function() {
      if (!this.closeTimeout) {
        var a = this;
        this.closeTimeout = setTimeout(function() {
          a.onDisconnect()
        }, this.socket.closeTimeout)
      }
    }, c.prototype.onDisconnect = function() {
      return this.isOpen && this.close(), this.clearTimeouts(), this.socket.onDisconnect(), this
    }, c.prototype.onConnect = function() {
      return this.socket.onConnect(), this
    }, c.prototype.clearCloseTimeout = function() {
      this.closeTimeout && (clearTimeout(this.closeTimeout), this.closeTimeout = null)
    }, c.prototype.clearTimeouts = function() {
      this.clearCloseTimeout(), this.reopenTimeout && clearTimeout(this.reopenTimeout)
    }, c.prototype.packet = function(a) {
      this.send(b.parser.encodePacket(a))
    }, c.prototype.onHeartbeat = function(a) {
      this.packet({
        type: "heartbeat"
      })
    }, c.prototype.onOpen = function() {
      this.isOpen = !0, this.clearCloseTimeout(), this.socket.onOpen()
    }, c.prototype.onClose = function() {
      var a = this;
      this.isOpen = !1, this.socket.onClose(), this.onDisconnect()
    }, c.prototype.prepareUrl = function() {
      var a = this.socket.options;
      return this.scheme() + "://" + a.host + ":" + a.port + "/" + a.resource + "/" + b.protocol + "/" + this.name + "/" + this.sessid
    }, c.prototype.ready = function(a, b) {
      b.call(this)
    }
  }("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports),
  function(a, b, c) {
    function d(a) {
      this.options = {
        port: 80,
        secure: !1,
        document: "document" in c ? document : !1,
        resource: "socket.io",
        transports: b.transports,
        "connect timeout": 1e4,
        "try multiple transports": !0,
        reconnect: !0,
        "reconnection delay": 500,
        "reconnection limit": Infinity,
        "reopen delay": 3e3,
        "max reconnection attempts": 10,
        "sync disconnect on unload": !1,
        "auto connect": !0,
        "flash policy port": 10843,
        manualFlush: !1
      }, b.util.merge(this.options, a), this.connected = !1, this.open = !1, this.connecting = !1, this.reconnecting = !1, this.namespaces = {}, this.buffer = [], this.doBuffer = !1;
      if (this.options["sync disconnect on unload"] && (!this.isXDomain() || b.util.ua.hasCORS)) {
        var d = this;
        b.util.on(c, "beforeunload", function() {
          d.disconnectSync()
        }, !1)
      }
      this.options["auto connect"] && this.connect()
    }

    function e() {}
    a.Socket = d, b.util.mixin(d, b.EventEmitter), d.prototype.of = function(a) {
      return this.namespaces[a] || (this.namespaces[a] = new b.SocketNamespace(this, a), a !== "" && this.namespaces[a].packet({
        type: "connect"
      })), this.namespaces[a]
    }, d.prototype.publish = function() {
      this.emit.apply(this, arguments);
      var a;
      for (var b in this.namespaces) this.namespaces.hasOwnProperty(b) && (a = this.of(b), a.$emit.apply(a, arguments))
    }, d.prototype.handshake = function(a) {
      function f(b) {
        b instanceof Error ? (c.connecting = !1, c.onError(b.message)) : a.apply(null, b.split(":"))
      }
      var c = this,
        d = this.options,
        g = ["http" + (d.secure ? "s" : "") + ":/", d.host + ":" + d.port, d.resource, b.protocol, b.util.query(this.options.query, "t=" + +(new Date))].join("/");
      if (this.isXDomain() && !b.util.ua.hasCORS) {
        var h = document.getElementsByTagName("script")[0],
          i = document.createElement("script");
        i.src = g + "&jsonp=" + b.j.length, h.parentNode.insertBefore(i, h), b.j.push(function(a) {
          f(a), i.parentNode.removeChild(i)
        })
      } else {
        var j = b.util.request();
        j.open("GET", g, !0), this.isXDomain() && (j.withCredentials = !0), j.onreadystatechange = function() {
          j.readyState == 4 && (j.onreadystatechange = e, j.status == 200 ? f(j.responseText) : j.status == 403 ? c.onError(j.responseText) : (c.connecting = !1, !c.reconnecting && c.onError(j.responseText)))
        }, j.send(null)
      }
    }, d.prototype.getTransport = function(a) {
      var c = a || this.transports,
        d;
      for (var e = 0, f; f = c[e]; e++)
        if (b.Transport[f] && b.Transport[f].check(this) && (!this.isXDomain() || b.Transport[f].xdomainCheck(this))) return new b.Transport[f](this, this.sessionid);
      return null
    }, d.prototype.connect = function(a) {
      if (this.connecting) return this;
      var c = this;
      return c.connecting = !0, this.handshake(function(d, e, f, g) {
        function h(a) {
          c.transport && c.transport.clearTimeouts(), c.transport = c.getTransport(a);
          if (!c.transport) return c.publish("connect_failed");
          c.transport.ready(c, function() {
            c.connecting = !0, c.publish("connecting", c.transport.name), c.transport.open(), c.options["connect timeout"] && (c.connectTimeoutTimer = setTimeout(function() {
              if (!c.connected) {
                c.connecting = !1;
                if (c.options["try multiple transports"]) {
                  var a = c.transports;
                  while (a.length > 0 && a.splice(0, 1)[0] != c.transport.name);
                  a.length ? h(a) : c.publish("connect_failed")
                }
              }
            }, c.options["connect timeout"]))
          })
        }
        c.sessionid = d, c.closeTimeout = f * 1e3, c.heartbeatTimeout = e * 1e3, c.transports || (c.transports = c.origTransports = g ? b.util.intersect(g.split(","), c.options.transports) : c.options.transports), c.setHeartbeatTimeout(), h(c.transports), c.once("connect", function() {
          clearTimeout(c.connectTimeoutTimer), a && typeof a == "function" && a()
        })
      }), this
    }, d.prototype.setHeartbeatTimeout = function() {
      clearTimeout(this.heartbeatTimeoutTimer);
      if (this.transport && !this.transport.heartbeats()) return;
      var a = this;
      this.heartbeatTimeoutTimer = setTimeout(function() {
        a.transport.onClose()
      }, this.heartbeatTimeout)
    }, d.prototype.packet = function(a) {
      return this.connected && !this.doBuffer ? this.transport.packet(a) : this.buffer.push(a), this
    }, d.prototype.setBuffer = function(a) {
      this.doBuffer = a, !a && this.connected && this.buffer.length && (this.options.manualFlush || this.flushBuffer())
    }, d.prototype.flushBuffer = function() {
      this.transport.payload(this.buffer), this.buffer = []
    }, d.prototype.disconnect = function() {
      if (this.connected || this.connecting) this.open && this.of("").packet({
        type: "disconnect"
      }), this.onDisconnect("booted");
      return this
    }, d.prototype.disconnectSync = function() {
      var a = b.util.request(),
        c = ["http" + (this.options.secure ? "s" : "") + ":/", this.options.host + ":" + this.options.port, this.options.resource, b.protocol, "", this.sessionid].join("/") + "/?disconnect=1";
      a.open("GET", c, !1), a.send(null), this.onDisconnect("booted")
    }, d.prototype.isXDomain = function() {
      var a = c.location.port || ("https:" == c.location.protocol ? 443 : 80);
      return this.options.host !== c.location.hostname || this.options.port != a
    }, d.prototype.onConnect = function() {
      this.connected || (this.connected = !0, this.connecting = !1, this.doBuffer || this.setBuffer(!1), this.emit("connect"))
    }, d.prototype.onOpen = function() {
      this.open = !0
    }, d.prototype.onClose = function() {
      this.open = !1, clearTimeout(this.heartbeatTimeoutTimer)
    }, d.prototype.onPacket = function(a) {
      this.of(a.endpoint).onPacket(a)
    }, d.prototype.onError = function(a) {
      a && a.advice && a.advice === "reconnect" && (this.connected || this.connecting) && (this.disconnect(), this.options.reconnect && this.reconnect()), this.publish("error", a && a.reason ? a.reason : a)
    }, d.prototype.onDisconnect = function(a) {
      var b = this.connected,
        c = this.connecting;
      this.connected = !1, this.connecting = !1, this.open = !1;
      if (b || c) this.transport.close(), this.transport.clearTimeouts(), b && (this.publish("disconnect", a), "booted" != a && this.options.reconnect && !this.reconnecting && this.reconnect())
    }, d.prototype.reconnect = function() {
      function e() {
        if (a.connected) {
          for (var b in a.namespaces) a.namespaces.hasOwnProperty(b) && "" !== b && a.namespaces[b].packet({
            type: "connect"
          });
          a.publish("reconnect", a.transport.name, a.reconnectionAttempts)
        }
        clearTimeout(a.reconnectionTimer), a.removeListener("connect_failed", f), a.removeListener("connect", f), a.reconnecting = !1, delete a.reconnectionAttempts, delete a.reconnectionDelay, delete a.reconnectionTimer, delete a.redoTransports, a.options["try multiple transports"] = c
      }

      function f() {
        if (!a.reconnecting) return;
        if (a.connected) return e();
        if (a.connecting && a.reconnecting) return a.reconnectionTimer = setTimeout(f, 1e3);
        a.reconnectionAttempts++ >= b ? a.redoTransports ? (a.publish("reconnect_failed"), e()) : (a.on("connect_failed", f), a.options["try multiple transports"] = !0, a.transports = a.origTransports, a.transport = a.getTransport(), a.redoTransports = !0, a.connect()) : (a.reconnectionDelay < d && (a.reconnectionDelay *= 2), a.connect(), a.publish("reconnecting", a.reconnectionDelay, a.reconnectionAttempts), a.reconnectionTimer = setTimeout(f, a.reconnectionDelay))
      }
      this.reconnecting = !0, this.reconnectionAttempts = 0, this.reconnectionDelay = this.options["reconnection delay"];
      var a = this,
        b = this.options["max reconnection attempts"],
        c = this.options["try multiple transports"],
        d = this.options["reconnection limit"];
      this.options["try multiple transports"] = !1, this.reconnectionTimer = setTimeout(f, this.reconnectionDelay), this.on("connect", f)
    }
  }("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports, this),
  function(a, b) {
    function c(a, b) {
      this.socket = a, this.name = b || "", this.flags = {}, this.json = new d(this, "json"), this.ackPackets = 0, this.acks = {}
    }

    function d(a, b) {
      this.namespace = a, this.name = b
    }
    a.SocketNamespace = c, b.util.mixin(c, b.EventEmitter), c.prototype.$emit = b.EventEmitter.prototype.emit, c.prototype.of = function() {
      return this.socket.of.apply(this.socket, arguments)
    }, c.prototype.packet = function(a) {
      return a.endpoint = this.name, this.socket.packet(a), this.flags = {}, this
    }, c.prototype.send = function(a, b) {
      var c = {
        type: this.flags.json ? "json" : "message",
        data: a
      };
      return "function" == typeof b && (c.id = ++this.ackPackets, c.ack = !0, this.acks[c.id] = b), this.packet(c)
    }, c.prototype.emit = function(a) {
      var b = Array.prototype.slice.call(arguments, 1),
        c = b[b.length - 1],
        d = {
          type: "event",
          name: a
        };
      return "function" == typeof c && (d.id = ++this.ackPackets, d.ack = "data", this.acks[d.id] = c, b = b.slice(0, b.length - 1)), d.args = b, this.packet(d)
    }, c.prototype.disconnect = function() {
      return this.name === "" ? this.socket.disconnect() : (this.packet({
        type: "disconnect"
      }), this.$emit("disconnect")), this
    }, c.prototype.onPacket = function(a) {
      function d() {
        c.packet({
          type: "ack",
          args: b.util.toArray(arguments),
          ackId: a.id
        })
      }
      var c = this;
      switch (a.type) {
        case "connect":
          this.$emit("connect");
          break;
        case "disconnect":
          this.name === "" ? this.socket.onDisconnect(a.reason || "booted") : this.$emit("disconnect", a.reason);
          break;
        case "message":
        case "json":
          var e = ["message", a.data];
          a.ack == "data" ? e.push(d) : a.ack && this.packet({
            type: "ack",
            ackId: a.id
          }), this.$emit.apply(this, e);
          break;
        case "event":
          var e = [a.name].concat(a.args);
          a.ack == "data" && e.push(d), this.$emit.apply(this, e);
          break;
        case "ack":
          this.acks[a.ackId] && (this.acks[a.ackId].apply(this, a.args), delete this.acks[a.ackId]);
          break;
        case "error":
          a.advice ? this.socket.onError(a) : a.reason == "unauthorized" ? this.$emit("connect_failed", a.reason) : this.$emit("error", a.reason)
      }
    }, d.prototype.send = function() {
      this.namespace.flags[this.name] = !0, this.namespace.send.apply(this.namespace, arguments)
    }, d.prototype.emit = function() {
      this.namespace.flags[this.name] = !0, this.namespace.emit.apply(this.namespace, arguments)
    }
  }("undefined" != typeof io ? io : module.exports, "undefined" != typeof io ? io : module.parent.exports),
  function(a, b, c) {
    function d(a) {
      b.Transport.apply(this, arguments)
    }
    a.websocket = d, b.util.inherit(d, b.Transport), d.prototype.name = "websocket", d.prototype.open = function() {
      var a = b.util.query(this.socket.options.query),
        d = this,
        e;
      return e || (e = c.MozWebSocket || c.WebSocket), this.websocket = new e(this.prepareUrl() + a), this.websocket.onopen = function() {
        d.onOpen(), d.socket.setBuffer(!1)
      }, this.websocket.onmessage = function(a) {
        d.onData(a.data)
      }, this.websocket.onclose = function() {
        d.onClose(), d.socket.setBuffer(!0)
      }, this.websocket.onerror = function(a) {
        d.onError(a)
      }, this
    }, b.util.ua.iDevice ? d.prototype.send = function(a) {
      var b = this;
      return setTimeout(function() {
        b.websocket.send(a)
      }, 0), this
    } : d.prototype.send = function(a) {
      return this.websocket.send(a), this
    }, d.prototype.payload = function(a) {
      for (var b = 0, c = a.length; b < c; b++) this.packet(a[b]);
      return this
    }, d.prototype.close = function() {
      return this.websocket.close(), this
    }, d.prototype.onError = function(a) {
      this.socket.onError(a)
    }, d.prototype.scheme = function() {
      return this.socket.options.secure ? "wss" : "ws"
    }, d.check = function() {
      return "WebSocket" in c && !("__addTask" in WebSocket) || "MozWebSocket" in c
    }, d.xdomainCheck = function() {
      return !0
    }, b.transports.push("websocket")
  }("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this),
  function(a, b) {
    function c() {
      b.Transport.websocket.apply(this, arguments)
    }
    a.flashsocket = c, b.util.inherit(c, b.Transport.websocket), c.prototype.name = "flashsocket", c.prototype.open = function() {
      var a = this,
        c = arguments;
      return WebSocket.__addTask(function() {
        b.Transport.websocket.prototype.open.apply(a, c)
      }), this
    }, c.prototype.send = function() {
      var a = this,
        c = arguments;
      return WebSocket.__addTask(function() {
        b.Transport.websocket.prototype.send.apply(a, c)
      }), this
    }, c.prototype.close = function() {
      return WebSocket.__tasks.length = 0, b.Transport.websocket.prototype.close.call(this), this
    }, c.prototype.ready = function(a, d) {
      function e() {
        var b = a.options,
          e = b["flash policy port"],
          g = ["http" + (b.secure ? "s" : "") + ":/", b.host + ":" + b.port, b.resource, "static/flashsocket", "WebSocketMain" + (a.isXDomain() ? "Insecure" : "") + ".swf"];
        c.loaded || (typeof WEB_SOCKET_SWF_LOCATION == "undefined" && (WEB_SOCKET_SWF_LOCATION = g.join("/")), e !== 843 && WebSocket.loadFlashPolicyFile("xmlsocket://" + b.host + ":" + e), WebSocket.__initialize(), c.loaded = !0), d.call(f)
      }
      var f = this;
      if (document.body) return e();
      b.util.load(e)
    }, c.check = function() {
      return typeof WebSocket != "undefined" && "__initialize" in WebSocket && !!swfobject ? swfobject.getFlashPlayerVersion().major >= 10 : !1
    }, c.xdomainCheck = function() {
      return !0
    }, typeof window != "undefined" && (WEB_SOCKET_DISABLE_AUTO_INITIALIZATION = !0), b.transports.push("flashsocket")
  }("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports);
  if ("undefined" != typeof window) var swfobject = function() {
    function A() {
      if (t) return;
      try {
        var a = i.getElementsByTagName("body")[0].appendChild(Q("span"));
        a.parentNode.removeChild(a)
      } catch (b) {
        return
      }
      t = !0;
      var c = l.length;
      for (var d = 0; d < c; d++) l[d]()
    }

    function B(a) {
      t ? a() : l[l.length] = a
    }

    function C(b) {
      if (typeof h.addEventListener != a) h.addEventListener("load", b, !1);
      else if (typeof i.addEventListener != a) i.addEventListener("load", b, !1);
      else if (typeof h.attachEvent != a) R(h, "onload", b);
      else if (typeof h.onload == "function") {
        var c = h.onload;
        h.onload = function() {
          c(), b()
        }
      } else h.onload = b
    }

    function D() {
      k ? E() : F()
    }

    function E() {
      var c = i.getElementsByTagName("body")[0],
        d = Q(b);
      d.setAttribute("type", e);
      var f = c.appendChild(d);
      if (f) {
        var g = 0;
        (function() {
          if (typeof f.GetVariable != a) {
            var b = f.GetVariable("$version");
            b && (b = b.split(" ")[1].split(","), y.pv = [parseInt(b[0], 10), parseInt(b[1], 10), parseInt(b[2], 10)])
          } else if (g < 10) {
            g++, setTimeout(arguments.callee, 10);
            return
          }
          c.removeChild(d), f = null, F()
        })()
      } else F()
    }

    function F() {
      var b = m.length;
      if (b > 0)
        for (var c = 0; c < b; c++) {
          var d = m[c].id,
            e = m[c].callbackFn,
            f = {
              success: !1,
              id: d
            };
          if (y.pv[0] > 0) {
            var g = P(d);
            if (g)
              if (S(m[c].swfVersion) && !(y.wk && y.wk < 312)) U(d, !0), e && (f.success = !0, f.ref = G(d), e(f));
              else if (m[c].expressInstall && H()) {
              var h = {};
              h.data = m[c].expressInstall, h.width = g.getAttribute("width") || "0", h.height = g.getAttribute("height") || "0", g.getAttribute("class") && (h.styleclass = g.getAttribute("class")), g.getAttribute("align") && (h.align = g.getAttribute("align"));
              var i = {},
                j = g.getElementsByTagName("param"),
                k = j.length;
              for (var l = 0; l < k; l++) j[l].getAttribute("name").toLowerCase() != "movie" && (i[j[l].getAttribute("name")] = j[l].getAttribute("value"));
              I(h, i, d, e)
            } else J(g), e && e(f)
          } else {
            U(d, !0);
            if (e) {
              var n = G(d);
              n && typeof n.SetVariable != a && (f.success = !0, f.ref = n), e(f)
            }
          }
        }
    }

    function G(c) {
      var d = null,
        e = P(c);
      if (e && e.nodeName == "OBJECT")
        if (typeof e.SetVariable != a) d = e;
        else {
          var f = e.getElementsByTagName(b)[0];
          f && (d = f)
        }
      return d
    }

    function H() {
      return !u && S("6.0.65") && (y.win || y.mac) && !(y.wk && y.wk < 312)
    }

    function I(b, c, d, e) {
      u = !0, r = e || null, s = {
        success: !1,
        id: d
      };
      var g = P(d);
      if (g) {
        g.nodeName == "OBJECT" ? (p = K(g), q = null) : (p = g, q = d), b.id = f;
        if (typeof b.width == a || !/%$/.test(b.width) && parseInt(b.width, 10) < 310) b.width = "310";
        if (typeof b.height == a || !/%$/.test(b.height) && parseInt(b.height, 10) < 137) b.height = "137";
        i.title = i.title.slice(0, 47) + " - Flash Player Installation";
        var j = y.ie && y.win ? ["Active"].concat("").join("X") : "PlugIn",
          k = "MMredirectURL=" + h.location.toString().replace(/&/g, "%26") + "&MMplayerType=" + j + "&MMdoctitle=" + i.title;
        typeof c.flashvars != a ? c.flashvars += "&" + k : c.flashvars = k;
        if (y.ie && y.win && g.readyState != 4) {
          var l = Q("div");
          d += "SWFObjectNew", l.setAttribute("id", d), g.parentNode.insertBefore(l, g), g.style.display = "none",
            function() {
              g.readyState == 4 ? g.parentNode.removeChild(g) : setTimeout(arguments.callee, 10)
            }()
        }
        L(b, c, d)
      }
    }

    function J(a) {
      if (y.ie && y.win && a.readyState != 4) {
        var b = Q("div");
        a.parentNode.insertBefore(b, a), b.parentNode.replaceChild(K(a), b), a.style.display = "none",
          function() {
            a.readyState == 4 ? a.parentNode.removeChild(a) : setTimeout(arguments.callee, 10)
          }()
      } else a.parentNode.replaceChild(K(a), a)
    }

    function K(a) {
      var c = Q("div");
      if (y.win && y.ie) c.innerHTML = a.innerHTML;
      else {
        var d = a.getElementsByTagName(b)[0];
        if (d) {
          var e = d.childNodes;
          if (e) {
            var f = e.length;
            for (var g = 0; g < f; g++)(e[g].nodeType != 1 || e[g].nodeName != "PARAM") && e[g].nodeType != 8 && c.appendChild(e[g].cloneNode(!0))
          }
        }
      }
      return c
    }

    function L(c, d, f) {
      var g, h = P(f);
      if (y.wk && y.wk < 312) return g;
      if (h) {
        typeof c.id == a && (c.id = f);
        if (y.ie && y.win) {
          var i = "";
          for (var j in c) c[j] != Object.prototype[j] && (j.toLowerCase() == "data" ? d.movie = c[j] : j.toLowerCase() == "styleclass" ? i += ' class="' + c[j] + '"' : j.toLowerCase() != "classid" && (i += " " + j + '="' + c[j] + '"'));
          var k = "";
          for (var l in d) d[l] != Object.prototype[l] && (k += '<param name="' + l + '" value="' + d[l] + '" />');
          h.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"' + i + ">" + k + "</object>", n[n.length] = c.id, g = P(c.id)
        } else {
          var m = Q(b);
          m.setAttribute("type", e);
          for (var o in c) c[o] != Object.prototype[o] && (o.toLowerCase() == "styleclass" ? m.setAttribute("class", c[o]) : o.toLowerCase() != "classid" && m.setAttribute(o, c[o]));
          for (var p in d) d[p] != Object.prototype[p] && p.toLowerCase() != "movie" && M(m, p, d[p]);
          h.parentNode.replaceChild(m, h), g = m
        }
      }
      return g
    }

    function M(a, b, c) {
      var d = Q("param");
      d.setAttribute("name", b), d.setAttribute("value", c), a.appendChild(d)
    }

    function N(a) {
      var b = P(a);
      b && b.nodeName == "OBJECT" && (y.ie && y.win ? (b.style.display = "none", function() {
        b.readyState == 4 ? O(a) : setTimeout(arguments.callee, 10)
      }()) : b.parentNode.removeChild(b))
    }

    function O(a) {
      var b = P(a);
      if (b) {
        for (var c in b) typeof b[c] == "function" && (b[c] = null);
        b.parentNode.removeChild(b)
      }
    }

    function P(a) {
      var b = null;
      try {
        b = i.getElementById(a)
      } catch (c) {}
      return b
    }

    function Q(a) {
      return i.createElement(a)
    }

    function R(a, b, c) {
      a.attachEvent(b, c), o[o.length] = [a, b, c]
    }

    function S(a) {
      var b = y.pv,
        c = a.split(".");
      return c[0] = parseInt(c[0], 10), c[1] = parseInt(c[1], 10) || 0, c[2] = parseInt(c[2], 10) || 0, b[0] > c[0] || b[0] == c[0] && b[1] > c[1] || b[0] == c[0] && b[1] == c[1] && b[2] >= c[2] ? !0 : !1
    }

    function T(c, d, e, f) {
      if (y.ie && y.mac) return;
      var g = i.getElementsByTagName("head")[0];
      if (!g) return;
      var h = e && typeof e == "string" ? e : "screen";
      f && (v = null, w = null);
      if (!v || w != h) {
        var j = Q("style");
        j.setAttribute("type", "text/css"), j.setAttribute("media", h), v = g.appendChild(j), y.ie && y.win && typeof i.styleSheets != a && i.styleSheets.length > 0 && (v = i.styleSheets[i.styleSheets.length - 1]), w = h
      }
      y.ie && y.win ? v && typeof v.addRule == b && v.addRule(c, d) : v && typeof i.createTextNode != a && v.appendChild(i.createTextNode(c + " {" + d + "}"))
    }

    function U(a, b) {
      if (!x) return;
      var c = b ? "visible" : "hidden";
      t && P(a) ? P(a).style.visibility = c : T("#" + a, "visibility:" + c)
    }

    function V(b) {
      var c = /[\\\"<>\.;]/,
        d = c.exec(b) != null;
      return d && typeof encodeURIComponent != a ? encodeURIComponent(b) : b
    }
    var a = "undefined",
      b = "object",
      c = "Shockwave Flash",
      d = "ShockwaveFlash.ShockwaveFlash",
      e = "application/x-shockwave-flash",
      f = "SWFObjectExprInst",
      g = "onreadystatechange",
      h = window,
      i = document,
      j = navigator,
      k = !1,
      l = [D],
      m = [],
      n = [],
      o = [],
      p, q, r, s, t = !1,
      u = !1,
      v, w, x = !0,
      y = function() {
        var f = typeof i.getElementById != a && typeof i.getElementsByTagName != a && typeof i.createElement != a,
          g = j.userAgent.toLowerCase(),
          l = j.platform.toLowerCase(),
          m = l ? /win/.test(l) : /win/.test(g),
          n = l ? /mac/.test(l) : /mac/.test(g),
          o = /webkit/.test(g) ? parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/, "$1")) : !1,
          p = !1,
          q = [0, 0, 0],
          r = null;
        if (typeof j.plugins != a && typeof j.plugins[c] == b) r = j.plugins[c].description, r && (typeof j.mimeTypes == a || !j.mimeTypes[e] || !!j.mimeTypes[e].enabledPlugin) && (k = !0, p = !1, r = r.replace(/^.*\s+(\S+\s+\S+$)/, "$1"), q[0] = parseInt(r.replace(/^(.*)\..*$/, "$1"), 10), q[1] = parseInt(r.replace(/^.*\.(.*)\s.*$/, "$1"), 10), q[2] = /[a-zA-Z]/.test(r) ? parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/, "$1"), 10) : 0);
        else if (typeof h[["Active"].concat("Object").join("X")] != a) try {
          var s = new(window[["Active"].concat("Object").join("X")])(d);
          s && (r = s.GetVariable("$version"), r && (p = !0, r = r.split(" ")[1].split(","), q = [parseInt(r[0], 10), parseInt(r[1], 10), parseInt(r[2], 10)]))
        } catch (t) {}
        return {
          w3: f,
          pv: q,
          wk: o,
          ie: p,
          win: m,
          mac: n
        }
      }(),
      z = function() {
        if (!y.w3) return;
        (typeof i.readyState != a && i.readyState == "complete" || typeof i.readyState == a && (i.getElementsByTagName("body")[0] || i.body)) && A(), t || (typeof i.addEventListener != a && i.addEventListener("DOMContentLoaded", A, !1), y.ie && y.win && (i.attachEvent(g, function() {
          i.readyState == "complete" && (i.detachEvent(g, arguments.callee), A())
        }), h == top && function() {
          if (t) return;
          try {
            i.documentElement.doScroll("left")
          } catch (a) {
            setTimeout(arguments.callee, 0);
            return
          }
          A()
        }()), y.wk && function() {
          if (t) return;
          if (!/loaded|complete/.test(i.readyState)) {
            setTimeout(arguments.callee, 0);
            return
          }
          A()
        }(), C(A))
      }(),
      W = function() {
        y.ie && y.win && window.attachEvent("onunload", function() {
          var a = o.length;
          for (var b = 0; b < a; b++) o[b][0].detachEvent(o[b][1], o[b][2]);
          var c = n.length;
          for (var d = 0; d < c; d++) N(n[d]);
          for (var e in y) y[e] = null;
          y = null;
          for (var f in swfobject) swfobject[f] = null;
          swfobject = null
        })
      }();
    return {
      registerObject: function(a, b, c, d) {
        if (y.w3 && a && b) {
          var e = {};
          e.id = a, e.swfVersion = b, e.expressInstall = c, e.callbackFn = d, m[m.length] = e, U(a, !1)
        } else d && d({
          success: !1,
          id: a
        })
      },
      getObjectById: function(a) {
        if (y.w3) return G(a)
      },
      embedSWF: function(c, d, e, f, g, h, i, j, k, l) {
        var m = {
          success: !1,
          id: d
        };
        y.w3 && !(y.wk && y.wk < 312) && c && d && e && f && g ? (U(d, !1), B(function() {
          e += "", f += "";
          var n = {};
          if (k && typeof k === b)
            for (var o in k) n[o] = k[o];
          n.data = c, n.width = e, n.height = f;
          var p = {};
          if (j && typeof j === b)
            for (var q in j) p[q] = j[q];
          if (i && typeof i === b)
            for (var r in i) typeof p.flashvars != a ? p.flashvars += "&" + r + "=" + i[r] : p.flashvars = r + "=" + i[r];
          if (S(g)) {
            var s = L(n, p, d);
            n.id == d && U(d, !0), m.success = !0, m.ref = s
          } else {
            if (h && H()) {
              n.data = h, I(n, p, d, l);
              return
            }
            U(d, !0)
          }
          l && l(m)
        })) : l && l(m)
      },
      switchOffAutoHideShow: function() {
        x = !1
      },
      ua: y,
      getFlashPlayerVersion: function() {
        return {
          major: y.pv[0],
          minor: y.pv[1],
          release: y.pv[2]
        }
      },
      hasFlashPlayerVersion: S,
      createSWF: function(a, b, c) {
        return y.w3 ? L(a, b, c) : undefined
      },
      showExpressInstall: function(a, b, c, d) {
        y.w3 && H() && I(a, b, c, d)
      },
      removeSWF: function(a) {
        y.w3 && N(a)
      },
      createCSS: function(a, b, c, d) {
        y.w3 && T(a, b, c, d)
      },
      addDomLoadEvent: B,
      addLoadEvent: C,
      getQueryParamValue: function(a) {
        var b = i.location.search || i.location.hash;
        if (b) {
          /\?/.test(b) && (b = b.split("?")[1]);
          if (a == null) return V(b);
          var c = b.split("&");
          for (var d = 0; d < c.length; d++)
            if (c[d].substring(0, c[d].indexOf("=")) == a) return V(c[d].substring(c[d].indexOf("=") + 1))
        }
        return ""
      },
      expressInstallCallback: function() {
        if (u) {
          var a = P(f);
          a && p && (a.parentNode.replaceChild(p, a), q && (U(q, !0), y.ie && y.win && (p.style.display = "block")), r && r(s)), u = !1
        }
      }
    }
  }();
  (function() {
    if ("undefined" == typeof window || window.WebSocket) return;
    var a = window.console;
    if (!a || !a.log || !a.error) a = {
      log: function() {},
      error: function() {}
    };
    if (!swfobject.hasFlashPlayerVersion("10.0.0")) {
      a.error("Flash Player >= 10.0.0 is required.");
      return
    }
    location.protocol == "file:" && a.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."), WebSocket = function(a, b, c, d, e) {
      var f = this;
      f.__id = WebSocket.__nextId++, WebSocket.__instances[f.__id] = f, f.readyState = WebSocket.CONNECTING, f.bufferedAmount = 0, f.__events = {}, b ? typeof b == "string" && (b = [b]) : b = [], setTimeout(function() {
        WebSocket.__addTask(function() {
          WebSocket.__flash.create(f.__id, a, b, c || null, d || 0, e || null)
        })
      }, 0)
    }, WebSocket.prototype.send = function(a) {
      if (this.readyState == WebSocket.CONNECTING) throw "INVALID_STATE_ERR: Web Socket connection has not been established";
      var b = WebSocket.__flash.send(this.__id, encodeURIComponent(a));
      return b < 0 ? !0 : (this.bufferedAmount += b, !1)
    }, WebSocket.prototype.close = function() {
      if (this.readyState == WebSocket.CLOSED || this.readyState == WebSocket.CLOSING) return;
      this.readyState = WebSocket.CLOSING, WebSocket.__flash.close(this.__id)
    }, WebSocket.prototype.addEventListener = function(a, b, c) {
      a in this.__events || (this.__events[a] = []), this.__events[a].push(b)
    }, WebSocket.prototype.removeEventListener = function(a, b, c) {
      if (!(a in this.__events)) return;
      var d = this.__events[a];
      for (var e = d.length - 1; e >= 0; --e)
        if (d[e] === b) {
          d.splice(e, 1);
          break
        }
    }, WebSocket.prototype.dispatchEvent = function(a) {
      var b = this.__events[a.type] || [];
      for (var c = 0; c < b.length; ++c) b[c](a);
      var d = this["on" + a.type];
      d && d(a)
    }, WebSocket.prototype.__handleEvent = function(a) {
      "readyState" in a && (this.readyState = a.readyState), "protocol" in a && (this.protocol = a.protocol);
      var b;
      if (a.type == "open" || a.type == "error") b = this.__createSimpleEvent(a.type);
      else if (a.type == "close") b = this.__createSimpleEvent("close");
      else {
        if (a.type != "message") throw "unknown event type: " + a.type;
        var c = decodeURIComponent(a.message);
        b = this.__createMessageEvent("message", c)
      }
      this.dispatchEvent(b)
    }, WebSocket.prototype.__createSimpleEvent = function(a) {
      if (document.createEvent && window.Event) {
        var b = document.createEvent("Event");
        return b.initEvent(a, !1, !1), b
      }
      return {
        type: a,
        bubbles: !1,
        cancelable: !1
      }
    }, WebSocket.prototype.__createMessageEvent = function(a, b) {
      if (document.createEvent && window.MessageEvent && !window.opera) {
        var c = document.createEvent("MessageEvent");
        return c.initMessageEvent("message", !1, !1, b, null, null, window, null), c
      }
      return {
        type: a,
        data: b,
        bubbles: !1,
        cancelable: !1
      }
    }, WebSocket.CONNECTING = 0, WebSocket.OPEN = 1, WebSocket.CLOSING = 2, WebSocket.CLOSED = 3, WebSocket.__flash = null, WebSocket.__instances = {}, WebSocket.__tasks = [], WebSocket.__nextId = 0, WebSocket.loadFlashPolicyFile = function(a) {
      WebSocket.__addTask(function() {
        WebSocket.__flash.loadManualPolicyFile(a)
      })
    }, WebSocket.__initialize = function() {
      if (WebSocket.__flash) return;
      WebSocket.__swfLocation && (window.WEB_SOCKET_SWF_LOCATION = WebSocket.__swfLocation);
      if (!window.WEB_SOCKET_SWF_LOCATION) {
        a.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");
        return
      }
      var b = document.createElement("div");
      b.id = "webSocketContainer", b.style.position = "absolute", WebSocket.__isFlashLite() ? (b.style.left = "0px", b.style.top = "0px") : (b.style.left = "-100px", b.style.top = "-100px");
      var c = document.createElement("div");
      c.id = "webSocketFlash", b.appendChild(c), document.body.appendChild(b), swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION, "webSocketFlash", "1", "1", "10.0.0", null, null, {
        hasPriority: !0,
        swliveconnect: !0,
        allowScriptAccess: "always"
      }, null, function(b) {
        b.success || a.error("[WebSocket] swfobject.embedSWF failed")
      })
    }, WebSocket.__onFlashInitialized = function() {
      setTimeout(function() {
        WebSocket.__flash = document.getElementById("webSocketFlash"), WebSocket.__flash.setCallerUrl(location.href), WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);
        for (var a = 0; a < WebSocket.__tasks.length; ++a) WebSocket.__tasks[a]();
        WebSocket.__tasks = []
      }, 0)
    }, WebSocket.__onFlashEvent = function() {
      return setTimeout(function() {
        try {
          var b = WebSocket.__flash.receiveEvents();
          for (var c = 0; c < b.length; ++c) WebSocket.__instances[b[c].webSocketId].__handleEvent(b[c])
        } catch (d) {
          a.error(d)
        }
      }, 0), !0
    }, WebSocket.__log = function(b) {
      a.log(decodeURIComponent(b))
    }, WebSocket.__error = function(b) {
      a.error(decodeURIComponent(b))
    }, WebSocket.__addTask = function(a) {
      WebSocket.__flash ? a() : WebSocket.__tasks.push(a)
    }, WebSocket.__isFlashLite = function() {
      if (!window.navigator || !window.navigator.mimeTypes) return !1;
      var a = window.navigator.mimeTypes["application/x-shockwave-flash"];
      return !a || !a.enabledPlugin || !a.enabledPlugin.filename ? !1 : a.enabledPlugin.filename.match(/flashlite/i) ? !0 : !1
    }, window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION || (window.addEventListener ? window.addEventListener("load", function() {
      WebSocket.__initialize()
    }, !1) : window.attachEvent("onload", function() {
      WebSocket.__initialize()
    }))
  })(),
  function(a, b, c) {
    function d(a) {
      if (!a) return;
      b.Transport.apply(this, arguments), this.sendBuffer = []
    }

    function e() {}
    a.XHR = d, b.util.inherit(d, b.Transport), d.prototype.open = function() {
      return this.socket.setBuffer(!1), this.onOpen(), this.get(), this.setCloseTimeout(), this
    }, d.prototype.payload = function(a) {
      var c = [];
      for (var d = 0, e = a.length; d < e; d++) c.push(b.parser.encodePacket(a[d]));
      this.send(b.parser.encodePayload(c))
    }, d.prototype.send = function(a) {
      return this.post(a), this
    }, d.prototype.post = function(a) {
      function d() {
        this.readyState == 4 && (this.onreadystatechange = e, b.posting = !1, this.status == 200 ? b.socket.setBuffer(!1) : b.onClose())
      }

      function f() {
        this.onload = e, b.socket.setBuffer(!1)
      }
      var b = this;
      this.socket.setBuffer(!0), this.sendXHR = this.request("POST"), c.XDomainRequest && this.sendXHR instanceof XDomainRequest ? this.sendXHR.onload = this.sendXHR.onerror = f : this.sendXHR.onreadystatechange = d, this.sendXHR.send(a)
    }, d.prototype.close = function() {
      return this.onClose(), this
    }, d.prototype.request = function(a) {
      var c = b.util.request(this.socket.isXDomain()),
        d = b.util.query(this.socket.options.query, "t=" + +(new Date));
      c.open(a || "GET", this.prepareUrl() + d, !0);
      if (a == "POST") try {
        c.setRequestHeader ? c.setRequestHeader("Content-type", "text/plain;charset=UTF-8") : c.contentType = "text/plain"
      } catch (e) {}
      return c
    }, d.prototype.scheme = function() {
      return this.socket.options.secure ? "https" : "http"
    }, d.check = function(a, d) {
      try {
        var e = b.util.request(d),
          f = c.XDomainRequest && e instanceof XDomainRequest,
          g = a && a.options && a.options.secure ? "https:" : "http:",
          h = c.location && g != c.location.protocol;
        if (e && (!f || !h)) return !0
      } catch (i) {}
      return !1
    }, d.xdomainCheck = function(a) {
      return d.check(a, !0)
    }
  }("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this),
  function(a, b) {
    function c(a) {
      b.Transport.XHR.apply(this, arguments)
    }
    a.htmlfile = c, b.util.inherit(c, b.Transport.XHR), c.prototype.name = "htmlfile", c.prototype.get = function() {
      this.doc = new(window[["Active"].concat("Object").join("X")])("htmlfile"), this.doc.open(), this.doc.write("<html></html>"), this.doc.close(), this.doc.parentWindow.s = this;
      var a = this.doc.createElement("div");
      a.className = "socketio", this.doc.body.appendChild(a), this.iframe = this.doc.createElement("iframe"), a.appendChild(this.iframe);
      var c = this,
        d = b.util.query(this.socket.options.query, "t=" + +(new Date));
      this.iframe.src = this.prepareUrl() + d, b.util.on(window, "unload", function() {
        c.destroy()
      })
    }, c.prototype._ = function(a, b) {
      this.onData(a);
      try {
        var c = b.getElementsByTagName("script")[0];
        c.parentNode.removeChild(c)
      } catch (d) {}
    }, c.prototype.destroy = function() {
      if (this.iframe) {
        try {
          this.iframe.src = "about:blank"
        } catch (a) {}
        this.doc = null, this.iframe.parentNode.removeChild(this.iframe), this.iframe = null, CollectGarbage()
      }
    }, c.prototype.close = function() {
      return this.destroy(), b.Transport.XHR.prototype.close.call(this)
    }, c.check = function(a) {
      if (typeof window != "undefined" && ["Active"].concat("Object").join("X") in window) try {
        var c = new(window[["Active"].concat("Object").join("X")])("htmlfile");
        return c && b.Transport.XHR.check(a)
      } catch (d) {}
      return !1
    }, c.xdomainCheck = function() {
      return !1
    }, b.transports.push("htmlfile")
  }("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports),
  function(a, b, c) {
    function d() {
      b.Transport.XHR.apply(this, arguments)
    }

    function e() {}
    a["xhr-polling"] = d, b.util.inherit(d, b.Transport.XHR), b.util.merge(d, b.Transport.XHR), d.prototype.name = "xhr-polling", d.prototype.heartbeats = function() {
      return !1
    }, d.prototype.open = function() {
      var a = this;
      return b.Transport.XHR.prototype.open.call(a), !1
    }, d.prototype.get = function() {
      function b() {
        this.readyState == 4 && (this.onreadystatechange = e, this.status == 200 ? (a.onData(this.responseText), a.get()) : a.onClose())
      }

      function d() {
        this.onload = e, this.onerror = e, a.retryCounter = 1, a.onData(this.responseText), a.get()
      }

      function f() {
        a.retryCounter++, !a.retryCounter || a.retryCounter > 3 ? a.onClose() : a.get()
      }
      if (!this.isOpen) return;
      var a = this;
      this.xhr = this.request(), c.XDomainRequest && this.xhr instanceof XDomainRequest ? (this.xhr.onload = d, this.xhr.onerror = f) : this.xhr.onreadystatechange = b, this.xhr.send(null)
    }, d.prototype.onClose = function() {
      b.Transport.XHR.prototype.onClose.call(this);
      if (this.xhr) {
        this.xhr.onreadystatechange = this.xhr.onload = this.xhr.onerror = e;
        try {
          this.xhr.abort()
        } catch (a) {}
        this.xhr = null
      }
    }, d.prototype.ready = function(a, c) {
      var d = this;
      b.util.defer(function() {
        c.call(d)
      })
    }, b.transports.push("xhr-polling")
  }("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this),
  function(a, b, c) {
    function e(a) {
      b.Transport["xhr-polling"].apply(this, arguments), this.index = b.j.length;
      var c = this;
      b.j.push(function(a) {
        c._(a)
      })
    }
    var d = c.document && "MozAppearance" in c.document.documentElement.style;
    a["jsonp-polling"] = e, b.util.inherit(e, b.Transport["xhr-polling"]), e.prototype.name = "jsonp-polling", e.prototype.post = function(a) {
      function i() {
        j(), c.socket.setBuffer(!1)
      }

      function j() {
        c.iframe && c.form.removeChild(c.iframe);
        try {
          h = document.createElement('<iframe name="' + c.iframeId + '">')
        } catch (a) {
          h = document.createElement("iframe"), h.name = c.iframeId
        }
        h.id = c.iframeId, c.form.appendChild(h), c.iframe = h
      }
      var c = this,
        d = b.util.query(this.socket.options.query, "t=" + +(new Date) + "&i=" + this.index);
      if (!this.form) {
        var e = document.createElement("form"),
          f = document.createElement("textarea"),
          g = this.iframeId = "socketio_iframe_" + this.index,
          h;
        e.className = "socketio", e.style.position = "absolute", e.style.top = "0px", e.style.left = "0px", e.style.display = "none", e.target = g, e.method = "POST", e.setAttribute("accept-charset", "utf-8"), f.name = "d", e.appendChild(f), document.body.appendChild(e), this.form = e, this.area = f
      }
      this.form.action = this.prepareUrl() + d, j(), this.area.value = b.JSON.stringify(a);
      try {
        this.form.submit()
      } catch (k) {}
      this.iframe.attachEvent ? h.onreadystatechange = function() {
        c.iframe.readyState == "complete" && i()
      } : this.iframe.onload = i, this.socket.setBuffer(!0)
    }, e.prototype.get = function() {
      var a = this,
        c = document.createElement("script"),
        e = b.util.query(this.socket.options.query, "t=" + +(new Date) + "&i=" + this.index);
      this.script && (this.script.parentNode.removeChild(this.script), this.script = null), c.async = !0, c.src = this.prepareUrl() + e, c.onerror = function() {
        a.onClose()
      };
      var f = document.getElementsByTagName("script")[0];
      f.parentNode.insertBefore(c, f), this.script = c, d && setTimeout(function() {
        var a = document.createElement("iframe");
        document.body.appendChild(a), document.body.removeChild(a)
      }, 100)
    }, e.prototype._ = function(a) {
      return this.onData(a), this.isOpen && this.get(), this
    }, e.prototype.ready = function(a, c) {
      var e = this;
      if (!d) return c.call(this);
      b.util.load(function() {
        c.call(e)
      })
    }, e.check = function() {
      return "document" in c
    }, e.xdomainCheck = function() {
      return !0
    }, b.transports.push("jsonp-polling")
  }("undefined" != typeof io ? io.Transport : module.exports, "undefined" != typeof io ? io : module.parent.exports, this), typeof define == "function" && define.amd && define([], function() {
    return io
  })
})();
(function() {
  var a = this,
    b = b || {};
  b.WEBGL_RENDERER = 0, b.CANVAS_RENDERER = 1, b.VERSION = "v1.6.1", b.blendModes = {
    NORMAL: 0,
    ADD: 1,
    MULTIPLY: 2,
    SCREEN: 3,
    OVERLAY: 4,
    DARKEN: 5,
    LIGHTEN: 6,
    COLOR_DODGE: 7,
    COLOR_BURN: 8,
    HARD_LIGHT: 9,
    SOFT_LIGHT: 10,
    DIFFERENCE: 11,
    EXCLUSION: 12,
    HUE: 13,
    SATURATION: 14,
    COLOR: 15,
    LUMINOSITY: 16
  }, b.scaleModes = {
    DEFAULT: 0,
    LINEAR: 0,
    NEAREST: 1
  }, b._UID = 0, "undefined" != typeof Float32Array ? (b.Float32Array = Float32Array, b.Uint16Array = Uint16Array) : (b.Float32Array = Array, b.Uint16Array = Array), b.INTERACTION_FREQUENCY = 30, b.AUTO_PREVENT_DEFAULT = !0, b.RAD_TO_DEG = 180 / Math.PI, b.DEG_TO_RAD = Math.PI / 180, b.dontSayHello = !1, b.sayHello = function(a) {
    if (!b.dontSayHello) {
      if (navigator.userAgent.toLowerCase().indexOf("chrome") > -1) {
        var c = ["%c %c %c Pixi.js " + b.VERSION + " - " + a + "  %c  %c  http://www.pixijs.com/  %c %c %c%c ", "background: #ff66a5", "background: #ff66a5", "color: #ff66a5; background: #030307;", "background: #ff66a5", "background: #ffc3dc", "background: #ff66a5", "color: #ff2424; background: #fff", "color: #ff2424; background: #fff", "color: #ff2424; background: #fff"];
        console.log.apply(console, c)
      } else window.console && console.log("Pixi.js " + b.VERSION + " - http://www.pixijs.com/");
      b.dontSayHello = !0
    }
  }, b.Point = function(a, b) {
    this.x = a || 0, this.y = b || 0
  }, b.Point.prototype.clone = function() {
    return new b.Point(this.x, this.y)
  }, b.Point.prototype.set = function(a, b) {
    this.x = a || 0, this.y = b || (0 !== b ? this.x : 0)
  }, b.Point.prototype.constructor = b.Point, b.Rectangle = function(a, b, c, d) {
    this.x = a || 0, this.y = b || 0, this.width = c || 0, this.height = d || 0
  }, b.Rectangle.prototype.clone = function() {
    return new b.Rectangle(this.x, this.y, this.width, this.height)
  }, b.Rectangle.prototype.contains = function(a, b) {
    if (this.width <= 0 || this.height <= 0) return !1;
    var c = this.x;
    if (a >= c && a <= c + this.width) {
      var d = this.y;
      if (b >= d && b <= d + this.height) return !0
    }
    return !1
  }, b.Rectangle.prototype.constructor = b.Rectangle, b.EmptyRectangle = new b.Rectangle(0, 0, 0, 0), b.Polygon = function(a) {
    if (a instanceof Array || (a = Array.prototype.slice.call(arguments)), "number" == typeof a[0]) {
      for (var c = [], d = 0, e = a.length; e > d; d += 2) c.push(new b.Point(a[d], a[d + 1]));
      a = c
    }
    this.points = a
  }, b.Polygon.prototype.clone = function() {
    for (var a = [], c = 0; c < this.points.length; c++) a.push(this.points[c].clone());
    return new b.Polygon(a)
  }, b.Polygon.prototype.contains = function(a, b) {
    for (var c = !1, d = 0, e = this.points.length - 1; d < this.points.length; e = d++) {
      var f = this.points[d].x,
        g = this.points[d].y,
        h = this.points[e].x,
        i = this.points[e].y,
        j = g > b != i > b && (h - f) * (b - g) / (i - g) + f > a;
      j && (c = !c)
    }
    return c
  }, b.Polygon.prototype.constructor = b.Polygon, b.Circle = function(a, b, c) {
    this.x = a || 0, this.y = b || 0, this.radius = c || 0
  }, b.Circle.prototype.clone = function() {
    return new b.Circle(this.x, this.y, this.radius)
  }, b.Circle.prototype.contains = function(a, b) {
    if (this.radius <= 0) return !1;
    var c = this.x - a,
      d = this.y - b,
      e = this.radius * this.radius;
    return c *= c, d *= d, e >= c + d
  }, b.Circle.prototype.getBounds = function() {
    return new b.Rectangle(this.x - this.radius, this.y - this.radius, this.width, this.height)
  }, b.Circle.prototype.constructor = b.Circle, b.Ellipse = function(a, b, c, d) {
    this.x = a || 0, this.y = b || 0, this.width = c || 0, this.height = d || 0
  }, b.Ellipse.prototype.clone = function() {
    return new b.Ellipse(this.x, this.y, this.width, this.height)
  }, b.Ellipse.prototype.contains = function(a, b) {
    if (this.width <= 0 || this.height <= 0) return !1;
    var c = (a - this.x) / this.width,
      d = (b - this.y) / this.height;
    return c *= c, d *= d, 1 >= c + d
  }, b.Ellipse.prototype.getBounds = function() {
    return new b.Rectangle(this.x - this.width, this.y - this.height, this.width, this.height)
  }, b.Ellipse.prototype.constructor = b.Ellipse, b.Matrix = function() {
    this.a = 1, this.b = 0, this.c = 0, this.d = 1, this.tx = 0, this.ty = 0
  }, b.Matrix.prototype.fromArray = function(a) {
    this.a = a[0], this.b = a[1], this.c = a[3], this.d = a[4], this.tx = a[2], this.ty = a[5]
  }, b.Matrix.prototype.toArray = function(a) {
    this.array || (this.array = new Float32Array(9));
    var b = this.array;
    return a ? (b[0] = this.a, b[1] = this.c, b[2] = 0, b[3] = this.b, b[4] = this.d, b[5] = 0, b[6] = this.tx, b[7] = this.ty, b[8] = 1) : (b[0] = this.a, b[1] = this.b, b[2] = this.tx, b[3] = this.c, b[4] = this.d, b[5] = this.ty, b[6] = 0, b[7] = 0, b[8] = 1), b
  }, b.identityMatrix = new b.Matrix, b.determineMatrixArrayType = function() {
    return "undefined" != typeof Float32Array ? Float32Array : Array
  }, b.Matrix2 = b.determineMatrixArrayType(), b.DisplayObject = function() {
    this.position = new b.Point, this.scale = new b.Point(1, 1), this.pivot = new b.Point(0, 0), this.rotation = 0, this.alpha = 1, this.visible = !0, this.hitArea = null, this.buttonMode = !1, this.renderable = !1, this.parent = null, this.stage = null, this.worldAlpha = 1, this._interactive = !1, this.defaultCursor = "pointer", this.worldTransform = new b.Matrix, this.color = [], this.dynamic = !0, this._sr = 0, this._cr = 1, this.filterArea = null, this._bounds = new b.Rectangle(0, 0, 1, 1), this._currentBounds = null, this._mask = null, this._cacheAsBitmap = !1, this._cacheIsDirty = !1
  }, b.DisplayObject.prototype.constructor = b.DisplayObject, b.DisplayObject.prototype.setInteractive = function(a) {
    this.interactive = a
  }, Object.defineProperty(b.DisplayObject.prototype, "interactive", {
    get: function() {
      return this._interactive
    },
    set: function(a) {
      this._interactive = a, this.stage && (this.stage.dirty = !0)
    }
  }), Object.defineProperty(b.DisplayObject.prototype, "worldVisible", {
    get: function() {
      var a = this;
      do {
        if (!a.visible) return !1;
        a = a.parent
      } while (a);
      return !0
    }
  }), Object.defineProperty(b.DisplayObject.prototype, "mask", {
    get: function() {
      return this._mask
    },
    set: function(a) {
      this._mask && (this._mask.isMask = !1), this._mask = a, this._mask && (this._mask.isMask = !0)
    }
  }), Object.defineProperty(b.DisplayObject.prototype, "filters", {
    get: function() {
      return this._filters
    },
    set: function(a) {
      if (a) {
        for (var b = [], c = 0; c < a.length; c++)
          for (var d = a[c].passes, e = 0; e < d.length; e++) b.push(d[e]);
        this._filterBlock = {
          target: this,
          filterPasses: b
        }
      }
      this._filters = a
    }
  }), Object.defineProperty(b.DisplayObject.prototype, "cacheAsBitmap", {
    get: function() {
      return this._cacheAsBitmap
    },
    set: function(a) {
      this._cacheAsBitmap !== a && (a ? this._generateCachedSprite() : this._destroyCachedSprite(), this._cacheAsBitmap = a)
    }
  }), b.DisplayObject.prototype.updateTransform = function() {
    this.rotation !== this.rotationCache && (this.rotationCache = this.rotation, this._sr = Math.sin(this.rotation), this._cr = Math.cos(this.rotation));
    var a = this.parent.worldTransform,
      b = this.worldTransform,
      c = this.pivot.x,
      d = this.pivot.y,
      e = this._cr * this.scale.x,
      f = -this._sr * this.scale.y,
      g = this._sr * this.scale.x,
      h = this._cr * this.scale.y,
      i = this.position.x - e * c - d * f,
      j = this.position.y - h * d - c * g,
      k = a.a,
      l = a.b,
      m = a.c,
      n = a.d;
    b.a = k * e + l * g, b.b = k * f + l * h, b.tx = k * i + l * j + a.tx, b.c = m * e + n * g, b.d = m * f + n * h, b.ty = m * i + n * j + a.ty, this.worldAlpha = this.alpha * this.parent.worldAlpha
  }, b.DisplayObject.prototype.getBounds = function(a) {
    return a = a, b.EmptyRectangle
  }, b.DisplayObject.prototype.getLocalBounds = function() {
    return this.getBounds(b.identityMatrix)
  }, b.DisplayObject.prototype.setStageReference = function(a) {
    this.stage = a, this._interactive && (this.stage.dirty = !0)
  }, b.DisplayObject.prototype.generateTexture = function(a) {
    var c = this.getLocalBounds(),
      d = new b.RenderTexture(0 | c.width, 0 | c.height, a);
    return d.render(this, new b.Point(-c.x, -c.y)), d
  }, b.DisplayObject.prototype.updateCache = function() {
    this._generateCachedSprite()
  }, b.DisplayObject.prototype._renderCachedSprite = function(a) {
    this._cachedSprite.worldAlpha = this.worldAlpha, a.gl ? b.Sprite.prototype._renderWebGL.call(this._cachedSprite, a) : b.Sprite.prototype._renderCanvas.call(this._cachedSprite, a)
  }, b.DisplayObject.prototype._generateCachedSprite = function() {
    this._cacheAsBitmap = !1;
    var a = this.getLocalBounds();
    if (this._cachedSprite) this._cachedSprite.texture.resize(0 | a.width, 0 | a.height);
    else {
      var c = new b.RenderTexture(0 | a.width, 0 | a.height);
      this._cachedSprite = new b.Sprite(c), this._cachedSprite.worldTransform = this.worldTransform
    }
    var d = this._filters;
    this._filters = null, this._cachedSprite.filters = d, this._cachedSprite.texture.render(this, new b.Point(-a.x, -a.y)), this._cachedSprite.anchor.x = -(a.x / a.width), this._cachedSprite.anchor.y = -(a.y / a.height), this._filters = d, this._cacheAsBitmap = !0
  }, b.DisplayObject.prototype._destroyCachedSprite = function() {
    this._cachedSprite && (this._cachedSprite.texture.destroy(!0), this._cachedSprite = null)
  }, b.DisplayObject.prototype._renderWebGL = function(a) {
    a = a
  }, b.DisplayObject.prototype._renderCanvas = function(a) {
    a = a
  }, Object.defineProperty(b.DisplayObject.prototype, "x", {
    get: function() {
      return this.position.x
    },
    set: function(a) {
      this.position.x = a
    }
  }), Object.defineProperty(b.DisplayObject.prototype, "y", {
    get: function() {
      return this.position.y
    },
    set: function(a) {
      this.position.y = a
    }
  }), b.DisplayObjectContainer = function() {
    b.DisplayObject.call(this), this.children = []
  }, b.DisplayObjectContainer.prototype = Object.create(b.DisplayObject.prototype), b.DisplayObjectContainer.prototype.constructor = b.DisplayObjectContainer, Object.defineProperty(b.DisplayObjectContainer.prototype, "width", {
    get: function() {
      return this.scale.x * this.getLocalBounds().width
    },
    set: function(a) {
      var b = this.getLocalBounds().width;
      this.scale.x = 0 !== b ? a / (b / this.scale.x) : 1, this._width = a
    }
  }), Object.defineProperty(b.DisplayObjectContainer.prototype, "height", {
    get: function() {
      return this.scale.y * this.getLocalBounds().height
    },
    set: function(a) {
      var b = this.getLocalBounds().height;
      this.scale.y = 0 !== b ? a / (b / this.scale.y) : 1, this._height = a
    }
  }), b.DisplayObjectContainer.prototype.addChild = function(a) {
    return this.addChildAt(a, this.children.length)
  }, b.DisplayObjectContainer.prototype.addChildAt = function(a, b) {
    if (b >= 0 && b <= this.children.length) return a.parent && a.parent.removeChild(a), a.parent = this, this.children.splice(b, 0, a), this.stage && a.setStageReference(this.stage), a;
    throw new Error(a + " The index " + b + " supplied is out of bounds " + this.children.length)
  }, b.DisplayObjectContainer.prototype.swapChildren = function(a, b) {
    if (a !== b) {
      var c = this.children.indexOf(a),
        d = this.children.indexOf(b);
      if (0 > c || 0 > d) throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");
      this.children[c] = b, this.children[d] = a
    }
  }, b.DisplayObjectContainer.prototype.getChildAt = function(a) {
    if (a >= 0 && a < this.children.length) return this.children[a];
    throw new Error("Supplied index does not exist in the child list, or the supplied DisplayObject must be a child of the caller")
  }, b.DisplayObjectContainer.prototype.removeChild = function(a) {
    return this.removeChildAt(this.children.indexOf(a))
  }, b.DisplayObjectContainer.prototype.removeChildAt = function(a) {
    var b = this.getChildAt(a);
    return this.stage && b.removeStageReference(), b.parent = void 0, this.children.splice(a, 1), b
  }, b.DisplayObjectContainer.prototype.removeChildren = function(a, b) {
    var c = a || 0,
      d = "number" == typeof b ? b : this.children.length,
      e = d - c;
    if (e > 0 && d >= e) {
      for (var f = this.children.splice(c, e), g = 0; g < f.length; g++) {
        var h = f[g];
        this.stage && h.removeStageReference(), h.parent = void 0
      }
      return f
    }
    throw new Error("Range Error, numeric values are outside the acceptable range")
  }, b.DisplayObjectContainer.prototype.updateTransform = function() {
    if (this.visible && (b.DisplayObject.prototype.updateTransform.call(this), !this._cacheAsBitmap))
      for (var a = 0, c = this.children.length; c > a; a++) this.children[a].updateTransform()
  }, b.DisplayObjectContainer.prototype.getBounds = function(a) {
    if (0 === this.children.length) return b.EmptyRectangle;
    if (a) {
      var c = this.worldTransform;
      this.worldTransform = a, this.updateTransform(), this.worldTransform = c
    }
    for (var d, e, f, g = 1 / 0, h = 1 / 0, i = -1 / 0, j = -1 / 0, k = !1, l = 0, m = this.children.length; m > l; l++) {
      var n = this.children[l];
      n.visible && (k = !0, d = this.children[l].getBounds(a), g = g < d.x ? g : d.x, h = h < d.y ? h : d.y, e = d.width + d.x, f = d.height + d.y, i = i > e ? i : e, j = j > f ? j : f)
    }
    if (!k) return b.EmptyRectangle;
    var o = this._bounds;
    return o.x = g, o.y = h, o.width = i - g, o.height = j - h, o
  }, b.DisplayObjectContainer.prototype.getLocalBounds = function() {
    var a = this.worldTransform;
    this.worldTransform = b.identityMatrix;
    for (var c = 0, d = this.children.length; d > c; c++) this.children[c].updateTransform();
    var e = this.getBounds();
    return this.worldTransform = a, e
  }, b.DisplayObjectContainer.prototype.setStageReference = function(a) {
    this.stage = a, this._interactive && (this.stage.dirty = !0);
    for (var b = 0, c = this.children.length; c > b; b++) {
      var d = this.children[b];
      d.setStageReference(a)
    }
  }, b.DisplayObjectContainer.prototype.removeStageReference = function() {
    for (var a = 0, b = this.children.length; b > a; a++) {
      var c = this.children[a];
      c.removeStageReference()
    }
    this._interactive && (this.stage.dirty = !0), this.stage = null
  }, b.DisplayObjectContainer.prototype._renderWebGL = function(a) {
    if (this.visible && !(this.alpha <= 0)) {
      if (this._cacheAsBitmap) return this._renderCachedSprite(a), void 0;
      var b, c;
      if (this._mask || this._filters) {
        for (this._filters && (a.spriteBatch.flush(), a.filterManager.pushFilter(this._filterBlock)), this._mask && (a.spriteBatch.stop(), a.maskManager.pushMask(this.mask, a), a.spriteBatch.start()), b = 0, c = this.children.length; c > b; b++) this.children[b]._renderWebGL(a);
        a.spriteBatch.stop(), this._mask && a.maskManager.popMask(this._mask, a), this._filters && a.filterManager.popFilter(), a.spriteBatch.start()
      } else
        for (b = 0, c = this.children.length; c > b; b++) this.children[b]._renderWebGL(a)
    }
  }, b.DisplayObjectContainer.prototype._renderCanvas = function(a) {
    if (this.visible !== !1 && 0 !== this.alpha) {
      if (this._cacheAsBitmap) return this._renderCachedSprite(a), void 0;
      this._mask && a.maskManager.pushMask(this._mask, a.context);
      for (var b = 0, c = this.children.length; c > b; b++) {
        var d = this.children[b];
        d._renderCanvas(a)
      }
      this._mask && a.maskManager.popMask(a.context)
    }
  }, b.Sprite = function(a) {
    b.DisplayObjectContainer.call(this), this.anchor = new b.Point, this.texture = a, this._width = 0, this._height = 0, this.tint = 16777215, this.blendMode = b.blendModes.NORMAL, a.baseTexture.hasLoaded ? this.onTextureUpdate() : (this.onTextureUpdateBind = this.onTextureUpdate.bind(this), this.texture.addEventListener("update", this.onTextureUpdateBind)), this.renderable = !0
  }, b.Sprite.prototype = Object.create(b.DisplayObjectContainer.prototype), b.Sprite.prototype.constructor = b.Sprite, Object.defineProperty(b.Sprite.prototype, "width", {
    get: function() {
      return this.scale.x * this.texture.frame.width
    },
    set: function(a) {
      this.scale.x = a / this.texture.frame.width, this._width = a
    }
  }), Object.defineProperty(b.Sprite.prototype, "height", {
    get: function() {
      return this.scale.y * this.texture.frame.height
    },
    set: function(a) {
      this.scale.y = a / this.texture.frame.height, this._height = a
    }
  }), b.Sprite.prototype.setTexture = function(a) {
    this.texture = a, this.cachedTint = 16777215
  }, b.Sprite.prototype.onTextureUpdate = function() {
    this._width && (this.scale.x = this._width / this.texture.frame.width), this._height && (this.scale.y = this._height / this.texture.frame.height)
  }, b.Sprite.prototype.getBounds = function(a) {
    var b = this.texture.frame.width,
      c = this.texture.frame.height,
      d = b * (1 - this.anchor.x),
      e = b * -this.anchor.x,
      f = c * (1 - this.anchor.y),
      g = c * -this.anchor.y,
      h = a || this.worldTransform,
      i = h.a,
      j = h.c,
      k = h.b,
      l = h.d,
      m = h.tx,
      n = h.ty,
      o = i * e + k * g + m,
      p = l * g + j * e + n,
      q = i * d + k * g + m,
      r = l * g + j * d + n,
      s = i * d + k * f + m,
      t = l * f + j * d + n,
      u = i * e + k * f + m,
      v = l * f + j * e + n,
      w = -1 / 0,
      x = -1 / 0,
      y = 1 / 0,
      z = 1 / 0;
    y = y > o ? o : y, y = y > q ? q : y, y = y > s ? s : y, y = y > u ? u : y, z = z > p ? p : z, z = z > r ? r : z, z = z > t ? t : z, z = z > v ? v : z, w = o > w ? o : w, w = q > w ? q : w, w = s > w ? s : w, w = u > w ? u : w, x = p > x ? p : x, x = r > x ? r : x, x = t > x ? t : x, x = v > x ? v : x;
    var A = this._bounds;
    return A.x = y, A.width = w - y, A.y = z, A.height = x - z, this._currentBounds = A, A
  }, b.Sprite.prototype._renderWebGL = function(a) {
    if (this.visible && !(this.alpha <= 0)) {
      var b, c;
      if (this._mask || this._filters) {
        var d = a.spriteBatch;
        for (this._filters && (d.flush(), a.filterManager.pushFilter(this._filterBlock)), this._mask && (d.stop(), a.maskManager.pushMask(this.mask, a), d.start()), d.render(this), b = 0, c = this.children.length; c > b; b++) this.children[b]._renderWebGL(a);
        d.stop(), this._mask && a.maskManager.popMask(this._mask, a), this._filters && a.filterManager.popFilter(), d.start()
      } else
        for (a.spriteBatch.render(this), b = 0, c = this.children.length; c > b; b++) this.children[b]._renderWebGL(a)
    }
  }, b.Sprite.prototype._renderCanvas = function(a) {
    if (this.visible !== !1 && 0 !== this.alpha) {
      if (this.blendMode !== a.currentBlendMode && (a.currentBlendMode = this.blendMode, a.context.globalCompositeOperation = b.blendModesCanvas[a.currentBlendMode]), this._mask && a.maskManager.pushMask(this._mask, a.context), this.texture.valid) {
        a.context.globalAlpha = this.worldAlpha, a.roundPixels ? a.context.setTransform(this.worldTransform.a, this.worldTransform.c, this.worldTransform.b, this.worldTransform.d, 0 | this.worldTransform.tx, 0 | this.worldTransform.ty) : a.context.setTransform(this.worldTransform.a, this.worldTransform.c, this.worldTransform.b, this.worldTransform.d, this.worldTransform.tx, this.worldTransform.ty), a.smoothProperty && a.scaleMode !== this.texture.baseTexture.scaleMode && (a.scaleMode = this.texture.baseTexture.scaleMode, a.context[a.smoothProperty] = a.scaleMode === b.scaleModes.LINEAR);
        var c = this.texture.trim ? this.texture.trim.x - this.anchor.x * this.texture.trim.width : this.anchor.x * -this.texture.frame.width,
          d = this.texture.trim ? this.texture.trim.y - this.anchor.y * this.texture.trim.height : this.anchor.y * -this.texture.frame.height;
        16777215 !== this.tint ? (this.cachedTint !== this.tint && (this.cachedTint = this.tint, this.tintedTexture = b.CanvasTinter.getTintedTexture(this, this.tint)), a.context.drawImage(this.tintedTexture, 0, 0, this.texture.crop.width, this.texture.crop.height, c, d, this.texture.crop.width, this.texture.crop.height)) : a.context.drawImage(this.texture.baseTexture.source, this.texture.crop.x, this.texture.crop.y, this.texture.crop.width, this.texture.crop.height, c, d, this.texture.crop.width, this.texture.crop.height)
      }
      for (var e = 0, f = this.children.length; f > e; e++) this.children[e]._renderCanvas(a);
      this._mask && a.maskManager.popMask(a.context)
    }
  }, b.Sprite.fromFrame = function(a) {
    var c = b.TextureCache[a];
    if (!c) throw new Error('The frameId "' + a + '" does not exist in the texture cache' + this);
    return new b.Sprite(c)
  }, b.Sprite.fromImage = function(a, c, d) {
    var e = b.Texture.fromImage(a, c, d);
    return new b.Sprite(e)
  }, b.SpriteBatch = function(a) {
    b.DisplayObjectContainer.call(this), this.textureThing = a, this.ready = !1
  }, b.SpriteBatch.prototype = Object.create(b.DisplayObjectContainer.prototype), b.SpriteBatch.constructor = b.SpriteBatch, b.SpriteBatch.prototype.initWebGL = function(a) {
    this.fastSpriteBatch = new b.WebGLFastSpriteBatch(a), this.ready = !0
  }, b.SpriteBatch.prototype.updateTransform = function() {
    b.DisplayObject.prototype.updateTransform.call(this)
  }, b.SpriteBatch.prototype._renderWebGL = function(a) {
    !this.visible || this.alpha <= 0 || !this.children.length || (this.ready || this.initWebGL(a.gl), a.spriteBatch.stop(), a.shaderManager.setShader(a.shaderManager.fastShader), this.fastSpriteBatch.begin(this, a), this.fastSpriteBatch.render(this), a.spriteBatch.start())
  }, b.SpriteBatch.prototype._renderCanvas = function(a) {
    var c = a.context;
    c.globalAlpha = this.worldAlpha, b.DisplayObject.prototype.updateTransform.call(this);
    for (var d = this.worldTransform, e = !0, f = 0; f < this.children.length; f++) {
      var g = this.children[f];
      if (g.visible) {
        var h = g.texture,
          i = h.frame;
        if (c.globalAlpha = this.worldAlpha * g.alpha, g.rotation % (2 * Math.PI) === 0) e && (c.setTransform(d.a, d.c, d.b, d.d, d.tx, d.ty), e = !1), c.drawImage(h.baseTexture.source, i.x, i.y, i.width, i.height, g.anchor.x * -i.width * g.scale.x + g.position.x + .5 | 0, g.anchor.y * -i.height * g.scale.y + g.position.y + .5 | 0, i.width * g.scale.x, i.height * g.scale.y);
        else {
          e || (e = !0), b.DisplayObject.prototype.updateTransform.call(g);
          var j = g.worldTransform;
          a.roundPixels ? c.setTransform(j.a, j.c, j.b, j.d, 0 | j.tx, 0 | j.ty) : c.setTransform(j.a, j.c, j.b, j.d, j.tx, j.ty), c.drawImage(h.baseTexture.source, i.x, i.y, i.width, i.height, g.anchor.x * -i.width + .5 | 0, g.anchor.y * -i.height + .5 | 0, i.width, i.height)
        }
      }
    }
  }, b.MovieClip = function(a) {
    b.Sprite.call(this, a[0]), this.textures = a, this.animationSpeed = 1, this.loop = !0, this.onComplete = null, this.currentFrame = 0, this.playing = !1
  }, b.MovieClip.prototype = Object.create(b.Sprite.prototype), b.MovieClip.prototype.constructor = b.MovieClip, Object.defineProperty(b.MovieClip.prototype, "totalFrames", {
    get: function() {
      return this.textures.length
    }
  }), b.MovieClip.prototype.stop = function() {
    this.playing = !1
  }, b.MovieClip.prototype.play = function() {
    this.playing = !0
  }, b.MovieClip.prototype.gotoAndStop = function(a) {
    this.playing = !1, this.currentFrame = a;
    var b = this.currentFrame + .5 | 0;
    this.setTexture(this.textures[b % this.textures.length])
  }, b.MovieClip.prototype.gotoAndPlay = function(a) {
    this.currentFrame = a, this.playing = !0
  }, b.MovieClip.prototype.updateTransform = function() {
    if (b.Sprite.prototype.updateTransform.call(this), this.playing) {
      this.currentFrame += this.animationSpeed;
      var a = this.currentFrame + .5 | 0;
      this.currentFrame = this.currentFrame % this.textures.length, this.loop || a < this.textures.length ? this.setTexture(this.textures[a % this.textures.length]) : a >= this.textures.length && (this.gotoAndStop(this.textures.length - 1), this.onComplete && this.onComplete())
    }
  }, b.MovieClip.fromFrames = function(a) {
    for (var c = [], d = 0; d < a.length; d++) c.push(new b.Texture.fromFrame(a[d]));
    return new b.MovieClip(c)
  }, b.MovieClip.fromImages = function(a) {
    for (var c = [], d = 0; d < a.length; d++) c.push(new b.Texture.fromImage(a[d]));
    return new b.MovieClip(c)
  }, b.FilterBlock = function() {
    this.visible = !0, this.renderable = !0
  }, b.Text = function(a, c) {
    this.canvas = document.createElement("canvas"), this.context = this.canvas.getContext("2d"), b.Sprite.call(this, b.Texture.fromCanvas(this.canvas)), this.setText(a), this.setStyle(c)
  }, b.Text.prototype = Object.create(b.Sprite.prototype), b.Text.prototype.constructor = b.Text, Object.defineProperty(b.Text.prototype, "width", {
    get: function() {
      return this.dirty && (this.updateText(), this.dirty = !1), this.scale.x * this.texture.frame.width
    },
    set: function(a) {
      this.scale.x = a / this.texture.frame.width, this._width = a
    }
  }), Object.defineProperty(b.Text.prototype, "height", {
    get: function() {
      return this.dirty && (this.updateText(), this.dirty = !1), this.scale.y * this.texture.frame.height
    },
    set: function(a) {
      this.scale.y = a / this.texture.frame.height, this._height = a
    }
  }), b.Text.prototype.setStyle = function(a) {
    a = a || {}, a.font = a.font || "bold 20pt Arial", a.fill = a.fill || "black", a.align = a.align || "left", a.stroke = a.stroke || "black", a.strokeThickness = a.strokeThickness || 0, a.wordWrap = a.wordWrap || !1, a.wordWrapWidth = a.wordWrapWidth || 100, a.wordWrapWidth = a.wordWrapWidth || 100, a.dropShadow = a.dropShadow || !1, a.dropShadowAngle = a.dropShadowAngle || Math.PI / 6, a.dropShadowDistance = a.dropShadowDistance || 4, a.dropShadowColor = a.dropShadowColor || "black", this.style = a, this.dirty = !0
  }, b.Text.prototype.setText = function(a) {
    this.text = a.toString() || " ", this.dirty = !0
  }, b.Text.prototype.updateText = function() {
    this.context.font = this.style.font;
    var a = this.text;
    this.style.wordWrap && (a = this.wordWrap(this.text));
    for (var b = a.split(/(?:\r\n|\r|\n)/), c = [], d = 0, e = 0; e < b.length; e++) {
      var f = this.context.measureText(b[e]).width;
      c[e] = f, d = Math.max(d, f)
    }
    var g = d + this.style.strokeThickness;
    this.style.dropShadow && (g += this.style.dropShadowDistance), this.canvas.width = g + this.context.lineWidth;
    var h = this.determineFontHeight("font: " + this.style.font + ";") + this.style.strokeThickness,
      i = h * b.length;
    this.style.dropShadow && (i += this.style.dropShadowDistance), this.canvas.height = i, navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height), this.context.font = this.style.font, this.context.strokeStyle = this.style.stroke, this.context.lineWidth = this.style.strokeThickness, this.context.textBaseline = "top";
    var j, k;
    if (this.style.dropShadow) {
      this.context.fillStyle = this.style.dropShadowColor;
      var l = Math.sin(this.style.dropShadowAngle) * this.style.dropShadowDistance,
        m = Math.cos(this.style.dropShadowAngle) * this.style.dropShadowDistance;
      for (e = 0; e < b.length; e++) j = this.style.strokeThickness / 2, k = this.style.strokeThickness / 2 + e * h, "right" === this.style.align ? j += d - c[e] : "center" === this.style.align && (j += (d - c[e]) / 2), this.style.fill && this.context.fillText(b[e], j + l, k + m)
    }
    for (this.context.fillStyle = this.style.fill, e = 0; e < b.length; e++) j = this.style.strokeThickness / 2, k = this.style.strokeThickness / 2 + e * h, "right" === this.style.align ? j += d - c[e] : "center" === this.style.align && (j += (d - c[e]) / 2), this.style.stroke && this.style.strokeThickness && this.context.strokeText(b[e], j, k), this.style.fill && this.context.fillText(b[e], j, k);
    this.updateTexture()
  }, b.Text.prototype.updateTexture = function() {
    this.texture.baseTexture.width = this.canvas.width, this.texture.baseTexture.height = this.canvas.height, this.texture.crop.width = this.texture.frame.width = this.canvas.width, this.texture.crop.height = this.texture.frame.height = this.canvas.height, this._width = this.canvas.width, this._height = this.canvas.height, this.requiresUpdate = !0
  }, b.Text.prototype._renderWebGL = function(a) {
    this.requiresUpdate && (this.requiresUpdate = !1, b.updateWebGLTexture(this.texture.baseTexture, a.gl)), b.Sprite.prototype._renderWebGL.call(this, a)
  }, b.Text.prototype.updateTransform = function() {
    this.dirty && (this.updateText(), this.dirty = !1), b.Sprite.prototype.updateTransform.call(this)
  }, b.Text.prototype.determineFontHeight = function(a) {
    var c = b.Text.heightCache[a];
    if (!c) {
      var d = document.getElementsByTagName("body")[0],
        e = document.createElement("div"),
        f = document.createTextNode("M");
      e.appendChild(f), e.setAttribute("style", a + ";position:absolute;top:0;left:0"), d.appendChild(e), c = e.offsetHeight, b.Text.heightCache[a] = c, d.removeChild(e)
    }
    return c
  }, b.Text.prototype.wordWrap = function(a) {
    for (var b = "", c = a.split("\n"), d = 0; d < c.length; d++) {
      for (var e = this.style.wordWrapWidth, f = c[d].split(" "), g = 0; g < f.length; g++) {
        var h = this.context.measureText(f[g]).width,
          i = h + this.context.measureText(" ").width;
        0 === g || i > e ? (g > 0 && (b += "\n"), b += f[g], e = this.style.wordWrapWidth - h) : (e -= i, b += " " + f[g])
      }
      d < c.length - 1 && (b += "\n")
    }
    return b
  }, b.Text.prototype.destroy = function(a) {
    this.context = null, this.canvas = null, this.texture.destroy(void 0 === a ? !0 : a)
  }, b.Text.heightCache = {}, b.BitmapText = function(a, c) {
    b.DisplayObjectContainer.call(this), this._pool = [], this.setText(a), this.setStyle(c), this.updateText(), this.dirty = !1
  }, b.BitmapText.prototype = Object.create(b.DisplayObjectContainer.prototype), b.BitmapText.prototype.constructor = b.BitmapText, b.BitmapText.prototype.setText = function(a) {
    this.text = a || " ", this.dirty = !0
  }, b.BitmapText.prototype.setStyle = function(a) {
    a = a || {}, a.align = a.align || "left", this.style = a;
    var c = a.font.split(" ");
    this.fontName = c[c.length - 1], this.fontSize = c.length >= 2 ? parseInt(c[c.length - 2], 10) : b.BitmapText.fonts[this.fontName].size, this.dirty = !0, this.tint = a.tint
  }, b.BitmapText.prototype.updateText = function() {
    for (var a = b.BitmapText.fonts[this.fontName], c = new b.Point, d = null, e = [], f = 0, g = [], h = 0, i = this.fontSize / a.size, j = 0; j < this.text.length; j++) {
      var k = this.text.charCodeAt(j);
      if (/(?:\r\n|\r|\n)/.test(this.text.charAt(j))) g.push(c.x), f = Math.max(f, c.x), h++, c.x = 0, c.y += a.lineHeight, d = null;
      else {
        var l = a.chars[k];
        l && (d && l[d] && (c.x += l.kerning[d]), e.push({
          texture: l.texture,
          line: h,
          charCode: k,
          position: new b.Point(c.x + l.xOffset, c.y + l.yOffset)
        }), c.x += l.xAdvance, d = k)
      }
    }
    g.push(c.x), f = Math.max(f, c.x);
    var m = [];
    for (j = 0; h >= j; j++) {
      var n = 0;
      "right" === this.style.align ? n = f - g[j] : "center" === this.style.align && (n = (f - g[j]) / 2), m.push(n)
    }
    var o = this.children.length,
      p = e.length,
      q = this.tint || 16777215;
    for (j = 0; p > j; j++) {
      var r = o > j ? this.children[j] : this._pool.pop();
      r ? r.setTexture(e[j].texture) : r = new b.Sprite(e[j].texture), r.position.x = (e[j].position.x + m[e[j].line]) * i, r.position.y = e[j].position.y * i, r.scale.x = r.scale.y = i, r.tint = q, r.parent || this.addChild(r)
    }
    for (; this.children.length > p;) {
      var s = this.getChildAt(this.children.length - 1);
      this._pool.push(s), this.removeChild(s)
    }
    this.textWidth = f * i, this.textHeight = (c.y + a.lineHeight) * i
  }, b.BitmapText.prototype.updateTransform = function() {
    this.dirty && (this.updateText(), this.dirty = !1), b.DisplayObjectContainer.prototype.updateTransform.call(this)
  }, b.BitmapText.fonts = {}, b.InteractionData = function() {
    this.global = new b.Point, this.target = null, this.originalEvent = null
  }, b.InteractionData.prototype.getLocalPosition = function(a) {
    var c = a.worldTransform,
      d = this.global,
      e = c.a,
      f = c.b,
      g = c.tx,
      h = c.c,
      i = c.d,
      j = c.ty,
      k = 1 / (e * i + f * -h);
    return new b.Point(i * k * d.x + -f * k * d.y + (j * f - g * i) * k, e * k * d.y + -h * k * d.x + (-j * e + g * h) * k)
  }, b.InteractionData.prototype.constructor = b.InteractionData, b.InteractionManager = function(a) {
    this.stage = a, this.mouse = new b.InteractionData, this.touchs = {}, this.tempPoint = new b.Point, this.mouseoverEnabled = !0, this.pool = [], this.interactiveItems = [], this.interactionDOMElement = null, this.onMouseMove = this.onMouseMove.bind(this), this.onMouseDown = this.onMouseDown.bind(this), this.onMouseOut = this.onMouseOut.bind(this), this.onMouseUp = this.onMouseUp.bind(this), this.onTouchStart = this.onTouchStart.bind(this), this.onTouchEnd = this.onTouchEnd.bind(this), this.onTouchMove = this.onTouchMove.bind(this), this.last = 0, this.currentCursorStyle = "inherit", this.mouseOut = !1
  }, b.InteractionManager.prototype.constructor = b.InteractionManager, b.InteractionManager.prototype.collectInteractiveSprite = function(a, b) {
    for (var c = a.children, d = c.length, e = d - 1; e >= 0; e--) {
      var f = c[e];
      f._interactive ? (b.interactiveChildren = !0, this.interactiveItems.push(f), f.children.length > 0 && this.collectInteractiveSprite(f, f)) : (f.__iParent = null, f.children.length > 0 && this.collectInteractiveSprite(f, b))
    }
  }, b.InteractionManager.prototype.setTarget = function(a) {
    this.target = a, null === this.interactionDOMElement && this.setTargetDomElement(a.view)
  }, b.InteractionManager.prototype.setTargetDomElement = function(a) {
    this.removeEvents(), window.navigator.msPointerEnabled && (a.style["-ms-content-zooming"] = "none", a.style["-ms-touch-action"] = "none"), this.interactionDOMElement = a, a.addEventListener("mousemove", this.onMouseMove, !0), a.addEventListener("mousedown", this.onMouseDown, !0), a.addEventListener("mouseout", this.onMouseOut, !0), a.addEventListener("touchstart", this.onTouchStart, !0), a.addEventListener("touchend", this.onTouchEnd, !0), a.addEventListener("touchmove", this.onTouchMove, !0), window.addEventListener("mouseup", this.onMouseUp, !0)
  }, b.InteractionManager.prototype.removeEvents = function() {
    this.interactionDOMElement && (this.interactionDOMElement.style["-ms-content-zooming"] = "", this.interactionDOMElement.style["-ms-touch-action"] = "", this.interactionDOMElement.removeEventListener("mousemove", this.onMouseMove, !0), this.interactionDOMElement.removeEventListener("mousedown", this.onMouseDown, !0), this.interactionDOMElement.removeEventListener("mouseout", this.onMouseOut, !0), this.interactionDOMElement.removeEventListener("touchstart", this.onTouchStart, !0), this.interactionDOMElement.removeEventListener("touchend", this.onTouchEnd, !0), this.interactionDOMElement.removeEventListener("touchmove", this.onTouchMove, !0), this.interactionDOMElement = null, window.removeEventListener("mouseup", this.onMouseUp, !0))
  }, b.InteractionManager.prototype.update = function() {
    if (this.target) {
      var a = Date.now(),
        c = a - this.last;
      if (c = c * b.INTERACTION_FREQUENCY / 1e3, !(1 > c)) {
        this.last = a;
        var d = 0;
        this.dirty && this.rebuildInteractiveGraph();
        var e = this.interactiveItems.length,
          f = "inherit",
          g = !1;
        for (d = 0; e > d; d++) {
          var h = this.interactiveItems[d];
          h.__hit = this.hitTest(h, this.mouse), this.mouse.target = h, h.__hit && !g ? (h.buttonMode && (f = h.defaultCursor), h.interactiveChildren || (g = !0), h.__isOver || (h.mouseover && h.mouseover(this.mouse), h.__isOver = !0)) : h.__isOver && (h.mouseout && h.mouseout(this.mouse), h.__isOver = !1)
        }
        this.currentCursorStyle !== f && (this.currentCursorStyle = f, this.interactionDOMElement.style.cursor = f)
      }
    }
  }, b.InteractionManager.prototype.rebuildInteractiveGraph = function() {
    this.dirty = !1;
    for (var a = this.interactiveItems.length, b = 0; a > b; b++) this.interactiveItems[b].interactiveChildren = !1;
    this.interactiveItems = [], this.stage.interactive && this.interactiveItems.push(this.stage), this.collectInteractiveSprite(this.stage, this.stage)
  }, b.InteractionManager.prototype.onMouseMove = function(a) {
    this.dirty && this.rebuildInteractiveGraph(), this.mouse.originalEvent = a || window.event;
    var b = this.interactionDOMElement.getBoundingClientRect();
    this.mouse.global.x = (a.clientX - b.left) * (this.target.width / b.width), this.mouse.global.y = (a.clientY - b.top) * (this.target.height / b.height);
    for (var c = this.interactiveItems.length, d = 0; c > d; d++) {
      var e = this.interactiveItems[d];
      e.mousemove && e.mousemove(this.mouse)
    }
  }, b.InteractionManager.prototype.onMouseDown = function(a) {
    this.dirty && this.rebuildInteractiveGraph(), this.mouse.originalEvent = a || window.event, b.AUTO_PREVENT_DEFAULT && this.mouse.originalEvent.preventDefault();
    for (var c = this.interactiveItems.length, d = 0; c > d; d++) {
      var e = this.interactiveItems[d];
      if ((e.mousedown || e.click) && (e.__mouseIsDown = !0, e.__hit = this.hitTest(e, this.mouse), e.__hit && (e.mousedown && e.mousedown(this.mouse), e.__isDown = !0, !e.interactiveChildren))) break
    }
  }, b.InteractionManager.prototype.onMouseOut = function() {
    this.dirty && this.rebuildInteractiveGraph();
    var a = this.interactiveItems.length;
    this.interactionDOMElement.style.cursor = "inherit";
    for (var b = 0; a > b; b++) {
      var c = this.interactiveItems[b];
      c.__isOver && (this.mouse.target = c, c.mouseout && c.mouseout(this.mouse), c.__isOver = !1)
    }
    this.mouseOut = !0, this.mouse.global.x = -1e4, this.mouse.global.y = -1e4
  }, b.InteractionManager.prototype.onMouseUp = function(a) {
    this.dirty && this.rebuildInteractiveGraph(), this.mouse.originalEvent = a || window.event;
    for (var b = this.interactiveItems.length, c = !1, d = 0; b > d; d++) {
      var e = this.interactiveItems[d];
      e.__hit = this.hitTest(e, this.mouse), e.__hit && !c ? (e.mouseup && e.mouseup(this.mouse), e.__isDown && e.click && e.click(this.mouse), e.interactiveChildren || (c = !0)) : e.__isDown && e.mouseupoutside && e.mouseupoutside(this.mouse), e.__isDown = !1
    }
  }, b.InteractionManager.prototype.hitTest = function(a, c) {
    var d = c.global;
    if (!a.worldVisible) return !1;
    var e = a instanceof b.Sprite,
      f = a.worldTransform,
      g = f.a,
      h = f.b,
      i = f.tx,
      j = f.c,
      k = f.d,
      l = f.ty,
      m = 1 / (g * k + h * -j),
      n = k * m * d.x + -h * m * d.y + (l * h - i * k) * m,
      o = g * m * d.y + -j * m * d.x + (-l * g + i * j) * m;
    if (c.target = a, a.hitArea && a.hitArea.contains) return a.hitArea.contains(n, o) ? (c.target = a, !0) : !1;
    if (e) {
      var p, q = a.texture.frame.width,
        r = a.texture.frame.height,
        s = -q * a.anchor.x;
      if (n > s && s + q > n && (p = -r * a.anchor.y, o > p && p + r > o)) return c.target = a, !0
    }
    for (var t = a.children.length, u = 0; t > u; u++) {
      var v = a.children[u],
        w = this.hitTest(v, c);
      if (w) return c.target = a, !0
    }
    return !1
  }, b.InteractionManager.prototype.onTouchMove = function(a) {
    this.dirty && this.rebuildInteractiveGraph();
    var b, c = this.interactionDOMElement.getBoundingClientRect(),
      d = a.changedTouches,
      e = 0;
    for (e = 0; e < d.length; e++) {
      var f = d[e];
      b = this.touchs[f.identifier], b.originalEvent = a || window.event, b.global.x = (f.clientX - c.left) * (this.target.width / c.width), b.global.y = (f.clientY - c.top) * (this.target.height / c.height), navigator.isCocoonJS && (b.global.x = f.clientX, b.global.y = f.clientY);
      for (var g = 0; g < this.interactiveItems.length; g++) {
        var h = this.interactiveItems[g];
        h.touchmove && h.__touchData && h.__touchData[f.identifier] && h.touchmove(b)
      }
    }
  }, b.InteractionManager.prototype.onTouchStart = function(a) {
    this.dirty && this.rebuildInteractiveGraph();
    var c = this.interactionDOMElement.getBoundingClientRect();
    b.AUTO_PREVENT_DEFAULT && a.preventDefault();
    for (var d = a.changedTouches, e = 0; e < d.length; e++) {
      var f = d[e],
        g = this.pool.pop();
      g || (g = new b.InteractionData), g.originalEvent = a || window.event, this.touchs[f.identifier] = g, g.global.x = (f.clientX - c.left) * (this.target.width / c.width), g.global.y = (f.clientY - c.top) * (this.target.height / c.height), navigator.isCocoonJS && (g.global.x = f.clientX, g.global.y = f.clientY);
      for (var h = this.interactiveItems.length, i = 0; h > i; i++) {
        var j = this.interactiveItems[i];
        if ((j.touchstart || j.tap) && (j.__hit = this.hitTest(j, g), j.__hit && (j.touchstart && j.touchstart(g), j.__isDown = !0, j.__touchData = j.__touchData || {}, j.__touchData[f.identifier] = g, !j.interactiveChildren))) break
      }
    }
  }, b.InteractionManager.prototype.onTouchEnd = function(a) {
    this.dirty && this.rebuildInteractiveGraph();
    for (var b = this.interactionDOMElement.getBoundingClientRect(), c = a.changedTouches, d = 0; d < c.length; d++) {
      var e = c[d],
        f = this.touchs[e.identifier],
        g = !1;
      f.global.x = (e.clientX - b.left) * (this.target.width / b.width), f.global.y = (e.clientY - b.top) * (this.target.height / b.height), navigator.isCocoonJS && (f.global.x = e.clientX, f.global.y = e.clientY);
      for (var h = this.interactiveItems.length, i = 0; h > i; i++) {
        var j = this.interactiveItems[i];
        j.__touchData && j.__touchData[e.identifier] && (j.__hit = this.hitTest(j, j.__touchData[e.identifier]), f.originalEvent = a || window.event, (j.touchend || j.tap) && (j.__hit && !g ? (j.touchend && j.touchend(f), j.__isDown && j.tap && j.tap(f), j.interactiveChildren || (g = !0)) : j.__isDown && j.touchendoutside && j.touchendoutside(f), j.__isDown = !1), j.__touchData[e.identifier] = null)
      }
      this.pool.push(f), this.touchs[e.identifier] = null
    }
  }, b.Stage = function(a) {
    b.DisplayObjectContainer.call(this), this.worldTransform = new b.Matrix, this.interactive = !0, this.interactionManager = new b.InteractionManager(this), this.dirty = !0, this.stage = this, this.stage.hitArea = new b.Rectangle(0, 0, 1e5, 1e5), this.setBackgroundColor(a)
  }, b.Stage.prototype = Object.create(b.DisplayObjectContainer.prototype), b.Stage.prototype.constructor = b.Stage, b.Stage.prototype.setInteractionDelegate = function(a) {
    this.interactionManager.setTargetDomElement(a)
  }, b.Stage.prototype.updateTransform = function() {
    this.worldAlpha = 1;
    for (var a = 0, b = this.children.length; b > a; a++) this.children[a].updateTransform();
    this.dirty && (this.dirty = !1, this.interactionManager.dirty = !0), this.interactive && this.interactionManager.update()
  }, b.Stage.prototype.setBackgroundColor = function(a) {
    this.backgroundColor = a || 0, this.backgroundColorSplit = b.hex2rgb(this.backgroundColor);
    var c = this.backgroundColor.toString(16);
    c = "000000".substr(0, 6 - c.length) + c, this.backgroundColorString = "#" + c
  }, b.Stage.prototype.getMousePosition = function() {
    return this.interactionManager.mouse.global
  };
  for (var c = 0, d = ["ms", "moz", "webkit", "o"], e = 0; e < d.length && !window.requestAnimationFrame; ++e) window.requestAnimationFrame = window[d[e] + "RequestAnimationFrame"], window.cancelAnimationFrame = window[d[e] + "CancelAnimationFrame"] || window[d[e] + "CancelRequestAnimationFrame"];
  window.requestAnimationFrame || (window.requestAnimationFrame = function(a) {
    var b = (new Date).getTime(),
      d = Math.max(0, 16 - (b - c)),
      e = window.setTimeout(function() {
        a(b + d)
      }, d);
    return c = b + d, e
  }), window.cancelAnimationFrame || (window.cancelAnimationFrame = function(a) {
    clearTimeout(a)
  }), window.requestAnimFrame = window.requestAnimationFrame, b.hex2rgb = function(a) {
    return [(a >> 16 & 255) / 255, (a >> 8 & 255) / 255, (255 & a) / 255]
  }, b.rgb2hex = function(a) {
    return (255 * a[0] << 16) + (255 * a[1] << 8) + 255 * a[2]
  }, "function" != typeof Function.prototype.bind && (Function.prototype.bind = function() {
    var a = Array.prototype.slice;
    return function(b) {
      function c() {
        var f = e.concat(a.call(arguments));
        d.apply(this instanceof c ? this : b, f)
      }
      var d = this,
        e = a.call(arguments, 1);
      if ("function" != typeof d) throw new TypeError;
      return c.prototype = function f(a) {
        return a && (f.prototype = a), this instanceof f ? void 0 : new f
      }(d.prototype), c
    }
  }()), b.AjaxRequest = function() {
    var a = ["Msxml2.XMLHTTP.6.0", "Msxml2.XMLHTTP.3.0", "Microsoft.XMLHTTP"];
    if (!window.ActiveXObject) return window.XMLHttpRequest ? new window.XMLHttpRequest : !1;
    for (var b = 0; b < a.length; b++) try {
      return new window.ActiveXObject(a[b])
    } catch (c) {}
  }, b.canUseNewCanvasBlendModes = function() {
    var a = document.createElement("canvas");
    a.width = 1, a.height = 1;
    var b = a.getContext("2d");
    return b.fillStyle = "#000", b.fillRect(0, 0, 1, 1), b.globalCompositeOperation = "multiply", b.fillStyle = "#fff", b.fillRect(0, 0, 1, 1), 0 === b.getImageData(0, 0, 1, 1).data[0]
  }, b.getNextPowerOfTwo = function(a) {
    if (a > 0 && 0 === (a & a - 1)) return a;
    for (var b = 1; a > b;) b <<= 1;
    return b
  }, b.EventTarget = function() {
    var a = {};
    this.addEventListener = this.on = function(b, c) {
      void 0 === a[b] && (a[b] = []), -1 === a[b].indexOf(c) && a[b].unshift(c)
    }, this.dispatchEvent = this.emit = function(b) {
      if (a[b.type] && a[b.type].length)
        for (var c = a[b.type].length - 1; c >= 0; c--) a[b.type][c](b)
    }, this.removeEventListener = this.off = function(b, c) {
      if (void 0 !== a[b]) {
        var d = a[b].indexOf(c); - 1 !== d && a[b].splice(d, 1)
      }
    }, this.removeAllEventListeners = function(b) {
      var c = a[b];
      c && (c.length = 0)
    }
  }, b.autoDetectRenderer = function(a, c, d, e, f) {
    a || (a = 800), c || (c = 600);
    var g = function() {
      try {
        var a = document.createElement("canvas");
        return !!window.WebGLRenderingContext && (a.getContext("webgl") || a.getContext("experimental-webgl"))
      } catch (b) {
        return !1
      }
    }();
    return g ? new b.WebGLRenderer(a, c, d, e, f) : new b.CanvasRenderer(a, c, d, e)
  }, b.autoDetectRecommendedRenderer = function(a, c, d, e, f) {
    a || (a = 800), c || (c = 600);
    var g = function() {
        try {
          var a = document.createElement("canvas");
          return !!window.WebGLRenderingContext && (a.getContext("webgl") || a.getContext("experimental-webgl"))
        } catch (b) {
          return !1
        }
      }(),
      h = /Android/i.test(navigator.userAgent);
    return g && !h ? new b.WebGLRenderer(a, c, d, e, f) : new b.CanvasRenderer(a, c, d, e)
  }, b.PolyK = {}, b.PolyK.Triangulate = function(a) {
    var c = !0,
      d = a.length >> 1;
    if (3 > d) return [];
    for (var e = [], f = [], g = 0; d > g; g++) f.push(g);
    g = 0;
    for (var h = d; h > 3;) {
      var i = f[(g + 0) % h],
        j = f[(g + 1) % h],
        k = f[(g + 2) % h],
        l = a[2 * i],
        m = a[2 * i + 1],
        n = a[2 * j],
        o = a[2 * j + 1],
        p = a[2 * k],
        q = a[2 * k + 1],
        r = !1;
      if (b.PolyK._convex(l, m, n, o, p, q, c)) {
        r = !0;
        for (var s = 0; h > s; s++) {
          var t = f[s];
          if (t !== i && t !== j && t !== k && b.PolyK._PointInTriangle(a[2 * t], a[2 * t + 1], l, m, n, o, p, q)) {
            r = !1;
            break
          }
        }
      }
      if (r) e.push(i, j, k), f.splice((g + 1) % h, 1), h--, g = 0;
      else if (g++ > 3 * h) {
        if (!c) return window.console.log("PIXI Warning: shape too complex to fill"), [];
        for (e = [], f = [], g = 0; d > g; g++) f.push(g);
        g = 0, h = d, c = !1
      }
    }
    return e.push(f[0], f[1], f[2]), e
  }, b.PolyK._PointInTriangle = function(a, b, c, d, e, f, g, h) {
    var i = g - c,
      j = h - d,
      k = e - c,
      l = f - d,
      m = a - c,
      n = b - d,
      o = i * i + j * j,
      p = i * k + j * l,
      q = i * m + j * n,
      r = k * k + l * l,
      s = k * m + l * n,
      t = 1 / (o * r - p * p),
      u = (r * q - p * s) * t,
      v = (o * s - p * q) * t;
    return u >= 0 && v >= 0 && 1 > u + v
  }, b.PolyK._convex = function(a, b, c, d, e, f, g) {
    return (b - d) * (e - c) + (c - a) * (f - d) >= 0 === g
  }, b.initDefaultShaders = function() {}, b.CompileVertexShader = function(a, c) {
    return b._CompileShader(a, c, a.VERTEX_SHADER)
  }, b.CompileFragmentShader = function(a, c) {
    return b._CompileShader(a, c, a.FRAGMENT_SHADER)
  }, b._CompileShader = function(a, b, c) {
    var d = b.join("\n"),
      e = a.createShader(c);
    return a.shaderSource(e, d), a.compileShader(e), a.getShaderParameter(e, a.COMPILE_STATUS) ? e : (window.console.log(a.getShaderInfoLog(e)), null)
  }, b.compileProgram = function(a, c, d) {
    var e = b.CompileFragmentShader(a, d),
      f = b.CompileVertexShader(a, c),
      g = a.createProgram();
    return a.attachShader(g, f), a.attachShader(g, e), a.linkProgram(g), a.getProgramParameter(g, a.LINK_STATUS) || window.console.log("Could not initialise shaders"), g
  }, b.PixiShader = function(a) {
    this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"], this.textureCount = 0, this.attributes = [], this.init()
  }, b.PixiShader.prototype.init = function() {
    var a = this.gl,
      c = b.compileProgram(a, this.vertexSrc || b.PixiShader.defaultVertexSrc, this.fragmentSrc);
    a.useProgram(c), this.uSampler = a.getUniformLocation(c, "uSampler"), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.dimensions = a.getUniformLocation(c, "dimensions"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.aTextureCoord = a.getAttribLocation(c, "aTextureCoord"), this.colorAttribute = a.getAttribLocation(c, "aColor"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute];
    for (var d in this.uniforms) this.uniforms[d].uniformLocation = a.getUniformLocation(c, d);
    this.initUniforms(), this.program = c
  }, b.PixiShader.prototype.initUniforms = function() {
    this.textureCount = 1;
    var a, b = this.gl;
    for (var c in this.uniforms) {
      a = this.uniforms[c];
      var d = a.type;
      "sampler2D" === d ? (a._init = !1, null !== a.value && this.initSampler2D(a)) : "mat2" === d || "mat3" === d || "mat4" === d ? (a.glMatrix = !0, a.glValueLength = 1, "mat2" === d ? a.glFunc = b.uniformMatrix2fv : "mat3" === d ? a.glFunc = b.uniformMatrix3fv : "mat4" === d && (a.glFunc = b.uniformMatrix4fv)) : (a.glFunc = b["uniform" + d], a.glValueLength = "2f" === d || "2i" === d ? 2 : "3f" === d || "3i" === d ? 3 : "4f" === d || "4i" === d ? 4 : 1)
    }
  }, b.PixiShader.prototype.initSampler2D = function(a) {
    if (a.value && a.value.baseTexture && a.value.baseTexture.hasLoaded) {
      var b = this.gl;
      if (b.activeTexture(b["TEXTURE" + this.textureCount]), b.bindTexture(b.TEXTURE_2D, a.value.baseTexture._glTextures[b.id]), a.textureData) {
        var c = a.textureData,
          d = c.magFilter ? c.magFilter : b.LINEAR,
          e = c.minFilter ? c.minFilter : b.LINEAR,
          f = c.wrapS ? c.wrapS : b.CLAMP_TO_EDGE,
          g = c.wrapT ? c.wrapT : b.CLAMP_TO_EDGE,
          h = c.luminance ? b.LUMINANCE : b.RGBA;
        if (c.repeat && (f = b.REPEAT, g = b.REPEAT), b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL, !!c.flipY), c.width) {
          var i = c.width ? c.width : 512,
            j = c.height ? c.height : 2,
            k = c.border ? c.border : 0;
          b.texImage2D(b.TEXTURE_2D, 0, h, i, j, k, h, b.UNSIGNED_BYTE, null)
        } else b.texImage2D(b.TEXTURE_2D, 0, h, b.RGBA, b.UNSIGNED_BYTE, a.value.baseTexture.source);
        b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MAG_FILTER, d), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MIN_FILTER, e), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_S, f), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_T, g)
      }
      b.uniform1i(a.uniformLocation, this.textureCount), a._init = !0, this.textureCount++
    }
  }, b.PixiShader.prototype.syncUniforms = function() {
    this.textureCount = 1;
    var a, c = this.gl;
    for (var d in this.uniforms) a = this.uniforms[d], 1 === a.glValueLength ? a.glMatrix === !0 ? a.glFunc.call(c, a.uniformLocation, a.transpose, a.value) : a.glFunc.call(c, a.uniformLocation, a.value) : 2 === a.glValueLength ? a.glFunc.call(c, a.uniformLocation, a.value.x, a.value.y) : 3 === a.glValueLength ? a.glFunc.call(c, a.uniformLocation, a.value.x, a.value.y, a.value.z) : 4 === a.glValueLength ? a.glFunc.call(c, a.uniformLocation, a.value.x, a.value.y, a.value.z, a.value.w) : "sampler2D" === a.type && (a._init ? (c.activeTexture(c["TEXTURE" + this.textureCount]), c.bindTexture(c.TEXTURE_2D, a.value.baseTexture._glTextures[c.id] || b.createWebGLTexture(a.value.baseTexture, c)), c.uniform1i(a.uniformLocation, this.textureCount), this.textureCount++) : this.initSampler2D(a))
  }, b.PixiShader.prototype.destroy = function() {
    this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
  }, b.PixiShader.defaultVertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute vec2 aColor;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;", "   vColor = vec4(color * aColor.x, aColor.x);", "}"], b.PixiFastShader = function(a) {
    this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying float vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aPositionCoord;", "attribute vec2 aScale;", "attribute float aRotation;", "attribute vec2 aTextureCoord;", "attribute float aColor;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform mat3 uMatrix;", "varying vec2 vTextureCoord;", "varying float vColor;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   vec2 v;", "   vec2 sv = aVertexPosition * aScale;", "   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);", "   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);", "   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;", "   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = aColor;", "}"], this.textureCount = 0, this.init()
  }, b.PixiFastShader.prototype.init = function() {
    var a = this.gl,
      c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
    a.useProgram(c), this.uSampler = a.getUniformLocation(c, "uSampler"), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.dimensions = a.getUniformLocation(c, "dimensions"), this.uMatrix = a.getUniformLocation(c, "uMatrix"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.aPositionCoord = a.getAttribLocation(c, "aPositionCoord"), this.aScale = a.getAttribLocation(c, "aScale"), this.aRotation = a.getAttribLocation(c, "aRotation"), this.aTextureCoord = a.getAttribLocation(c, "aTextureCoord"), this.colorAttribute = a.getAttribLocation(c, "aColor"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aPositionCoord, this.aScale, this.aRotation, this.aTextureCoord, this.colorAttribute], this.program = c
  }, b.PixiFastShader.prototype.destroy = function() {
    this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
  }, b.StripShader = function(a) {
    this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "uniform float alpha;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "}"], this.init()
  }, b.StripShader.prototype.init = function() {
    var a = this.gl,
      c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
    a.useProgram(c), this.uSampler = a.getUniformLocation(c, "uSampler"), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.colorAttribute = a.getAttribLocation(c, "aColor"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.aTextureCoord = a.getAttribLocation(c, "aTextureCoord"), this.attributes = [this.aVertexPosition, this.aTextureCoord], this.translationMatrix = a.getUniformLocation(c, "translationMatrix"), this.alpha = a.getUniformLocation(c, "alpha"), this.program = c
  }, b.PrimitiveShader = function(a) {
    this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec4 aColor;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform float alpha;", "uniform vec3 tint;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vColor = aColor * vec4(tint * alpha, alpha);", "}"], this.init()
  }, b.PrimitiveShader.prototype.init = function() {
    var a = this.gl,
      c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
    a.useProgram(c), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.tintColor = a.getUniformLocation(c, "tint"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.colorAttribute = a.getAttribLocation(c, "aColor"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = a.getUniformLocation(c, "translationMatrix"), this.alpha = a.getUniformLocation(c, "alpha"), this.program = c
  }, b.PrimitiveShader.prototype.destroy = function() {
    this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null
  }, b.ComplexPrimitiveShader = function(a) {
    this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform vec3 tint;", "uniform float alpha;", "uniform vec3 color;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vColor = vec4(color * alpha * tint, alpha);", "}"], this.init()
  }, b.ComplexPrimitiveShader.prototype.init = function() {
    var a = this.gl,
      c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
    a.useProgram(c), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.tintColor = a.getUniformLocation(c, "tint"), this.color = a.getUniformLocation(c, "color"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = a.getUniformLocation(c, "translationMatrix"), this.alpha = a.getUniformLocation(c, "alpha"), this.program = c
  }, b.ComplexPrimitiveShader.prototype.destroy = function() {
    this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null
  }, b.WebGLGraphics = function() {}, b.WebGLGraphics.renderGraphics = function(a, c) {
    var d, e = c.gl,
      f = c.projection,
      g = c.offset,
      h = c.shaderManager.primitiveShader;
    a.dirty && b.WebGLGraphics.updateGraphics(a, e);
    for (var i = a._webGL[e.id], j = 0; j < i.data.length; j++) 1 === i.data[j].mode ? (d = i.data[j], c.stencilManager.pushStencil(a, d, c), e.drawElements(e.TRIANGLE_FAN, 4, e.UNSIGNED_SHORT, 2 * (d.indices.length - 4)), c.stencilManager.popStencil(a, d, c), this.last = d.mode) : (d = i.data[j], c.shaderManager.setShader(h), h = c.shaderManager.primitiveShader, e.uniformMatrix3fv(h.translationMatrix, !1, a.worldTransform.toArray(!0)), e.uniform2f(h.projectionVector, f.x, -f.y), e.uniform2f(h.offsetVector, -g.x, -g.y), e.uniform3fv(h.tintColor, b.hex2rgb(a.tint)), e.uniform1f(h.alpha, a.worldAlpha), e.bindBuffer(e.ARRAY_BUFFER, d.buffer), e.vertexAttribPointer(h.aVertexPosition, 2, e.FLOAT, !1, 24, 0), e.vertexAttribPointer(h.colorAttribute, 4, e.FLOAT, !1, 24, 8), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, d.indexBuffer), e.drawElements(e.TRIANGLE_STRIP, d.indices.length, e.UNSIGNED_SHORT, 0))
  }, b.WebGLGraphics.updateGraphics = function(a, c) {
    var d = a._webGL[c.id];
    d || (d = a._webGL[c.id] = {
      lastIndex: 0,
      data: [],
      gl: c
    }), a.dirty = !1;
    var e;
    if (a.clearDirty) {
      for (a.clearDirty = !1, e = 0; e < d.data.length; e++) {
        var f = d.data[e];
        f.reset(), b.WebGLGraphics.graphicsDataPool.push(f)
      }
      d.data = [], d.lastIndex = 0
    }
    var g;
    for (e = d.lastIndex; e < a.graphicsData.length; e++) {
      var h = a.graphicsData[e];
      h.type === b.Graphics.POLY ? (h.fill && h.points.length > 6 && (h.points.length > 10 ? (g = b.WebGLGraphics.switchMode(d, 1), b.WebGLGraphics.buildComplexPoly(h, g)) : (g = b.WebGLGraphics.switchMode(d, 0), b.WebGLGraphics.buildPoly(h, g))), h.lineWidth > 0 && (g = b.WebGLGraphics.switchMode(d, 0), b.WebGLGraphics.buildLine(h, g))) : (g = b.WebGLGraphics.switchMode(d, 0), h.type === b.Graphics.RECT ? b.WebGLGraphics.buildRectangle(h, g) : h.type === b.Graphics.CIRC || h.type === b.Graphics.ELIP ? b.WebGLGraphics.buildCircle(h, g) : h.type === b.Graphics.RREC && b.WebGLGraphics.buildRoundedRectangle(h, g)), d.lastIndex++
    }
    for (e = 0; e < d.data.length; e++) g = d.data[e], g.dirty && g.upload()
  }, b.WebGLGraphics.switchMode = function(a, c) {
    var d;
    return a.data.length ? (d = a.data[a.data.length - 1], (d.mode !== c || 1 === c) && (d = b.WebGLGraphics.graphicsDataPool.pop() || new b.WebGLGraphicsData(a.gl), d.mode = c, a.data.push(d))) : (d = b.WebGLGraphics.graphicsDataPool.pop() || new b.WebGLGraphicsData(a.gl), d.mode = c, a.data.push(d)), d.dirty = !0, d
  }, b.WebGLGraphics.buildRectangle = function(a, c) {
    var d = a.points,
      e = d[0],
      f = d[1],
      g = d[2],
      h = d[3];
    if (a.fill) {
      var i = b.hex2rgb(a.fillColor),
        j = a.fillAlpha,
        k = i[0] * j,
        l = i[1] * j,
        m = i[2] * j,
        n = c.points,
        o = c.indices,
        p = n.length / 6;
      n.push(e, f), n.push(k, l, m, j), n.push(e + g, f), n.push(k, l, m, j), n.push(e, f + h), n.push(k, l, m, j), n.push(e + g, f + h), n.push(k, l, m, j), o.push(p, p, p + 1, p + 2, p + 3, p + 3)
    }
    if (a.lineWidth) {
      var q = a.points;
      a.points = [e, f, e + g, f, e + g, f + h, e, f + h, e, f], b.WebGLGraphics.buildLine(a, c), a.points = q
    }
  }, b.WebGLGraphics.buildRoundedRectangle = function(a, c) {
    var d = a.points,
      e = d[0],
      f = d[1],
      g = d[2],
      h = d[3],
      i = d[4],
      j = [];
    if (j.push(e, f + i), j = j.concat(b.WebGLGraphics.quadraticBezierCurve(e, f + h - i, e, f + h, e + i, f + h)), j = j.concat(b.WebGLGraphics.quadraticBezierCurve(e + g - i, f + h, e + g, f + h, e + g, f + h - i)), j = j.concat(b.WebGLGraphics.quadraticBezierCurve(e + g, f + i, e + g, f, e + g - i, f)), j = j.concat(b.WebGLGraphics.quadraticBezierCurve(e + i, f, e, f, e, f + i)), a.fill) {
      var k = b.hex2rgb(a.fillColor),
        l = a.fillAlpha,
        m = k[0] * l,
        n = k[1] * l,
        o = k[2] * l,
        p = c.points,
        q = c.indices,
        r = p.length / 6,
        s = b.PolyK.Triangulate(j),
        t = 0;
      for (t = 0; t < s.length; t += 3) q.push(s[t] + r), q.push(s[t] + r), q.push(s[t + 1] + r), q.push(s[t + 2] + r), q.push(s[t + 2] + r);
      for (t = 0; t < j.length; t++) p.push(j[t], j[++t], m, n, o, l)
    }
    if (a.lineWidth) {
      var u = a.points;
      a.points = j, b.WebGLGraphics.buildLine(a, c), a.points = u
    }
  }, b.WebGLGraphics.quadraticBezierCurve = function(a, b, c, d, e, f) {
    function g(a, b, c) {
      var d = b - a;
      return a + d * c
    }
    for (var h, i, j, k, l, m, n = 20, o = [], p = 0, q = 0; n >= q; q++) p = q / n, h = g(a, c, p), i = g(b, d, p), j = g(c, e, p), k = g(d, f, p), l = g(h, j, p), m = g(i, k, p), o.push(l, m);
    return o
  }, b.WebGLGraphics.buildCircle = function(a, c) {
    var d = a.points,
      e = d[0],
      f = d[1],
      g = d[2],
      h = d[3],
      i = 40,
      j = 2 * Math.PI / i,
      k = 0;
    if (a.fill) {
      var l = b.hex2rgb(a.fillColor),
        m = a.fillAlpha,
        n = l[0] * m,
        o = l[1] * m,
        p = l[2] * m,
        q = c.points,
        r = c.indices,
        s = q.length / 6;
      for (r.push(s), k = 0; i + 1 > k; k++) q.push(e, f, n, o, p, m), q.push(e + Math.sin(j * k) * g, f + Math.cos(j * k) * h, n, o, p, m), r.push(s++, s++);
      r.push(s - 1)
    }
    if (a.lineWidth) {
      var t = a.points;
      for (a.points = [], k = 0; i + 1 > k; k++) a.points.push(e + Math.sin(j * k) * g, f + Math.cos(j * k) * h);
      b.WebGLGraphics.buildLine(a, c), a.points = t
    }
  }, b.WebGLGraphics.buildLine = function(a, c) {
    var d = 0,
      e = a.points;
    if (0 !== e.length) {
      if (a.lineWidth % 2)
        for (d = 0; d < e.length; d++) e[d] += .5;
      var f = new b.Point(e[0], e[1]),
        g = new b.Point(e[e.length - 2], e[e.length - 1]);
      if (f.x === g.x && f.y === g.y) {
        e = e.slice(), e.pop(), e.pop(), g = new b.Point(e[e.length - 2], e[e.length - 1]);
        var h = g.x + .5 * (f.x - g.x),
          i = g.y + .5 * (f.y - g.y);
        e.unshift(h, i), e.push(h, i)
      }
      var j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G = c.points,
        H = c.indices,
        I = e.length / 2,
        J = e.length,
        K = G.length / 6,
        L = a.lineWidth / 2,
        M = b.hex2rgb(a.lineColor),
        N = a.lineAlpha,
        O = M[0] * N,
        P = M[1] * N,
        Q = M[2] * N;
      for (l = e[0], m = e[1], n = e[2], o = e[3], r = -(m - o), s = l - n, F = Math.sqrt(r * r + s * s), r /= F, s /= F, r *= L, s *= L, G.push(l - r, m - s, O, P, Q, N), G.push(l + r, m + s, O, P, Q, N), d = 1; I - 1 > d; d++) l = e[2 * (d - 1)], m = e[2 * (d - 1) + 1], n = e[2 * d], o = e[2 * d + 1], p = e[2 * (d + 1)], q = e[2 * (d + 1) + 1], r = -(m - o), s = l - n, F = Math.sqrt(r * r + s * s), r /= F, s /= F, r *= L, s *= L, t = -(o - q), u = n - p, F = Math.sqrt(t * t + u * u), t /= F, u /= F, t *= L, u *= L, x = -s + m - (-s + o), y = -r + n - (-r + l), z = (-r + l) * (-s + o) - (-r + n) * (-s + m), A = -u + q - (-u + o), B = -t + n - (-t + p), C = (-t + p) * (-u + o) - (-t + n) * (-u + q), D = x * B - A * y, Math.abs(D) < .1 ? (D += 10.1, G.push(n - r, o - s, O, P, Q, N), G.push(n + r, o + s, O, P, Q, N)) : (j = (y * C - B * z) / D, k = (A * z - x * C) / D, E = (j - n) * (j - n) + (k - o) + (k - o), E > 19600 ? (v = r - t, w = s - u, F = Math.sqrt(v * v + w * w), v /= F, w /= F, v *= L, w *= L, G.push(n - v, o - w), G.push(O, P, Q, N), G.push(n + v, o + w), G.push(O, P, Q, N), G.push(n - v, o - w), G.push(O, P, Q, N), J++) : (G.push(j, k), G.push(O, P, Q, N), G.push(n - (j - n), o - (k - o)), G.push(O, P, Q, N)));
      for (l = e[2 * (I - 2)], m = e[2 * (I - 2) + 1], n = e[2 * (I - 1)], o = e[2 * (I - 1) + 1], r = -(m - o), s = l - n, F = Math.sqrt(r * r + s * s), r /= F, s /= F, r *= L, s *= L, G.push(n - r, o - s), G.push(O, P, Q, N), G.push(n + r, o + s), G.push(O, P, Q, N), H.push(K), d = 0; J > d; d++) H.push(K++);
      H.push(K - 1)
    }
  }, b.WebGLGraphics.buildComplexPoly = function(a, c) {
    var d = a.points.slice();
    if (!(d.length < 6)) {
      var e = c.indices;
      c.points = d, c.alpha = a.fillAlpha, c.color = b.hex2rgb(a.fillColor);
      for (var f, g, h = 1 / 0, i = -1 / 0, j = 1 / 0, k = -1 / 0, l = 0; l < d.length; l += 2) f = d[l], g = d[l + 1], h = h > f ? f : h, i = f > i ? f : i, j = j > g ? g : j, k = g > k ? g : k;
      d.push(h, j, i, j, i, k, h, k);
      var m = d.length / 2;
      for (l = 0; m > l; l++) e.push(l)
    }
  }, b.WebGLGraphics.buildPoly = function(a, c) {
    var d = a.points;
    if (!(d.length < 6)) {
      var e = c.points,
        f = c.indices,
        g = d.length / 2,
        h = b.hex2rgb(a.fillColor),
        i = a.fillAlpha,
        j = h[0] * i,
        k = h[1] * i,
        l = h[2] * i,
        m = b.PolyK.Triangulate(d),
        n = e.length / 6,
        o = 0;
      for (o = 0; o < m.length; o += 3) f.push(m[o] + n), f.push(m[o] + n), f.push(m[o + 1] + n), f.push(m[o + 2] + n), f.push(m[o + 2] + n);
      for (o = 0; g > o; o++) e.push(d[2 * o], d[2 * o + 1], j, k, l, i)
    }
  }, b.WebGLGraphics.graphicsDataPool = [], b.WebGLGraphicsData = function(a) {
    this.gl = a, this.color = [0, 0, 0], this.points = [], this.indices = [], this.lastIndex = 0, this.buffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), this.mode = 1, this.alpha = 1, this.dirty = !0
  }, b.WebGLGraphicsData.prototype.reset = function() {
    this.points = [], this.indices = [], this.lastIndex = 0
  }, b.WebGLGraphicsData.prototype.upload = function() {
    var a = this.gl;
    this.glPoints = new Float32Array(this.points), a.bindBuffer(a.ARRAY_BUFFER, this.buffer), a.bufferData(a.ARRAY_BUFFER, this.glPoints, a.STATIC_DRAW), this.glIndicies = new Uint16Array(this.indices), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, this.glIndicies, a.STATIC_DRAW), this.dirty = !1
  }, b.glContexts = [], b.WebGLRenderer = function(a, c, d, e, f, g) {
    b.defaultRenderer || (b.sayHello("webGL"), b.defaultRenderer = this), this.type = b.WEBGL_RENDERER, this.transparent = !!e, this.preserveDrawingBuffer = g, this.width = a || 800, this.height = c || 600, this.view = d || document.createElement("canvas"), this.view.width = this.width, this.view.height = this.height, this.contextLost = this.handleContextLost.bind(this), this.contextRestoredLost = this.handleContextRestored.bind(this), this.view.addEventListener("webglcontextlost", this.contextLost, !1), this.view.addEventListener("webglcontextrestored", this.contextRestoredLost, !1), this.options = {
      alpha: this.transparent,
      antialias: !!f,
      premultipliedAlpha: !!e,
      stencil: !0,
      preserveDrawingBuffer: g
    };
    var h = null;
    if (["experimental-webgl", "webgl"].forEach(function(a) {
        try {
          h = h || this.view.getContext(a, this.options)
        } catch (b) {}
      }, this), !h) throw new Error("This browser does not support webGL. Try using the canvas renderer" + this);
    this.gl = h, this.glContextId = h.id = b.WebGLRenderer.glContextId++, b.glContexts[this.glContextId] = h, b.blendModesWebGL || (b.blendModesWebGL = [], b.blendModesWebGL[b.blendModes.NORMAL] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.ADD] = [h.SRC_ALPHA, h.DST_ALPHA], b.blendModesWebGL[b.blendModes.MULTIPLY] = [h.DST_COLOR, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.SCREEN] = [h.SRC_ALPHA, h.ONE], b.blendModesWebGL[b.blendModes.OVERLAY] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.DARKEN] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.LIGHTEN] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.COLOR_DODGE] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.COLOR_BURN] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.HARD_LIGHT] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.SOFT_LIGHT] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.DIFFERENCE] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.EXCLUSION] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.HUE] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.SATURATION] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.COLOR] = [h.ONE, h.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL[b.blendModes.LUMINOSITY] = [h.ONE, h.ONE_MINUS_SRC_ALPHA]), this.projection = new b.Point, this.projection.x = this.width / 2, this.projection.y = -this.height / 2, this.offset = new b.Point(0, 0), this.resize(this.width, this.height), this.contextLost = !1, this.shaderManager = new b.WebGLShaderManager(h), this.spriteBatch = new b.WebGLSpriteBatch(h), this.maskManager = new b.WebGLMaskManager(h), this.filterManager = new b.WebGLFilterManager(h, this.transparent), this.stencilManager = new b.WebGLStencilManager(h), this.blendModeManager = new b.WebGLBlendModeManager(h), this.renderSession = {}, this.renderSession.gl = this.gl, this.renderSession.drawCount = 0, this.renderSession.shaderManager = this.shaderManager, this.renderSession.maskManager = this.maskManager, this.renderSession.filterManager = this.filterManager, this.renderSession.blendModeManager = this.blendModeManager, this.renderSession.spriteBatch = this.spriteBatch, this.renderSession.stencilManager = this.stencilManager, this.renderSession.renderer = this, h.useProgram(this.shaderManager.defaultShader.program), h.disable(h.DEPTH_TEST), h.disable(h.CULL_FACE), h.enable(h.BLEND), h.colorMask(!0, !0, !0, this.transparent)
  }, b.WebGLRenderer.prototype.constructor = b.WebGLRenderer, b.WebGLRenderer.prototype.render = function(a) {
    if (!this.contextLost) {
      this.__stage !== a && (a.interactive && a.interactionManager.removeEvents(), this.__stage = a), b.WebGLRenderer.updateTextures(), a.updateTransform(), a._interactive && (a._interactiveEventsAdded || (a._interactiveEventsAdded = !0, a.interactionManager.setTarget(this)));
      var c = this.gl;
      c.viewport(0, 0, this.width, this.height), c.bindFramebuffer(c.FRAMEBUFFER, null), this.transparent ? c.clearColor(0, 0, 0, 0) : c.clearColor(a.backgroundColorSplit[0], a.backgroundColorSplit[1], a.backgroundColorSplit[2], 1), c.clear(c.COLOR_BUFFER_BIT), this.renderDisplayObject(a, this.projection), a.interactive ? a._interactiveEventsAdded || (a._interactiveEventsAdded = !0, a.interactionManager.setTarget(this)) : a._interactiveEventsAdded && (a._interactiveEventsAdded = !1, a.interactionManager.setTarget(this))
    }
  }, b.WebGLRenderer.prototype.renderDisplayObject = function(a, c, d) {
    this.renderSession.blendModeManager.setBlendMode(b.blendModes.NORMAL), this.renderSession.drawCount = 0, this.renderSession.currentBlendMode = 9999, this.renderSession.projection = c, this.renderSession.offset = this.offset, this.spriteBatch.begin(this.renderSession), this.filterManager.begin(this.renderSession, d), a._renderWebGL(this.renderSession), this.spriteBatch.end()
  }, b.WebGLRenderer.updateTextures = function() {
    var a = 0;
    for (a = 0; a < b.Texture.frameUpdates.length; a++) b.WebGLRenderer.updateTextureFrame(b.Texture.frameUpdates[a]);
    for (a = 0; a < b.texturesToDestroy.length; a++) b.WebGLRenderer.destroyTexture(b.texturesToDestroy[a]);
    b.texturesToUpdate.length = 0, b.texturesToDestroy.length = 0, b.Texture.frameUpdates.length = 0
  }, b.WebGLRenderer.destroyTexture = function(a) {
    for (var c = a._glTextures.length - 1; c >= 0; c--) {
      var d = a._glTextures[c],
        e = b.glContexts[c];
      e && d && e.deleteTexture(d)
    }
    a._glTextures.length = 0
  }, b.WebGLRenderer.updateTextureFrame = function(a) {
    a._updateWebGLuvs()
  }, b.WebGLRenderer.prototype.resize = function(a, b) {
    this.width = a, this.height = b, this.view.width = a, this.view.height = b, this.gl.viewport(0, 0, this.width, this.height), this.projection.x = this.width / 2, this.projection.y = -this.height / 2
  }, b.createWebGLTexture = function(a, c) {
    return a.hasLoaded && (a._glTextures[c.id] = c.createTexture(), c.bindTexture(c.TEXTURE_2D, a._glTextures[c.id]), c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, a.premultipliedAlpha), c.texImage2D(c.TEXTURE_2D, 0, c.RGBA, c.RGBA, c.UNSIGNED_BYTE, a.source), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MAG_FILTER, a.scaleMode === b.scaleModes.LINEAR ? c.LINEAR : c.NEAREST), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MIN_FILTER, a.scaleMode === b.scaleModes.LINEAR ? c.LINEAR : c.NEAREST), a._powerOf2 ? (c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_S, c.REPEAT), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_T, c.REPEAT)) : (c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_S, c.CLAMP_TO_EDGE), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_T, c.CLAMP_TO_EDGE)), c.bindTexture(c.TEXTURE_2D, null), a._dirty[c.id] = !1), a._glTextures[c.id]
  }, b.updateWebGLTexture = function(a, c) {
    a._glTextures[c.id] && (c.bindTexture(c.TEXTURE_2D, a._glTextures[c.id]), c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, a.premultipliedAlpha), c.texImage2D(c.TEXTURE_2D, 0, c.RGBA, c.RGBA, c.UNSIGNED_BYTE, a.source), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MAG_FILTER, a.scaleMode === b.scaleModes.LINEAR ? c.LINEAR : c.NEAREST), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MIN_FILTER, a.scaleMode === b.scaleModes.LINEAR ? c.LINEAR : c.NEAREST), a._powerOf2 ? (c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_S, c.REPEAT), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_T, c.REPEAT)) : (c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_S, c.CLAMP_TO_EDGE), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_T, c.CLAMP_TO_EDGE)), a._dirty[c.id] = !1)
  }, b.WebGLRenderer.prototype.handleContextLost = function(a) {
    a.preventDefault(), this.contextLost = !0
  }, b.WebGLRenderer.prototype.handleContextRestored = function() {
    try {
      this.gl = this.view.getContext("experimental-webgl", this.options)
    } catch (a) {
      try {
        this.gl = this.view.getContext("webgl", this.options)
      } catch (c) {
        throw new Error(" This browser does not support webGL. Try using the canvas renderer" + this)
      }
    }
    var d = this.gl;
    d.id = b.WebGLRenderer.glContextId++, this.shaderManager.setContext(d), this.spriteBatch.setContext(d), this.primitiveBatch.setContext(d), this.maskManager.setContext(d), this.filterManager.setContext(d), this.renderSession.gl = this.gl, d.disable(d.DEPTH_TEST), d.disable(d.CULL_FACE), d.enable(d.BLEND), d.colorMask(!0, !0, !0, this.transparent), this.gl.viewport(0, 0, this.width, this.height);
    for (var e in b.TextureCache) {
      var f = b.TextureCache[e].baseTexture;
      f._glTextures = []
    }
    this.contextLost = !1
  }, b.WebGLRenderer.prototype.destroy = function() {
    this.view.removeEventListener("webglcontextlost", this.contextLost), this.view.removeEventListener("webglcontextrestored", this.contextRestoredLost), b.glContexts[this.glContextId] = null, this.projection = null, this.offset = null, this.shaderManager.destroy(), this.spriteBatch.destroy(), this.primitiveBatch.destroy(), this.maskManager.destroy(), this.filterManager.destroy(), this.shaderManager = null, this.spriteBatch = null, this.maskManager = null, this.filterManager = null, this.gl = null, this.renderSession = null
  }, b.WebGLRenderer.glContextId = 0, b.WebGLBlendModeManager = function(a) {
    this.gl = a, this.currentBlendMode = 99999
  }, b.WebGLBlendModeManager.prototype.setBlendMode = function(a) {
    if (this.currentBlendMode === a) return !1;
    this.currentBlendMode = a;
    var c = b.blendModesWebGL[this.currentBlendMode];
    return this.gl.blendFunc(c[0], c[1]), !0
  }, b.WebGLBlendModeManager.prototype.destroy = function() {
    this.gl = null
  }, b.WebGLMaskManager = function(a) {
    this.maskStack = [], this.maskPosition = 0, this.setContext(a), this.reverse = !1, this.count = 0
  }, b.WebGLMaskManager.prototype.setContext = function(a) {
    this.gl = a
  }, b.WebGLMaskManager.prototype.pushMask = function(a, c) {
    var d = c.gl;
    a.dirty && b.WebGLGraphics.updateGraphics(a, d), a._webGL[d.id].data.length && c.stencilManager.pushStencil(a, a._webGL[d.id].data[0], c)
  }, b.WebGLMaskManager.prototype.popMask = function(a, b) {
    var c = this.gl;
    b.stencilManager.popStencil(a, a._webGL[c.id].data[0], b)
  }, b.WebGLMaskManager.prototype.destroy = function() {
    this.maskStack = null, this.gl = null
  }, b.WebGLStencilManager = function(a) {
    this.stencilStack = [], this.setContext(a), this.reverse = !0, this.count = 0
  }, b.WebGLStencilManager.prototype.setContext = function(a) {
    this.gl = a
  }, b.WebGLStencilManager.prototype.pushStencil = function(a, b, c) {
    var d = this.gl;
    this.bindGraphics(a, b, c), 0 === this.stencilStack.length && (d.enable(d.STENCIL_TEST), d.clear(d.STENCIL_BUFFER_BIT), this.reverse = !0, this.count = 0), this.stencilStack.push(b);
    var e = this.count;
    d.colorMask(!1, !1, !1, !1), d.stencilFunc(d.ALWAYS, 0, 255), d.stencilOp(d.KEEP, d.KEEP, d.INVERT), 1 === b.mode ? (d.drawElements(d.TRIANGLE_FAN, b.indices.length - 4, d.UNSIGNED_SHORT, 0), this.reverse ? (d.stencilFunc(d.EQUAL, 255 - e, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)) : (d.stencilFunc(d.EQUAL, e, 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)), d.drawElements(d.TRIANGLE_FAN, 4, d.UNSIGNED_SHORT, 2 * (b.indices.length - 4)), this.reverse ? d.stencilFunc(d.EQUAL, 255 - (e + 1), 255) : d.stencilFunc(d.EQUAL, e + 1, 255), this.reverse = !this.reverse) : (this.reverse ? (d.stencilFunc(d.EQUAL, e, 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)) : (d.stencilFunc(d.EQUAL, 255 - e, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)), d.drawElements(d.TRIANGLE_STRIP, b.indices.length, d.UNSIGNED_SHORT, 0), this.reverse ? d.stencilFunc(d.EQUAL, e + 1, 255) : d.stencilFunc(d.EQUAL, 255 - (e + 1), 255)), d.colorMask(!0, !0, !0, !0), d.stencilOp(d.KEEP, d.KEEP, d.KEEP), this.count++
  }, b.WebGLStencilManager.prototype.bindGraphics = function(a, c, d) {
    this._currentGraphics = a;
    var e, f = this.gl,
      g = d.projection,
      h = d.offset;
    1 === c.mode ? (e = d.shaderManager.complexPrimativeShader, d.shaderManager.setShader(e), f.uniformMatrix3fv(e.translationMatrix, !1, a.worldTransform.toArray(!0)), f.uniform2f(e.projectionVector, g.x, -g.y), f.uniform2f(e.offsetVector, -h.x, -h.y), f.uniform3fv(e.tintColor, b.hex2rgb(a.tint)), f.uniform3fv(e.color, c.color), f.uniform1f(e.alpha, a.worldAlpha * c.alpha), f.bindBuffer(f.ARRAY_BUFFER, c.buffer), f.vertexAttribPointer(e.aVertexPosition, 2, f.FLOAT, !1, 8, 0), f.bindBuffer(f.ELEMENT_ARRAY_BUFFER, c.indexBuffer)) : (e = d.shaderManager.primitiveShader, d.shaderManager.setShader(e), f.uniformMatrix3fv(e.translationMatrix, !1, a.worldTransform.toArray(!0)), f.uniform2f(e.projectionVector, g.x, -g.y), f.uniform2f(e.offsetVector, -h.x, -h.y), f.uniform3fv(e.tintColor, b.hex2rgb(a.tint)), f.uniform1f(e.alpha, a.worldAlpha), f.bindBuffer(f.ARRAY_BUFFER, c.buffer), f.vertexAttribPointer(e.aVertexPosition, 2, f.FLOAT, !1, 24, 0), f.vertexAttribPointer(e.colorAttribute, 4, f.FLOAT, !1, 24, 8), f.bindBuffer(f.ELEMENT_ARRAY_BUFFER, c.indexBuffer))
  }, b.WebGLStencilManager.prototype.popStencil = function(a, b, c) {
    var d = this.gl;
    if (this.stencilStack.pop(), this.count--, 0 === this.stencilStack.length) d.disable(d.STENCIL_TEST);
    else {
      var e = this.count;
      this.bindGraphics(a, b, c), d.colorMask(!1, !1, !1, !1), 1 === b.mode ? (this.reverse = !this.reverse, this.reverse ? (d.stencilFunc(d.EQUAL, 255 - (e + 1), 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)) : (d.stencilFunc(d.EQUAL, e + 1, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)), d.drawElements(d.TRIANGLE_FAN, 4, d.UNSIGNED_SHORT, 2 * (b.indices.length - 4)), d.stencilFunc(d.ALWAYS, 0, 255), d.stencilOp(d.KEEP, d.KEEP, d.INVERT), d.drawElements(d.TRIANGLE_FAN, b.indices.length - 4, d.UNSIGNED_SHORT, 0), this.reverse ? d.stencilFunc(d.EQUAL, e, 255) : d.stencilFunc(d.EQUAL, 255 - e, 255)) : (this.reverse ? (d.stencilFunc(d.EQUAL, e + 1, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)) : (d.stencilFunc(d.EQUAL, 255 - (e + 1), 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)), d.drawElements(d.TRIANGLE_STRIP, b.indices.length, d.UNSIGNED_SHORT, 0), this.reverse ? d.stencilFunc(d.EQUAL, e, 255) : d.stencilFunc(d.EQUAL, 255 - e, 255)), d.colorMask(!0, !0, !0, !0), d.stencilOp(d.KEEP, d.KEEP, d.KEEP)
    }
  }, b.WebGLStencilManager.prototype.destroy = function() {
    this.maskStack = null, this.gl = null
  }, b.WebGLShaderManager = function(a) {
    this.maxAttibs = 10, this.attribState = [], this.tempAttribState = [], this.shaderMap = [];
    for (var b = 0; b < this.maxAttibs; b++) this.attribState[b] = !1;
    this.setContext(a)
  }, b.WebGLShaderManager.prototype.setContext = function(a) {
    this.gl = a, this.primitiveShader = new b.PrimitiveShader(a), this.complexPrimativeShader = new b.ComplexPrimitiveShader(a), this.defaultShader = new b.PixiShader(a), this.fastShader = new b.PixiFastShader(a), this.stripShader = new b.StripShader(a), this.setShader(this.defaultShader)
  }, b.WebGLShaderManager.prototype.setAttribs = function(a) {
    var b;
    for (b = 0; b < this.tempAttribState.length; b++) this.tempAttribState[b] = !1;
    for (b = 0; b < a.length; b++) {
      var c = a[b];
      this.tempAttribState[c] = !0
    }
    var d = this.gl;
    for (b = 0; b < this.attribState.length; b++) this.attribState[b] !== this.tempAttribState[b] && (this.attribState[b] = this.tempAttribState[b], this.tempAttribState[b] ? d.enableVertexAttribArray(b) : d.disableVertexAttribArray(b))
  }, b.WebGLShaderManager.prototype.setShader = function(a) {
    return this._currentId === a._UID ? !1 : (this._currentId = a._UID, this.currentShader = a, this.gl.useProgram(a.program), this.setAttribs(a.attributes), !0)
  }, b.WebGLShaderManager.prototype.destroy = function() {
    this.attribState = null, this.tempAttribState = null, this.primitiveShader.destroy(), this.defaultShader.destroy(), this.fastShader.destroy(), this.stripShader.destroy(), this.gl = null
  }, b.WebGLSpriteBatch = function(a) {
    this.vertSize = 6, this.size = 2e3;
    var b = 4 * this.size * this.vertSize,
      c = 6 * this.size;
    this.vertices = new Float32Array(b), this.indices = new Uint16Array(c), this.lastIndexCount = 0;
    for (var d = 0, e = 0; c > d; d += 6, e += 4) this.indices[d + 0] = e + 0, this.indices[d + 1] = e + 1, this.indices[d + 2] = e + 2, this.indices[d + 3] = e + 0, this.indices[d + 4] = e + 2, this.indices[d + 5] = e + 3;
    this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.setContext(a), this.dirty = !0, this.textures = [], this.blendModes = []
  }, b.WebGLSpriteBatch.prototype.setContext = function(a) {
    this.gl = a, this.vertexBuffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, this.indices, a.STATIC_DRAW), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bufferData(a.ARRAY_BUFFER, this.vertices, a.DYNAMIC_DRAW), this.currentBlendMode = 99999
  }, b.WebGLSpriteBatch.prototype.begin = function(a) {
    this.renderSession = a, this.shader = this.renderSession.shaderManager.defaultShader, this.start()
  }, b.WebGLSpriteBatch.prototype.end = function() {
    this.flush()
  }, b.WebGLSpriteBatch.prototype.render = function(a) {
    var b = a.texture;
    this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = b.baseTexture);
    var c = b._uvs;
    if (c) {
      var d, e, f, g, h = a.worldAlpha,
        i = a.tint,
        j = this.vertices,
        k = a.anchor.x,
        l = a.anchor.y;
      if (b.trim) {
        var m = b.trim;
        e = m.x - k * m.width, d = e + b.crop.width, g = m.y - l * m.height, f = g + b.crop.height
      } else d = b.frame.width * (1 - k), e = b.frame.width * -k, f = b.frame.height * (1 - l), g = b.frame.height * -l;
      var n = 4 * this.currentBatchSize * this.vertSize,
        o = a.worldTransform,
        p = o.a,
        q = o.c,
        r = o.b,
        s = o.d,
        t = o.tx,
        u = o.ty;
      j[n++] = p * e + r * g + t, j[n++] = s * g + q * e + u, j[n++] = c.x0, j[n++] = c.y0, j[n++] = h, j[n++] = i, j[n++] = p * d + r * g + t, j[n++] = s * g + q * d + u, j[n++] = c.x1, j[n++] = c.y1, j[n++] = h, j[n++] = i, j[n++] = p * d + r * f + t, j[n++] = s * f + q * d + u, j[n++] = c.x2, j[n++] = c.y2, j[n++] = h, j[n++] = i, j[n++] = p * e + r * f + t, j[n++] = s * f + q * e + u, j[n++] = c.x3, j[n++] = c.y3, j[n++] = h, j[n++] = i, this.textures[this.currentBatchSize] = a.texture.baseTexture, this.blendModes[this.currentBatchSize] = a.blendMode, this.currentBatchSize++
    }
  }, b.WebGLSpriteBatch.prototype.renderTilingSprite = function(a) {
    var c = a.tilingTexture;
    this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = c.baseTexture), a._uvs || (a._uvs = new b.TextureUvs);
    var d = a._uvs;
    a.tilePosition.x %= c.baseTexture.width * a.tileScaleOffset.x, a.tilePosition.y %= c.baseTexture.height * a.tileScaleOffset.y;
    var e = a.tilePosition.x / (c.baseTexture.width * a.tileScaleOffset.x),
      f = a.tilePosition.y / (c.baseTexture.height * a.tileScaleOffset.y),
      g = a.width / c.baseTexture.width / (a.tileScale.x * a.tileScaleOffset.x),
      h = a.height / c.baseTexture.height / (a.tileScale.y * a.tileScaleOffset.y);
    d.x0 = 0 - e, d.y0 = 0 - f, d.x1 = 1 * g - e, d.y1 = 0 - f, d.x2 = 1 * g - e, d.y2 = 1 * h - f, d.x3 = 0 - e, d.y3 = 1 * h - f;
    var i = a.worldAlpha,
      j = a.tint,
      k = this.vertices,
      l = a.width,
      m = a.height,
      n = a.anchor.x,
      o = a.anchor.y,
      p = l * (1 - n),
      q = l * -n,
      r = m * (1 - o),
      s = m * -o,
      t = 4 * this.currentBatchSize * this.vertSize,
      u = a.worldTransform,
      v = u.a,
      w = u.c,
      x = u.b,
      y = u.d,
      z = u.tx,
      A = u.ty;
    k[t++] = v * q + x * s + z, k[t++] = y * s + w * q + A, k[t++] = d.x0, k[t++] = d.y0, k[t++] = i, k[t++] = j, k[t++] = v * p + x * s + z, k[t++] = y * s + w * p + A, k[t++] = d.x1, k[t++] = d.y1, k[t++] = i, k[t++] = j, k[t++] = v * p + x * r + z, k[t++] = y * r + w * p + A, k[t++] = d.x2, k[t++] = d.y2, k[t++] = i, k[t++] = j, k[t++] = v * q + x * r + z, k[t++] = y * r + w * q + A, k[t++] = d.x3, k[t++] = d.y3, k[t++] = i, k[t++] = j, this.textures[this.currentBatchSize] = c.baseTexture, this.blendModes[this.currentBatchSize] = a.blendMode, this.currentBatchSize++
  }, b.WebGLSpriteBatch.prototype.flush = function() {
    if (0 !== this.currentBatchSize) {
      var a = this.gl;
      if (this.renderSession.shaderManager.setShader(this.renderSession.shaderManager.defaultShader), this.dirty) {
        this.dirty = !1, a.activeTexture(a.TEXTURE0), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
        var b = this.renderSession.projection;
        a.uniform2f(this.shader.projectionVector, b.x, b.y);
        var c = 4 * this.vertSize;
        a.vertexAttribPointer(this.shader.aVertexPosition, 2, a.FLOAT, !1, c, 0), a.vertexAttribPointer(this.shader.aTextureCoord, 2, a.FLOAT, !1, c, 8), a.vertexAttribPointer(this.shader.colorAttribute, 2, a.FLOAT, !1, c, 16)
      }
      if (this.currentBatchSize > .5 * this.size) a.bufferSubData(a.ARRAY_BUFFER, 0, this.vertices);
      else {
        var d = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize);
        a.bufferSubData(a.ARRAY_BUFFER, 0, d)
      }
      for (var e, f, g = 0, h = 0, i = null, j = this.renderSession.blendModeManager.currentBlendMode, k = 0, l = this.currentBatchSize; l > k; k++) e = this.textures[k], f = this.blendModes[k], (i !== e || j !== f) && (this.renderBatch(i, g, h), h = k, g = 0, i = e, j = f, this.renderSession.blendModeManager.setBlendMode(j)), g++;
      this.renderBatch(i, g, h), this.currentBatchSize = 0
    }
  }, b.WebGLSpriteBatch.prototype.renderBatch = function(a, c, d) {
    if (0 !== c) {
      var e = this.gl;
      e.bindTexture(e.TEXTURE_2D, a._glTextures[e.id] || b.createWebGLTexture(a, e)), a._dirty[e.id] && b.updateWebGLTexture(this.currentBaseTexture, e), e.drawElements(e.TRIANGLES, 6 * c, e.UNSIGNED_SHORT, 6 * d * 2), this.renderSession.drawCount++
    }
  }, b.WebGLSpriteBatch.prototype.stop = function() {
    this.flush()
  }, b.WebGLSpriteBatch.prototype.start = function() {
    this.dirty = !0
  }, b.WebGLSpriteBatch.prototype.destroy = function() {
    this.vertices = null, this.indices = null, this.gl.deleteBuffer(this.vertexBuffer), this.gl.deleteBuffer(this.indexBuffer), this.currentBaseTexture = null, this.gl = null
  }, b.WebGLFastSpriteBatch = function(a) {
    this.vertSize = 10, this.maxSize = 6e3, this.size = this.maxSize;
    var b = 4 * this.size * this.vertSize,
      c = 6 * this.maxSize;
    this.vertices = new Float32Array(b), this.indices = new Uint16Array(c), this.vertexBuffer = null, this.indexBuffer = null, this.lastIndexCount = 0;
    for (var d = 0, e = 0; c > d; d += 6, e += 4) this.indices[d + 0] = e + 0, this.indices[d + 1] = e + 1, this.indices[d + 2] = e + 2, this.indices[d + 3] = e + 0, this.indices[d + 4] = e + 2, this.indices[d + 5] = e + 3;
    this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.currentBlendMode = 0, this.renderSession = null, this.shader = null, this.matrix = null, this.setContext(a)
  }, b.WebGLFastSpriteBatch.prototype.setContext = function(a) {
    this.gl = a, this.vertexBuffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, this.indices, a.STATIC_DRAW), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bufferData(a.ARRAY_BUFFER, this.vertices, a.DYNAMIC_DRAW)
  }, b.WebGLFastSpriteBatch.prototype.begin = function(a, b) {
    this.renderSession = b, this.shader = this.renderSession.shaderManager.fastShader, this.matrix = a.worldTransform.toArray(!0), this.start()
  }, b.WebGLFastSpriteBatch.prototype.end = function() {
    this.flush()
  }, b.WebGLFastSpriteBatch.prototype.render = function(a) {
    var b = a.children,
      c = b[0];
    if (c.texture._uvs) {
      this.currentBaseTexture = c.texture.baseTexture, c.blendMode !== this.renderSession.blendModeManager.currentBlendMode && (this.flush(), this.renderSession.blendModeManager.setBlendMode(c.blendMode));
      for (var d = 0, e = b.length; e > d; d++) this.renderSprite(b[d]);
      this.flush()
    }
  }, b.WebGLFastSpriteBatch.prototype.renderSprite = function(a) {
    if (a.visible && (a.texture.baseTexture === this.currentBaseTexture || (this.flush(), this.currentBaseTexture = a.texture.baseTexture, a.texture._uvs))) {
      var b, c, d, e, f, g, h, i, j = this.vertices;
      if (b = a.texture._uvs, c = a.texture.frame.width, d = a.texture.frame.height, a.texture.trim) {
        var k = a.texture.trim;
        f = k.x - a.anchor.x * k.width, e = f + a.texture.crop.width, h = k.y - a.anchor.y * k.height, g = h + a.texture.crop.height
      } else e = a.texture.frame.width * (1 - a.anchor.x), f = a.texture.frame.width * -a.anchor.x, g = a.texture.frame.height * (1 - a.anchor.y), h = a.texture.frame.height * -a.anchor.y;
      i = 4 * this.currentBatchSize * this.vertSize, j[i++] = f, j[i++] = h, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x0, j[i++] = b.y1, j[i++] = a.alpha, j[i++] = e, j[i++] = h, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x1, j[i++] = b.y1, j[i++] = a.alpha, j[i++] = e, j[i++] = g, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x2, j[i++] = b.y2, j[i++] = a.alpha, j[i++] = f, j[i++] = g, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x3, j[i++] = b.y3, j[i++] = a.alpha, this.currentBatchSize++, this.currentBatchSize >= this.size && this.flush()
    }
  }, b.WebGLFastSpriteBatch.prototype.flush = function() {
    if (0 !== this.currentBatchSize) {
      var a = this.gl;
      if (this.currentBaseTexture._glTextures[a.id] || b.createWebGLTexture(this.currentBaseTexture, a), a.bindTexture(a.TEXTURE_2D, this.currentBaseTexture._glTextures[a.id]), this.currentBatchSize > .5 * this.size) a.bufferSubData(a.ARRAY_BUFFER, 0, this.vertices);
      else {
        var c = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize);
        a.bufferSubData(a.ARRAY_BUFFER, 0, c)
      }
      a.drawElements(a.TRIANGLES, 6 * this.currentBatchSize, a.UNSIGNED_SHORT, 0), this.currentBatchSize = 0, this.renderSession.drawCount++
    }
  }, b.WebGLFastSpriteBatch.prototype.stop = function() {
    this.flush()
  }, b.WebGLFastSpriteBatch.prototype.start = function() {
    var a = this.gl;
    a.activeTexture(a.TEXTURE0), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
    var b = this.renderSession.projection;
    a.uniform2f(this.shader.projectionVector, b.x, b.y), a.uniformMatrix3fv(this.shader.uMatrix, !1, this.matrix);
    var c = 4 * this.vertSize;
    a.vertexAttribPointer(this.shader.aVertexPosition, 2, a.FLOAT, !1, c, 0), a.vertexAttribPointer(this.shader.aPositionCoord, 2, a.FLOAT, !1, c, 8), a.vertexAttribPointer(this.shader.aScale, 2, a.FLOAT, !1, c, 16), a.vertexAttribPointer(this.shader.aRotation, 1, a.FLOAT, !1, c, 24), a.vertexAttribPointer(this.shader.aTextureCoord, 2, a.FLOAT, !1, c, 28), a.vertexAttribPointer(this.shader.colorAttribute, 1, a.FLOAT, !1, c, 36)
  }, b.WebGLFilterManager = function(a, b) {
    this.transparent = b, this.filterStack = [], this.offsetX = 0, this.offsetY = 0, this.setContext(a)
  }, b.WebGLFilterManager.prototype.setContext = function(a) {
    this.gl = a, this.texturePool = [], this.initShaderBuffers()
  }, b.WebGLFilterManager.prototype.begin = function(a, b) {
    this.renderSession = a, this.defaultShader = a.shaderManager.defaultShader;
    var c = this.renderSession.projection;
    this.width = 2 * c.x, this.height = 2 * -c.y, this.buffer = b
  }, b.WebGLFilterManager.prototype.pushFilter = function(a) {
    var c = this.gl,
      d = this.renderSession.projection,
      e = this.renderSession.offset;
    a._filterArea = a.target.filterArea || a.target.getBounds(), this.filterStack.push(a);
    var f = a.filterPasses[0];
    this.offsetX += a._filterArea.x, this.offsetY += a._filterArea.y;
    var g = this.texturePool.pop();
    g ? g.resize(this.width, this.height) : g = new b.FilterTexture(this.gl, this.width, this.height), c.bindTexture(c.TEXTURE_2D, g.texture);
    var h = a._filterArea,
      i = f.padding;
    h.x -= i, h.y -= i, h.width += 2 * i, h.height += 2 * i, h.x < 0 && (h.x = 0), h.width > this.width && (h.width = this.width), h.y < 0 && (h.y = 0), h.height > this.height && (h.height = this.height), c.bindFramebuffer(c.FRAMEBUFFER, g.frameBuffer), c.viewport(0, 0, h.width, h.height), d.x = h.width / 2, d.y = -h.height / 2, e.x = -h.x, e.y = -h.y, this.renderSession.shaderManager.setShader(this.defaultShader), c.uniform2f(this.defaultShader.projectionVector, h.width / 2, -h.height / 2), c.uniform2f(this.defaultShader.offsetVector, -h.x, -h.y), c.colorMask(!0, !0, !0, !0), c.clearColor(0, 0, 0, 0), c.clear(c.COLOR_BUFFER_BIT), a._glFilterTexture = g
  }, b.WebGLFilterManager.prototype.popFilter = function() {
    var a = this.gl,
      c = this.filterStack.pop(),
      d = c._filterArea,
      e = c._glFilterTexture,
      f = this.renderSession.projection,
      g = this.renderSession.offset;
    if (c.filterPasses.length > 1) {
      a.viewport(0, 0, d.width, d.height), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = 0, this.vertexArray[1] = d.height, this.vertexArray[2] = d.width, this.vertexArray[3] = d.height, this.vertexArray[4] = 0, this.vertexArray[5] = 0, this.vertexArray[6] = d.width, this.vertexArray[7] = 0, a.bufferSubData(a.ARRAY_BUFFER, 0, this.vertexArray), a.bindBuffer(a.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = d.width / this.width, this.uvArray[5] = d.height / this.height, this.uvArray[6] = d.width / this.width, this.uvArray[7] = d.height / this.height, a.bufferSubData(a.ARRAY_BUFFER, 0, this.uvArray);
      var h = e,
        i = this.texturePool.pop();
      i || (i = new b.FilterTexture(this.gl, this.width, this.height)), i.resize(this.width, this.height), a.bindFramebuffer(a.FRAMEBUFFER, i.frameBuffer), a.clear(a.COLOR_BUFFER_BIT), a.disable(a.BLEND);
      for (var j = 0; j < c.filterPasses.length - 1; j++) {
        var k = c.filterPasses[j];
        a.bindFramebuffer(a.FRAMEBUFFER, i.frameBuffer), a.activeTexture(a.TEXTURE0), a.bindTexture(a.TEXTURE_2D, h.texture), this.applyFilterPass(k, d, d.width, d.height);
        var l = h;
        h = i, i = l
      }
      a.enable(a.BLEND), e = h, this.texturePool.push(i)
    }
    var m = c.filterPasses[c.filterPasses.length - 1];
    this.offsetX -= d.x, this.offsetY -= d.y;
    var n = this.width,
      o = this.height,
      p = 0,
      q = 0,
      r = this.buffer;
    if (0 === this.filterStack.length) a.colorMask(!0, !0, !0, !0);
    else {
      var s = this.filterStack[this.filterStack.length - 1];
      d = s._filterArea, n = d.width, o = d.height, p = d.x, q = d.y, r = s._glFilterTexture.frameBuffer
    }
    f.x = n / 2, f.y = -o / 2, g.x = p, g.y = q, d = c._filterArea;
    var t = d.x - p,
      u = d.y - q;
    a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = t, this.vertexArray[1] = u + d.height, this.vertexArray[2] = t + d.width, this.vertexArray[3] = u + d.height, this.vertexArray[4] = t, this.vertexArray[5] = u, this.vertexArray[6] = t + d.width, this.vertexArray[7] = u, a.bufferSubData(a.ARRAY_BUFFER, 0, this.vertexArray), a.bindBuffer(a.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = d.width / this.width, this.uvArray[5] = d.height / this.height, this.uvArray[6] = d.width / this.width, this.uvArray[7] = d.height / this.height, a.bufferSubData(a.ARRAY_BUFFER, 0, this.uvArray), a.viewport(0, 0, n, o), a.bindFramebuffer(a.FRAMEBUFFER, r), a.activeTexture(a.TEXTURE0), a.bindTexture(a.TEXTURE_2D, e.texture), this.applyFilterPass(m, d, n, o), this.renderSession.shaderManager.setShader(this.defaultShader), a.uniform2f(this.defaultShader.projectionVector, n / 2, -o / 2), a.uniform2f(this.defaultShader.offsetVector, -p, -q), this.texturePool.push(e), c._glFilterTexture = null
  }, b.WebGLFilterManager.prototype.applyFilterPass = function(a, c, d, e) {
    var f = this.gl,
      g = a.shaders[f.id];
    g || (g = new b.PixiShader(f), g.fragmentSrc = a.fragmentSrc, g.uniforms = a.uniforms, g.init(), a.shaders[f.id] = g), this.renderSession.shaderManager.setShader(g), f.uniform2f(g.projectionVector, d / 2, -e / 2), f.uniform2f(g.offsetVector, 0, 0), a.uniforms.dimensions && (a.uniforms.dimensions.value[0] = this.width, a.uniforms.dimensions.value[1] = this.height, a.uniforms.dimensions.value[2] = this.vertexArray[0], a.uniforms.dimensions.value[3] = this.vertexArray[5]), g.syncUniforms(), f.bindBuffer(f.ARRAY_BUFFER, this.vertexBuffer), f.vertexAttribPointer(g.aVertexPosition, 2, f.FLOAT, !1, 0, 0), f.bindBuffer(f.ARRAY_BUFFER, this.uvBuffer), f.vertexAttribPointer(g.aTextureCoord, 2, f.FLOAT, !1, 0, 0), f.bindBuffer(f.ARRAY_BUFFER, this.colorBuffer), f.vertexAttribPointer(g.colorAttribute, 2, f.FLOAT, !1, 0, 0), f.bindBuffer(f.ELEMENT_ARRAY_BUFFER, this.indexBuffer), f.drawElements(f.TRIANGLES, 6, f.UNSIGNED_SHORT, 0), this.renderSession.drawCount++
  }, b.WebGLFilterManager.prototype.initShaderBuffers = function() {
    var a = this.gl;
    this.vertexBuffer = a.createBuffer(), this.uvBuffer = a.createBuffer(), this.colorBuffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), this.vertexArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bufferData(a.ARRAY_BUFFER, this.vertexArray, a.STATIC_DRAW), this.uvArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), a.bindBuffer(a.ARRAY_BUFFER, this.uvBuffer), a.bufferData(a.ARRAY_BUFFER, this.uvArray, a.STATIC_DRAW), this.colorArray = new Float32Array([1, 16777215, 1, 16777215, 1, 16777215, 1, 16777215]), a.bindBuffer(a.ARRAY_BUFFER, this.colorBuffer), a.bufferData(a.ARRAY_BUFFER, this.colorArray, a.STATIC_DRAW), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 1, 3, 2]), a.STATIC_DRAW)
  }, b.WebGLFilterManager.prototype.destroy = function() {
    var a = this.gl;
    this.filterStack = null, this.offsetX = 0, this.offsetY = 0;
    for (var b = 0; b < this.texturePool.length; b++) this.texturePool[b].destroy();
    this.texturePool = null, a.deleteBuffer(this.vertexBuffer), a.deleteBuffer(this.uvBuffer), a.deleteBuffer(this.colorBuffer), a.deleteBuffer(this.indexBuffer)
  }, b.FilterTexture = function(a, c, d, e) {
    this.gl = a, this.frameBuffer = a.createFramebuffer(), this.texture = a.createTexture(), e = e || b.scaleModes.DEFAULT, a.bindTexture(a.TEXTURE_2D, this.texture), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, e === b.scaleModes.LINEAR ? a.LINEAR : a.NEAREST), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, e === b.scaleModes.LINEAR ? a.LINEAR : a.NEAREST), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_S, a.CLAMP_TO_EDGE), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_T, a.CLAMP_TO_EDGE), a.bindFramebuffer(a.FRAMEBUFFER, this.framebuffer), a.bindFramebuffer(a.FRAMEBUFFER, this.frameBuffer), a.framebufferTexture2D(a.FRAMEBUFFER, a.COLOR_ATTACHMENT0, a.TEXTURE_2D, this.texture, 0), this.renderBuffer = a.createRenderbuffer(), a.bindRenderbuffer(a.RENDERBUFFER, this.renderBuffer), a.framebufferRenderbuffer(a.FRAMEBUFFER, a.DEPTH_STENCIL_ATTACHMENT, a.RENDERBUFFER, this.renderBuffer), this.resize(c, d)
  }, b.FilterTexture.prototype.clear = function() {
    var a = this.gl;
    a.clearColor(0, 0, 0, 0), a.clear(a.COLOR_BUFFER_BIT)
  }, b.FilterTexture.prototype.resize = function(a, b) {
    if (this.width !== a || this.height !== b) {
      this.width = a, this.height = b;
      var c = this.gl;
      c.bindTexture(c.TEXTURE_2D, this.texture), c.texImage2D(c.TEXTURE_2D, 0, c.RGBA, a, b, 0, c.RGBA, c.UNSIGNED_BYTE, null), c.bindRenderbuffer(c.RENDERBUFFER, this.renderBuffer), c.renderbufferStorage(c.RENDERBUFFER, c.DEPTH_STENCIL, a, b)
    }
  }, b.FilterTexture.prototype.destroy = function() {
    var a = this.gl;
    a.deleteFramebuffer(this.frameBuffer), a.deleteTexture(this.texture), this.frameBuffer = null, this.texture = null
  }, b.CanvasMaskManager = function() {}, b.CanvasMaskManager.prototype.pushMask = function(a, c) {
    c.save();
    var d = a.alpha,
      e = a.worldTransform;
    c.setTransform(e.a, e.c, e.b, e.d, e.tx, e.ty), b.CanvasGraphics.renderGraphicsMask(a, c), c.clip(), a.worldAlpha = d
  }, b.CanvasMaskManager.prototype.popMask = function(a) {
    a.restore()
  }, b.CanvasTinter = function() {}, b.CanvasTinter.getTintedTexture = function(a, c) {
    var d = a.texture;
    c = b.CanvasTinter.roundColor(c);
    var e = "#" + ("00000" + (0 | c).toString(16)).substr(-6);
    if (d.tintCache = d.tintCache || {}, d.tintCache[e]) return d.tintCache[e];
    var f = b.CanvasTinter.canvas || document.createElement("canvas");
    if (b.CanvasTinter.tintMethod(d, c, f), b.CanvasTinter.convertTintToImage) {
      var g = new Image;
      g.src = f.toDataURL(), d.tintCache[e] = g
    } else d.tintCache[e] = f, b.CanvasTinter.canvas = null;
    return f
  }, b.CanvasTinter.tintWithMultiply = function(a, b, c) {
    var d = c.getContext("2d"),
      e = a.frame;
    c.width = e.width, c.height = e.height, d.fillStyle = "#" + ("00000" + (0 | b).toString(16)).substr(-6), d.fillRect(0, 0, e.width, e.height), d.globalCompositeOperation = "multiply", d.drawImage(a.baseTexture.source, e.x, e.y, e.width, e.height, 0, 0, e.width, e.height), d.globalCompositeOperation = "destination-atop", d.drawImage(a.baseTexture.source, e.x, e.y, e.width, e.height, 0, 0, e.width, e.height)
  }, b.CanvasTinter.tintWithOverlay = function(a, b, c) {
    var d = c.getContext("2d"),
      e = a.frame;
    c.width = e.width, c.height = e.height, d.globalCompositeOperation = "copy", d.fillStyle = "#" + ("00000" + (0 | b).toString(16)).substr(-6), d.fillRect(0, 0, e.width, e.height), d.globalCompositeOperation = "destination-atop", d.drawImage(a.baseTexture.source, e.x, e.y, e.width, e.height, 0, 0, e.width, e.height)
  }, b.CanvasTinter.tintWithPerPixel = function(a, c, d) {
    var e = d.getContext("2d"),
      f = a.frame;
    d.width = f.width, d.height = f.height, e.globalCompositeOperation = "copy", e.drawImage(a.baseTexture.source, f.x, f.y, f.width, f.height, 0, 0, f.width, f.height);
    for (var g = b.hex2rgb(c), h = g[0], i = g[1], j = g[2], k = e.getImageData(0, 0, f.width, f.height), l = k.data, m = 0; m < l.length; m += 4) l[m + 0] *= h, l[m + 1] *= i, l[m + 2] *= j;
    e.putImageData(k, 0, 0)
  }, b.CanvasTinter.roundColor = function(a) {
    var c = b.CanvasTinter.cacheStepsPerColorChannel,
      d = b.hex2rgb(a);
    return d[0] = Math.min(255, d[0] / c * c), d[1] = Math.min(255, d[1] / c * c), d[2] = Math.min(255, d[2] / c * c), b.rgb2hex(d)
  }, b.CanvasTinter.cacheStepsPerColorChannel = 8, b.CanvasTinter.convertTintToImage = !1, b.CanvasTinter.canUseMultiply = b.canUseNewCanvasBlendModes(), b.CanvasTinter.tintMethod = b.CanvasTinter.canUseMultiply ? b.CanvasTinter.tintWithMultiply : b.CanvasTinter.tintWithPerPixel, b.CanvasRenderer = function(a, c, d, e) {
    b.defaultRenderer || (b.sayHello("Canvas"), b.defaultRenderer = this), this.type = b.CANVAS_RENDERER, this.clearBeforeRender = !0, this.transparent = !!e, b.blendModesCanvas || (b.blendModesCanvas = [], b.canUseNewCanvasBlendModes() ? (b.blendModesCanvas[b.blendModes.NORMAL] = "source-over", b.blendModesCanvas[b.blendModes.ADD] = "lighter", b.blendModesCanvas[b.blendModes.MULTIPLY] = "multiply", b.blendModesCanvas[b.blendModes.SCREEN] = "screen", b.blendModesCanvas[b.blendModes.OVERLAY] = "overlay", b.blendModesCanvas[b.blendModes.DARKEN] = "darken", b.blendModesCanvas[b.blendModes.LIGHTEN] = "lighten", b.blendModesCanvas[b.blendModes.COLOR_DODGE] = "color-dodge", b.blendModesCanvas[b.blendModes.COLOR_BURN] = "color-burn", b.blendModesCanvas[b.blendModes.HARD_LIGHT] = "hard-light", b.blendModesCanvas[b.blendModes.SOFT_LIGHT] = "soft-light", b.blendModesCanvas[b.blendModes.DIFFERENCE] = "difference", b.blendModesCanvas[b.blendModes.EXCLUSION] = "exclusion", b.blendModesCanvas[b.blendModes.HUE] = "hue", b.blendModesCanvas[b.blendModes.SATURATION] = "saturation", b.blendModesCanvas[b.blendModes.COLOR] = "color", b.blendModesCanvas[b.blendModes.LUMINOSITY] = "luminosity") : (b.blendModesCanvas[b.blendModes.NORMAL] = "source-over", b.blendModesCanvas[b.blendModes.ADD] = "lighter", b.blendModesCanvas[b.blendModes.MULTIPLY] = "source-over", b.blendModesCanvas[b.blendModes.SCREEN] = "source-over", b.blendModesCanvas[b.blendModes.OVERLAY] = "source-over", b.blendModesCanvas[b.blendModes.DARKEN] = "source-over", b.blendModesCanvas[b.blendModes.LIGHTEN] = "source-over", b.blendModesCanvas[b.blendModes.COLOR_DODGE] = "source-over", b.blendModesCanvas[b.blendModes.COLOR_BURN] = "source-over", b.blendModesCanvas[b.blendModes.HARD_LIGHT] = "source-over", b.blendModesCanvas[b.blendModes.SOFT_LIGHT] = "source-over", b.blendModesCanvas[b.blendModes.DIFFERENCE] = "source-over", b.blendModesCanvas[b.blendModes.EXCLUSION] = "source-over", b.blendModesCanvas[b.blendModes.HUE] = "source-over", b.blendModesCanvas[b.blendModes.SATURATION] = "source-over", b.blendModesCanvas[b.blendModes.COLOR] = "source-over", b.blendModesCanvas[b.blendModes.LUMINOSITY] = "source-over")), this.width = a || 800, this.height = c || 600, this.view = d || document.createElement("canvas"), this.context = this.view.getContext("2d", {
      alpha: this.transparent
    }), this.refresh = !0, this.view.width = this.width, this.view.height = this.height, this.count = 0, this.maskManager = new b.CanvasMaskManager, this.renderSession = {
      context: this.context,
      maskManager: this.maskManager,
      scaleMode: null,
      smoothProperty: null,
      roundPixels: !1
    }, "imageSmoothingEnabled" in this.context ? this.renderSession.smoothProperty = "imageSmoothingEnabled" : "webkitImageSmoothingEnabled" in this.context ? this.renderSession.smoothProperty = "webkitImageSmoothingEnabled" : "mozImageSmoothingEnabled" in this.context ? this.renderSession.smoothProperty = "mozImageSmoothingEnabled" : "oImageSmoothingEnabled" in this.context && (this.renderSession.smoothProperty = "oImageSmoothingEnabled")
  }, b.CanvasRenderer.prototype.constructor = b.CanvasRenderer, b.CanvasRenderer.prototype.render = function(a) {
    b.texturesToUpdate.length = 0, b.texturesToDestroy.length = 0, a.updateTransform(), this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.globalAlpha = 1, navigator.isCocoonJS && this.view.screencanvas && (this.context.fillStyle = "black", this.context.clear()), !this.transparent && this.clearBeforeRender ? (this.context.fillStyle = a.backgroundColorString, this.context.fillRect(0, 0, this.width, this.height)) : this.transparent && this.clearBeforeRender && this.context.clearRect(0, 0, this.width, this.height), this.renderDisplayObject(a), a.interactive && (a._interactiveEventsAdded || (a._interactiveEventsAdded = !0, a.interactionManager.setTarget(this))), b.Texture.frameUpdates.length > 0 && (b.Texture.frameUpdates.length = 0)
  }, b.CanvasRenderer.prototype.resize = function(a, b) {
    this.width = a, this.height = b, this.view.width = a, this.view.height = b
  }, b.CanvasRenderer.prototype.renderDisplayObject = function(a, b) {
    this.renderSession.context = b || this.context, a._renderCanvas(this.renderSession)
  }, b.CanvasRenderer.prototype.renderStripFlat = function(a) {
    var b = this.context,
      c = a.verticies,
      d = c.length / 2;
    this.count++, b.beginPath();
    for (var e = 1; d - 2 > e; e++) {
      var f = 2 * e,
        g = c[f],
        h = c[f + 2],
        i = c[f + 4],
        j = c[f + 1],
        k = c[f + 3],
        l = c[f + 5];
      b.moveTo(g, j), b.lineTo(h, k), b.lineTo(i, l)
    }
    b.fillStyle = "#FF0000", b.fill(), b.closePath()
  }, b.CanvasRenderer.prototype.renderStrip = function(a) {
    var b = this.context,
      c = a.verticies,
      d = a.uvs,
      e = c.length / 2;
    this.count++;
    for (var f = 1; e - 2 > f; f++) {
      var g = 2 * f,
        h = c[g],
        i = c[g + 2],
        j = c[g + 4],
        k = c[g + 1],
        l = c[g + 3],
        m = c[g + 5],
        n = d[g] * a.texture.width,
        o = d[g + 2] * a.texture.width,
        p = d[g + 4] * a.texture.width,
        q = d[g + 1] * a.texture.height,
        r = d[g + 3] * a.texture.height,
        s = d[g + 5] * a.texture.height;
      b.save(), b.beginPath(), b.moveTo(h, k), b.lineTo(i, l), b.lineTo(j, m), b.closePath(), b.clip();
      var t = n * r + q * p + o * s - r * p - q * o - n * s,
        u = h * r + q * j + i * s - r * j - q * i - h * s,
        v = n * i + h * p + o * j - i * p - h * o - n * j,
        w = n * r * j + q * i * p + h * o * s - h * r * p - q * o * j - n * i * s,
        x = k * r + q * m + l * s - r * m - q * l - k * s,
        y = n * l + k * p + o * m - l * p - k * o - n * m,
        z = n * r * m + q * l * p + k * o * s - k * r * p - q * o * m - n * l * s;
      b.transform(u / t, x / t, v / t, y / t, w / t, z / t), b.drawImage(a.texture.baseTexture.source, 0, 0), b.restore()
    }
  }, b.CanvasBuffer = function(a, b) {
    this.width = a, this.height = b, this.canvas = document.createElement("canvas"), this.context = this.canvas.getContext("2d"), this.canvas.width = a, this.canvas.height = b
  }, b.CanvasBuffer.prototype.clear = function() {
    this.context.clearRect(0, 0, this.width, this.height)
  }, b.CanvasBuffer.prototype.resize = function(a, b) {
    this.width = this.canvas.width = a, this.height = this.canvas.height = b
  }, b.CanvasGraphics = function() {}, b.CanvasGraphics.renderGraphics = function(a, c) {
    for (var d = a.worldAlpha, e = "", f = 0; f < a.graphicsData.length; f++) {
      var g = a.graphicsData[f],
        h = g.points;
      if (c.strokeStyle = e = "#" + ("00000" + (0 | g.lineColor).toString(16)).substr(-6), c.lineWidth = g.lineWidth, g.type === b.Graphics.POLY) {
        c.beginPath(), c.moveTo(h[0], h[1]);
        for (var i = 1; i < h.length / 2; i++) c.lineTo(h[2 * i], h[2 * i + 1]);
        h[0] === h[h.length - 2] && h[1] === h[h.length - 1] && c.closePath(), g.fill && (c.globalAlpha = g.fillAlpha * d, c.fillStyle = e = "#" + ("00000" + (0 | g.fillColor).toString(16)).substr(-6), c.fill()), g.lineWidth && (c.globalAlpha = g.lineAlpha * d, c.stroke())
      } else if (g.type === b.Graphics.RECT)(g.fillColor || 0 === g.fillColor) && (c.globalAlpha = g.fillAlpha * d, c.fillStyle = e = "#" + ("00000" + (0 | g.fillColor).toString(16)).substr(-6), c.fillRect(h[0], h[1], h[2], h[3])), g.lineWidth && (c.globalAlpha = g.lineAlpha * d, c.strokeRect(h[0], h[1], h[2], h[3]));
      else if (g.type === b.Graphics.CIRC) c.beginPath(), c.arc(h[0], h[1], h[2], 0, 2 * Math.PI), c.closePath(), g.fill && (c.globalAlpha = g.fillAlpha * d, c.fillStyle = e = "#" + ("00000" + (0 | g.fillColor).toString(16)).substr(-6), c.fill()), g.lineWidth && (c.globalAlpha = g.lineAlpha * d, c.stroke());
      else if (g.type === b.Graphics.ELIP) {
        var j = g.points,
          k = 2 * j[2],
          l = 2 * j[3],
          m = j[0] - k / 2,
          n = j[1] - l / 2;
        c.beginPath();
        var o = .5522848,
          p = k / 2 * o,
          q = l / 2 * o,
          r = m + k,
          s = n + l,
          t = m + k / 2,
          u = n + l / 2;
        c.moveTo(m, u), c.bezierCurveTo(m, u - q, t - p, n, t, n), c.bezierCurveTo(t + p, n, r, u - q, r, u), c.bezierCurveTo(r, u + q, t + p, s, t, s), c.bezierCurveTo(t - p, s, m, u + q, m, u), c.closePath(), g.fill && (c.globalAlpha = g.fillAlpha * d, c.fillStyle = e = "#" + ("00000" + (0 | g.fillColor).toString(16)).substr(-6), c.fill()), g.lineWidth && (c.globalAlpha = g.lineAlpha * d, c.stroke())
      } else if (g.type === b.Graphics.RREC) {
        var v = h[0],
          w = h[1],
          x = h[2],
          y = h[3],
          z = h[4],
          A = Math.min(x, y) / 2 | 0;
        z = z > A ? A : z, c.beginPath(), c.moveTo(v, w + z), c.lineTo(v, w + y - z), c.quadraticCurveTo(v, w + y, v + z, w + y), c.lineTo(v + x - z, w + y), c.quadraticCurveTo(v + x, w + y, v + x, w + y - z), c.lineTo(v + x, w + z), c.quadraticCurveTo(v + x, w, v + x - z, w), c.lineTo(v + z, w), c.quadraticCurveTo(v, w, v, w + z), c.closePath(), (g.fillColor || 0 === g.fillColor) && (c.globalAlpha = g.fillAlpha * d, c.fillStyle = e = "#" + ("00000" + (0 | g.fillColor).toString(16)).substr(-6), c.fill()), g.lineWidth && (c.globalAlpha = g.lineAlpha * d, c.stroke())
      }
    }
  }, b.CanvasGraphics.renderGraphicsMask = function(a, c) {
    var d = a.graphicsData.length;
    if (0 !== d) {
      d > 1 && (d = 1, window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));
      for (var e = 0; 1 > e; e++) {
        var f = a.graphicsData[e],
          g = f.points;
        if (f.type === b.Graphics.POLY) {
          c.beginPath(), c.moveTo(g[0], g[1]);
          for (var h = 1; h < g.length / 2; h++) c.lineTo(g[2 * h], g[2 * h + 1]);
          g[0] === g[g.length - 2] && g[1] === g[g.length - 1] && c.closePath()
        } else if (f.type === b.Graphics.RECT) c.beginPath(), c.rect(g[0], g[1], g[2], g[3]), c.closePath();
        else if (f.type === b.Graphics.CIRC) c.beginPath(), c.arc(g[0], g[1], g[2], 0, 2 * Math.PI), c.closePath();
        else if (f.type === b.Graphics.ELIP) {
          var i = f.points,
            j = 2 * i[2],
            k = 2 * i[3],
            l = i[0] - j / 2,
            m = i[1] - k / 2;
          c.beginPath();
          var n = .5522848,
            o = j / 2 * n,
            p = k / 2 * n,
            q = l + j,
            r = m + k,
            s = l + j / 2,
            t = m + k / 2;
          c.moveTo(l, t), c.bezierCurveTo(l, t - p, s - o, m, s, m), c.bezierCurveTo(s + o, m, q, t - p, q, t), c.bezierCurveTo(q, t + p, s + o, r, s, r), c.bezierCurveTo(s - o, r, l, t + p, l, t), c.closePath()
        } else if (f.type === b.Graphics.RREC) {
          var u = g[0],
            v = g[1],
            w = g[2],
            x = g[3],
            y = g[4],
            z = Math.min(w, x) / 2 | 0;
          y = y > z ? z : y, c.beginPath(), c.moveTo(u, v + y), c.lineTo(u, v + x - y), c.quadraticCurveTo(u, v + x, u + y, v + x), c.lineTo(u + w - y, v + x), c.quadraticCurveTo(u + w, v + x, u + w, v + x - y), c.lineTo(u + w, v + y), c.quadraticCurveTo(u + w, v, u + w - y, v), c.lineTo(u + y, v), c.quadraticCurveTo(u, v, u, v + y), c.closePath()
        }
      }
    }
  }, b.Graphics = function() {
    b.DisplayObjectContainer.call(this), this.renderable = !0, this.fillAlpha = 1, this.lineWidth = 0, this.lineColor = "black", this.graphicsData = [], this.tint = 16777215, this.blendMode = b.blendModes.NORMAL, this.currentPath = {
      points: []
    }, this._webGL = [], this.isMask = !1, this.bounds = null, this.boundsPadding = 10, this.dirty = !0
  }, b.Graphics.prototype = Object.create(b.DisplayObjectContainer.prototype), b.Graphics.prototype.constructor = b.Graphics, Object.defineProperty(b.Graphics.prototype, "cacheAsBitmap", {
    get: function() {
      return this._cacheAsBitmap
    },
    set: function(a) {
      this._cacheAsBitmap = a, this._cacheAsBitmap ? this._generateCachedSprite() : (this.destroyCachedSprite(), this.dirty = !0)
    }
  }), b.Graphics.prototype.lineStyle = function(a, c, d) {
    return this.currentPath.points.length || this.graphicsData.pop(), this.lineWidth = a || 0, this.lineColor = c || 0, this.lineAlpha = arguments.length < 3 ? 1 : d, this.currentPath = {
      lineWidth: this.lineWidth,
      lineColor: this.lineColor,
      lineAlpha: this.lineAlpha,
      fillColor: this.fillColor,
      fillAlpha: this.fillAlpha,
      fill: this.filling,
      points: [],
      type: b.Graphics.POLY
    }, this.graphicsData.push(this.currentPath), this
  }, b.Graphics.prototype.moveTo = function(a, c) {
    return this.currentPath.points.length || this.graphicsData.pop(), this.currentPath = this.currentPath = {
      lineWidth: this.lineWidth,
      lineColor: this.lineColor,
      lineAlpha: this.lineAlpha,
      fillColor: this.fillColor,
      fillAlpha: this.fillAlpha,
      fill: this.filling,
      points: [],
      type: b.Graphics.POLY
    }, this.currentPath.points.push(a, c), this.graphicsData.push(this.currentPath), this
  }, b.Graphics.prototype.lineTo = function(a, b) {
    return this.currentPath.points.push(a, b), this.dirty = !0, this
  }, b.Graphics.prototype.quadraticCurveTo = function(a, b, c, d) {
    0 === this.currentPath.points.length && this.moveTo(0, 0);
    var e, f, g = 20,
      h = this.currentPath.points;
    0 === h.length && this.moveTo(0, 0);
    for (var i = h[h.length - 2], j = h[h.length - 1], k = 0, l = 1; g >= l; l++) k = l / g, e = i + (a - i) * k, f = j + (b - j) * k, h.push(e + (a + (c - a) * k - e) * k, f + (b + (d - b) * k - f) * k);
    return this.dirty = !0, this
  }, b.Graphics.prototype.bezierCurveTo = function(a, b, c, d, e, f) {
    0 === this.currentPath.points.length && this.moveTo(0, 0);
    for (var g, h, i, j, k, l = 20, m = this.currentPath.points, n = m[m.length - 2], o = m[m.length - 1], p = 0, q = 1; l > q; q++) p = q / l, g = 1 - p, h = g * g, i = h * g, j = p * p, k = j * p, m.push(i * n + 3 * h * p * a + 3 * g * j * c + k * e, i * o + 3 * h * p * b + 3 * g * j * d + k * f);
    return this.dirty = !0, this
  }, b.Graphics.prototype.arcTo = function(a, b, c, d, e) {
    0 === this.currentPath.points.length && this.moveTo(a, b);
    var f = this.currentPath.points,
      g = f[f.length - 2],
      h = f[f.length - 1],
      i = h - b,
      j = g - a,
      k = d - b,
      l = c - a,
      m = Math.abs(i * l - j * k);
    if (1e-8 > m || 0 === e) f.push(a, b);
    else {
      var n = i * i + j * j,
        o = k * k + l * l,
        p = i * k + j * l,
        q = e * Math.sqrt(n) / m,
        r = e * Math.sqrt(o) / m,
        s = q * p / n,
        t = r * p / o,
        u = q * l + r * j,
        v = q * k + r * i,
        w = j * (r + s),
        x = i * (r + s),
        y = l * (q + t),
        z = k * (q + t),
        A = Math.atan2(x - v, w - u),
        B = Math.atan2(z - v, y - u);
      this.arc(u + a, v + b, e, A, B, j * k > l * i)
    }
    return this.dirty = !0, this
  }, b.Graphics.prototype.arc = function(a, b, c, d, e, f) {
    var g = a + Math.cos(d) * c,
      h = b + Math.sin(d) * c,
      i = this.currentPath.points;
    if ((0 !== i.length && i[i.length - 2] !== g || i[i.length - 1] !== h) && (this.moveTo(g, h), i = this.currentPath.points), d === e) return this;
    !f && d >= e ? e += 2 * Math.PI : f && e >= d && (d += 2 * Math.PI);
    var j = f ? -1 * (d - e) : e - d,
      k = Math.abs(j) / (2 * Math.PI) * 40;
    if (0 === j) return this;
    for (var l = j / (2 * k), m = 2 * l, n = Math.cos(l), o = Math.sin(l), p = k - 1, q = p % 1 / p, r = 0; p >= r; r++) {
      var s = r + q * r,
        t = l + d + m * s,
        u = Math.cos(t),
        v = -Math.sin(t);
      i.push((n * u + o * v) * c + a, (n * -v + o * u) * c + b)
    }
    return this.dirty = !0, this
  }, b.Graphics.prototype.drawPath = function(a) {
    return this.currentPath.points.length || this.graphicsData.pop(), this.currentPath = this.currentPath = {
      lineWidth: this.lineWidth,
      lineColor: this.lineColor,
      lineAlpha: this.lineAlpha,
      fillColor: this.fillColor,
      fillAlpha: this.fillAlpha,
      fill: this.filling,
      points: [],
      type: b.Graphics.POLY
    }, this.graphicsData.push(this.currentPath), this.currentPath.points = this.currentPath.points.concat(a), this.dirty = !0, this
  }, b.Graphics.prototype.beginFill = function(a, b) {
    return this.filling = !0, this.fillColor = a || 0, this.fillAlpha = arguments.length < 2 ? 1 : b, this
  }, b.Graphics.prototype.endFill = function() {
    return this.filling = !1, this.fillColor = null, this.fillAlpha = 1, this
  }, b.Graphics.prototype.drawRect = function(a, c, d, e) {
    return this.currentPath.points.length || this.graphicsData.pop(), this.currentPath = {
      lineWidth: this.lineWidth,
      lineColor: this.lineColor,
      lineAlpha: this.lineAlpha,
      fillColor: this.fillColor,
      fillAlpha: this.fillAlpha,
      fill: this.filling,
      points: [a, c, d, e],
      type: b.Graphics.RECT
    }, this.graphicsData.push(this.currentPath), this.dirty = !0, this
  }, b.Graphics.prototype.drawRoundedRect = function(a, c, d, e, f) {
    return this.currentPath.points.length || this.graphicsData.pop(), this.currentPath = {
      lineWidth: this.lineWidth,
      lineColor: this.lineColor,
      lineAlpha: this.lineAlpha,
      fillColor: this.fillColor,
      fillAlpha: this.fillAlpha,
      fill: this.filling,
      points: [a, c, d, e, f],
      type: b.Graphics.RREC
    }, this.graphicsData.push(this.currentPath), this.dirty = !0, this
  }, b.Graphics.prototype.drawCircle = function(a, c, d) {
    return this.currentPath.points.length || this.graphicsData.pop(), this.currentPath = {
      lineWidth: this.lineWidth,
      lineColor: this.lineColor,
      lineAlpha: this.lineAlpha,
      fillColor: this.fillColor,
      fillAlpha: this.fillAlpha,
      fill: this.filling,
      points: [a, c, d, d],
      type: b.Graphics.CIRC
    }, this.graphicsData.push(this.currentPath), this.dirty = !0, this
  }, b.Graphics.prototype.drawEllipse = function(a, c, d, e) {
    return this.currentPath.points.length || this.graphicsData.pop(), this.currentPath = {
      lineWidth: this.lineWidth,
      lineColor: this.lineColor,
      lineAlpha: this.lineAlpha,
      fillColor: this.fillColor,
      fillAlpha: this.fillAlpha,
      fill: this.filling,
      points: [a, c, d, e],
      type: b.Graphics.ELIP
    }, this.graphicsData.push(this.currentPath), this.dirty = !0, this
  }, b.Graphics.prototype.clear = function() {
    return this.lineWidth = 0, this.filling = !1, this.dirty = !0, this.clearDirty = !0, this.graphicsData = [], this.bounds = null, this
  }, b.Graphics.prototype.generateTexture = function() {
    var a = this.getBounds(),
      c = new b.CanvasBuffer(a.width, a.height),
      d = b.Texture.fromCanvas(c.canvas);
    return c.context.translate(-a.x, -a.y), b.CanvasGraphics.renderGraphics(this, c.context), d
  }, b.Graphics.prototype._renderWebGL = function(a) {
    if (this.visible !== !1 && 0 !== this.alpha && this.isMask !== !0) {
      if (this._cacheAsBitmap) return this.dirty && (this._generateCachedSprite(), b.updateWebGLTexture(this._cachedSprite.texture.baseTexture, a.gl), this.dirty = !1), this._cachedSprite.alpha = this.alpha, b.Sprite.prototype._renderWebGL.call(this._cachedSprite, a), void 0;
      if (a.spriteBatch.stop(), a.blendModeManager.setBlendMode(this.blendMode), this._mask && a.maskManager.pushMask(this._mask, a), this._filters && a.filterManager.pushFilter(this._filterBlock), this.blendMode !== a.spriteBatch.currentBlendMode) {
        a.spriteBatch.currentBlendMode = this.blendMode;
        var c = b.blendModesWebGL[a.spriteBatch.currentBlendMode];
        a.spriteBatch.gl.blendFunc(c[0], c[1])
      }
      if (b.WebGLGraphics.renderGraphics(this, a), this.children.length) {
        a.spriteBatch.start();
        for (var d = 0, e = this.children.length; e > d; d++) this.children[d]._renderWebGL(a);
        a.spriteBatch.stop()
      }
      this._filters && a.filterManager.popFilter(), this._mask && a.maskManager.popMask(this.mask, a), a.drawCount++, a.spriteBatch.start()
    }
  }, b.Graphics.prototype._renderCanvas = function(a) {
    if (this.visible !== !1 && 0 !== this.alpha && this.isMask !== !0) {
      var c = a.context,
        d = this.worldTransform;
      this.blendMode !== a.currentBlendMode && (a.currentBlendMode = this.blendMode, c.globalCompositeOperation = b.blendModesCanvas[a.currentBlendMode]), this._mask && a.maskManager.pushMask(this._mask, a.context), c.setTransform(d.a, d.c, d.b, d.d, d.tx, d.ty), b.CanvasGraphics.renderGraphics(this, c);
      for (var e = 0, f = this.children.length; f > e; e++) this.children[e]._renderCanvas(a);
      this._mask && a.maskManager.popMask(a.context)
    }
  }, b.Graphics.prototype.getBounds = function(a) {
    this.bounds || this.updateBounds();
    var b = this.bounds.x,
      c = this.bounds.width + this.bounds.x,
      d = this.bounds.y,
      e = this.bounds.height + this.bounds.y,
      f = a || this.worldTransform,
      g = f.a,
      h = f.c,
      i = f.b,
      j = f.d,
      k = f.tx,
      l = f.ty,
      m = g * c + i * e + k,
      n = j * e + h * c + l,
      o = g * b + i * e + k,
      p = j * e + h * b + l,
      q = g * b + i * d + k,
      r = j * d + h * b + l,
      s = g * c + i * d + k,
      t = j * d + h * c + l,
      u = m,
      v = n,
      w = m,
      x = n;
    w = w > o ? o : w, w = w > q ? q : w, w = w > s ? s : w, x = x > p ? p : x, x = x > r ? r : x, x = x > t ? t : x, u = o > u ? o : u, u = q > u ? q : u, u = s > u ? s : u, v = p > v ? p : v, v = r > v ? r : v, v = t > v ? t : v;
    var y = this._bounds;
    return y.x = w, y.width = u - w, y.y = x, y.height = v - x, y
  }, b.Graphics.prototype.updateBounds = function() {
    for (var a, c, d, e, f, g = 1 / 0, h = -1 / 0, i = 1 / 0, j = -1 / 0, k = 0; k < this.graphicsData.length; k++) {
      var l = this.graphicsData[k],
        m = l.type,
        n = l.lineWidth;
      if (a = l.points, m === b.Graphics.RECT) c = a[0] - n / 2, d = a[1] - n / 2, e = a[2] + n, f = a[3] + n, g = g > c ? c : g, h = c + e > h ? c + e : h, i = i > d ? c : i, j = d + f > j ? d + f : j;
      else if (m === b.Graphics.CIRC || m === b.Graphics.ELIP) c = a[0], d = a[1], e = a[2] + n / 2, f = a[3] + n / 2, g = g > c - e ? c - e : g, h = c + e > h ? c + e : h, i = i > d - f ? d - f : i, j = d + f > j ? d + f : j;
      else
        for (var o = 0; o < a.length; o += 2) c = a[o], d = a[o + 1], g = g > c - n ? c - n : g, h = c + n > h ? c + n : h, i = i > d - n ? d - n : i, j = d + n > j ? d + n : j
    }
    var p = this.boundsPadding;
    this.bounds = new b.Rectangle(g - p, i - p, h - g + 2 * p, j - i + 2 * p)
  }, b.Graphics.prototype._generateCachedSprite = function() {
    var a = this.getLocalBounds();
    if (this._cachedSprite) this._cachedSprite.buffer.resize(a.width, a.height);
    else {
      var c = new b.CanvasBuffer(a.width, a.height),
        d = b.Texture.fromCanvas(c.canvas);
      this._cachedSprite = new b.Sprite(d), this._cachedSprite.buffer = c, this._cachedSprite.worldTransform = this.worldTransform
    }
    this._cachedSprite.anchor.x = -(a.x / a.width), this._cachedSprite.anchor.y = -(a.y / a.height), this._cachedSprite.buffer.context.translate(-a.x, -a.y), b.CanvasGraphics.renderGraphics(this, this._cachedSprite.buffer.context), this._cachedSprite.alpha = this.alpha
  }, b.Graphics.prototype.destroyCachedSprite = function() {
    this._cachedSprite.texture.destroy(!0), this._cachedSprite = null
  }, b.Graphics.POLY = 0, b.Graphics.RECT = 1, b.Graphics.CIRC = 2, b.Graphics.ELIP = 3, b.Graphics.RREC = 4, b.Strip = function(a) {
    b.DisplayObjectContainer.call(this), this.texture = a, this.uvs = new b.Float32Array([0, 1, 1, 1, 1, 0, 0, 1]), this.verticies = new b.Float32Array([0, 0, 100, 0, 100, 100, 0, 100]), this.colors = new b.Float32Array([1, 1, 1, 1]), this.indices = new b.Uint16Array([0, 1, 2, 3]), this.dirty = !0
  }, b.Strip.prototype = Object.create(b.DisplayObjectContainer.prototype), b.Strip.prototype.constructor = b.Strip, b.Strip.prototype._renderWebGL = function(a) {
    !this.visible || this.alpha <= 0 || (a.spriteBatch.stop(), this._vertexBuffer || this._initWebGL(a), a.shaderManager.setShader(a.shaderManager.stripShader), this._renderStrip(a), a.spriteBatch.start())
  }, b.Strip.prototype._initWebGL = function(a) {
    var b = a.gl;
    this._vertexBuffer = b.createBuffer(), this._indexBuffer = b.createBuffer(), this._uvBuffer = b.createBuffer(), this._colorBuffer = b.createBuffer(), b.bindBuffer(b.ARRAY_BUFFER, this._vertexBuffer), b.bufferData(b.ARRAY_BUFFER, this.verticies, b.DYNAMIC_DRAW), b.bindBuffer(b.ARRAY_BUFFER, this._uvBuffer), b.bufferData(b.ARRAY_BUFFER, this.uvs, b.STATIC_DRAW), b.bindBuffer(b.ARRAY_BUFFER, this._colorBuffer), b.bufferData(b.ARRAY_BUFFER, this.colors, b.STATIC_DRAW), b.bindBuffer(b.ELEMENT_ARRAY_BUFFER, this._indexBuffer), b.bufferData(b.ELEMENT_ARRAY_BUFFER, this.indices, b.STATIC_DRAW)
  }, b.Strip.prototype._renderStrip = function(a) {
    var c = a.gl,
      d = a.projection,
      e = a.offset,
      f = a.shaderManager.stripShader;
    c.blendFunc(c.ONE, c.ONE_MINUS_SRC_ALPHA), c.uniformMatrix3fv(f.translationMatrix, !1, this.worldTransform.toArray(!0)), c.uniform2f(f.projectionVector, d.x, -d.y), c.uniform2f(f.offsetVector, -e.x, -e.y), c.uniform1f(f.alpha, 1), this.dirty ? (this.dirty = !1, c.bindBuffer(c.ARRAY_BUFFER, this._vertexBuffer), c.bufferData(c.ARRAY_BUFFER, this.verticies, c.STATIC_DRAW), c.vertexAttribPointer(f.aVertexPosition, 2, c.FLOAT, !1, 0, 0), c.bindBuffer(c.ARRAY_BUFFER, this._uvBuffer), c.bufferData(c.ARRAY_BUFFER, this.uvs, c.STATIC_DRAW), c.vertexAttribPointer(f.aTextureCoord, 2, c.FLOAT, !1, 0, 0), c.activeTexture(c.TEXTURE0), c.bindTexture(c.TEXTURE_2D, this.texture.baseTexture._glTextures[c.id] || b.createWebGLTexture(this.texture.baseTexture, c)), c.bindBuffer(c.ELEMENT_ARRAY_BUFFER, this._indexBuffer), c.bufferData(c.ELEMENT_ARRAY_BUFFER, this.indices, c.STATIC_DRAW)) : (c.bindBuffer(c.ARRAY_BUFFER, this._vertexBuffer), c.bufferSubData(c.ARRAY_BUFFER, 0, this.verticies), c.vertexAttribPointer(f.aVertexPosition, 2, c.FLOAT, !1, 0, 0), c.bindBuffer(c.ARRAY_BUFFER, this._uvBuffer), c.vertexAttribPointer(f.aTextureCoord, 2, c.FLOAT, !1, 0, 0), c.activeTexture(c.TEXTURE0), c.bindTexture(c.TEXTURE_2D, this.texture.baseTexture._glTextures[c.id] || b.createWebGLTexture(this.texture.baseTexture, c)), c.bindBuffer(c.ELEMENT_ARRAY_BUFFER, this._indexBuffer)), c.drawElements(c.TRIANGLE_STRIP, this.indices.length, c.UNSIGNED_SHORT, 0)
  }, b.Strip.prototype._renderCanvas = function(a) {
    var b = a.context,
      c = this.worldTransform;
    a.roundPixels ? b.setTransform(c.a, c.c, c.b, c.d, 0 | c.tx, 0 | c.ty) : b.setTransform(c.a, c.c, c.b, c.d, c.tx, c.ty);
    var d = this,
      e = d.verticies,
      f = d.uvs,
      g = e.length / 2;
    this.count++;
    for (var h = 0; g - 2 > h; h++) {
      var i = 2 * h,
        j = e[i],
        k = e[i + 2],
        l = e[i + 4],
        m = e[i + 1],
        n = e[i + 3],
        o = e[i + 5],
        p = (j + k + l) / 3,
        q = (m + n + o) / 3,
        r = j - p,
        s = m - q,
        t = Math.sqrt(r * r + s * s);
      j = p + r / t * (t + 3), m = q + s / t * (t + 3), r = k - p, s = n - q, t = Math.sqrt(r * r + s * s), k = p + r / t * (t + 3), n = q + s / t * (t + 3), r = l - p, s = o - q, t = Math.sqrt(r * r + s * s), l = p + r / t * (t + 3), o = q + s / t * (t + 3);
      var u = f[i] * d.texture.width,
        v = f[i + 2] * d.texture.width,
        w = f[i + 4] * d.texture.width,
        x = f[i + 1] * d.texture.height,
        y = f[i + 3] * d.texture.height,
        z = f[i + 5] * d.texture.height;
      b.save(), b.beginPath(), b.moveTo(j, m), b.lineTo(k, n), b.lineTo(l, o), b.closePath(), b.clip();
      var A = u * y + x * w + v * z - y * w - x * v - u * z,
        B = j * y + x * l + k * z - y * l - x * k - j * z,
        C = u * k + j * w + v * l - k * w - j * v - u * l,
        D = u * y * l + x * k * w + j * v * z - j * y * w - x * v * l - u * k * z,
        E = m * y + x * o + n * z - y * o - x * n - m * z,
        F = u * n + m * w + v * o - n * w - m * v - u * o,
        G = u * y * o + x * n * w + m * v * z - m * y * w - x * v * o - u * n * z;
      b.transform(B / A, E / A, C / A, F / A, D / A, G / A), b.drawImage(d.texture.baseTexture.source, 0, 0), b.restore()
    }
  }, b.Strip.prototype.onTextureUpdate = function() {
    this.updateFrame = !0
  }, b.Rope = function(a, c) {
    b.Strip.call(this, a), this.points = c, this.verticies = new b.Float32Array(4 * c.length), this.uvs = new b.Float32Array(4 * c.length), this.colors = new b.Float32Array(2 * c.length), this.indices = new b.Uint16Array(2 * c.length), this.refresh()
  }, b.Rope.prototype = Object.create(b.Strip.prototype), b.Rope.prototype.constructor = b.Rope, b.Rope.prototype.refresh = function() {
    var a = this.points;
    if (!(a.length < 1)) {
      var b = this.uvs,
        c = a[0],
        d = this.indices,
        e = this.colors;
      this.count -= .2, b[0] = 0, b[1] = 0, b[2] = 0, b[3] = 1, e[0] = 1, e[1] = 1, d[0] = 0, d[1] = 1;
      for (var f, g, h, i = a.length, j = 1; i > j; j++) f = a[j], g = 4 * j, h = j / (i - 1), j % 2 ? (b[g] = h, b[g + 1] = 0, b[g + 2] = h, b[g + 3] = 1) : (b[g] = h, b[g + 1] = 0, b[g + 2] = h, b[g + 3] = 1), g = 2 * j, e[g] = 1, e[g + 1] = 1, g = 2 * j, d[g] = g, d[g + 1] = g + 1, c = f
    }
  }, b.Rope.prototype.updateTransform = function() {
    var a = this.points;
    if (!(a.length < 1)) {
      var c, d = a[0],
        e = {
          x: 0,
          y: 0
        };
      this.count -= .2;
      for (var f, g, h, i, j, k = this.verticies, l = a.length, m = 0; l > m; m++) f = a[m], g = 4 * m, c = m < a.length - 1 ? a[m + 1] : f, e.y = -(c.x - d.x), e.x = c.y - d.y, h = 10 * (1 - m / (l - 1)), h > 1 && (h = 1), i = Math.sqrt(e.x * e.x + e.y * e.y), j = this.texture.height / 2, e.x /= i, e.y /= i, e.x *= j, e.y *= j, k[g] = f.x + e.x, k[g + 1] = f.y + e.y, k[g + 2] = f.x - e.x, k[g + 3] = f.y - e.y, d = f;
      b.DisplayObjectContainer.prototype.updateTransform.call(this)
    }
  }, b.Rope.prototype.setTexture = function(a) {
    this.texture = a
  }, b.TilingSprite = function(a, c, d) {
    b.Sprite.call(this, a), this._width = c || 100, this._height = d || 100, this.tileScale = new b.Point(1, 1), this.tileScaleOffset = new b.Point(1, 1), this.tilePosition = new b.Point(0, 0), this.renderable = !0, this.tint = 16777215, this.blendMode = b.blendModes.NORMAL
  }, b.TilingSprite.prototype = Object.create(b.Sprite.prototype), b.TilingSprite.prototype.constructor = b.TilingSprite, Object.defineProperty(b.TilingSprite.prototype, "width", {
    get: function() {
      return this._width
    },
    set: function(a) {
      this._width = a
    }
  }), Object.defineProperty(b.TilingSprite.prototype, "height", {
    get: function() {
      return this._height
    },
    set: function(a) {
      this._height = a
    }
  }), b.TilingSprite.prototype.setTexture = function(a) {
    this.texture !== a && (this.texture = a, this.refreshTexture = !0, this.cachedTint = 16777215)
  }, b.TilingSprite.prototype._renderWebGL = function(a) {
    if (this.visible !== !1 && 0 !== this.alpha) {
      var c, d;
      for (this._mask && (a.spriteBatch.stop(), a.maskManager.pushMask(this.mask, a), a.spriteBatch.start()), this._filters && (a.spriteBatch.flush(), a.filterManager.pushFilter(this._filterBlock)), !this.tilingTexture || this.refreshTexture ? (this.generateTilingTexture(!0), this.tilingTexture && this.tilingTexture.needsUpdate && (b.updateWebGLTexture(this.tilingTexture.baseTexture, a.gl), this.tilingTexture.needsUpdate = !1)) : a.spriteBatch.renderTilingSprite(this), c = 0, d = this.children.length; d > c; c++) this.children[c]._renderWebGL(a);
      a.spriteBatch.stop(), this._filters && a.filterManager.popFilter(), this._mask && a.maskManager.popMask(a), a.spriteBatch.start()
    }
  }, b.TilingSprite.prototype._renderCanvas = function(a) {
    if (this.visible !== !1 && 0 !== this.alpha) {
      var c = a.context;
      this._mask && a.maskManager.pushMask(this._mask, c), c.globalAlpha = this.worldAlpha;
      var d, e, f = this.worldTransform;
      if (c.setTransform(f.a, f.c, f.b, f.d, f.tx, f.ty), !this.__tilePattern || this.refreshTexture) {
        if (this.generateTilingTexture(!1), !this.tilingTexture) return;
        this.__tilePattern = c.createPattern(this.tilingTexture.baseTexture.source, "repeat")
      }
      this.blendMode !== a.currentBlendMode && (a.currentBlendMode = this.blendMode, c.globalCompositeOperation = b.blendModesCanvas[a.currentBlendMode]);
      var g = this.tilePosition,
        h = this.tileScale;
      for (g.x %= this.tilingTexture.baseTexture.width, g.y %= this.tilingTexture.baseTexture.height, c.scale(h.x, h.y), c.translate(g.x, g.y), c.fillStyle = this.__tilePattern, c.fillRect(-g.x + this.anchor.x * -this._width, -g.y + this.anchor.y * -this._height, this._width / h.x, this._height / h.y), c.scale(1 / h.x, 1 / h.y), c.translate(-g.x, -g.y), this._mask && a.maskManager.popMask(a.context), d = 0, e = this.children.length; e > d; d++) this.children[d]._renderCanvas(a)
    }
  }, b.TilingSprite.prototype.getBounds = function() {
    var a = this._width,
      b = this._height,
      c = a * (1 - this.anchor.x),
      d = a * -this.anchor.x,
      e = b * (1 - this.anchor.y),
      f = b * -this.anchor.y,
      g = this.worldTransform,
      h = g.a,
      i = g.c,
      j = g.b,
      k = g.d,
      l = g.tx,
      m = g.ty,
      n = h * d + j * f + l,
      o = k * f + i * d + m,
      p = h * c + j * f + l,
      q = k * f + i * c + m,
      r = h * c + j * e + l,
      s = k * e + i * c + m,
      t = h * d + j * e + l,
      u = k * e + i * d + m,
      v = -1 / 0,
      w = -1 / 0,
      x = 1 / 0,
      y = 1 / 0;
    x = x > n ? n : x, x = x > p ? p : x, x = x > r ? r : x, x = x > t ? t : x, y = y > o ? o : y, y = y > q ? q : y, y = y > s ? s : y, y = y > u ? u : y, v = n > v ? n : v, v = p > v ? p : v, v = r > v ? r : v, v = t > v ? t : v, w = o > w ? o : w, w = q > w ? q : w, w = s > w ? s : w, w = u > w ? u : w;
    var z = this._bounds;
    return z.x = x, z.width = v - x, z.y = y, z.height = w - y, this._currentBounds = z, z
  }, b.TilingSprite.prototype.onTextureUpdate = function() {}, b.TilingSprite.prototype.generateTilingTexture = function(a) {
    if (this.texture.baseTexture.hasLoaded) {
      var c, d, e = this.texture,
        f = e.frame,
        g = f.width !== e.baseTexture.width || f.height !== e.baseTexture.height,
        h = !1;
      if (a ? (c = b.getNextPowerOfTwo(f.width), d = b.getNextPowerOfTwo(f.height), (f.width !== c || f.height !== d) && (h = !0)) : g && (c = f.width, d = f.height, h = !0), h) {
        var i;
        this.tilingTexture && this.tilingTexture.isTiling ? (i = this.tilingTexture.canvasBuffer, i.resize(c, d), this.tilingTexture.baseTexture.width = c, this.tilingTexture.baseTexture.height = d, this.tilingTexture.needsUpdate = !0) : (i = new b.CanvasBuffer(c, d), this.tilingTexture = b.Texture.fromCanvas(i.canvas), this.tilingTexture.canvasBuffer = i, this.tilingTexture.isTiling = !0), i.context.drawImage(e.baseTexture.source, e.crop.x, e.crop.y, e.crop.width, e.crop.height, 0, 0, c, d), this.tileScaleOffset.x = f.width / c, this.tileScaleOffset.y = f.height / d
      } else this.tilingTexture && this.tilingTexture.isTiling && this.tilingTexture.destroy(!0), this.tileScaleOffset.x = 1, this.tileScaleOffset.y = 1, this.tilingTexture = e;
      this.refreshTexture = !1, this.tilingTexture.baseTexture._powerOf2 = !0
    }
  };
  var f = {};
  f.BoneData = function(a, b) {
    this.name = a, this.parent = b
  }, f.BoneData.prototype = {
    length: 0,
    x: 0,
    y: 0,
    rotation: 0,
    scaleX: 1,
    scaleY: 1
  }, f.SlotData = function(a, b) {
    this.name = a, this.boneData = b
  }, f.SlotData.prototype = {
    r: 1,
    g: 1,
    b: 1,
    a: 1,
    attachmentName: null
  }, f.Bone = function(a, b) {
    this.data = a, this.parent = b, this.setToSetupPose()
  }, f.Bone.yDown = !1, f.Bone.prototype = {
    x: 0,
    y: 0,
    rotation: 0,
    scaleX: 1,
    scaleY: 1,
    m00: 0,
    m01: 0,
    worldX: 0,
    m10: 0,
    m11: 0,
    worldY: 0,
    worldRotation: 0,
    worldScaleX: 1,
    worldScaleY: 1,
    updateWorldTransform: function(a, b) {
      var c = this.parent;
      null != c ? (this.worldX = this.x * c.m00 + this.y * c.m01 + c.worldX, this.worldY = this.x * c.m10 + this.y * c.m11 + c.worldY, this.worldScaleX = c.worldScaleX * this.scaleX, this.worldScaleY = c.worldScaleY * this.scaleY, this.worldRotation = c.worldRotation + this.rotation) : (this.worldX = this.x, this.worldY = this.y, this.worldScaleX = this.scaleX, this.worldScaleY = this.scaleY, this.worldRotation = this.rotation);
      var d = this.worldRotation * Math.PI / 180,
        e = Math.cos(d),
        g = Math.sin(d);
      this.m00 = e * this.worldScaleX, this.m10 = g * this.worldScaleX, this.m01 = -g * this.worldScaleY, this.m11 = e * this.worldScaleY, a && (this.m00 = -this.m00, this.m01 = -this.m01), b && (this.m10 = -this.m10, this.m11 = -this.m11), f.Bone.yDown && (this.m10 = -this.m10, this.m11 = -this.m11)
    },
    setToSetupPose: function() {
      var a = this.data;
      this.x = a.x, this.y = a.y, this.rotation = a.rotation, this.scaleX = a.scaleX, this.scaleY = a.scaleY
    }
  }, f.Slot = function(a, b, c) {
    this.data = a, this.skeleton = b, this.bone = c, this.setToSetupPose()
  }, f.Slot.prototype = {
    r: 1,
    g: 1,
    b: 1,
    a: 1,
    _attachmentTime: 0,
    attachment: null,
    setAttachment: function(a) {
      this.attachment = a, this._attachmentTime = this.skeleton.time
    },
    setAttachmentTime: function(a) {
      this._attachmentTime = this.skeleton.time - a
    },
    getAttachmentTime: function() {
      return this.skeleton.time - this._attachmentTime
    },
    setToSetupPose: function() {
      var a = this.data;
      this.r = a.r, this.g = a.g, this.b = a.b, this.a = a.a;
      for (var b = this.skeleton.data.slots, c = 0, d = b.length; d > c; c++)
        if (b[c] == a) {
          this.setAttachment(a.attachmentName ? this.skeleton.getAttachmentBySlotIndex(c, a.attachmentName) : null);
          break
        }
    }
  }, f.Skin = function(a) {
    this.name = a, this.attachments = {}
  }, f.Skin.prototype = {
    addAttachment: function(a, b, c) {
      this.attachments[a + ":" + b] = c
    },
    getAttachment: function(a, b) {
      return this.attachments[a + ":" + b]
    },
    _attachAll: function(a, b) {
      for (var c in b.attachments) {
        var d = c.indexOf(":"),
          e = parseInt(c.substring(0, d), 10),
          f = c.substring(d + 1),
          g = a.slots[e];
        if (g.attachment && g.attachment.name == f) {
          var h = this.getAttachment(e, f);
          h && g.setAttachment(h)
        }
      }
    }
  }, f.Animation = function(a, b, c) {
    this.name = a, this.timelines = b, this.duration = c
  }, f.Animation.prototype = {
    apply: function(a, b, c) {
      c && this.duration && (b %= this.duration);
      for (var d = this.timelines, e = 0, f = d.length; f > e; e++) d[e].apply(a, b, 1)
    },
    mix: function(a, b, c, d) {
      c && this.duration && (b %= this.duration);
      for (var e = this.timelines, f = 0, g = e.length; g > f; f++) e[f].apply(a, b, d)
    }
  }, f.binarySearch = function(a, b, c) {
    var d = 0,
      e = Math.floor(a.length / c) - 2;
    if (!e) return c;
    for (var f = e >>> 1;;) {
      if (a[(f + 1) * c] <= b ? d = f + 1 : e = f, d == e) return (d + 1) * c;
      f = d + e >>> 1
    }
  }, f.linearSearch = function(a, b, c) {
    for (var d = 0, e = a.length - c; e >= d; d += c)
      if (a[d] > b) return d;
    return -1
  }, f.Curves = function(a) {
    this.curves = [], this.curves.length = 6 * (a - 1)
  }, f.Curves.prototype = {
    setLinear: function(a) {
      this.curves[6 * a] = 0
    },
    setStepped: function(a) {
      this.curves[6 * a] = -1
    },
    setCurve: function(a, b, c, d, e) {
      var f = .1,
        g = f * f,
        h = g * f,
        i = 3 * f,
        j = 3 * g,
        k = 6 * g,
        l = 6 * h,
        m = 2 * -b + d,
        n = 2 * -c + e,
        o = 3 * (b - d) + 1,
        p = 3 * (c - e) + 1,
        q = 6 * a,
        r = this.curves;
      r[q] = b * i + m * j + o * h, r[q + 1] = c * i + n * j + p * h, r[q + 2] = m * k + o * l, r[q + 3] = n * k + p * l, r[q + 4] = o * l, r[q + 5] = p * l
    },
    getCurvePercent: function(a, b) {
      b = 0 > b ? 0 : b > 1 ? 1 : b;
      var c = 6 * a,
        d = this.curves,
        e = d[c];
      if (!e) return b;
      if (-1 == e) return 0;
      for (var f = d[c + 1], g = d[c + 2], h = d[c + 3], i = d[c + 4], j = d[c + 5], k = e, l = f, m = 8;;) {
        if (k >= b) {
          var n = k - e,
            o = l - f;
          return o + (l - o) * (b - n) / (k - n)
        }
        if (!m) break;
        m--, e += g, f += h, g += i, h += j, k += e, l += f
      }
      return l + (1 - l) * (b - k) / (1 - k)
    }
  }, f.RotateTimeline = function(a) {
    this.curves = new f.Curves(a), this.frames = [], this.frames.length = 2 * a
  }, f.RotateTimeline.prototype = {
    boneIndex: 0,
    getFrameCount: function() {
      return this.frames.length / 2
    },
    setFrame: function(a, b, c) {
      a *= 2, this.frames[a] = b, this.frames[a + 1] = c
    },
    apply: function(a, b, c) {
      var d, e = this.frames;
      if (!(b < e[0])) {
        var g = a.bones[this.boneIndex];
        if (b >= e[e.length - 2]) {
          for (d = g.data.rotation + e[e.length - 1] - g.rotation; d > 180;) d -= 360;
          for (; - 180 > d;) d += 360;
          return g.rotation += d * c, void 0
        }
        var h = f.binarySearch(e, b, 2),
          i = e[h - 1],
          j = e[h],
          k = 1 - (b - j) / (e[h - 2] - j);
        for (k = this.curves.getCurvePercent(h / 2 - 1, k), d = e[h + 1] - i; d > 180;) d -= 360;
        for (; - 180 > d;) d += 360;
        for (d = g.data.rotation + (i + d * k) - g.rotation; d > 180;) d -= 360;
        for (; - 180 > d;) d += 360;
        g.rotation += d * c
      }
    }
  }, f.TranslateTimeline = function(a) {
    this.curves = new f.Curves(a), this.frames = [], this.frames.length = 3 * a
  }, f.TranslateTimeline.prototype = {
    boneIndex: 0,
    getFrameCount: function() {
      return this.frames.length / 3
    },
    setFrame: function(a, b, c, d) {
      a *= 3, this.frames[a] = b, this.frames[a + 1] = c, this.frames[a + 2] = d
    },
    apply: function(a, b, c) {
      var d = this.frames;
      if (!(b < d[0])) {
        var e = a.bones[this.boneIndex];
        if (b >= d[d.length - 3]) return e.x += (e.data.x + d[d.length - 2] - e.x) * c, e.y += (e.data.y + d[d.length - 1] - e.y) * c, void 0;
        var g = f.binarySearch(d, b, 3),
          h = d[g - 2],
          i = d[g - 1],
          j = d[g],
          k = 1 - (b - j) / (d[g + -3] - j);
        k = this.curves.getCurvePercent(g / 3 - 1, k), e.x += (e.data.x + h + (d[g + 1] - h) * k - e.x) * c, e.y += (e.data.y + i + (d[g + 2] - i) * k - e.y) * c
      }
    }
  }, f.ScaleTimeline = function(a) {
    this.curves = new f.Curves(a), this.frames = [], this.frames.length = 3 * a
  }, f.ScaleTimeline.prototype = {
    boneIndex: 0,
    getFrameCount: function() {
      return this.frames.length / 3
    },
    setFrame: function(a, b, c, d) {
      a *= 3, this.frames[a] = b, this.frames[a + 1] = c, this.frames[a + 2] = d
    },
    apply: function(a, b, c) {
      var d = this.frames;
      if (!(b < d[0])) {
        var e = a.bones[this.boneIndex];
        if (b >= d[d.length - 3]) return e.scaleX += (e.data.scaleX - 1 + d[d.length - 2] - e.scaleX) * c, e.scaleY += (e.data.scaleY - 1 + d[d.length - 1] - e.scaleY) * c, void 0;
        var g = f.binarySearch(d, b, 3),
          h = d[g - 2],
          i = d[g - 1],
          j = d[g],
          k = 1 - (b - j) / (d[g + -3] - j);
        k = this.curves.getCurvePercent(g / 3 - 1, k), e.scaleX += (e.data.scaleX - 1 + h + (d[g + 1] - h) * k - e.scaleX) * c, e.scaleY += (e.data.scaleY - 1 + i + (d[g + 2] - i) * k - e.scaleY) * c
      }
    }
  }, f.ColorTimeline = function(a) {
    this.curves = new f.Curves(a), this.frames = [], this.frames.length = 5 * a
  }, f.ColorTimeline.prototype = {
    slotIndex: 0,
    getFrameCount: function() {
      return this.frames.length / 5
    },
    setFrame: function(a, b, c, d, e, f) {
      a *= 5, this.frames[a] = b, this.frames[a + 1] = c, this.frames[a + 2] = d, this.frames[a + 3] = e, this.frames[a + 4] = f
    },
    apply: function(a, b, c) {
      var d = this.frames;
      if (!(b < d[0])) {
        var e = a.slots[this.slotIndex];
        if (b >= d[d.length - 5]) {
          var g = d.length - 1;
          return e.r = d[g - 3], e.g = d[g - 2], e.b = d[g - 1], e.a = d[g], void 0
        }
        var h = f.binarySearch(d, b, 5),
          i = d[h - 4],
          j = d[h - 3],
          k = d[h - 2],
          l = d[h - 1],
          m = d[h],
          n = 1 - (b - m) / (d[h - 5] - m);
        n = this.curves.getCurvePercent(h / 5 - 1, n);
        var o = i + (d[h + 1] - i) * n,
          p = j + (d[h + 2] - j) * n,
          q = k + (d[h + 3] - k) * n,
          r = l + (d[h + 4] - l) * n;
        1 > c ? (e.r += (o - e.r) * c, e.g += (p - e.g) * c, e.b += (q - e.b) * c, e.a += (r - e.a) * c) : (e.r = o, e.g = p, e.b = q, e.a = r)
      }
    }
  }, f.AttachmentTimeline = function(a) {
    this.curves = new f.Curves(a), this.frames = [], this.frames.length = a, this.attachmentNames = [], this.attachmentNames.length = a
  }, f.AttachmentTimeline.prototype = {
    slotIndex: 0,
    getFrameCount: function() {
      return this.frames.length
    },
    setFrame: function(a, b, c) {
      this.frames[a] = b, this.attachmentNames[a] = c
    },
    apply: function(a, b) {
      var c = this.frames;
      if (!(b < c[0])) {
        var d;
        d = b >= c[c.length - 1] ? c.length - 1 : f.binarySearch(c, b, 1) - 1;
        var e = this.attachmentNames[d];
        a.slots[this.slotIndex].setAttachment(e ? a.getAttachmentBySlotIndex(this.slotIndex, e) : null)
      }
    }
  }, f.SkeletonData = function() {
    this.bones = [], this.slots = [], this.skins = [], this.animations = []
  }, f.SkeletonData.prototype = {
    defaultSkin: null,
    findBone: function(a) {
      for (var b = this.bones, c = 0, d = b.length; d > c; c++)
        if (b[c].name == a) return b[c];
      return null
    },
    findBoneIndex: function(a) {
      for (var b = this.bones, c = 0, d = b.length; d > c; c++)
        if (b[c].name == a) return c;
      return -1
    },
    findSlot: function(a) {
      for (var b = this.slots, c = 0, d = b.length; d > c; c++)
        if (b[c].name == a) return slot[c];
      return null
    },
    findSlotIndex: function(a) {
      for (var b = this.slots, c = 0, d = b.length; d > c; c++)
        if (b[c].name == a) return c;
      return -1
    },
    findSkin: function(a) {
      for (var b = this.skins, c = 0, d = b.length; d > c; c++)
        if (b[c].name == a) return b[c];
      return null
    },
    findAnimation: function(a) {
      for (var b = this.animations, c = 0, d = b.length; d > c; c++)
        if (b[c].name == a) return b[c];
      return null
    }
  }, f.Skeleton = function(a) {
    this.data = a, this.bones = [];
    for (var b = 0, c = a.bones.length; c > b; b++) {
      var d = a.bones[b],
        e = d.parent ? this.bones[a.bones.indexOf(d.parent)] : null;
      this.bones.push(new f.Bone(d, e))
    }
    for (this.slots = [], this.drawOrder = [], b = 0, c = a.slots.length; c > b; b++) {
      var g = a.slots[b],
        h = this.bones[a.bones.indexOf(g.boneData)],
        i = new f.Slot(g, this, h);
      this.slots.push(i), this.drawOrder.push(i)
    }
  }, f.Skeleton.prototype = {
    x: 0,
    y: 0,
    skin: null,
    r: 1,
    g: 1,
    b: 1,
    a: 1,
    time: 0,
    flipX: !1,
    flipY: !1,
    updateWorldTransform: function() {
      for (var a = this.flipX, b = this.flipY, c = this.bones, d = 0, e = c.length; e > d; d++) c[d].updateWorldTransform(a, b)
    },
    setToSetupPose: function() {
      this.setBonesToSetupPose(), this.setSlotsToSetupPose()
    },
    setBonesToSetupPose: function() {
      for (var a = this.bones, b = 0, c = a.length; c > b; b++) a[b].setToSetupPose()
    },
    setSlotsToSetupPose: function() {
      for (var a = this.slots, b = 0, c = a.length; c > b; b++) a[b].setToSetupPose(b)
    },
    getRootBone: function() {
      return this.bones.length ? this.bones[0] : null
    },
    findBone: function(a) {
      for (var b = this.bones, c = 0, d = b.length; d > c; c++)
        if (b[c].data.name == a) return b[c];
      return null
    },
    findBoneIndex: function(a) {
      for (var b = this.bones, c = 0, d = b.length; d > c; c++)
        if (b[c].data.name == a) return c;
      return -1
    },
    findSlot: function(a) {
      for (var b = this.slots, c = 0, d = b.length; d > c; c++)
        if (b[c].data.name == a) return b[c];
      return null
    },
    findSlotIndex: function(a) {
      for (var b = this.slots, c = 0, d = b.length; d > c; c++)
        if (b[c].data.name == a) return c;
      return -1
    },
    setSkinByName: function(a) {
      var b = this.data.findSkin(a);
      if (!b) throw "Skin not found: " + a;
      this.setSkin(b)
    },
    setSkin: function(a) {
      this.skin && a && a._attachAll(this, this.skin), this.skin = a
    },
    getAttachmentBySlotName: function(a, b) {
      return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a), b)
    },
    getAttachmentBySlotIndex: function(a, b) {
      if (this.skin) {
        var c = this.skin.getAttachment(a, b);
        if (c) return c
      }
      return this.data.defaultSkin ? this.data.defaultSkin.getAttachment(a, b) : null
    },
    setAttachment: function(a, b) {
      for (var c = this.slots, d = 0, e = c.size; e > d; d++) {
        var f = c[d];
        if (f.data.name == a) {
          var g = null;
          if (b && (g = this.getAttachment(d, b), null == g)) throw "Attachment not found: " + b + ", for slot: " + a;
          return f.setAttachment(g), void 0
        }
      }
      throw "Slot not found: " + a
    },
    update: function(a) {
      time += a
    }
  }, f.AttachmentType = {
    region: 0
  }, f.RegionAttachment = function() {
    this.offset = [], this.offset.length = 8, this.uvs = [], this.uvs.length = 8
  }, f.RegionAttachment.prototype = {
    x: 0,
    y: 0,
    rotation: 0,
    scaleX: 1,
    scaleY: 1,
    width: 0,
    height: 0,
    rendererObject: null,
    regionOffsetX: 0,
    regionOffsetY: 0,
    regionWidth: 0,
    regionHeight: 0,
    regionOriginalWidth: 0,
    regionOriginalHeight: 0,
    setUVs: function(a, b, c, d, e) {
      var f = this.uvs;
      e ? (f[2] = a, f[3] = d, f[4] = a, f[5] = b, f[6] = c, f[7] = b, f[0] = c, f[1] = d) : (f[0] = a, f[1] = d, f[2] = a, f[3] = b, f[4] = c, f[5] = b, f[6] = c, f[7] = d)
    },
    updateOffset: function() {
      var a = this.width / this.regionOriginalWidth * this.scaleX,
        b = this.height / this.regionOriginalHeight * this.scaleY,
        c = -this.width / 2 * this.scaleX + this.regionOffsetX * a,
        d = -this.height / 2 * this.scaleY + this.regionOffsetY * b,
        e = c + this.regionWidth * a,
        f = d + this.regionHeight * b,
        g = this.rotation * Math.PI / 180,
        h = Math.cos(g),
        i = Math.sin(g),
        j = c * h + this.x,
        k = c * i,
        l = d * h + this.y,
        m = d * i,
        n = e * h + this.x,
        o = e * i,
        p = f * h + this.y,
        q = f * i,
        r = this.offset;
      r[0] = j - m, r[1] = l + k, r[2] = j - q, r[3] = p + k, r[4] = n - q, r[5] = p + o, r[6] = n - m, r[7] = l + o
    },
    computeVertices: function(a, b, c, d) {
      a += c.worldX, b += c.worldY;
      var e = c.m00,
        f = c.m01,
        g = c.m10,
        h = c.m11,
        i = this.offset;
      d[0] = i[0] * e + i[1] * f + a, d[1] = i[0] * g + i[1] * h + b, d[2] = i[2] * e + i[3] * f + a, d[3] = i[2] * g + i[3] * h + b, d[4] = i[4] * e + i[5] * f + a, d[5] = i[4] * g + i[5] * h + b, d[6] = i[6] * e + i[7] * f + a, d[7] = i[6] * g + i[7] * h + b
    }
  }, f.AnimationStateData = function(a) {
    this.skeletonData = a, this.animationToMixTime = {}
  }, f.AnimationStateData.prototype = {
    defaultMix: 0,
    setMixByName: function(a, b, c) {
      var d = this.skeletonData.findAnimation(a);
      if (!d) throw "Animation not found: " + a;
      var e = this.skeletonData.findAnimation(b);
      if (!e) throw "Animation not found: " + b;
      this.setMix(d, e, c)
    },
    setMix: function(a, b, c) {
      this.animationToMixTime[a.name + ":" + b.name] = c
    },
    getMix: function(a, b) {
      var c = this.animationToMixTime[a.name + ":" + b.name];
      return c ? c : this.defaultMix
    }
  }, f.AnimationState = function(a) {
    this.data = a, this.queue = []
  }, f.AnimationState.prototype = {
    animationSpeed: 1,
    current: null,
    previous: null,
    currentTime: 0,
    previousTime: 0,
    currentLoop: !1,
    previousLoop: !1,
    mixTime: 0,
    mixDuration: 0,
    update: function(a) {
      if (this.currentTime += a * this.animationSpeed, this.previousTime += a, this.mixTime += a, this.queue.length > 0) {
        var b = this.queue[0];
        this.currentTime >= b.delay && (this._setAnimation(b.animation, b.loop), this.queue.shift())
      }
    },
    apply: function(a) {
      if (this.current)
        if (this.previous) {
          this.previous.apply(a, this.previousTime, this.previousLoop);
          var b = this.mixTime / this.mixDuration;
          b >= 1 && (b = 1, this.previous = null), this.current.mix(a, this.currentTime, this.currentLoop, b)
        } else this.current.apply(a, this.currentTime, this.currentLoop)
    },
    clearAnimation: function() {
      this.previous = null, this.current = null, this.queue.length = 0
    },
    _setAnimation: function(a, b) {
      this.previous = null, a && this.current && (this.mixDuration = this.data.getMix(this.current, a), this.mixDuration > 0 && (this.mixTime = 0, this.previous = this.current, this.previousTime = this.currentTime, this.previousLoop = this.currentLoop)), this.current = a, this.currentLoop = b, this.currentTime = 0
    },
    setAnimationByName: function(a, b) {
      var c = this.data.skeletonData.findAnimation(a);
      if (!c) throw "Animation not found: " + a;
      this.setAnimation(c, b)
    },
    setAnimation: function(a, b) {
      this.queue.length = 0, this._setAnimation(a, b)
    },
    addAnimationByName: function(a, b, c) {
      var d = this.data.skeletonData.findAnimation(a);
      if (!d) throw "Animation not found: " + a;
      this.addAnimation(d, b, c)
    },
    addAnimation: function(a, b, c) {
      var d = {};
      if (d.animation = a, d.loop = b, !c || 0 >= c) {
        var e = this.queue.length ? this.queue[this.queue.length - 1].animation : this.current;
        c = null != e ? e.duration - this.data.getMix(e, a) + (c || 0) : 0
      }
      d.delay = c, this.queue.push(d)
    },
    isComplete: function() {
      return !this.current || this.currentTime >= this.current.duration
    }
  }, f.SkeletonJson = function(a) {
    this.attachmentLoader = a
  }, f.SkeletonJson.prototype = {
    scale: 1,
    readSkeletonData: function(a) {
      for (var b, c = new f.SkeletonData, d = a.bones, e = 0, g = d.length; g > e; e++) {
        var h = d[e],
          i = null;
        if (h.parent && (i = c.findBone(h.parent), !i)) throw "Parent bone not found: " + h.parent;
        b = new f.BoneData(h.name, i), b.length = (h.length || 0) * this.scale, b.x = (h.x || 0) * this.scale, b.y = (h.y || 0) * this.scale, b.rotation = h.rotation || 0, b.scaleX = h.scaleX || 1, b.scaleY = h.scaleY || 1, c.bones.push(b)
      }
      var j = a.slots;
      for (e = 0, g = j.length; g > e; e++) {
        var k = j[e];
        if (b = c.findBone(k.bone), !b) throw "Slot bone not found: " + k.bone;
        var l = new f.SlotData(k.name, b),
          m = k.color;
        m && (l.r = f.SkeletonJson.toColor(m, 0), l.g = f.SkeletonJson.toColor(m, 1), l.b = f.SkeletonJson.toColor(m, 2), l.a = f.SkeletonJson.toColor(m, 3)), l.attachmentName = k.attachment, c.slots.push(l)
      }
      var n = a.skins;
      for (var o in n)
        if (n.hasOwnProperty(o)) {
          var p = n[o],
            q = new f.Skin(o);
          for (var r in p)
            if (p.hasOwnProperty(r)) {
              var s = c.findSlotIndex(r),
                t = p[r];
              for (var u in t)
                if (t.hasOwnProperty(u)) {
                  var v = this.readAttachment(q, u, t[u]);
                  null != v && q.addAttachment(s, u, v)
                }
            }
          c.skins.push(q), "default" == q.name && (c.defaultSkin = q)
        }
      var w = a.animations;
      for (var x in w) w.hasOwnProperty(x) && this.readAnimation(x, w[x], c);
      return c
    },
    readAttachment: function(a, b, c) {
      b = c.name || b;
      var d = f.AttachmentType[c.type || "region"];
      if (d == f.AttachmentType.region) {
        var e = new f.RegionAttachment;
        return e.x = (c.x || 0) * this.scale, e.y = (c.y || 0) * this.scale, e.scaleX = c.scaleX || 1, e.scaleY = c.scaleY || 1, e.rotation = c.rotation || 0, e.width = (c.width || 32) * this.scale, e.height = (c.height || 32) * this.scale, e.updateOffset(), e.rendererObject = {}, e.rendererObject.name = b, e.rendererObject.scale = {}, e.rendererObject.scale.x = e.scaleX, e.rendererObject.scale.y = e.scaleY, e.rendererObject.rotation = -e.rotation * Math.PI / 180, e
      }
      throw "Unknown attachment type: " + d
    },
    readAnimation: function(a, b, c) {
      var d, e, g, h, i, j, k, l = [],
        m = 0,
        n = b.bones;
      for (var o in n)
        if (n.hasOwnProperty(o)) {
          var p = c.findBoneIndex(o);
          if (-1 == p) throw "Bone not found: " + o;
          var q = n[o];
          for (g in q)
            if (q.hasOwnProperty(g))
              if (i = q[g], "rotate" == g) {
                for (e = new f.RotateTimeline(i.length), e.boneIndex = p, d = 0, j = 0, k = i.length; k > j; j++) h = i[j], e.setFrame(d, h.time, h.angle), f.SkeletonJson.readCurve(e, d, h), d++;
                l.push(e), m = Math.max(m, e.frames[2 * e.getFrameCount() - 2])
              } else {
                if ("translate" != g && "scale" != g) throw "Invalid timeline type for a bone: " + g + " (" + o + ")";
                var r = 1;
                for ("scale" == g ? e = new f.ScaleTimeline(i.length) : (e = new f.TranslateTimeline(i.length), r = this.scale), e.boneIndex = p, d = 0, j = 0, k = i.length; k > j; j++) {
                  h = i[j];
                  var s = (h.x || 0) * r,
                    t = (h.y || 0) * r;
                  e.setFrame(d, h.time, s, t), f.SkeletonJson.readCurve(e, d, h), d++
                }
                l.push(e), m = Math.max(m, e.frames[3 * e.getFrameCount() - 3])
              }
        }
      var u = b.slots;
      for (var v in u)
        if (u.hasOwnProperty(v)) {
          var w = u[v],
            x = c.findSlotIndex(v);
          for (g in w)
            if (w.hasOwnProperty(g))
              if (i = w[g], "color" == g) {
                for (e = new f.ColorTimeline(i.length), e.slotIndex = x, d = 0, j = 0, k = i.length; k > j; j++) {
                  h = i[j];
                  var y = h.color,
                    z = f.SkeletonJson.toColor(y, 0),
                    A = f.SkeletonJson.toColor(y, 1),
                    B = f.SkeletonJson.toColor(y, 2),
                    C = f.SkeletonJson.toColor(y, 3);
                  e.setFrame(d, h.time, z, A, B, C), f.SkeletonJson.readCurve(e, d, h), d++
                }
                l.push(e), m = Math.max(m, e.frames[5 * e.getFrameCount() - 5])
              } else {
                if ("attachment" != g) throw "Invalid timeline type for a slot: " + g + " (" + v + ")";
                for (e = new f.AttachmentTimeline(i.length), e.slotIndex = x, d = 0, j = 0, k = i.length; k > j; j++) h = i[j], e.setFrame(d++, h.time, h.name);
                l.push(e), m = Math.max(m, e.frames[e.getFrameCount() - 1])
              }
        }
      c.animations.push(new f.Animation(a, l, m))
    }
  }, f.SkeletonJson.readCurve = function(a, b, c) {
    var d = c.curve;
    d && ("stepped" == d ? a.curves.setStepped(b) : d instanceof Array && a.curves.setCurve(b, d[0], d[1], d[2], d[3]))
  }, f.SkeletonJson.toColor = function(a, b) {
    if (8 != a.length) throw "Color hexidecimal length must be 8, recieved: " + a;
    return parseInt(a.substr(2 * b, 2), 16) / 255
  }, f.Atlas = function(a, b) {
    this.textureLoader = b, this.pages = [], this.regions = [];
    var c = new f.AtlasReader(a),
      d = [];
    d.length = 4;
    for (var e = null;;) {
      var g = c.readLine();
      if (null == g) break;
      if (g = c.trim(g), g.length)
        if (e) {
          var h = new f.AtlasRegion;
          h.name = g, h.page = e, h.rotate = "true" == c.readValue(), c.readTuple(d);
          var i = parseInt(d[0], 10),
            j = parseInt(d[1], 10);
          c.readTuple(d);
          var k = parseInt(d[0], 10),
            l = parseInt(d[1], 10);
          h.u = i / e.width, h.v = j / e.height, h.rotate ? (h.u2 = (i + l) / e.width, h.v2 = (j + k) / e.height) : (h.u2 = (i + k) / e.width, h.v2 = (j + l) / e.height), h.x = i, h.y = j, h.width = Math.abs(k), h.height = Math.abs(l), 4 == c.readTuple(d) && (h.splits = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10), parseInt(d[3], 10)], 4 == c.readTuple(d) && (h.pads = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10), parseInt(d[3], 10)], c.readTuple(d))), h.originalWidth = parseInt(d[0], 10), h.originalHeight = parseInt(d[1], 10), c.readTuple(d), h.offsetX = parseInt(d[0], 10), h.offsetY = parseInt(d[1], 10), h.index = parseInt(c.readValue(), 10), this.regions.push(h)
        } else {
          e = new f.AtlasPage, e.name = g, e.format = f.Atlas.Format[c.readValue()], c.readTuple(d), e.minFilter = f.Atlas.TextureFilter[d[0]], e.magFilter = f.Atlas.TextureFilter[d[1]];
          var m = c.readValue();
          e.uWrap = f.Atlas.TextureWrap.clampToEdge, e.vWrap = f.Atlas.TextureWrap.clampToEdge, "x" == m ? e.uWrap = f.Atlas.TextureWrap.repeat : "y" == m ? e.vWrap = f.Atlas.TextureWrap.repeat : "xy" == m && (e.uWrap = e.vWrap = f.Atlas.TextureWrap.repeat), b.load(e, g), this.pages.push(e)
        } else e = null
    }
  }, f.Atlas.prototype = {
    findRegion: function(a) {
      for (var b = this.regions, c = 0, d = b.length; d > c; c++)
        if (b[c].name == a) return b[c];
      return null
    },
    dispose: function() {
      for (var a = this.pages, b = 0, c = a.length; c > b; b++) this.textureLoader.unload(a[b].rendererObject)
    },
    updateUVs: function(a) {
      for (var b = this.regions, c = 0, d = b.length; d > c; c++) {
        var e = b[c];
        e.page == a && (e.u = e.x / a.width, e.v = e.y / a.height, e.rotate ? (e.u2 = (e.x + e.height) / a.width, e.v2 = (e.y + e.width) / a.height) : (e.u2 = (e.x + e.width) / a.width, e.v2 = (e.y + e.height) / a.height))
      }
    }
  }, f.Atlas.Format = {
    alpha: 0,
    intensity: 1,
    luminanceAlpha: 2,
    rgb565: 3,
    rgba4444: 4,
    rgb888: 5,
    rgba8888: 6
  }, f.Atlas.TextureFilter = {
    nearest: 0,
    linear: 1,
    mipMap: 2,
    mipMapNearestNearest: 3,
    mipMapLinearNearest: 4,
    mipMapNearestLinear: 5,
    mipMapLinearLinear: 6
  }, f.Atlas.TextureWrap = {
    mirroredRepeat: 0,
    clampToEdge: 1,
    repeat: 2
  }, f.AtlasPage = function() {}, f.AtlasPage.prototype = {
    name: null,
    format: null,
    minFilter: null,
    magFilter: null,
    uWrap: null,
    vWrap: null,
    rendererObject: null,
    width: 0,
    height: 0
  }, f.AtlasRegion = function() {}, f.AtlasRegion.prototype = {
    page: null,
    name: null,
    x: 0,
    y: 0,
    width: 0,
    height: 0,
    u: 0,
    v: 0,
    u2: 0,
    v2: 0,
    offsetX: 0,
    offsetY: 0,
    originalWidth: 0,
    originalHeight: 0,
    index: 0,
    rotate: !1,
    splits: null,
    pads: null
  }, f.AtlasReader = function(a) {
    this.lines = a.split(/\r\n|\r|\n/)
  }, f.AtlasReader.prototype = {
    index: 0,
    trim: function(a) {
      return a.replace(/^\s+|\s+$/g, "")
    },
    readLine: function() {
      return this.index >= this.lines.length ? null : this.lines[this.index++]
    },
    readValue: function() {
      var a = this.readLine(),
        b = a.indexOf(":");
      if (-1 == b) throw "Invalid line: " + a;
      return this.trim(a.substring(b + 1))
    },
    readTuple: function(a) {
      var b = this.readLine(),
        c = b.indexOf(":");
      if (-1 == c) throw "Invalid line: " + b;
      for (var d = 0, e = c + 1; 3 > d; d++) {
        var f = b.indexOf(",", e);
        if (-1 == f) {
          if (!d) throw "Invalid line: " + b;
          break
        }
        a[d] = this.trim(b.substr(e, f - e)), e = f + 1
      }
      return a[d] = this.trim(b.substring(e)), d + 1
    }
  }, f.AtlasAttachmentLoader = function(a) {
    this.atlas = a
  }, f.AtlasAttachmentLoader.prototype = {
    newAttachment: function(a, b, c) {
      switch (b) {
        case f.AttachmentType.region:
          var d = this.atlas.findRegion(c);
          if (!d) throw "Region not found in atlas: " + c + " (" + b + ")";
          var e = new f.RegionAttachment(c);
          return e.rendererObject = d, e.setUVs(d.u, d.v, d.u2, d.v2, d.rotate), e.regionOffsetX = d.offsetX, e.regionOffsetY = d.offsetY, e.regionWidth = d.width, e.regionHeight = d.height, e.regionOriginalWidth = d.originalWidth, e.regionOriginalHeight = d.originalHeight, e
      }
      throw "Unknown attachment type: " + b
    }
  }, f.Bone.yDown = !0, b.AnimCache = {}, b.Spine = function(a) {
    if (b.DisplayObjectContainer.call(this), this.spineData = b.AnimCache[a], !this.spineData) throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: " + a);
    this.skeleton = new f.Skeleton(this.spineData), this.skeleton.updateWorldTransform(), this.stateData = new f.AnimationStateData(this.spineData), this.state = new f.AnimationState(this.stateData), this.slotContainers = [];
    for (var c = 0, d = this.skeleton.drawOrder.length; d > c; c++) {
      var e = this.skeleton.drawOrder[c],
        g = e.attachment,
        h = new b.DisplayObjectContainer;
      if (this.slotContainers.push(h), this.addChild(h), g instanceof f.RegionAttachment) {
        var i = g.rendererObject.name,
          j = this.createSprite(e, g.rendererObject);
        e.currentSprite = j, e.currentSpriteName = i, h.addChild(j)
      }
    }
  }, b.Spine.prototype = Object.create(b.DisplayObjectContainer.prototype), b.Spine.prototype.constructor = b.Spine, b.Spine.prototype.updateTransform = function() {
    this.lastTime = this.lastTime || Date.now();
    var a = .001 * (Date.now() - this.lastTime);
    this.lastTime = Date.now(), this.state.update(a), this.state.apply(this.skeleton), this.skeleton.updateWorldTransform();
    for (var c = this.skeleton.drawOrder, d = 0, e = c.length; e > d; d++) {
      var g = c[d],
        h = g.attachment,
        i = this.slotContainers[d];
      if (h instanceof f.RegionAttachment) {
        if (h.rendererObject && (!g.currentSpriteName || g.currentSpriteName != h.name)) {
          var j = h.rendererObject.name;
          if (void 0 !== g.currentSprite && (g.currentSprite.visible = !1), g.sprites = g.sprites || {}, void 0 !== g.sprites[j]) g.sprites[j].visible = !0;
          else {
            var k = this.createSprite(g, h.rendererObject);
            i.addChild(k)
          }
          g.currentSprite = g.sprites[j], g.currentSpriteName = j
        }
        i.visible = !0;
        var l = g.bone;
        i.position.x = l.worldX + h.x * l.m00 + h.y * l.m01, i.position.y = l.worldY + h.x * l.m10 + h.y * l.m11, i.scale.x = l.worldScaleX, i.scale.y = l.worldScaleY, i.rotation = -(g.bone.worldRotation * Math.PI / 180), i.alpha = g.a, g.currentSprite.tint = b.rgb2hex([g.r, g.g, g.b])
      } else i.visible = !1
    }
    b.DisplayObjectContainer.prototype.updateTransform.call(this)
  }, b.Spine.prototype.createSprite = function(a, c) {
    var d = b.TextureCache[c.name] ? c.name : c.name + ".png",
      e = new b.Sprite(b.Texture.fromFrame(d));
    return e.scale = c.scale, e.rotation = c.rotation, e.anchor.x = e.anchor.y = .5, a.sprites = a.sprites || {}, a.sprites[c.name] = e, e
  }, b.BaseTextureCache = {}, b.texturesToUpdate = [], b.texturesToDestroy = [], b.BaseTextureCacheIdGenerator = 0, b.BaseTexture = function(a, c) {
    if (b.EventTarget.call(this), this.width = 100, this.height = 100, this.scaleMode = c || b.scaleModes.DEFAULT, this.hasLoaded = !1, this.source = a, this.id = b.BaseTextureCacheIdGenerator++, this.premultipliedAlpha = !0, this._glTextures = [], this._dirty = [], a) {
      if ((this.source.complete || this.source.getContext) && this.source.width && this.source.height) this.hasLoaded = !0, this.width = this.source.width, this.height = this.source.height, b.texturesToUpdate.push(this);
      else {
        var d = this;
        this.source.onload = function() {
          d.hasLoaded = !0, d.width = d.source.width, d.height = d.source.height;
          for (var a = 0; a < d._glTextures.length; a++) d._dirty[a] = !0;
          d.dispatchEvent({
            type: "loaded",
            content: d
          })
        }, this.source.onerror = function() {
          d.dispatchEvent({
            type: "error",
            content: d
          })
        }
      }
      this.imageUrl = null, this._powerOf2 = !1
    }
  }, b.BaseTexture.prototype.constructor = b.BaseTexture, b.BaseTexture.prototype.destroy = function() {
    this.imageUrl ? (delete b.BaseTextureCache[this.imageUrl], delete b.TextureCache[this.imageUrl], this.imageUrl = null, this.source.src = null) : this.source && this.source._pixiId && delete b.BaseTextureCache[this.source._pixiId], this.source = null, b.texturesToDestroy.push(this)
  }, b.BaseTexture.prototype.updateSourceImage = function(a) {
    this.hasLoaded = !1, this.source.src = null, this.source.src = a
  }, b.BaseTexture.fromImage = function(a, c, d) {
    var e = b.BaseTextureCache[a];
    if (void 0 === c && -1 === a.indexOf("data:") && (c = !0), !e) {
      var f = new Image;
      c && (f.crossOrigin = ""), f.src = a, e = new b.BaseTexture(f, d), e.imageUrl = a, b.BaseTextureCache[a] = e
    }
    return e
  }, b.BaseTexture.fromCanvas = function(a, c) {
    a._pixiId || (a._pixiId = "canvas_" + b.TextureCacheIdGenerator++);
    var d = b.BaseTextureCache[a._pixiId];
    return d || (d = new b.BaseTexture(a, c), b.BaseTextureCache[a._pixiId] = d), d
  }, b.TextureCache = {}, b.FrameCache = {}, b.TextureCacheIdGenerator = 0, b.Texture = function(a, c) {
    if (b.EventTarget.call(this), this.noFrame = !1, c || (this.noFrame = !0, c = new b.Rectangle(0, 0, 1, 1)), a instanceof b.Texture && (a = a.baseTexture), this.baseTexture = a, this.frame = c, this.trim = null, this.valid = !1, this.scope = this, this._uvs = null, this.width = 0, this.height = 0, this.crop = new b.Rectangle(0, 0, 1, 1), a.hasLoaded) this.noFrame && (c = new b.Rectangle(0, 0, a.width, a.height)), this.setFrame(c);
    else {
      var d = this;
      a.addEventListener("loaded", function() {
        d.onBaseTextureLoaded()
      })
    }
  }, b.Texture.prototype.constructor = b.Texture, b.Texture.prototype.onBaseTextureLoaded = function() {
    var a = this.baseTexture;
    a.removeEventListener("loaded", this.onLoaded), this.noFrame && (this.frame = new b.Rectangle(0, 0, a.width, a.height)), this.setFrame(this.frame), this.scope.dispatchEvent({
      type: "update",
      content: this
    })
  }, b.Texture.prototype.destroy = function(a) {
    a && this.baseTexture.destroy(), this.valid = !1
  }, b.Texture.prototype.setFrame = function(a) {
    if (this.noFrame = !1, this.frame = a, this.width = a.width, this.height = a.height, this.crop.x = a.x, this.crop.y = a.y, this.crop.width = a.width, this.crop.height = a.height, !this.trim && (a.x + a.width > this.baseTexture.width || a.y + a.height > this.baseTexture.height)) throw new Error("Texture Error: frame does not fit inside the base Texture dimensions " + this);
    this.valid = a && a.width && a.height && this.baseTexture.source && this.baseTexture.hasLoaded, this.trim && (this.width = this.trim.width, this.height = this.trim.height, this.frame.width = this.trim.width, this.frame.height = this.trim.height), this.valid && b.Texture.frameUpdates.push(this)
  }, b.Texture.prototype._updateWebGLuvs = function() {
    this._uvs || (this._uvs = new b.TextureUvs);
    var a = this.crop,
      c = this.baseTexture.width,
      d = this.baseTexture.height;
    this._uvs.x0 = a.x / c, this._uvs.y0 = a.y / d, this._uvs.x1 = (a.x + a.width) / c, this._uvs.y1 = a.y / d, this._uvs.x2 = (a.x + a.width) / c, this._uvs.y2 = (a.y + a.height) / d, this._uvs.x3 = a.x / c, this._uvs.y3 = (a.y + a.height) / d
  }, b.Texture.fromImage = function(a, c, d) {
    var e = b.TextureCache[a];
    return e || (e = new b.Texture(b.BaseTexture.fromImage(a, c, d)), b.TextureCache[a] = e), e
  }, b.Texture.fromFrame = function(a) {
    var c = b.TextureCache[a];
    if (!c) throw new Error('The frameId "' + a + '" does not exist in the texture cache ');
    return c
  }, b.Texture.fromCanvas = function(a, c) {
    var d = b.BaseTexture.fromCanvas(a, c);
    return new b.Texture(d)
  }, b.Texture.addTextureToCache = function(a, c) {
    b.TextureCache[c] = a
  }, b.Texture.removeTextureFromCache = function(a) {
    var c = b.TextureCache[a];
    return delete b.TextureCache[a], delete b.BaseTextureCache[a], c
  }, b.Texture.frameUpdates = [], b.TextureUvs = function() {
    this.x0 = 0, this.y0 = 0, this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.x3 = 0, this.y3 = 0
  }, b.RenderTexture = function(a, c, d, e) {
    if (b.EventTarget.call(this), this.width = a || 100, this.height = c || 100, this.frame = new b.Rectangle(0, 0, this.width, this.height), this.crop = new b.Rectangle(0, 0, this.width, this.height), this.baseTexture = new b.BaseTexture, this.baseTexture.width = this.width, this.baseTexture.height = this.height, this.baseTexture._glTextures = [], this.baseTexture.scaleMode = e || b.scaleModes.DEFAULT, this.baseTexture.hasLoaded = !0, this.renderer = d || b.defaultRenderer, this.renderer.type === b.WEBGL_RENDERER) {
      var f = this.renderer.gl;
      this.textureBuffer = new b.FilterTexture(f, this.width, this.height, this.baseTexture.scaleMode), this.baseTexture._glTextures[f.id] = this.textureBuffer.texture, this.render = this.renderWebGL, this.projection = new b.Point(this.width / 2, -this.height / 2)
    } else this.render = this.renderCanvas, this.textureBuffer = new b.CanvasBuffer(this.width, this.height), this.baseTexture.source = this.textureBuffer.canvas;
    this.valid = !0, b.Texture.frameUpdates.push(this)
  }, b.RenderTexture.prototype = Object.create(b.Texture.prototype), b.RenderTexture.prototype.constructor = b.RenderTexture, b.RenderTexture.prototype.resize = function(a, c, d) {
    (a !== this.width || c !== this.height) && (this.width = this.frame.width = this.crop.width = a, this.height = this.frame.height = this.crop.height = c, d && (this.baseTexture.width = this.width, this.baseTexture.height = this.height), this.renderer.type === b.WEBGL_RENDERER && (this.projection.x = this.width / 2, this.projection.y = -this.height / 2), this.textureBuffer.resize(this.width, this.height))
  }, b.RenderTexture.prototype.clear = function() {
    this.renderer.type === b.WEBGL_RENDERER && this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER, this.textureBuffer.frameBuffer), this.textureBuffer.clear()
  }, b.RenderTexture.prototype.renderWebGL = function(a, c, d) {
    var e = this.renderer.gl;
    e.colorMask(!0, !0, !0, !0), e.viewport(0, 0, this.width, this.height), e.bindFramebuffer(e.FRAMEBUFFER, this.textureBuffer.frameBuffer), d && this.textureBuffer.clear();
    var f = a.children,
      g = a.worldTransform;
    a.worldTransform = b.RenderTexture.tempMatrix, a.worldTransform.d = -1, a.worldTransform.ty = -2 * this.projection.y, c && (a.worldTransform.tx = c.x, a.worldTransform.ty -= c.y);
    for (var h = 0, i = f.length; i > h; h++) f[h].updateTransform();
    b.WebGLRenderer.updateTextures(), this.renderer.spriteBatch.dirty = !0, this.renderer.renderDisplayObject(a, this.projection, this.textureBuffer.frameBuffer), a.worldTransform = g, this.renderer.spriteBatch.dirty = !0
  }, b.RenderTexture.prototype.renderCanvas = function(a, c, d) {
    var e = a.children,
      f = a.worldTransform;
    a.worldTransform = b.RenderTexture.tempMatrix, c ? (a.worldTransform.tx = c.x, a.worldTransform.ty = c.y) : (a.worldTransform.tx = 0, a.worldTransform.ty = 0);
    for (var g = 0, h = e.length; h > g; g++) e[g].updateTransform();
    d && this.textureBuffer.clear();
    var i = this.textureBuffer.context;
    this.renderer.renderDisplayObject(a, i), i.setTransform(1, 0, 0, 1, 0, 0), a.worldTransform = f
  }, b.RenderTexture.tempMatrix = new b.Matrix, b.AssetLoader = function(a, c) {
    b.EventTarget.call(this), this.assetURLs = a, this.crossorigin = c, this.loadersByType = {
      jpg: b.ImageLoader,
      jpeg: b.ImageLoader,
      png: b.ImageLoader,
      gif: b.ImageLoader,
      webp: b.ImageLoader,
      json: b.JsonLoader,
      atlas: b.AtlasLoader,
      anim: b.SpineLoader,
      xml: b.BitmapFontLoader,
      fnt: b.BitmapFontLoader
    }
  }, b.AssetLoader.prototype.constructor = b.AssetLoader, b.AssetLoader.prototype._getDataType = function(a) {
    var b = "data:",
      c = a.slice(0, b.length).toLowerCase();
    if (c === b) {
      var d = a.slice(b.length),
        e = d.indexOf(",");
      if (-1 === e) return null;
      var f = d.slice(0, e).split(";")[0];
      return f && "text/plain" !== f.toLowerCase() ? f.split("/").pop().toLowerCase() : "txt"
    }
    return null
  }, b.AssetLoader.prototype.load = function() {
    function a(a) {
      b.onAssetLoaded(a.content)
    }
    var b = this;
    this.loadCount = this.assetURLs.length;
    for (var c = 0; c < this.assetURLs.length; c++) {
      var d = this.assetURLs[c],
        e = this._getDataType(d);
      e || (e = d.split("?").shift().split(".").pop().toLowerCase());
      var f = this.loadersByType[e];
      if (!f) throw new Error(e + " is an unsupported file type");
      var g = new f(d, this.crossorigin);
      g.addEventListener("loaded", a), g.load()
    }
  }, b.AssetLoader.prototype.onAssetLoaded = function(a) {
    this.loadCount--, this.dispatchEvent({
      type: "onProgress",
      content: this,
      loader: a
    }), this.onProgress && this.onProgress(a), this.loadCount || (this.dispatchEvent({
      type: "onComplete",
      content: this
    }), this.onComplete && this.onComplete())
  }, b.JsonLoader = function(a, c) {
    b.EventTarget.call(this), this.url = a, this.crossorigin = c, this.baseUrl = a.replace(/[^\/]*$/, ""), this.loaded = !1
  }, b.JsonLoader.prototype.constructor = b.JsonLoader, b.JsonLoader.prototype.load = function() {
    var a = this;
    window.XDomainRequest && a.crossorigin ? (this.ajaxRequest = new window.XDomainRequest, this.ajaxRequest.timeout = 3e3, this.ajaxRequest.onerror = function() {
      a.onError()
    }, this.ajaxRequest.ontimeout = function() {
      a.onError()
    }, this.ajaxRequest.onprogress = function() {}) : this.ajaxRequest = window.XMLHttpRequest ? new window.XMLHttpRequest : new window.ActiveXObject("Microsoft.XMLHTTP"), this.ajaxRequest.onload = function() {
      a.onJSONLoaded()
    }, this.ajaxRequest.open("GET", this.url, !0), this.ajaxRequest.send()
  }, b.JsonLoader.prototype.onJSONLoaded = function() {
    if (!this.ajaxRequest.responseText) return this.onError(), void 0;
    if (this.json = JSON.parse(this.ajaxRequest.responseText), this.json.frames) {
      var a = this,
        c = this.baseUrl + this.json.meta.image,
        d = new b.ImageLoader(c, this.crossorigin),
        e = this.json.frames;
      this.texture = d.texture.baseTexture, d.addEventListener("loaded", function() {
        a.onLoaded()
      });
      for (var g in e) {
        var h = e[g].frame;
        if (h && (b.TextureCache[g] = new b.Texture(this.texture, {
            x: h.x,
            y: h.y,
            width: h.w,
            height: h.h
          }), b.TextureCache[g].crop = new b.Rectangle(h.x, h.y, h.w, h.h), e[g].trimmed)) {
          var i = e[g].sourceSize,
            j = e[g].spriteSourceSize;
          b.TextureCache[g].trim = new b.Rectangle(j.x, j.y, i.w, i.h)
        }
      }
      d.load()
    } else if (this.json.bones) {
      var k = new f.SkeletonJson,
        l = k.readSkeletonData(this.json);
      b.AnimCache[this.url] = l, this.onLoaded()
    } else this.onLoaded()
  }, b.JsonLoader.prototype.onLoaded = function() {
    this.loaded = !0, this.dispatchEvent({
      type: "loaded",
      content: this
    })
  }, b.JsonLoader.prototype.onError = function() {
    this.dispatchEvent({
      type: "error",
      content: this
    })
  }, b.AtlasLoader = function(a, c) {
    b.EventTarget.call(this), this.url = a, this.baseUrl = a.replace(/[^\/]*$/, ""), this.crossorigin = c, this.loaded = !1
  }, b.AtlasLoader.constructor = b.AtlasLoader, b.AtlasLoader.prototype.load = function() {
    this.ajaxRequest = new b.AjaxRequest, this.ajaxRequest.onreadystatechange = this.onAtlasLoaded.bind(this), this.ajaxRequest.open("GET", this.url, !0), this.ajaxRequest.overrideMimeType && this.ajaxRequest.overrideMimeType("application/json"), this.ajaxRequest.send(null)
  }, b.AtlasLoader.prototype.onAtlasLoaded = function() {
    if (4 === this.ajaxRequest.readyState)
      if (200 === this.ajaxRequest.status || -1 === window.location.href.indexOf("http")) {
        this.atlas = {
          meta: {
            image: []
          },
          frames: []
        };
        var a = this.ajaxRequest.responseText.split(/\r?\n/),
          c = -3,
          d = 0,
          e = null,
          f = !1,
          g = 0,
          h = 0,
          i = this.onLoaded.bind(this);
        for (g = 0; g < a.length; g++)
          if (a[g] = a[g].replace(/^\s+|\s+$/g, ""), "" === a[g] && (f = g + 1), a[g].length > 0) {
            if (f === g) this.atlas.meta.image.push(a[g]), d = this.atlas.meta.image.length - 1, this.atlas.frames.push({}), c = -3;
            else if (c > 0)
              if (c % 7 === 1) null != e && (this.atlas.frames[d][e.name] = e), e = {
                name: a[g],
                frame: {}
              };
              else {
                var j = a[g].split(" ");
                if (c % 7 === 3) e.frame.x = Number(j[1].replace(",", "")), e.frame.y = Number(j[2]);
                else if (c % 7 === 4) e.frame.w = Number(j[1].replace(",", "")), e.frame.h = Number(j[2]);
                else if (c % 7 === 5) {
                  var k = {
                    x: 0,
                    y: 0,
                    w: Number(j[1].replace(",", "")),
                    h: Number(j[2])
                  };
                  k.w > e.frame.w || k.h > e.frame.h ? (e.trimmed = !0, e.realSize = k) : e.trimmed = !1
                }
              }
            c++
          }
        if (null != e && (this.atlas.frames[d][e.name] = e), this.atlas.meta.image.length > 0) {
          for (this.images = [], h = 0; h < this.atlas.meta.image.length; h++) {
            var l = this.baseUrl + this.atlas.meta.image[h],
              m = this.atlas.frames[h];
            this.images.push(new b.ImageLoader(l, this.crossorigin));
            for (g in m) {
              var n = m[g].frame;
              n && (b.TextureCache[g] = new b.Texture(this.images[h].texture.baseTexture, {
                x: n.x,
                y: n.y,
                width: n.w,
                height: n.h
              }), m[g].trimmed && (b.TextureCache[g].realSize = m[g].realSize, b.TextureCache[g].trim.x = 0, b.TextureCache[g].trim.y = 0))
            }
          }
          for (this.currentImageId = 0, h = 0; h < this.images.length; h++) this.images[h].addEventListener("loaded", i);
          this.images[this.currentImageId].load()
        } else this.onLoaded()
      } else this.onError()
  }, b.AtlasLoader.prototype.onLoaded = function() {
    this.images.length - 1 > this.currentImageId ? (this.currentImageId++, this.images[this.currentImageId].load()) : (this.loaded = !0, this.dispatchEvent({
      type: "loaded",
      content: this
    }))
  }, b.AtlasLoader.prototype.onError = function() {
    this.dispatchEvent({
      type: "error",
      content: this
    })
  }, b.SpriteSheetLoader = function(a, c) {
    b.EventTarget.call(this), this.url = a, this.crossorigin = c, this.baseUrl = a.replace(/[^\/]*$/, ""), this.texture = null, this.frames = {}
  }, b.SpriteSheetLoader.prototype.constructor = b.SpriteSheetLoader, b.SpriteSheetLoader.prototype.load = function() {
    var a = this,
      c = new b.JsonLoader(this.url, this.crossorigin);
    c.addEventListener("loaded", function(b) {
      a.json = b.content.json, a.onLoaded()
    }), c.load()
  }, b.SpriteSheetLoader.prototype.onLoaded = function() {
    this.dispatchEvent({
      type: "loaded",
      content: this
    })
  }, b.ImageLoader = function(a, c) {
    b.EventTarget.call(this), this.texture = b.Texture.fromImage(a, c), this.frames = []
  }, b.ImageLoader.prototype.constructor = b.ImageLoader, b.ImageLoader.prototype.load = function() {
    if (this.texture.baseTexture.hasLoaded) this.onLoaded();
    else {
      var a = this;
      this.texture.baseTexture.addEventListener("loaded", function() {
        a.onLoaded()
      })
    }
  }, b.ImageLoader.prototype.onLoaded = function() {
    this.dispatchEvent({
      type: "loaded",
      content: this
    })
  }, b.ImageLoader.prototype.loadFramedSpriteSheet = function(a, c, d) {
    this.frames = [];
    for (var e = Math.floor(this.texture.width / a), f = Math.floor(this.texture.height / c), g = 0, h = 0; f > h; h++)
      for (var i = 0; e > i; i++, g++) {
        var j = new b.Texture(this.texture, {
          x: i * a,
          y: h * c,
          width: a,
          height: c
        });
        this.frames.push(j), d && (b.TextureCache[d + "-" + g] = j)
      }
    if (this.texture.baseTexture.hasLoaded) this.onLoaded();
    else {
      var k = this;
      this.texture.baseTexture.addEventListener("loaded", function() {
        k.onLoaded()
      })
    }
  }, b.BitmapFontLoader = function(a, c) {
    b.EventTarget.call(this), this.url = a, this.crossorigin = c, this.baseUrl = a.replace(/[^\/]*$/, ""), this.texture = null
  }, b.BitmapFontLoader.prototype.constructor = b.BitmapFontLoader, b.BitmapFontLoader.prototype.load = function() {
    this.ajaxRequest = new b.AjaxRequest;
    var a = this;
    this.ajaxRequest.onreadystatechange = function() {
      a.onXMLLoaded()
    }, this.ajaxRequest.open("GET", this.url, !0), this.ajaxRequest.overrideMimeType && this.ajaxRequest.overrideMimeType("application/xml"), this.ajaxRequest.send(null)
  }, b.BitmapFontLoader.prototype.onXMLLoaded = function() {
    if (4 === this.ajaxRequest.readyState && (200 === this.ajaxRequest.status || -1 === window.location.protocol.indexOf("http"))) {
      var a = this.ajaxRequest.responseXML;
      if (!a || /MSIE 9/i.test(navigator.userAgent) || navigator.isCocoonJS)
        if ("function" == typeof window.DOMParser) {
          var c = new DOMParser;
          a = c.parseFromString(this.ajaxRequest.responseText, "text/xml")
        } else {
          var d = document.createElement("div");
          d.innerHTML = this.ajaxRequest.responseText, a = d
        }
      var e = this.baseUrl + a.getElementsByTagName("page")[0].getAttribute("file"),
        f = new b.ImageLoader(e, this.crossorigin);
      this.texture = f.texture.baseTexture;
      var g = {},
        h = a.getElementsByTagName("info")[0],
        i = a.getElementsByTagName("common")[0];
      g.font = h.getAttribute("face"), g.size = parseInt(h.getAttribute("size"), 10), g.lineHeight = parseInt(i.getAttribute("lineHeight"), 10), g.chars = {};
      for (var j = a.getElementsByTagName("char"), k = 0; k < j.length; k++) {
        var l = parseInt(j[k].getAttribute("id"), 10),
          m = new b.Rectangle(parseInt(j[k].getAttribute("x"), 10), parseInt(j[k].getAttribute("y"), 10), parseInt(j[k].getAttribute("width"), 10), parseInt(j[k].getAttribute("height"), 10));
        g.chars[l] = {
          xOffset: parseInt(j[k].getAttribute("xoffset"), 10),
          yOffset: parseInt(j[k].getAttribute("yoffset"), 10),
          xAdvance: parseInt(j[k].getAttribute("xadvance"), 10),
          kerning: {},
          texture: b.TextureCache[l] = new b.Texture(this.texture, m)
        }
      }
      var n = a.getElementsByTagName("kerning");
      for (k = 0; k < n.length; k++) {
        var o = parseInt(n[k].getAttribute("first"), 10),
          p = parseInt(n[k].getAttribute("second"), 10),
          q = parseInt(n[k].getAttribute("amount"), 10);
        g.chars[p].kerning[o] = q
      }
      b.BitmapText.fonts[g.font] = g;
      var r = this;
      f.addEventListener("loaded", function() {
        r.onLoaded()
      }), f.load()
    }
  }, b.BitmapFontLoader.prototype.onLoaded = function() {
    this.dispatchEvent({
      type: "loaded",
      content: this
    })
  }, b.SpineLoader = function(a, c) {
    b.EventTarget.call(this), this.url = a, this.crossorigin = c, this.loaded = !1
  }, b.SpineLoader.prototype.constructor = b.SpineLoader, b.SpineLoader.prototype.load = function() {
    var a = this,
      c = new b.JsonLoader(this.url, this.crossorigin);
    c.addEventListener("loaded", function(b) {
      a.json = b.content.json, a.onLoaded()
    }), c.load()
  }, b.SpineLoader.prototype.onLoaded = function() {
    this.loaded = !0, this.dispatchEvent({
      type: "loaded",
      content: this
    })
  }, b.AbstractFilter = function(a, b) {
    this.passes = [this], this.shaders = [], this.dirty = !0, this.padding = 0, this.uniforms = b || {}, this.fragmentSrc = a || []
  }, b.AlphaMaskFilter = function(a) {
    b.AbstractFilter.call(this), this.passes = [this], a.baseTexture._powerOf2 = !0, this.uniforms = {
      mask: {
        type: "sampler2D",
        value: a
      },
      mapDimensions: {
        type: "2f",
        value: {
          x: 1,
          y: 5112
        }
      },
      dimensions: {
        type: "4fv",
        value: [0, 0, 0, 0]
      }
    }, a.baseTexture.hasLoaded ? (this.uniforms.mask.value.x = a.width, this.uniforms.mask.value.y = a.height) : (this.boundLoadedFunction = this.onTextureLoaded.bind(this), a.baseTexture.on("loaded", this.boundLoadedFunction)), this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D mask;", "uniform sampler2D uSampler;", "uniform vec2 offset;", "uniform vec4 dimensions;", "uniform vec2 mapDimensions;", "void main(void) {", "   vec2 mapCords = vTextureCoord.xy;", "   mapCords += (dimensions.zw + offset)/ dimensions.xy ;", "   mapCords.y *= -1.0;", "   mapCords.y += 1.0;", "   mapCords *= dimensions.xy / mapDimensions;", "   vec4 original =  texture2D(uSampler, vTextureCoord);", "   float maskAlpha =  texture2D(mask, mapCords).r;", "   original *= maskAlpha;", "   gl_FragColor =  original;", "}"]
  }, b.AlphaMaskFilter.prototype = Object.create(b.AbstractFilter.prototype), b.AlphaMaskFilter.prototype.constructor = b.AlphaMaskFilter, b.AlphaMaskFilter.prototype.onTextureLoaded = function() {
    this.uniforms.mapDimensions.value.x = this.uniforms.mask.value.width, this.uniforms.mapDimensions.value.y = this.uniforms.mask.value.height, this.uniforms.mask.value.baseTexture.off("loaded", this.boundLoadedFunction)
  }, Object.defineProperty(b.AlphaMaskFilter.prototype, "map", {
    get: function() {
      return this.uniforms.mask.value
    },
    set: function(a) {
      this.uniforms.mask.value = a
    }
  }), b.ColorMatrixFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      matrix: {
        type: "mat4",
        value: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform float invert;", "uniform mat4 matrix;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;", "}"]
  }, b.ColorMatrixFilter.prototype = Object.create(b.AbstractFilter.prototype), b.ColorMatrixFilter.prototype.constructor = b.ColorMatrixFilter, Object.defineProperty(b.ColorMatrixFilter.prototype, "matrix", {
    get: function() {
      return this.uniforms.matrix.value
    },
    set: function(a) {
      this.uniforms.matrix.value = a
    }
  }), b.GrayFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      gray: {
        type: "1f",
        value: 1
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D uSampler;", "uniform float gray;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord);", "   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);", "}"]
  }, b.GrayFilter.prototype = Object.create(b.AbstractFilter.prototype), b.GrayFilter.prototype.constructor = b.GrayFilter, Object.defineProperty(b.GrayFilter.prototype, "gray", {
    get: function() {
      return this.uniforms.gray.value
    },
    set: function(a) {
      this.uniforms.gray.value = a
    }
  }), b.DisplacementFilter = function(a) {
    b.AbstractFilter.call(this), this.passes = [this], a.baseTexture._powerOf2 = !0, this.uniforms = {
      displacementMap: {
        type: "sampler2D",
        value: a
      },
      scale: {
        type: "2f",
        value: {
          x: 30,
          y: 30
        }
      },
      offset: {
        type: "2f",
        value: {
          x: 0,
          y: 0
        }
      },
      mapDimensions: {
        type: "2f",
        value: {
          x: 1,
          y: 5112
        }
      },
      dimensions: {
        type: "4fv",
        value: [0, 0, 0, 0]
      }
    }, a.baseTexture.hasLoaded ? (this.uniforms.mapDimensions.value.x = a.width, this.uniforms.mapDimensions.value.y = a.height) : (this.boundLoadedFunction = this.onTextureLoaded.bind(this), a.baseTexture.on("loaded", this.boundLoadedFunction)), this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D displacementMap;", "uniform sampler2D uSampler;", "uniform vec2 scale;", "uniform vec2 offset;", "uniform vec4 dimensions;", "uniform vec2 mapDimensions;", "void main(void) {", "   vec2 mapCords = vTextureCoord.xy;", "   mapCords += (dimensions.zw + offset)/ dimensions.xy ;", "   mapCords.y *= -1.0;", "   mapCords.y += 1.0;", "   vec2 matSample = texture2D(displacementMap, mapCords).xy;", "   matSample -= 0.5;", "   matSample *= scale;", "   matSample /= mapDimensions;", "   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));", "   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);", "   vec2 cord = vTextureCoord;", "}"]
  }, b.DisplacementFilter.prototype = Object.create(b.AbstractFilter.prototype), b.DisplacementFilter.prototype.constructor = b.DisplacementFilter, b.DisplacementFilter.prototype.onTextureLoaded = function() {
    this.uniforms.mapDimensions.value.x = this.uniforms.displacementMap.value.width, this.uniforms.mapDimensions.value.y = this.uniforms.displacementMap.value.height, this.uniforms.displacementMap.value.baseTexture.off("loaded", this.boundLoadedFunction)
  }, Object.defineProperty(b.DisplacementFilter.prototype, "map", {
    get: function() {
      return this.uniforms.displacementMap.value
    },
    set: function(a) {
      this.uniforms.displacementMap.value = a
    }
  }), Object.defineProperty(b.DisplacementFilter.prototype, "scale", {
    get: function() {
      return this.uniforms.scale.value
    },
    set: function(a) {
      this.uniforms.scale.value = a
    }
  }), Object.defineProperty(b.DisplacementFilter.prototype, "offset", {
    get: function() {
      return this.uniforms.offset.value
    },
    set: function(a) {
      this.uniforms.offset.value = a
    }
  }), b.PixelateFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      invert: {
        type: "1f",
        value: 0
      },
      dimensions: {
        type: "4fv",
        value: new Float32Array([1e4, 100, 10, 10])
      },
      pixelSize: {
        type: "2f",
        value: {
          x: 10,
          y: 10
        }
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform vec2 testDim;", "uniform vec4 dimensions;", "uniform vec2 pixelSize;", "uniform sampler2D uSampler;", "void main(void) {", "   vec2 coord = vTextureCoord;", "   vec2 size = dimensions.xy/pixelSize;", "   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;", "   gl_FragColor = texture2D(uSampler, color);", "}"]
  }, b.PixelateFilter.prototype = Object.create(b.AbstractFilter.prototype), b.PixelateFilter.prototype.constructor = b.PixelateFilter, Object.defineProperty(b.PixelateFilter.prototype, "size", {
    get: function() {
      return this.uniforms.pixelSize.value
    },
    set: function(a) {
      this.dirty = !0, this.uniforms.pixelSize.value = a
    }
  }), b.BlurXFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      blur: {
        type: "1f",
        value: 1 / 512
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform float blur;", "uniform sampler2D uSampler;", "void main(void) {", "   vec4 sum = vec4(0.0);", "   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;", "   gl_FragColor = sum;", "}"]
  }, b.BlurXFilter.prototype = Object.create(b.AbstractFilter.prototype), b.BlurXFilter.prototype.constructor = b.BlurXFilter, Object.defineProperty(b.BlurXFilter.prototype, "blur", {
    get: function() {
      return this.uniforms.blur.value / (1 / 7e3)
    },
    set: function(a) {
      this.dirty = !0, this.uniforms.blur.value = 1 / 7e3 * a
    }
  }), b.BlurYFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      blur: {
        type: "1f",
        value: 1 / 512
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform float blur;", "uniform sampler2D uSampler;", "void main(void) {", "   vec4 sum = vec4(0.0);", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;", "   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;", "   gl_FragColor = sum;", "}"]
  }, b.BlurYFilter.prototype = Object.create(b.AbstractFilter.prototype), b.BlurYFilter.prototype.constructor = b.BlurYFilter, Object.defineProperty(b.BlurYFilter.prototype, "blur", {
    get: function() {
      return this.uniforms.blur.value / (1 / 7e3)
    },
    set: function(a) {
      this.uniforms.blur.value = 1 / 7e3 * a
    }
  }), b.BlurFilter = function() {
    this.blurXFilter = new b.BlurXFilter, this.blurYFilter = new b.BlurYFilter, this.passes = [this.blurXFilter, this.blurYFilter]
  }, Object.defineProperty(b.BlurFilter.prototype, "blur", {
    get: function() {
      return this.blurXFilter.blur
    },
    set: function(a) {
      this.blurXFilter.blur = this.blurYFilter.blur = a
    }
  }), Object.defineProperty(b.BlurFilter.prototype, "blurX", {
    get: function() {
      return this.blurXFilter.blur
    },
    set: function(a) {
      this.blurXFilter.blur = a
    }
  }), Object.defineProperty(b.BlurFilter.prototype, "blurY", {
    get: function() {
      return this.blurYFilter.blur
    },
    set: function(a) {
      this.blurYFilter.blur = a
    }
  }), b.InvertFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      invert: {
        type: "1f",
        value: 1
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform float invert;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord);", "   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);", "}"]
  }, b.InvertFilter.prototype = Object.create(b.AbstractFilter.prototype), b.InvertFilter.prototype.constructor = b.InvertFilter, Object.defineProperty(b.InvertFilter.prototype, "invert", {
    get: function() {
      return this.uniforms.invert.value
    },
    set: function(a) {
      this.uniforms.invert.value = a
    }
  }), b.SepiaFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      sepia: {
        type: "1f",
        value: 1
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform float sepia;", "uniform sampler2D uSampler;", "const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord);", "   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);", "}"]
  }, b.SepiaFilter.prototype = Object.create(b.AbstractFilter.prototype), b.SepiaFilter.prototype.constructor = b.SepiaFilter, Object.defineProperty(b.SepiaFilter.prototype, "sepia", {
    get: function() {
      return this.uniforms.sepia.value
    },
    set: function(a) {
      this.uniforms.sepia.value = a
    }
  }), b.TwistFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      radius: {
        type: "1f",
        value: .5
      },
      angle: {
        type: "1f",
        value: 5
      },
      offset: {
        type: "2f",
        value: {
          x: .5,
          y: .5
        }
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform vec4 dimensions;", "uniform sampler2D uSampler;", "uniform float radius;", "uniform float angle;", "uniform vec2 offset;", "void main(void) {", "   vec2 coord = vTextureCoord - offset;", "   float distance = length(coord);", "   if (distance < radius) {", "       float ratio = (radius - distance) / radius;", "       float angleMod = ratio * ratio * angle;", "       float s = sin(angleMod);", "       float c = cos(angleMod);", "       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);", "   }", "   gl_FragColor = texture2D(uSampler, coord+offset);", "}"]
  }, b.TwistFilter.prototype = Object.create(b.AbstractFilter.prototype), b.TwistFilter.prototype.constructor = b.TwistFilter, Object.defineProperty(b.TwistFilter.prototype, "offset", {
    get: function() {
      return this.uniforms.offset.value
    },
    set: function(a) {
      this.dirty = !0, this.uniforms.offset.value = a
    }
  }), Object.defineProperty(b.TwistFilter.prototype, "radius", {
    get: function() {
      return this.uniforms.radius.value
    },
    set: function(a) {
      this.dirty = !0, this.uniforms.radius.value = a
    }
  }), Object.defineProperty(b.TwistFilter.prototype, "angle", {
    get: function() {
      return this.uniforms.angle.value
    },
    set: function(a) {
      this.dirty = !0, this.uniforms.angle.value = a
    }
  }), b.ColorStepFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      step: {
        type: "1f",
        value: 5
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D uSampler;", "uniform float step;", "void main(void) {", "   vec4 color = texture2D(uSampler, vTextureCoord);", "   color = floor(color * step) / step;", "   gl_FragColor = color;", "}"]
  }, b.ColorStepFilter.prototype = Object.create(b.AbstractFilter.prototype), b.ColorStepFilter.prototype.constructor = b.ColorStepFilter, Object.defineProperty(b.ColorStepFilter.prototype, "step", {
    get: function() {
      return this.uniforms.step.value
    },
    set: function(a) {
      this.uniforms.step.value = a
    }
  }), b.DotScreenFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      scale: {
        type: "1f",
        value: 1
      },
      angle: {
        type: "1f",
        value: 5
      },
      dimensions: {
        type: "4fv",
        value: [0, 0, 0, 0]
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform vec4 dimensions;", "uniform sampler2D uSampler;", "uniform float angle;", "uniform float scale;", "float pattern() {", "   float s = sin(angle), c = cos(angle);", "   vec2 tex = vTextureCoord * dimensions.xy;", "   vec2 point = vec2(", "       c * tex.x - s * tex.y,", "       s * tex.x + c * tex.y", "   ) * scale;", "   return (sin(point.x) * sin(point.y)) * 4.0;", "}", "void main() {", "   vec4 color = texture2D(uSampler, vTextureCoord);", "   float average = (color.r + color.g + color.b) / 3.0;", "   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);", "}"]
  }, b.DotScreenFilter.prototype = Object.create(b.AbstractFilter.prototype), b.DotScreenFilter.prototype.constructor = b.DotScreenFilter, Object.defineProperty(b.DotScreenFilter.prototype, "scale", {
    get: function() {
      return this.uniforms.scale.value
    },
    set: function(a) {
      this.dirty = !0, this.uniforms.scale.value = a
    }
  }), Object.defineProperty(b.DotScreenFilter.prototype, "angle", {
    get: function() {
      return this.uniforms.angle.value
    },
    set: function(a) {
      this.dirty = !0, this.uniforms.angle.value = a
    }
  }), b.CrossHatchFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      blur: {
        type: "1f",
        value: 1 / 512
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform float blur;", "uniform sampler2D uSampler;", "void main(void) {", "    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);", "    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);", "    if (lum < 1.00) {", "        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {", "            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);", "        }", "    }", "    if (lum < 0.75) {", "        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {", "            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);", "        }", "    }", "    if (lum < 0.50) {", "        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {", "            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);", "        }", "    }", "    if (lum < 0.3) {", "        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {", "            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);", "        }", "    }", "}"]
  }, b.CrossHatchFilter.prototype = Object.create(b.AbstractFilter.prototype), b.CrossHatchFilter.prototype.constructor = b.BlurYFilter, Object.defineProperty(b.CrossHatchFilter.prototype, "blur", {
    get: function() {
      return this.uniforms.blur.value / (1 / 7e3)
    },
    set: function(a) {
      this.uniforms.blur.value = 1 / 7e3 * a
    }
  }), b.RGBSplitFilter = function() {
    b.AbstractFilter.call(this), this.passes = [this], this.uniforms = {
      red: {
        type: "2f",
        value: {
          x: 20,
          y: 20
        }
      },
      green: {
        type: "2f",
        value: {
          x: -20,
          y: 20
        }
      },
      blue: {
        type: "2f",
        value: {
          x: 20,
          y: -20
        }
      },
      dimensions: {
        type: "4fv",
        value: [0, 0, 0, 0]
      }
    }, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform vec2 red;", "uniform vec2 green;", "uniform vec2 blue;", "uniform vec4 dimensions;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;", "   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;", "   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;", "   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;", "}"]
  }, b.RGBSplitFilter.prototype = Object.create(b.AbstractFilter.prototype), b.RGBSplitFilter.prototype.constructor = b.RGBSplitFilter, Object.defineProperty(b.RGBSplitFilter.prototype, "angle", {
    get: function() {
      return this.uniforms.blur.value / (1 / 7e3)
    },
    set: function(a) {
      this.uniforms.blur.value = 1 / 7e3 * a
    }
  }), "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = b), exports.PIXI = b) : "undefined" != typeof define && define.amd ? define(b) : a.PIXI = b
}).call(this);;

(function() {
  (function(a) {
    function b(a) {
      a = a.split(/\s/);
      return {
        X: a[0],
        Y: a[1]
      }
    }
    var c = a('<div style="background-position: 3px 5px">');
    a.support.backgroundPosition = "3px 5px" === c.css("backgroundPosition") ? !0 : !1;
    a.support.backgroundPositionXY = "3px" === c.css("backgroundPositionX") ? !0 : !1;
    var c = null,
      d = ["X", "Y"];
    !a.support.backgroundPosition && a.support.backgroundPositionXY && (a.cssHooks.backgroundPosition = {
      get: function(b, c, h) {
        return a.map(d, function(d, c) {
          return a.css(b, "backgroundPosition" + d)
        }).join(" ")
      },
      set: function(c,
        f) {
        a.each(d, function(a, d) {
          var m = b(f);
          c.style["backgroundPosition" + d] = m[d]
        })
      }
    });
    a.support.backgroundPosition && !a.support.backgroundPositionXY && a.each(d, function(d, c) {
      a.cssHooks["backgroundPosition" + c] = {
        get: function(d, e, m) {
          return b(a.css(d, "backgroundPosition"))[c]
        },
        set: function(d, e) {
          var m = b(a.css(d, "backgroundPosition")),
            n = "X" === c;
          d.style.backgroundPosition = (n ? e : m.X) + " " + (n ? m.Y : e)
        }
      };
      a.fx.step["backgroundPosition" + c] = function(b) {
        a.cssHooks["backgroundPosition" + c].set(b.elem, b.now + b.unit)
      }
    })
  })(jQuery);
  (function(a) {
    function b(b) {
      var d, c, e, f;
      a(b.style[a.cssProps.transform].replace(/(?:\,\s|\)|\()/g, "|").split(" ")).each(function(a, b) {
        "" !== b && (void 0 === d && (d = {}), c = b.split("|"), e = c.shift(), f = /.*[^XY]/.exec(e)[0], d[f] || (d[f] = "     ".split(" ")), /Y/.test(e) || (d[f][0] = c[0]), /X/.test(e) || (d[f][1] = c[1]), 6 == c.length && (d[f][2] = c[2], d[f][3] = c[3], d[f][4] = c[4], d[f][5] = c[5]))
      });
      return void 0 !== d ? d : null
    }

    function c(a) {
      if ("number" === typeof a) return parseFloat(a);
      if (-1 != a.indexOf("deg")) return parseInt(a, 10) * (2 *
        Math.PI / 360);
      if (-1 != a.indexOf("grad")) return parseInt(a, 10) * (Math.PI / 200)
    }

    function d(b, d) {
      var e, f, p = "matrixFilter" === a.cssProps.transformOrigin ? !0 : !1;
      e = [a.cssHooks.scaleX.get(b), c(a.cssHooks.skewY.get(b)), c(a.cssHooks.skewX.get(b)), a.cssHooks.scaleY.get(b), a.cssHooks.translateX.get(b), a.cssHooks.translateY.get(b)];
      if (p) {
        b.style.filter = "progid:DXImageTransform.Microsoft.Matrix(M11=1,M12=0,M21=0,M22=1,SizingMethod='auto expand')";
        var q = a.cssHooks.transformOriginX.get(b),
          r = a.cssHooks.transformOriginY.get(b),
          q = 0 < q.indexOf("%") ? /[\d]*/.exec(q) / 100 : q,
          r = 0 < r.indexOf("%") ? /[\d]*/.exec(r) / 100 : r,
          s = b.offsetWidth,
          t = b.offsetHeight
      }
      d = "array" !== typeof d || 6 !== d.length ? e : [e[0] * d[0] + e[1] * d[2], e[0] * d[1] + e[1] * d[3], e[2] * d[0] + e[3] * d[2], e[2] * d[1] + e[3] * d[3], d[4], d[5]];
      if (f = a.data(b, "rotate")) f = c(f), e = Math.cos(f), f = Math.sin(f), f = [e, -f, f, e], d = [d[0] * f[0] + d[1] * f[2], d[0] * f[1] + d[1] * f[3], d[2] * f[0] + d[3] * f[2], d[2] * f[1] + d[3] * f[3], d[4], d[5]];
      b.style.filter = ["progid:DXImageTransform.Microsoft.Matrix(", "M11=" + d[0] + ", ", "M12=" + d[1] + ", ",
        "M21=" + d[2] + ", ", "M22=" + d[3] + ", ", "SizingMethod='auto expand')"
      ].join("");
      p && (p = b.offsetWidth, e = b.offsetHeight, b.style.position = "relative", b.style.left = q * (s - p) + (parseInt(d[4]) || 0), b.style.top = r * (t - e) + (parseInt(d[5]) || 0))
    }
    var e = document.createElement("div"),
      e = e.style;
    a.cssProps.transform = "" === e.MozTransform ? "MozTransform" : "" === e.msTransform ? "msTransform" : "" === e.WebkitTransform ? "WebkitTransform" : "" === e.OTransform ? "OTransform" : "" === e.Transform ? "Transform" : !1;
    a.cssProps.transformOrigin = "" === e.MozTransformOrigin ?
      "MozTransformOrigin" : "" === e.msTransformOrigin ? "msTransformOrigin" : "" === e.WebkitTransformOrigin ? "WebkitTransformOrigin" : "" === e.OTransformOrigin ? "OTransformOrigin" : "" === e.TransformOrigin ? "TransformOrigin" : !1;
    a.support.transform = !1 !== a.cssProps.transform || "" === e.filter ? !0 : !1;
    a.support.transformOrigin = !1 !== a.cssProps.transformOrigin ? !0 : !1;
    a.support.matrixFilter = "" === e.filter && !1 === a.cssProps.transform ? !0 : !1;
    e = null;
    if (!1 !== a.support.transform) {
      a.cssNumber.skew = a.cssNumber.skewX = a.cssNumber.skewY = a.cssNumber.scale =
        a.cssNumber.scaleX = a.cssNumber.scaleY = a.cssNumber.rotate = a.cssNumber.matrix = !0;
      a.cssNumber.transformOrigin = a.cssNumber.transformOriginX = a.cssNumber.transformOriginY = !0;
      a.support.matrixFilter && (a.cssNumber.transformOrigin = a.cssNumber.transformOriginX = a.cssNumber.transformOriginY = !0, a.cssProps.transformOrigin = "matrixFilter");
      a.cssHooks.transform = {
        set: function(b, d, c) {
          a.support.matrixFilter ? b.style.filter = "" + d : b.style[a.cssProps.transform] = d + "%"
        },
        get: function(b, d) {
          return a.support.matrixFilter ? b.style.filter :
            b.style[a.cssProps.transform]
        }
      };
      a.cssHooks.transformOrigin = {
        set: function(b, d, c) {
          a.support.matrixFilter ? (d = d.split(","), a.cssHooks.transformOriginX.set(b, d[0]), 1 < d.length && a.cssHooks.transformOriginY.set(b, d[1])) : b.style[a.cssProps.transformOrigin] = "string" === typeof d ? d : d + (c || "%")
        },
        get: function(b, d) {
          if (a.support.matrixFilter) {
            var c = a.data(b, "transformOriginX"),
              e = a.data(b, "transformOriginY");
            return c && e && c === e ? c : "50%"
          }
          return b.style[a.cssProps.transformOrigin]
        }
      };
      a.fx.step.transformOrigin = function(b) {
        a.cssHooks.transformOrigin.set(b.elem,
          b.now, b.unit)
      };
      a.cssHooks.transformOriginX = {
        set: function(b, c, e) {
          a.support.matrixFilter ? (a.data(b, "transformOriginX", e ? c + e : c), d(b)) : b.style[a.cssProps.transformOrigin + "X"] = "string" === typeof c ? c : c + (e || "%")
        },
        get: function(b, d) {
          if (a.support.matrixFilter) {
            var c = a.data(b, "transformOriginX");
            switch (c) {
              case "left":
                return "0%";
              case "center":
                return "50%";
              case "right":
                return "100%"
            }
            return c ? c : "50%"
          }
          return b.style[a.cssProps.transformOrigin + "X"]
        }
      };
      a.fx.step.transformOriginX = function(b) {
        a.cssHooks.transformOriginX.set(b.elem,
          b.now, b.unit)
      };
      a.cssHooks.transformOriginY = {
        set: function(b, c, e) {
          a.support.matrixFilter ? (a.data(b, "transformOriginY", e ? c + e : c), d(b)) : b.style[a.cssProps.transformOrigin + "Y"] = "string" === typeof c ? c : c + (e || "%")
        },
        get: function(b, d) {
          if (a.support.matrixFilter) {
            var c = a.data(b, "transformOriginY");
            switch (c) {
              case "top":
                return "0%";
              case "center":
                return "50%";
              case "bottom":
                return "100%"
            }
            return c ? c : "50%"
          }
          return b.style[a.cssProps.transformOrigin + "Y"]
        }
      };
      a.fx.step.transformOriginY = function(b) {
        a.cssHooks.transformOriginY.set(b.elem,
          b.now, b.unit)
      };
      var e = function(a) {
          return a
        },
        f = [
          ["X", "Y"], "X", "Y"
        ];
      jQuery.each([{
        prop: "rotate",
        matrix: [function(a) {
          return Math.cos(a)
        }, function(a) {
          return -Math.sin(a)
        }, function(a) {
          return Math.sin(a)
        }, function(a) {
          return Math.cos(a)
        }],
        unit: "rad",
        subProps: [""],
        fnc: c
      }, {
        prop: "scale",
        matrix: [
          [e, 0, 0, e],
          [e, 0, 0, 1],
          [1, 0, 0, e]
        ],
        unit: "",
        subProps: f,
        fnc: parseFloat,
        _default: 1
      }, {
        prop: "skew",
        matrix: [
          [1, e, e, 1],
          [1, e, 0, 1],
          [1, 0, e, 1]
        ],
        unit: "rad",
        subProps: f,
        fnc: c
      }, {
        prop: "translate",
        matrix: [
          [1, 0, 0, 1, e, e],
          [1, 0, 0, 1, e, 0],
          [1, 0,
            0, 1, 0, e
          ]
        ],
        standardUnit: "px",
        subProps: f,
        fnc: parseFloat
      }, {
        prop: "matrix",
        matrix: [
          [e, e, e, e, e, e],
          [e, 0, 0, 1, 0, 0],
          [1, e, 0, 1, 0, 0],
          [1, 0, e, 1, 0, 0],
          [1, 0, 0, e, 0, 0],
          [1, 0, 0, 1, 0, e]
        ],
        subProps: ["ABCDXY".split(""), "A", "B", "C", "D", "X", "Y"],
        fnc: parseFloat
      }], function(c, e) {
        jQuery.each(e.subProps, function(c, h) {
          var f;
          a.isArray(h) ? (f = e.prop, a.cssHooks[f] = {
            set: function(b, d, c) {
              jQuery.each(h, function(e, h) {
                a.cssHooks[f + h].set(b, d, c)
              })
            },
            get: function(b, d) {
              var c = [];
              jQuery.each(h, function(d, e) {
                c.push(a.cssHooks[f + e].get(b, c))
              });
              return c[0] ||
                c[1]
            }
          }) : (f = e.prop + h, a.cssHooks[f] = {
            set: function(c, h, m) {
              a.data(c, f, m ? h + m : h);
              h = e.fnc(m ? h + m : h);
              var n = f;
              m = e.unit || m || e.standardUnit;
              if (a.support.matrixFilter) d(c, h);
              else {
                var w = b(c),
                  v = /[X|Y]/.exec(n),
                  v = null === v ? "" : v[0] ? v[0] : v,
                  n = /.*[^XY]/.exec(n)[0];
                m = void 0 === m ? "" : m;
                var u = "",
                  x = !1,
                  y;
                if (null !== w)
                  for (var A in w)
                    if (y = w[A], n === A) "matrix" !== n ? (u += n + "(", u += "X" === v || "" === v ? h + m : "" !== y[0] ? y[0] : a.cssHooks[n + "X"].get(c) + m, u += "Y" === v ? ", " + h + m : "" !== y[1] ? ", " + y[1] : n + "Y" in a.cssHooks ? ", " + a.cssHooks[n + "Y"].get(c) + m : "",
                      u += ") ") : u += h + " ", x = !0;
                    else {
                      for (var u = u + (A + "("), z = 0; z < y.length; z++)
                        if (u += y[z], z < y.length - 1 && "" !== y[z + 1]) u += ", ";
                        else break;
                      u += ") "
                    }
                x || (u += n + v + "(" + h + m + ") ");
                c.style[a.cssProps.transform] = u
              }
            },
            get: function(b, d) {
              var c = a.data(b, f);
              return c && void 0 !== c ? c : e._default || 0
            }
          });
          a.fx.step[f] = function(b) {
            b.unit = "px" === b.unit && a.cssNumber[f] ? e.standardUnit : b.unit;
            a.cssHooks[f].set(b.elem, b.now, b.unit)
          }
        })
      });
      a.rotate = {
        radToDeg: function(a) {
          return 180 * a / Math.PI
        }
      }
    }
  })(jQuery);
  (function(a) {
    function b(b, d) {
      var e, f;

      function h(b) {
        y.start = w ? b.pageX : b.pageY;
        b = parseInt(t.obj.css(v));
        e = "auto" == b ? 0 : b;
        a(document).bind("mousemove", n);
        document.ontouchmove = function(b) {
          a(document).unbind("mousemove");
          n(b.touches[0])
        };
        a(document).bind("mouseup", m);
        t.obj.bind("mouseup", m);
        t.obj[0].ontouchend = document.ontouchend = function(b) {
          a(document).unbind("mouseup");
          t.obj.unbind("mouseup");
          m(b.touches[0])
        };
        return !1
      }

      function k(a) {
        1 <= q.ratio || (x -= (a.wheelDelta ? a.wheelDelta / 120 : -a.detail / 3) * d.wheel, x =
          Math.min(q[d.axis] - p[d.axis], Math.max(0, x)), t.obj.css(v, x / r.ratio), q.obj.css(v, -x), a.preventDefault())
      }

      function m(b) {
        a(document).unbind("mousemove", n);
        a(document).unbind("mouseup", m);
        t.obj.unbind("mouseup", m);
        document.ontouchmove = t.obj[0].ontouchend = document.ontouchend = null;
        return !1
      }

      function n(a) {
        1 <= q.ratio || (f = Math.min(s[d.axis] - t[d.axis], Math.max(0, e + ((w ? a.pageX : a.pageY) - y.start))), x = f * r.ratio, q.obj.css(v, -x), t.obj.css(v, f));
        return !1
      }
      var p = {
          obj: a(".viewport", b)
        },
        q = {
          obj: a(".overview", b)
        },
        r = {
          obj: a(".scrollbar",
            b)
        },
        s = {
          obj: a(".track", r.obj)
        },
        t = {
          obj: a(".thumb", r.obj)
        },
        w = "x" == d.axis,
        v = w ? "left" : "top",
        u = w ? "Width" : "Height",
        x;
      f = e = 0;
      var y = {};
      this.update = function(a) {
        p[d.axis] = p.obj[0]["offset" + u];
        q[d.axis] = q.obj[0]["scroll" + u];
        q.ratio = p[d.axis] / q[d.axis];
        r.obj.toggleClass("disable", 1 <= q.ratio);
        s[d.axis] = "auto" == d.size ? p[d.axis] : d.size;
        t[d.axis] = Math.min(s[d.axis], Math.max(d.min_thumb_size, "auto" == d.sizethumb ? s[d.axis] * q.ratio : d.sizethumb));
        r.ratio = (q[d.axis] - p[d.axis]) / (s[d.axis] - t[d.axis]);
        x = "relative" == a && 1 >= q.ratio ?
          Math.min(q[d.axis] - p[d.axis], Math.max(0, x)) : 0;
        x = "bottom" == a && 1 >= q.ratio ? q[d.axis] - p[d.axis] : isNaN(parseInt(a)) ? x : parseInt(a);
        t.obj.css(v, x / r.ratio);
        q.obj.css(v, -x);
        y.start = t.obj.offset()[v];
        a = u.toLowerCase();
        r.obj.css(a, s[d.axis]);
        s.obj.css(a, s[d.axis]);
        t.obj.css(a, t[d.axis]);
        Number(q.obj.css("height").slice(0, -2)) > Number(p.obj.css("height").slice(0, -2)) ? r.obj.show() : r.obj.hide()
      };
      this.isAtLastScrollLine = function() {
        return 1 <= q.ratio || x == q.obj[0]["scroll" + u] - p.obj[0]["offset" + u]
      };
      this.update();
      (function() {
        t.obj.bind("mousedown",
          h);
        t.obj[0].ontouchstart = function(a) {
          a.preventDefault();
          t.obj.unbind("mousedown");
          h(a.touches[0]);
          return !1
        };
        s.obj.bind("mouseup", n);
        d.scroll && this.addEventListener ? (b[0].addEventListener("DOMMouseScroll", k, !1), b[0].addEventListener("mousewheel", k, !1)) : d.scroll && (b[0].onmousewheel = k)
      })();
      return this
    }
    a.tiny = a.tiny || {};
    a.tiny.scrollbar = {
      options: {
        axis: "y",
        wheel: 40,
        scroll: !0,
        size: "auto",
        sizethumb: "auto",
        min_thumb_size: 20
      }
    };
    a.fn.tinyscrollbar = function(c) {
      c = a.extend({}, a.tiny.scrollbar.options, c);
      this.each(function() {
        a(this).data("tsb",
          new b(a(this), c))
      });
      return this
    };
    a.fn.tinyscrollbar_update = function(b) {
      return a(this).data("tsb").update(b)
    };
    a.fn.tinyscrollbar_isAtLastScrollLine = function() {
      return a(this).data("tsb").isAtLastScrollLine()
    }
  })(jQuery);
  var CryptoJS = CryptoJS || function(a, b) {
    var c = {},
      d = c.lib = {},
      e = function() {},
      f = d.Base = {
        extend: function(a) {
          e.prototype = this;
          var b = new e;
          a && b.mixIn(a);
          b.hasOwnProperty("init") || (b.init = function() {
            b.$super.init.apply(this, arguments)
          });
          b.init.prototype = b;
          b.$super = this;
          return b
        },
        create: function() {
          var a = this.extend();
          a.init.apply(a, arguments);
          return a
        },
        init: function() {},
        mixIn: function(a) {
          for (var b in a) a.hasOwnProperty(b) && (this[b] = a[b]);
          a.hasOwnProperty("toString") && (this.toString = a.toString)
        },
        clone: function() {
          return this.init.prototype.extend(this)
        }
      },
      h = d.WordArray = f.extend({
        init: function(a, d) {
          a = this.words = a || [];
          this.sigBytes = d != b ? d : 4 * a.length
        },
        toString: function(a) {
          return (a || m).stringify(this)
        },
        concat: function(a) {
          var b = this.words,
            d = a.words,
            c = this.sigBytes;
          a = a.sigBytes;
          this.clamp();
          if (c % 4)
            for (var e = 0; e < a; e++) b[c + e >>> 2] |= (d[e >>> 2] >>> 24 - e % 4 * 8 & 255) << 24 - (c + e) % 4 * 8;
          else if (65535 < d.length)
            for (e = 0; e < a; e += 4) b[c + e >>> 2] = d[e >>> 2];
          else b.push.apply(b, d);
          this.sigBytes += a;
          return this
        },
        clamp: function() {
          var b = this.words,
            d = this.sigBytes;
          b[d >>> 2] &= 4294967295 << 32 -
            d % 4 * 8;
          b.length = a.ceil(d / 4)
        },
        clone: function() {
          var a = f.clone.call(this);
          a.words = this.words.slice(0);
          return a
        },
        random: function(b) {
          for (var d = [], c = 0; c < b; c += 4) d.push(4294967296 * a.random() | 0);
          return new h.init(d, b)
        }
      }),
      k = c.enc = {},
      m = k.Hex = {
        stringify: function(a) {
          var b = a.words;
          a = a.sigBytes;
          for (var d = [], c = 0; c < a; c++) {
            var e = b[c >>> 2] >>> 24 - c % 4 * 8 & 255;
            d.push((e >>> 4).toString(16));
            d.push((e & 15).toString(16))
          }
          return d.join("")
        },
        parse: function(a) {
          for (var b = a.length, d = [], c = 0; c < b; c += 2) d[c >>> 3] |= parseInt(a.substr(c, 2), 16) <<
            24 - c % 8 * 4;
          return new h.init(d, b / 2)
        }
      },
      n = k.Latin1 = {
        stringify: function(a) {
          var b = a.words;
          a = a.sigBytes;
          for (var d = [], c = 0; c < a; c++) d.push(String.fromCharCode(b[c >>> 2] >>> 24 - c % 4 * 8 & 255));
          return d.join("")
        },
        parse: function(a) {
          for (var b = a.length, d = [], c = 0; c < b; c++) d[c >>> 2] |= (a.charCodeAt(c) & 255) << 24 - c % 4 * 8;
          return new h.init(d, b)
        }
      },
      p = k.Utf8 = {
        stringify: function(a) {
          try {
            return decodeURIComponent(escape(n.stringify(a)))
          } catch (b) {
            throw Error("Malformed UTF-8 data");
          }
        },
        parse: function(a) {
          return n.parse(unescape(encodeURIComponent(a)))
        }
      },
      q = d.BufferedBlockAlgorithm = f.extend({
        reset: function() {
          this._data = new h.init;
          this._nDataBytes = 0
        },
        _append: function(a) {
          "string" == typeof a && (a = p.parse(a));
          this._data.concat(a);
          this._nDataBytes += a.sigBytes
        },
        _process: function(b) {
          var d = this._data,
            c = d.words,
            e = d.sigBytes,
            f = this.blockSize,
            k = e / (4 * f),
            k = b ? a.ceil(k) : a.max((k | 0) - this._minBufferSize, 0);
          b = k * f;
          e = a.min(4 * b, e);
          if (b) {
            for (var m = 0; m < b; m += f) this._doProcessBlock(c, m);
            m = c.splice(0, b);
            d.sigBytes -= e
          }
          return new h.init(m, e)
        },
        clone: function() {
          var a = f.clone.call(this);
          a._data = this._data.clone();
          return a
        },
        _minBufferSize: 0
      });
    d.Hasher = q.extend({
      cfg: f.extend(),
      init: function(a) {
        this.cfg = this.cfg.extend(a);
        this.reset()
      },
      reset: function() {
        q.reset.call(this);
        this._doReset()
      },
      update: function(a) {
        this._append(a);
        this._process();
        return this
      },
      finalize: function(a) {
        a && this._append(a);
        return this._doFinalize()
      },
      blockSize: 16,
      _createHelper: function(a) {
        return function(b, d) {
          return (new a.init(d)).finalize(b)
        }
      },
      _createHmacHelper: function(a) {
        return function(b, d) {
          return (new r.HMAC.init(a,
            d)).finalize(b)
        }
      }
    });
    var r = c.algo = {};
    return c
  }(Math);
  (function(a) {
    for (var b = CryptoJS, c = b.lib, d = c.WordArray, e = c.Hasher, c = b.algo, f = [], h = [], k = function(a) {
        return 4294967296 * (a - (a | 0)) | 0
      }, m = 2, n = 0; 64 > n;) {
      var p;
      a: {
        p = m;
        for (var q = a.sqrt(p), r = 2; r <= q; r++)
          if (!(p % r)) {
            p = !1;
            break a
          }
        p = !0
      }
      p && (8 > n && (f[n] = k(a.pow(m, 0.5))), h[n] = k(a.pow(m, 1 / 3)), n++);
      m++
    }
    var s = [],
      c = c.SHA256 = e.extend({
        _doReset: function() {
          this._hash = new d.init(f.slice(0))
        },
        _doProcessBlock: function(a, b) {
          for (var d = this._hash.words, c = d[0], e = d[1], f = d[2], k = d[3], m = d[4], n = d[5], p = d[6], q = d[7], r = 0; 64 > r; r++) {
            if (16 > r) s[r] =
              a[b + r] | 0;
            else {
              var B = s[r - 15],
                C = s[r - 2];
              s[r] = ((B << 25 | B >>> 7) ^ (B << 14 | B >>> 18) ^ B >>> 3) + s[r - 7] + ((C << 15 | C >>> 17) ^ (C << 13 | C >>> 19) ^ C >>> 10) + s[r - 16]
            }
            B = q + ((m << 26 | m >>> 6) ^ (m << 21 | m >>> 11) ^ (m << 7 | m >>> 25)) + (m & n ^ ~m & p) + h[r] + s[r];
            C = ((c << 30 | c >>> 2) ^ (c << 19 | c >>> 13) ^ (c << 10 | c >>> 22)) + (c & e ^ c & f ^ e & f);
            q = p;
            p = n;
            n = m;
            m = k + B | 0;
            k = f;
            f = e;
            e = c;
            c = B + C | 0
          }
          d[0] = d[0] + c | 0;
          d[1] = d[1] + e | 0;
          d[2] = d[2] + f | 0;
          d[3] = d[3] + k | 0;
          d[4] = d[4] + m | 0;
          d[5] = d[5] + n | 0;
          d[6] = d[6] + p | 0;
          d[7] = d[7] + q | 0
        },
        _doFinalize: function() {
          var b = this._data,
            d = b.words,
            c = 8 * this._nDataBytes,
            e = 8 * b.sigBytes;
          d[e >>> 5] |= 128 << 24 - e % 32;
          d[(e + 64 >>> 9 << 4) + 14] = a.floor(c / 4294967296);
          d[(e + 64 >>> 9 << 4) + 15] = c;
          b.sigBytes = 4 * d.length;
          this._process();
          return this._hash
        },
        clone: function() {
          var a = e.clone.call(this);
          a._hash = this._hash.clone();
          return a
        }
      });
    b.SHA256 = e._createHelper(c);
    b.HmacSHA256 = e._createHmacHelper(c)
  })(Math);
  (function(a) {
    function b(a, b) {
      return "function" == typeof a ? a.call(b) : a
    }

    function c(b, c) {
      this.$element = a(b);
      this.options = c;
      this.enabled = !0;
      this.fixTitle()
    }
    c.prototype = {
      show: function() {
        var d = this.getTitle();
        if (d && this.enabled) {
          var c = this.tip();
          c.find(".tipsy-inner")[this.options.html ? "html" : "text"](d);
          c[0].className = "tipsy";
          c.remove().css({
            top: 0,
            left: 0,
            visibility: "hidden",
            display: "block"
          }).prependTo(document.body);
          var d = a.extend({}, this.$element.offset(), {
              width: this.$element[0].offsetWidth,
              height: this.$element[0].offsetHeight
            }),
            f = c[0].offsetWidth,
            h = c[0].offsetHeight,
            k = b(this.options.gravity, this.$element[0]),
            m;
          switch (k.charAt(0)) {
            case "n":
              m = {
                top: d.top + d.height + this.options.offset,
                left: d.left + d.width / 2 - f / 2
              };
              break;
            case "s":
              m = {
                top: d.top - h - this.options.offset,
                left: d.left + d.width / 2 - f / 2
              };
              break;
            case "e":
              m = {
                top: d.top + d.height / 2 - h / 2,
                left: d.left - f - this.options.offset
              };
              break;
            case "w":
              m = {
                top: d.top + d.height / 2 - h / 2,
                left: d.left + d.width + this.options.offset
              }
          }
          2 == k.length && ("w" == k.charAt(1) ? m.left = d.left + d.width / 2 - 15 : m.left = d.left + d.width /
            2 - f + 15);
          c.css(m).addClass("tipsy-" + k);
          c.find(".tipsy-arrow")[0].className = "tipsy-arrow tipsy-arrow-" + k.charAt(0);
          this.options.className && c.addClass(b(this.options.className, this.$element[0]));
          this.options.fade ? c.stop().css({
            opacity: 0,
            display: "block",
            visibility: "visible"
          }).animate({
            opacity: this.options.opacity
          }) : c.css({
            visibility: "visible",
            opacity: this.options.opacity
          })
        }
      },
      hide: function() {
        this.options.fade ? this.tip().stop().fadeOut(function() {
          a(this).remove()
        }) : this.tip().remove()
      },
      fixTitle: function() {
        var a =
          this.$element;
        (a.attr("title") || "string" != typeof a.attr("original-title")) && a.attr("original-title", a.attr("title") || "").removeAttr("title")
      },
      getTitle: function() {
        var a, b = this.$element,
          c = this.options;
        this.fixTitle();
        c = this.options;
        "string" == typeof c.title ? a = b.attr("title" == c.title ? "original-title" : c.title) : "function" == typeof c.title && (a = c.title.call(b[0]));
        return (a = ("" + a).replace(/(^\s*|\s*$)/, "")) || c.fallback
      },
      tip: function() {
        this.$tip || (this.$tip = a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),
          this.$tip.data("tipsy-pointee", this.$element[0]));
        return this.$tip
      },
      validate: function() {
        this.$element[0].parentNode || (this.hide(), this.options = this.$element = null)
      },
      enable: function() {
        this.enabled = !0
      },
      disable: function() {
        this.enabled = !1
      },
      toggleEnabled: function() {
        this.enabled = !this.enabled
      }
    };
    a.fn.tipsy = function(b) {
      function e(e) {
        var h = a.data(e, "tipsy");
        h || (h = new c(e, a.fn.tipsy.elementOptions(e, b)), a.data(e, "tipsy", h));
        return h
      }

      function f() {
        var a = e(this);
        a.hoverState = "in";
        0 == b.delayIn ? a.show() : (a.fixTitle(),
          setTimeout(function() {
            "in" == a.hoverState && a.show()
          }, b.delayIn))
      }

      function h() {
        var a = e(this);
        a.hoverState = "out";
        0 == b.delayOut ? a.hide() : setTimeout(function() {
          "out" == a.hoverState && a.hide()
        }, b.delayOut)
      }
      if (!0 === b) return this.data("tipsy");
      if ("string" == typeof b) {
        var k = this.data("tipsy");
        if (k) k[b]();
        return this
      }
      b = a.extend({}, a.fn.tipsy.defaults, b);
      b.live || this.each(function() {
        e(this)
      });
      if ("manual" != b.trigger) {
        var k = b.live ? "live" : "bind",
          m = "hover" == b.trigger ? "mouseleave" : "blur";
        this[k]("hover" == b.trigger ?
          "mouseenter" : "focus", f)[k](m, h)
      }
      return this
    };
    a.fn.tipsy.defaults = {
      className: null,
      delayIn: 0,
      delayOut: 0,
      fade: !1,
      fallback: "",
      gravity: "n",
      html: !1,
      live: !1,
      offset: 0,
      opacity: 0.8,
      title: "title",
      trigger: "hover"
    };
    a.fn.tipsy.revalidate = function() {
      a(".tipsy").each(function() {
        var b = a.data(this, "tipsy-pointee"),
          c;
        if (!(c = !b)) {
          a: {
            for (; b = b.parentNode;)
              if (b == document) {
                b = !0;
                break a
              }
            b = !1
          }
          c = !b
        }
        c && a(this).remove()
      })
    };
    a.fn.tipsy.elementOptions = function(b, c) {
      return a.metadata ? a.extend({}, c, a(b).metadata()) : c
    };
    a.fn.tipsy.autoNS =
      function() {
        return a(this).offset().top > a(document).scrollTop() + a(window).height() / 2 ? "s" : "n"
      };
    a.fn.tipsy.autoWE = function() {
      return a(this).offset().left > a(document).scrollLeft() + a(window).width() / 2 ? "e" : "w"
    };
    a.fn.tipsy.autoBounds = function(b, c) {
      return function() {
        var f = c[0],
          h = 1 < c.length ? c[1] : !1,
          k = a(document).scrollTop() + b,
          m = a(document).scrollLeft() + b,
          n = a(this);
        n.offset().top < k && (f = "n");
        n.offset().left < m && (h = "w");
        a(window).width() + a(document).scrollLeft() - n.offset().left < b && (h = "e");
        a(window).height() + a(document).scrollTop() -
          n.offset().top < b && (f = "s");
        return f + (h ? h : "")
      }
    }
  })(jQuery);
  (function(a) {
    function b(b, c) {
      if (!(1 < b.originalEvent.touches.length)) {
        var d = b.originalEvent.changedTouches[0],
          e = document.createEvent("MouseEvents");
        a(d.target).is("input") || a(d.target).is("textarea") ? b.stopPropagation() : b.preventDefault();
        e.initMouseEvent(c, !0, !0, window, 1, d.screenX, d.screenY, d.clientX, d.clientY, !1, !1, !1, !1, 0, null);
        b.target.dispatchEvent(e)
      }
    }
    a.support.touch = "ontouchend" in document;
    if (a.support.touch) {
      var c = a.ui.mouse.prototype,
        d = c._mouseInit,
        e = c._mouseDestroy,
        f;
      c._touchStart = function(a) {
        !f &&
          this._mouseCapture(a.originalEvent.changedTouches[0]) && (f = !0, this._touchMoved = !1, b(a, "mouseover"), b(a, "mousemove"), b(a, "mousedown"))
      };
      c._touchMove = function(a) {
        f && (this._touchMoved = !0, b(a, "mousemove"))
      };
      c._touchEnd = function(a) {
        f && (b(a, "mouseup"), b(a, "mouseout"), this._touchMoved || b(a, "click"), f = !1)
      };
      c._mouseInit = function() {
        this.element.bind({
          touchstart: a.proxy(this, "_touchStart"),
          touchmove: a.proxy(this, "_touchMove"),
          touchend: a.proxy(this, "_touchEnd")
        });
        d.call(this)
      };
      c._mouseDestroy = function() {
        this.element.unbind({
          touchstart: a.proxy(this,
            "_touchStart"),
          touchmove: a.proxy(this, "_touchMove"),
          touchend: a.proxy(this, "_touchEnd")
        });
        e.call(this)
      }
    }
  })(jQuery);
  navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
  window.AudioContext = window.AudioContext || window.webkitAudioContext;
  window.URL = window.URL || window.webkitURL;
  var TIME_SECOND = 1E3,
    TIME_MINUTE = 60 * TIME_SECOND,
    TIME_HOUR = 60 * TIME_MINUTE,
    TIME_DAY = 24 * TIME_HOUR,
    TIME_WEEK = 7 * TIME_DAY,
    TIME_MONTH = 30 * TIME_DAY,
    TIME_YEAR = 365 * TIME_DAY;

  function random(a, b) {
    return Math.floor(Math.random() * (b - a + 1) + a)
  }
  get_time = Date.now;
  max = Math.max;
  min = Math.min;
  abs = Math.abs;
  round = Math.round;
  floor = Math.floor;
  ceil = Math.ceil;
  window.console || (console = {
    log: function() {},
    info: function() {},
    warn: function() {},
    error: function() {}
  });
  log = console.log.bind(console);
  info = console.info.bind(console);
  warn = console.warn.bind(console);
  error = console.error.bind(console);
  dlog = function() {
    window.DEBUG && console.log.apply(console, arguments)
  };
  console.clear = void 0;
  try {
    Object.freeze(console)
  } catch (e$$17) {}

  function ParseQuery() {
    var a = {
      search: {},
      hash: {}
    };
    location.search && location.search.substr(1).split("&").forEach(function(b) {
      a.search[b.split("=")[0]] = decodeURIComponent(b.split("=")[1])
    });
    location.hash && location.hash.substr(1).split("&").forEach(function(b) {
      a.hash[b.split("=")[0]] = decodeURIComponent(b.split("=")[1])
    });
    return a
  }

  function RadToAngle(a) {
    return 180 * a / Math.PI
  }

  function AngleToRad(a) {
    return a * Math.PI / 180
  }

  function Vector(a, b) {
    this.ang = a;
    this.size = b;
    this.x = Math.cos(AngleToRad(a)) * b;
    this.y = -Math.sin(AngleToRad(a)) * b
  }

  function Dist2Points(a, b, c, d) {
    return Math.sqrt((c - a) * (c - a) + (d - b) * (d - b))
  }

  function Loop(a, b, c) {
    var d = setInterval(function() {
      a()
    }, 1E3 / b);
    setTimeout(function() {
      clearInterval(d)
    }, 1E3 * c)
  }

  function setCookie(a, b) {
    var c = new Date;
    c.setTime(c.getTime() + 31536E6);
    document.cookie = a + "=" + b + ";expires=" + c.toUTCString()
  }

  function getCookie(a) {
    return (a = document.cookie.match("(^|;) ?" + a + "=([^;]*)(;|$)")) ? a[2] : null
  }

  function deleteCookie(a) {
    document.cookie = a + "=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"
  }

  function Commatize(a) {
    return a.toString().replace(/(\d)(?=(\d{3})+$)/g, "$1,")
  }

  function ArrayRemove(a, b) {
    var c = a.indexOf(b); - 1 != c && a.splice(c, 1)
  }

  function ArrayUnique(a) {
    for (var b = [], c = a.length, d = 0; d < c; d++) {
      for (var e = d + 1; e < c; e++) a[d] === a[e] && (e = ++d);
      b.push(a[d])
    }
    return b
  }
  (function(a) {
    a.fn.outerHTML = function(b) {
      return b ? this.before(b).remove() : a("<p>").append(this.eq(0).clone()).html()
    }
  })(jQuery);

  function DoesFileExist(a, b, c) {
    var d = new Image;
    c && (d.onload = function() {
      c(!0)
    }, d.onerror = function() {
      c(!1)
    }, d.onabort = function() {
      c(!1)
    });
    b && (a += "?" + random(0, 99999999));
    d.src = a
  }
  text_filter = function(a, b) {
    var c, d, e, f = a.toLocaleLowerCase(),
      h = b.length,
      k;
    for (c = 0; c < h; c++)
      for (d = 0; - 1 != (e = f.indexOf(b[c], d));) k = b[c].length, d = [], d.length = k + 1, d = d.join("*"), a = a.slice(0, e) + d + a.slice(e + k), f = f.slice(0, e) + d + f.slice(e + k), d = e + k;
    return a
  };
  GetBackgroundImageUrl = function(a) {
    return $(a).css("background-image").slice(4, -1).replace(/"/g, "")
  };
  Object.freeze || (Object.freeze = function(a) {
    return a
  });
  "function" !== typeof Object.create && (Object.create = function(a) {
    function b() {}
    b.prototype = a;
    return new b
  });

  function EscapeHTML(a) {
    return ("" + a).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;")
  }

  function UnEscapeHTML(a) {
    return ("" + a).replace(/&amp;/g, "&").replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&quot;/g, '"').replace(/&#x27;/g, "'").replace(/&#x2F;/g, "/")
  }
  var g_fillString_cache = {};

  function fillString(a, b) {
    if (g_fillString_cache[a] && b <= g_fillString_cache[a].length) return g_fillString_cache[a].slice(0, b);
    var c = "",
      d;
    if (99999 < b) {
      var e = "",
        f = "";
      for (d = 0; 500 > d; d++) e += a;
      for (d = 0; 200 > d; d++) f += e;
      var h = 1E5,
        k = b % h,
        m;
      d = 0;
      for (m = b - k; d < m; d += h) c += f;
      for (d = 0; d < k; d++) c += a
    } else if (500 < b) {
      e = "";
      for (d = 0; 500 > d; d++) e += a;
      h = 500;
      k = b % h;
      d = 0;
      for (m = b - k; d < m; d += h) c += e;
      for (d = 0; d < k; d++) c += a
    } else
      for (d = 0; d < b; d++) c += a;
    return g_fillString_cache[a] = c
  }
  var g_t_start_time;
  t0 = function() {
    g_t_start_time = get_time()
  };
  t1 = function(a) {
    console.log(a ? a + ":" : "TIME:", get_time() - g_t_start_time)
  };

  function RandomString(a) {
    for (var b = "", c = 0; c < a; c++) b = 2 < c && " " != b[c - 1] && " " != b[c - 2] && 0 == random(0, 4) && c < a - 2 ? b + " " : b + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62 * Math.random()));
    return b
  }

  function shuffle(a) {
    for (var b, c, d = a.length; d; b = parseInt(Math.random() * d), c = a[--d], a[d] = a[b], a[b] = c);
    return a
  }
  window.localStorage || (window.localStorage = {});

  function SetValue(a, b) {
    window.localStorage ? (void 0 != b ? window.localStorage[a] = b : delete window.localStorage[a], deleteCookie(a)) : void 0 != b && 3E3 > b.toString().length ? setCookie(a, b) : deleteCookie(a)
  }

  function GetValue(a) {
    var b = getCookie(a);
    return window.localStorage ? b ? (window.localStorage[a] = b, deleteCookie(a), b) : window.localStorage[a] : getCookie(a)
  }

  function getSelected() {
    var a = "";
    window.getSelection ? a = window.getSelection() : document.getSelection ? a = document.getSelection() : document.selection && (a = document.selection.createRange().text);
    return a
  }

  function GetRandomElementFromArray(a) {
    if (a) return a[Math.floor(Math.random() * a.length)]
  }

  function GetURLParameter(a, b) {
    var c = RegExp("[?|&|#]" + b + "=(.*?)(&|#|$)").exec(a);
    return c ? decodeURIComponent(c[1]) : void 0
  }

  function SetClass(a, b, c) {
    "string" == typeof a && (a = $(a));
    c ? a.addClass(b) : a.removeClass(b)
  }
  var re_ReplaceNonPrintableUnicodeChars = /[\x00-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g;

  function ReplaceNonPrintableUnicodeChars(a, b) {
    return a.replace(re_ReplaceNonPrintableUnicodeChars, b)
  }

  function DragonFreeze(a) {
    var b = a.name;
    if (!b) {
      var c = a.toString().match(/^\n?function\s*([^\s(]+)/);
      c && 2 == c.length && (b = c[1])
    }
    if (b) {
      "Object" != b && Object.freeze(a.prototype);
      Object.freeze(a);
      window.dfz ? dfz++ : dfz = 1;
      var d = a,
        e = a.prototype,
        b = function() {
          a !== d && (a = d);
          window.rcp = myhash;
          a.prototype !== e && (a.prototype = e)
        };
      setTimeout(b, 100);
      setTimeout(b, 1E3);
      setTimeout(b, 1E4);
      setInterval(b, 1E5)
    } else Object.freeze(a)
  }

  function URLRandomizer(a) {
    a = a.toString().split("");
    for (var b = 0; b < a.length; b++)
      if ("/" == a[b] || 2 == random(1, 2)) a[b] = "%" + a[b].charCodeAt(0).toString(16);
    return a.join("")
  }

  function ArrayToObject(a, b) {
    var c, d = b.length,
      e = {};
    for (c = 0; c < d; c++) e[b[c]] = a[c];
    return e
  }

  function GetCloserToTargetValue(a, b, c) {
    return a < c ? a + b < c ? a + b : c : a - b > c ? a - b : c
  }

  function FixCORS(a) {
    return FixHTTPS(0 == a.indexOf("http") && -1 == a.indexOf("://i.imgur.com/") ? a.replace("//", "//cors-anywhere.herokuapp.com/") : a)
  }

  function FixHTTPS(a) {
    a && 0 == a.indexOf("http://i.imgur.com/") && (a = a.slice(5));
    return a
  }
  var _ttt = 23;
  if (23 != window._ttt) {
    var PIXI = window.PIXI;
    delete window.PIXI;
    var eval = window.eval;
    window.eval = function(a) {
      return a
    };
    window.eval.toString = function() {
      return "function eval() { [native code] }"
    }
  }

  function FixHTML(a) {
    return a.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
  }

  function dataURLToBlob(a) {
    if (-1 == a.indexOf(";base64,")) {
      var b = a.split(",");
      a = b[0].split(":")[1];
      b = decodeURIComponent(b[1]);
      return new Blob([b], {
        type: a
      })
    }
    b = a.split(";base64,");
    a = b[0].split(":")[1];
    for (var b = window.atob(b[1]), c = b.length, d = new Uint8Array(c), e = 0; e < c; ++e) d[e] = b.charCodeAt(e);
    return new Blob([d], {
      type: a
    })
  };
  var AUDIO_ARMOR_BLAST = 1,
    AUDIO_ARMOR_FIRE = 2,
    AUDIO_ICE_SHOOT = 5,
    AUDIO_ARMOR_FIRE2 = 6,
    AUDIO_ICE_BLAST = 7,
    AUDIO_ICE_FIRE = 8,
    AUDIO_ICE_BLAST2 = 9,
    AUDIO_ADUKA_FIRE = 10,
    AUDIO_ADUKA_FIRE2 = 11,
    AUDIO_BUTTON_SELECT = 12,
    AUDIO_MUSIC_CHANNEL = 13,
    AUDIO_MUSIC_ROOM = 14,
    AUDIO_MUSIC_STAGE7 = 15,
    AUDIO_MY_TURN = 16,
    AUDIO_TURN_TICK = 17,
    AUDIO_BUTTON_SELECT2 = 18,
    AUDIO_GOLD = 19,
    AUDIO_BIGFOOT_FIRE1 = 20,
    AUDIO_BIGFOOT_FIRE2 = 21,
    AUDIO_BIGFOOT_BLAST1 = 22,
    AUDIO_BIGFOOT_BLAST2 = 23,
    AUDIO_LIGHTNING_FIRE = 24,
    AUDIO_LIGHTNING_BLAST = 25,
    AUDIO_JD_FIRE = 26,
    AUDIO_JD_BLAST1 =
    27,
    AUDIO_JD_BLAST2 = 28,
    AUDIO_ASATE_FIRE = 29,
    AUDIO_KNIGHT_FIRE = 30,
    AUDIO_ASATE_KNIGHT_BLAST = 31,
    AUDIO_WIND = 32,
    AUDIO_WAIT = 33,
    AUDIO_GAME_START = 34,
    AUDIO_LOGIN = 35,
    AUDIO_BROKER = 36,
    AUDIO_NAK_FIRE1 = 37,
    AUDIO_NAK_FIRE2 = 38,
    AUDIO_NAK_BLAST1 = 39,
    AUDIO_NAK_BLAST2 = 40,
    AUDIO_DINO_FIRE = 41,
    AUDIO_DINO_BLAST = 42,
    AUDIO_DING = 43,
    AUDIO_MAGE_FIRE = 44,
    AUDIO_MAGE_BLAST = 45,
    AUDIO_TURTLE_FIRE = 46,
    AUDIO_TURTLE_BLAST = 47,
    AUDIO_MUSIC_STAGE1 = 48,
    AUDIO_MUSIC_STAGE2 = 49,
    AUDIO_MUSIC_STAGE3 = 50,
    AUDIO_MUSIC_STAGE4 = 51,
    AUDIO_MUSIC_STAGE5 = 52,
    AUDIO_MUSIC_STAGE6 =
    53,
    AUDIO_MUSIC_SUDDEN = 54,
    g_sound_files = [void 0, "11blast", "11fire", void 0, void 0, "12blast", "12fire", "111blast", "111fire", "112blast", "161fire", "162fire", "bpush1", "channel", "ready", "dbparty", "turn", "turnwa", "bselect1", "gold", "51fire", "52fire", "51blast", "52blast", "82fire", "82blast", "91fire", "91blast", "92blast", "10s1fire", "15s1fire", "10s1blast", "wind3", "wait", "start", "login", "broker", "31fire", "32fire", "31blast", "32blast", "42fire", "42blast", "ding", "21fire", "22blast", "121fire", "121blast", "stage1", "stage2",
      "stage3", "stage4", "stage5", "stage6", "sudden"
    ],
    g_music_numbers = [AUDIO_MUSIC_CHANNEL, AUDIO_MUSIC_ROOM, AUDIO_MUSIC_STAGE1, AUDIO_MUSIC_STAGE2, AUDIO_MUSIC_STAGE3, AUDIO_MUSIC_STAGE4, AUDIO_MUSIC_STAGE5, AUDIO_MUSIC_STAGE6, AUDIO_MUSIC_STAGE7, AUDIO_MUSIC_SUDDEN],
    g_audio_last_music_wanted_to_play, audio = void 0;

  function AudioInit() {
    audio = new DragonAudio;
    for (var a = [], b = [], c = 0; c < g_sound_files.length; c++)
      if (g_sound_files[c]) {
        var d = STATIC_DIR + "images/1/" + g_sound_files[c] + ".png"; - 1 != g_music_numbers.indexOf(c) ? b.push([c, d]) : a.push([c, d])
      }
    audio.LoadFiles(a, b, AUDIO_MUSIC_CHANNEL)
  }

  function AudioPlayInLoop(a, b) {
    audio.PlayMusic(a)
  }

  function AudioPlay(a, b) {
    audio.PlaySFX(a)
  }

  function AudioSetMusicVolume(a) {
    audio.SetMusicVolume(a)
  }

  function AudioSetSFXVolume(a) {
    audio.SetSfxVolume(a)
  };
  var myhash = 8325279,
    STATIC_DIR = "/static/",
    STATIC_DIR2 = STATIC_DIR,
    LOCATION_TYPE_UNKNOWN = 0,
    LOCATION_TYPE_CHANNEL = 1,
    LOCATION_TYPE_ROOM = 2,
    ROOM_TYPE_CHANNEL = 0,
    ROOM_TYPE_GAME = 1,
    ROOM_STATUS_WAITING = 0,
    ROOM_STATUS_FULL = 1,
    ROOM_STATUS_PLAYING = 2,
    GUI_LOCATION_CHANNEL = 1,
    GUI_LOCATION_ROOM = 2,
    GUI_LOCATION_GAME = 3,
    GUI_LOCATION_SHOP = 4,
    ITEM_NONE = -1,
    ITEM_DUAL = 0,
    ITEM_TELEPORT = 1,
    ITEM_CLASS = ["itemDual", "itemTeleport"],
    ITEM_SIZE = [2, 2],
    DIR_LEFT = 0,
    DIR_RIGHT = 1,
    PLAYER_LOOK_LEFT = DIR_LEFT,
    PLAYER_LOOK_RIGHT = DIR_RIGHT,
    SHOT1 = 0,
    SHOT2 =
    1,
    SHOTSS = 2,
    AVATAR_TYPE_HEAD = "h",
    AVATAR_TYPE_BODY = "b",
    AVATAR_TYPE_EYES = "g",
    AVATAR_TYPE_FLAG = "f",
    AVATAR_TYPE_BACKGROUND = "1",
    AVATAR_TYPE_FOREGROUND = "2",
    AVATAR_TYPE_EXITEM = "x",
    AVATAR_NAKED_HEAD_MALE = 1,
    AVATAR_NAKED_BODY_MALE = 2,
    AVATAR_NAKED_HEAD_FEMALE = 3,
    AVATAR_NAKED_BODY_FEMALE = 4,
    AVATAR_INDEX_N = 0,
    AVATAR_INDEX_TYPE = 1,
    AVATAR_INDEX_GENDER = 2,
    AVATAR_INDEX_NAME = 3,
    AVATAR_INDEX_SHOP = 4,
    AVATAR_INDEX_NOTE = 5,
    AVATAR_INDEX_GOLD_WEEK = 6,
    AVATAR_INDEX_GOLD_MONTH = 7,
    AVATAR_INDEX_GOLD_PERM = 8,
    AVATAR_INDEX_CASH_WEEK = 9,
    AVATAR_INDEX_CASH_MONTH =
    10,
    AVATAR_INDEX_CASH_PERM = 11,
    AVATAR_INDEX_STAT_POP = 12,
    AVATAR_INDEX_STAT_TIME = 13,
    AVATAR_INDEX_STAT_ATK = 14,
    AVATAR_INDEX_STAT_DEF = 15,
    AVATAR_INDEX_STAT_LIFE = 16,
    AVATAR_INDEX_STAT_ITEM = 17,
    AVATAR_INDEX_STAT_DIG = 18,
    AVATAR_INDEX_STAT_SHLD = 19,
    AVATAR_INDEX_GRAPHICS = 20,
    AVATAR_INDEX_GLOW = 21,
    AVATAR_INDEX_URL = 22,
    GAME_MODE_NORMAL = 0,
    GAME_MODE_BOSS = 1,
    GAME_MODE_SAME = 2,
    GAME_MODE_SCORE = 3,
    GAME_MODE_NAMES = ["NORMAL", "BOSS", "SAME", "SCORE"],
    GAME_MODE_NAMES_LOWER = ["Normal", "Boss", "Same", "Score"],
    GAME_MODES = GAME_MODE_NAMES.length,
    CHAT_TYPE_NORMAL = 0,
    CHAT_TYPE_DEAD = 2,
    CHAT_TYPE_GOLD = 3,
    CHAT_TYPE_POWER_USER = 4,
    CHAT_TYPE_GM = 5,
    CHAT_TYPE_SYSTEM = 6,
    CHAT_TYPE_BUGLE = 7,
    CHAT_TYPE_LOSE_LIFE = 8,
    CHAT_TYPE_GM_BUGLE = 9,
    CHAT_TYPE_NORMAL_TEAM = 10,
    CHAT_TYPE_POWER_USER_TEAM = 11,
    CHAT_TYPE_LOVE = 12,
    CHAT_TYPE_BREAK_UP = 13,
    CHAT_TYPE_AUDIO = 14,
    CHAT_TYPE_AUDIO_PU = 15,
    CHAT_TYPE_AUDIO_GM = 16,
    CHAT_TYPE_BOT = 17,
    CHAT_LENGTH_LIMIT = 150,
    GENDER_MALE = "m",
    GENDER_FEMALE = "f",
    GENDER_ALL = "a",
    TEAM_A = 0,
    TEAM_B = 1,
    TIE = 2,
    MS_IN_1_HOUR = 36E5,
    MS_IN_1_DAY = 24 * MS_IN_1_HOUR,
    PRO_GM_RANK = 26,
    GM_RANK = 27,
    ITEMS_RANK_LIMIT = {
      9002: 16
    },
    MOBILE = Object.freeze({
      ARMOR: 0,
      ICE: 1,
      ADUKA: 2,
      LIGHTNING: 3,
      BIGFOOT: 4,
      JD: 5,
      ASATE: 6,
      RANDOM: 7,
      KNIGHT: 8,
      FOX: 9,
      DRAGON: 10,
      NAK: 11,
      TRICO: 12,
      MAGE: 13,
      TURTLE: 14
    }),
    SELECTABLE_MOBILES = [MOBILE.ARMOR, MOBILE.ICE, MOBILE.ADUKA, MOBILE.LIGHTNING, MOBILE.BIGFOOT, MOBILE.JD, MOBILE.ASATE, MOBILE.RANDOM, MOBILE.NAK, MOBILE.TRICO, MOBILE.MAGE, MOBILE.TURTLE];

  function GetMobileAfter(a) {
    return SELECTABLE_MOBILES[(SELECTABLE_MOBILES.indexOf(a) + 1) % SELECTABLE_MOBILES.length]
  }
  var BULLETS = Object.freeze({
      ARMOR1: 0,
      ARMOR2: 1,
      ARMORSS: 2,
      ARMORSS2: 3,
      ICE1: 4,
      ICE2: 5,
      ICESS: 6,
      ADUKA1_THOR: 7,
      ADUKA2: 8,
      ADUKASS: 9,
      TELEPORT: 10,
      LIGHTNING12: 11,
      LIGHTNINGSS: 12,
      BIGFOOT1: 13,
      BIGFOOT2: 14,
      BIGFOOTSS: 15,
      JD1: 16,
      JD2: 17,
      JDSS: 18,
      ASATE1: 19,
      ASATE2: 20,
      ASATESS: 21,
      ASATEION: 22,
      KNIGHT1: 23,
      KNIGHT2: 24,
      KNIGHTSS: 25,
      KNIGHTION: 26,
      TEST: 27,
      FOX1: 28,
      FOX2: 29,
      FOXSS: 30,
      DRAGON1: 31,
      DRAGON2: 32,
      DRAGONSS: 33,
      NAK1: 34,
      NAK2: 35,
      NAK2UG: 36,
      NAKSS: 37,
      TRICO1: 38,
      TRICO2: 39,
      TRICOSS: 40,
      MAGE1: 41,
      MAGE2A: 42,
      MAGE2B: 43,
      MAGESS: 44,
      TURTLE1: 45,
      TURTLE2A: 46,
      TURTLE2B: 47,
      TURTLESS: 48,
      TURTLESS2: 49
    }),
    EXPLODE = Object.freeze({
      ARMOR1: 0,
      ARMOR2: 1,
      ARMORSS: 2,
      ICE1: 3,
      ICE2: 4,
      ICESS: 5,
      ADUKA1_THOR: 6,
      TELEPORT: 7,
      LIGHTINING12_JD1: 8,
      LIGHTNINGSS: 9,
      BIGFOOT1SS: 10,
      BIGFOOT2: 11,
      JD2: 12,
      JDSS: 13,
      ASATE1: 14,
      ASATE2: 15,
      ASATESS: 16,
      KNIGHT: 17,
      TEST: 18,
      FOX1: 19,
      FOX2: 20,
      FOXSS: 21,
      DRAGON1: 22,
      DRAGON2: 23,
      DRAGONSS: 24,
      NAK1: 25,
      NAK2: 26,
      NAKSS: 27,
      TRICO1: 28,
      TRICO2: 29,
      TRICOSS: 30,
      MAGE1: 31,
      MAGE2: 32,
      MAGESS: 33,
      TURTLE1: 34,
      TURTLE2: 35,
      TURTLESS: 36,
      TURTLESS2: 37
    }),
    MOBILES = [],
    EXPLODES = [],
    BULLET = [];

  function InitGlobals() {


  function Graphics2(a) {
    var b = 0,
      c = [],
      d, e, f = a.length;
    for (e = 0; e < f; e++) d = a[e], c[e] = {
      x: b,
      y: 0,
      w: d[0],
      h: d[1],
      cx: d[2],
      cy: d[3],
      css: {
        "background-position": -b + "px 0",
        width: d[0],
        height: d[1],
        "margin-left": -d[2],
        "margin-top": -d[3]
      }
    }, b += d[0] + 1;
    return c
  }

  var MAP_BACKGROUND_W = 1E3,
    MAP_BACKGROUND_H = 1E3,
    RENDERER_DOM = 0,
    RENDERER_CANVAS = 1,
    RENDERER_WEBGL = 2,
    RENDERER_NAME = ["DOM", "Canvas", "WebGL"],
    MIN_GOOD_FPS = 30,
    FB_APP_ID = "154795011315451",
    FB_API_VERSION = "v2.2",
    FB_PERMISSIONS = "public_profile,email,user_friends,user_birthday";
  var g_is_firefox = -1 != navigator.userAgent.indexOf("Firefox");

  function DragonAudio() {
    this.sounds = {};
    this.musics = {};
    this.playing_music_name = this.music = void 0;
    this.Init()
  }
  DragonAudio.prototype.LoadFiles = function(a, b, c) {
    for (var d = 0; d < a.length; d++) this.LoadSFX(a[d][0], a[d][1]);
    for (d = 0; d < b.length; d++) this.SetMusic(b[d][0], b[d][1]);
    void 0 != c && this.PlayMusic(c)
  };
  DragonAudio.prototype.Init = function() {
    this.sfx_volume = void 0 != localStorage.sfx_volume && 0 <= localStorage.sfx_volume && 100 >= localStorage.sfx_volume ? Number(localStorage.sfx_volume) : 50;
    this.music_volume = void 0 != localStorage.music_volume && 0 <= localStorage.music_volume && 100 >= localStorage.music_volume ? Number(localStorage.music_volume) : 50;
    if (!g_is_firefox) try {
      window.AudioContext = window.AudioContext || window.webkitAudioContext, this.context = new AudioContext, this.is_webaudio_supported = !0, this.gainNode = this.context.createGain(),
        this.gainNode.connect(this.context.destination), this.gainNode.gain.value = this.sfx_volume / 100
    } catch (a) {}
  };
  DragonAudio.prototype.LoadSFX = function(a, b) {
    var c = this,
      d = new XMLHttpRequest;
    d.open("GET", b, !0);
    d.overrideMimeType && d.overrideMimeType("audio/mpeg");
    var e = {
      url: b
    };
    c.sounds[a] = e;
    if (this.is_webaudio_supported) d.responseType = "arraybuffer", d.onload = function() {
      c.context.decodeAudioData(d.response, function(b) {
        e.data = b;
        e.onload_play && (delete e.onload_play, c.PlaySFX(a))
      }, function(a) {
        console.error("[DragonAudio.LoadSFX] Error:", a)
      })
    };
    else {
      if (!window.URL) return warn('"URL" not supported in this browser');
      if (!window.Audio) return warn('"Audio" not supported in this browser');
      d.responseType = "blob";
      d.onload = function() {
        var b = d.response;
        e.blob = b;
        e.data = URL.createObjectURL(b);
        e.onload_play && (delete e.onload_play, c.PlaySFX(a))
      }
    }
    d.send()
  };
  DragonAudio.prototype.PlaySFX = function(a) {
    var b = this.sounds[a];
    if (!b) return console.error("[DragonAudio.PlaySFX] Sound not found:", a);
    if (0 != this.sfx_volume) {
      if (!b.data) return b.onload_play = !0;
      this.is_webaudio_supported ? (a = this.context.createBufferSource(), a.buffer = b.data, a.connect(this.gainNode), a.start(0)) : (b = new Audio(b.data), b.volume = this.sfx_volume / 100, b.play())
    }
  };
  DragonAudio.prototype.SetSfxVolume = function(a) {
    0 > a || 100 < a || (this.sfx_volume = a = Math.round(a), localStorage.sfx_volume = a, this.is_webaudio_supported && (this.gainNode.gain.value = a / 100))
  };
  DragonAudio.prototype.SetMusic = function(a, b) {
    this.musics[a] = {
      url: b
    }
  };
  DragonAudio.prototype.PlayMusic = function(a) {
    if (!window.Audio) return warn('"Audio" not supported in this browser');
    var b = this.musics[a];
    if (!b) return console.error("[DragonAudio.PlayMusic] Music name not found (use SetMusic):", a);
    var c = b.url;
    this.music && (this.PauseMusic(), delete this.music);
    this.playing_music_name = a;
    if (this.music_volume) {
      if (!b.audio) {
        if (g_is_firefox || "dev" == SERVER_TYPE) {
          if (!b.is_downloading) {
            b.is_downloading = !0;
            if (!window.URL) {
              warn('"URL" not supported in this browser');
              return
            }
            var d =
              new XMLHttpRequest,
              e = this;
            d.open("GET", c, !0);
            d.overrideMimeType && d.overrideMimeType("audio/mpeg");
            d.responseType = "blob";
            d.onload = function() {
              b.audio = new Audio(URL.createObjectURL(d.response));
              delete b.is_downloading;
              e.PlayMusicHelper(b.audio)
            };
            d.send()
          }
          return
        }
        b.audio = new Audio(c)
      }
      this.PlayMusicHelper(b.audio)
    }
  };
  DragonAudio.prototype.PlayMusicHelper = function(a) {
    a = this.music = a;
    a.currentTime && (a.pause(), a.currentTime = 0);
    a.volume = this.music_volume / 100;
    a.loop = !0;
    a.play()
  };
  DragonAudio.prototype.SetMusicVolume = function(a) {
    0 <= a && 100 >= a && (this.music_volume = a = Math.round(a), localStorage.music_volume = a, this.music ? (this.music.volume = a / 100, 0 == a ? this.PauseMusic() : this.UnPauseMusic()) : this.playing_music_name && this.PlayMusic(this.playing_music_name))
  };
  DragonAudio.prototype.PauseMusic = function() {
    this.music && this.music.pause()
  };
  DragonAudio.prototype.UnPauseMusic = function() {
    this.music && this.music.play()
  };
  var SERVER_TYPE = GetServerType(),
    DEBUG = "dev" == SERVER_TYPE,
    debug = DEBUG,
    query = ParseQuery(),
    QUICK_JOIN;
  if (location.hash) {
    var loc = /#server-([0-9]+)\/room-([0-9]+)\/password-(.+)/.exec(location.hash);
    loc ? QUICK_JOIN = {
      server: Number(loc[1]),
      room: Number(loc[2]),
      password: decodeURIComponent(loc[3])
    } : (loc = /#server-([0-9]+)\/room-([0-9]+)/.exec(location.hash)) ? QUICK_JOIN = {
      server: Number(loc[1]),
      room: Number(loc[2])
    } : (loc = /#server-([0-9]+)/.exec(location.hash)) && (QUICK_JOIN = {
      server: Number(loc[1])
    })
  }
  var POWER_USER_BACKGROUND, POWER_USER_EXITEM, g_graphics_high = !0,
    g_items = [ITEM_DUAL, ITEM_NONE, ITEM_DUAL, ITEM_NONE, ITEM_TELEPORT, ITEM_NONE],
    g_auto_ready_timer, g_ranking_offset = 0,
    g_is_ranking_loading = !1,
    g_is_show_ranking = !0,
    g_shop_player, g_channel_player, g_current_buy_avatar_index, g_current_shop_type, g_current_shop_page, g_bot_select_for_slot, g_is_ranking_loaded = !1,
    l, g_is_mobile_device, g_is_installed_app = !!query.search.app,
    g_is_facebook_canvas = !!query.search.fb,
    g_is_my_domain = "dragonbound.net" == location.host;
  auto_start = void 0;
  var OPTIONS = {
    explodes: 0 != GetValue("explodes"),
    killmsg: 0 != GetValue("killmsg"),
    background: 0 != GetValue("background"),
    anim: 0 != GetValue("anim"),
    vortex: 1 == GetValue("vortex"),
    countries: 0 != GetValue("countries"),
    gameendcounter: 0 != GetValue("gameendcounter"),
    camfollowbullets: 0 != GetValue("camfollowbullets"),
    slice: 0 != GetValue("slice"),
    music: 0 != GetValue("music"),
    effects: 0 != GetValue("effects"),
    sfx_volume: GetValue("sfx_volume"),
    music_volume: GetValue("music_volume")
  };
  OPTIONS.sfx_volume = void 0 == OPTIONS.sfx_volume ? OPTIONS.effects ? 50 : 0 : Number(OPTIONS.sfx_volume);
  OPTIONS.music_volume = void 0 == OPTIONS.music_volume ? OPTIONS.music ? 50 : 0 : Number(OPTIONS.music_volume);
  var g_is_game_background = OPTIONS.background,
    g_is_game_slice = OPTIONS.slice;
  void 0 == localStorage.fps && (localStorage.fps = 0);
  OPTIONS.camfollowbullets = !1;
  var g_renderer;
  $(document).ajaxSend(function(a, b, c) {
    if (a = !/^(GET|HEAD|OPTIONS|TRACE)$/.test(c.type)) {
      c = c.url;
      a = "//" + document.location.host;
      var d = document.location.protocol + a;
      a = c == d || c.slice(0, d.length + 1) == d + "/" || c == a || c.slice(0, a.length + 1) == a + "/" || !/^(\/\/|http:|https:).*/.test(c)
    }
    a && b.setRequestHeader("X-CSRFToken", getCookie("csrftoken"))
  });
  var g_draggable_z_index = 1001;
  $.prototype.draggable2 = function() {
    var a = this,
      b = !1,
      c = !1,
      d, e, f, h;
    a.css("z-index", g_draggable_z_index += 1);
    this.mousedown(function(c) {
      b = !0;
      d = c.pageX;
      e = c.pageY;
      c = a.offset();
      f = c.left;
      h = c.top;
      a.css("z-index", g_draggable_z_index += 1)
    });
    $(document).mousemove(function(k) {
      b && !c && (5 < Math.abs(k.pageX - d) || 5 < Math.abs(k.pageY - e)) && (c = !0);
      c && a.css({
        left: f + (k.pageX - d) + "px",
        top: h + (k.pageY - e) + "px"
      })
    });
    $(document).mouseup(function() {
      c = b = !1
    });
    return this
  };

  function onUpdateReady() {
    $("#channelScreen").is(":visible") ? location.reload() : DragonDialogOpen(l.t("Update Available!"), l.t("A newer version is available, refresh?"), DIALOG_BUTTONS_OK_CANCEL, function(a) {
      a && location.reload()
    })
  }

  function DragonUpdater() {
    if (window.applicationCache) {
      var a = window.applicationCache,
        b = $("#updater");
      a.status === a.UPDATEREADY ? (b.html("Update Available!").slideDown(), onUpdateReady()) : (a.addEventListener("checking", function() {
        b.html("Checking for updates...").slideDown()
      }, !1), a.addEventListener("noupdate", function() {
        b.html("At Latest Version!").slideUp()
      }, !1), a.addEventListener("obsolete", function() {
        DEBUG && console.log("** applicationCache EVENT:", "obsolete");
        b.html("Obsolete!").slideUp()
      }, !1), a.addEventListener("error",
        function(a) {
          DEBUG && console.log("** applicationCache EVENT:", "error", a);
          b.html("Failed!").slideUp();
          a.url && -1 != a.url.indexOf(".js") && (alertify.alert("Update Failed<br><br>An update is available but could not be downloaded, please F5 (refresh) to try again."), setTimeout(function() {
            location.reload()
          }, 2E4))
        }, !1), a.addEventListener("cached", function() {
        DEBUG && console.log("** applicationCache EVENT:", "cached");
        b.html("Downloaded!").slideUp()
      }, !1), a.addEventListener("downloading", function() {
        DEBUG && console.log("** applicationCache EVENT:",
          "downloading");
        b.html("Downloading Updates...")
      }, !1), a.addEventListener("progress", function(a) {
        a = void 0 != a.loaded && void 0 != a.total ? Math.round(100 * a.loaded / a.total) + "%" : ["\\", "/", "-", "|"][random(0, 3)];
        b.html("Downloading Updates... " + a)
      }, !1), a.addEventListener("updateready", function() {
        DEBUG && console.log("** applicationCache EVENT:", "updateready");
        b.html("Update Available!");
        onUpdateReady()
      }), setInterval(function() {
        a.update()
      }, 144E5 + random(0, 18E5)))
    }
  }

  function LoadTwitter() {
    var a = document,
      b = a.getElementsByTagName("script")[0];
    a.getElementById("twitter-wjs") || (a = a.createElement("script"), a.id = "twitter-wjs", a.async = !0, a.src = "https://platform.twitter.com/widgets.js", b.parentNode.insertBefore(a, b))
  }

  function LoadGooglePlus() {
    var a = document.createElement("script");
    a.async = !0;
    a.src = "https://apis.google.com/js/plusone.js";
    var b = document.getElementsByTagName("script")[0];
    b.parentNode.insertBefore(a, b)
  }

  function LoadGoogleAnalytics() {
    (function(a, b, c, d, e, f, h) {
      a.GoogleAnalyticsObject = e;
      a[e] = a[e] || function() {
        (a[e].q = a[e].q || []).push(arguments)
      };
      a[e].l = 1 * new Date;
      f = b.createElement(c);
      h = b.getElementsByTagName(c)[0];
      f.async = 1;
      f.src = d;
      h.parentNode.insertBefore(f, h)
    })(window, document, "script", "https://www.google-analytics.com/analytics.js", "ga");
    ga("create", "UA-33394735-1", "auto");
    ga("send", "pageview")
  }

  function DetectBrowser() {
    var a = -1 != navigator.userAgent.indexOf("MSIE "),
      b = -1 != navigator.userAgent.indexOf("Trident/") || a,
      c = $("body");
    c.addClass(b ? "ie" : "non-ie");
    a && (c.prepend("You are using an old version of Internet Explorer. Please upgrade to IE11+ or use Chrome."), alertify.alert("You are using an old version of Internet Explorer. Please upgrade to IE11+ or use Chrome."))
  }
  $(function() {
    rndDiv = $("#BrokerChannel0");
    document.addEventListener("mouseenter", function() {
      ck()
    }, !1);
    ck();
    var a = get_time();
    localStorage.renderer != RENDERER_WEBGL && localStorage.renderer != RENDERER_CANVAS || void 0 == localStorage.renderer_t || localStorage.renderer_t < a - 7 * TIME_DAY || localStorage.renderer_t > a ? setTimeout(function() {
      $("#Loading .wrapper").remove();
      SpeedTest(function(a, c) {
        localStorage.renderer = localStorage.e7 = g_renderer = a;
        localStorage.renderer_t = localStorage.m9 = Date.now();
        Main()
      })
    }, 150) : (a = localStorage.renderer,
      g_renderer = a == RENDERER_WEBGL || a == RENDERER_CANVAS ? Number(a) : RENDERER_DOM, Main())
  });

  function AddAds() {
    $("#ad1").html('<ins class="adsbygoogle" style="display:inline-block;width:234px;height:60px" data-ad-client="ca-pub-8879206577023168" data-ad-slot="1919095739"></ins>');
    $("#ad2").html('<ins class="adsbygoogle" style="display:inline-block;width:180px;height:150px" data-ad-client="ca-pub-8879206577023168" data-ad-slot="2558224131"></ins>');
    var a = document.createElement("script");
    a.async = !0;
    a.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";
    var b = document.getElementsByTagName("script")[0];
    b.parentNode.insertBefore(a, b);
    (adsbygoogle = window.adsbygoogle || []).push({});
    (adsbygoogle = window.adsbygoogle || []).push({})
  }

  function Main() {
    DetectBrowser();
    $(document).bind("contextmenu", function(a) {
      return !1
    });
    $(document).bind("dragstart", function(a) {
      return !(a.srcElement && "img" == a.srcElement.localName)
    });
    $("body").bind("keydown", function(a) {
      a.which != KEY.Backspace || $(document.activeElement).is("input") || $(document.activeElement).is("textarea") || (a.preventDefault(), a.stopPropagation())
    });
    DragonUpdater();
    $(".Tip").tipsy({
      fade: !0,
      gravity: "s"
    });
    $(".TipN").tipsy({
      fade: !0,
      gravity: "n"
    });
    l = new DragonLanguage(STRINGS, GetValue("lang"));
    l.SetAll();
    if (void 0 == localStorage.lobby_channel || "0" == localStorage.lobby_channel) localStorage.lobby_channel = Number(l.GetCurrentLangNumber()) + 1;
    g_is_show_ranking = !0;
    var a = navigator.userAgent;
    a.match(/(iPhone|iPod|blackberry|android|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i) && (g_graphics_high = !1, window.scrollTo(0, 1),
      g_is_show_ranking = !1, g_is_mobile_device = !0, OPTIONS.vortex = !1);
    a.match(/(Windows|MacOS|Mac OS|UNIX|Linux)/i) || $("#touch_ui").show();
    750 > window.innerWidth && (g_is_show_ranking = !1);
    g_is_show_ranking && ($("#buttonRanking").addClass("open"), g_is_facebook_canvas || setTimeout(function() {
      AddAds()
    }, 500));
    navigator.userAgent.match(/Trident\/7\./) && ($("body").addClass("if-ie"), g_is_ie = !0);
    var b = new DragonNetwork;
    b.dl = l;
    Hotkeys(b);
    DragonTheme_Init();
    AudioInit();
    ChannelGUI(b);
    RankingGUI(b);
    RoomGUI(b);
    GameGUI(b);
    ShopGUI(b);
    DragonDesigner_Init();
    ResellersGUI(b);
    for (a = 0; a < AVATARS.length; a++) AVATARS[a] && 3E3 == AVATARS[a][0] ? POWER_USER_BACKGROUND = a : AVATARS[a] && 9E3 == AVATARS[a][0] && (POWER_USER_EXITEM = a);
    $("#dialogCreateRoom").draggable2();
    $("#OptionsDialog").draggable();
    var c = !1,
      d = $("#FullScreenButton"),
      e = $("body")[0],
      f = window.chrome && e.webkitRequestFullScreen;
    $("body").keydown(function(a) {
      if (a.which == KEY.Enter) "INPUT" != a.target.tagName && (0 < $("#alertify-ok").length && !$("#alertify").hasClass("alertify-hidden") ? $("#alertify-ok")[0].click() :
        $("#OptionsOK").is(":visible") ? $("#OptionsOK").click() : $("#DragonDialogOK").is(":visible") ? $("#DragonDialogOK").click() : b.location == GUI_LOCATION_CHANNEL ? $("#display_name").is(":visible") ? $("#display_name").focus() : $("#dialogCreateRoom").is(":visible") ? $("#createRoomTitle").focus() : $("#dialog_join_room_div").is(":visible") ? $("#join_room_input").focus() : $("#channelInput").focus() : b.location == GUI_LOCATION_ROOM ? $("#dialog_room_options").is(":visible") ? $("#RoomOptionsOK").click() : $("#roomInput").focus() :
        b.location == GUI_LOCATION_GAME && $("#gameInput").focus(), a.stopPropagation(), a.preventDefault());
      else {
        if (a.which == KEY.Esc) {
          for (var c = $("#chat_divs").children(), e = 0, n, p = 0; p < c.length; p++) {
            var q = c.eq(p),
              r = q.css("z-index");
            r > e && (e = r, n = q)
          }
          if (n) return n.children(".chatDialogClose").click();
          if ($("#chargeWindowClose").is(":visible")) return $("#chargeWindowClose").click();
          if ($("#CancelWaiting").is(":visible")) return $("#CancelWaiting").click();
          if ($("#roomMobileSelectCancel").is(":visible")) return $("#roomMobileSelectCancel").click();
          if ($("#DragonDialogCancel").is(":visible")) return a.stopPropagation(), $("#DragonDialogCancel").click();
          if ($("#dialogCreateRoom").is(":visible")) return $("#dialogCreateRoomButtonCancel").click();
          if ($("#dialog_join_room_div").is(":visible")) return $("#dialog_join_room_cancel").click();
          if ($("#dialog_room_options").is(":visible")) return $("#RoomOptionsCancel").click();
          if ($("#buy_cancel_btn").is(":visible")) return $("#buy_cancel_btn").click();
          if ($("#dialog_change_name_cancel").is(":visible")) return $("#dialog_change_name_cancel").click()
        } else a.which ==
          KEY.F1 && (a.preventDefault(), f && d.hide());
        if (b.game) return b.game.OnKeyDown(a)
      }
    });
    f && ($(document).bind("fullscreenchange webkitfullscreenchange mozfullscreenchange", function() {
      (c = document.fullscreen || document.webkitIsFullScreen || document.mozFullScreen) ? (d.hide(), ChangeRankingsViewState(!1)) : (d.show(), ChangeRankingsViewState(!0))
    }), d.show().click(function() {
      e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)
    }));
    document.onhelp = function() {
      return !1
    };
    window.onhelp = function() {
      return !1
    };
    $("#container, .NoSelect").bind("selectstart",
      function(a) {
        a.stopPropagation();
        return !1
      });
    $(".CanSelect").bind("selectstart", function(a) {
      a.stopPropagation();
      return !0
    });
    OPTIONS.background ? $("#map_bg").show() : $("#map_bg").hide();
    ResizeInit();
    $("#help_btn").click(function(a) {
      $("#howtoplay").toggle("slow");
      a.stopPropagation()
    });
    $("#howtoplayClose").click(function(a) {
      $("#howtoplay").hide("slow");
      a.stopPropagation()
    });
    setInterval(function() {
      $(".pls-container").parent().hide()
    }, 2E3);
    b.dragonLogin = new DragonLogin(b);
    $("#BrokerLogout").click(function() {
      b.dragonLogin.Logout()
    });
    window.onbeforeunload = function() {
      if (b.game && b.location == GUI_LOCATION_GAME) return "You are in a game."
    };
    InitShare();
    FixLogin(b);
    InitSlider();
    b.c = 0;
    setInterval(function() {
      b.c += 2
    }, 2E3);
    LoadGoogleAnalytics();
    g_is_facebook_canvas ? $("#Tweeter,#GooglePlus").hide() : setTimeout(function() {
      LoadTwitter();
      LoadGooglePlus()
    }, 7E3);
    setTimeout(function() {
      $(".hhh").hide()
    }, 67E3);
    $("#DragonThemeDialog").parent().bind("mousedown touchstart click", function(a) {
      a.stopPropagation()
    });
    $("#iframe1").attr("src", "https://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fzotata&height=62&colorscheme=dark&show_faces=false&header=false&stream=false&show_border=false");
    $("#iframe2").attr("src", "https://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fdragonbound.net.game&height=62&colorscheme=dark&show_faces=false&header=false&stream=false&show_border=false")
  }
  var rndDiv, rnd = random(1, 9999999);
  rndsys = rnd;

  function ck() {
    if (rndsys != rnd || rndDiv && 0 == rndDiv.closest("html").length || window.myhash && 0 != location.host.indexOf("t.") || $(".BrokerChannelName > a").length) delete window.onbeforeunload, location.href = "/anticheat"
  }

  function FixLogin(a) {
    0 != location.host.indexOf("t.") && setInterval(function() {
      a.user_id && a.user_id != GetValue("y") && (g_dont_show_disconnect_window = !0, this.ds && this.ds.Disconnect(), window.onbeforeunload = void 0, DragonDialogOpen("Multiple Account Login Detected", l.t("You've logged into another account on the same computer.<br>Press [OK] to refresh the page and change account, or relog back to this account."), DIALOG_BUTTONS_OK, function() {
        location.reload()
      }, [35, 52]), setTimeout(function() {
          location.reload()
        },
        1E5))
    }, 3E4)
  }

  function SetVolumeSFX(a) {
    var b = $("#slidersection1 .volume");
    0 >= a ? b.css("background-position", "0 0") : 25 >= a ? b.css("background-position", "0 -25px") : 50 >= a ? b.css("background-position", "0 -50px") : 75 >= a ? b.css("background-position", "0 -75px") : b.css("background-position", "0 -100px");
    OPTIONS.sfx_volume = a;
    AudioSetSFXVolume(a)
  }

  function SetVolumeMusic(a) {
    var b = $("#slidersection2 .volume");
    0 >= a ? b.css("background-position", "0 0") : 25 >= a ? b.css("background-position", "0 -25px") : 50 >= a ? b.css("background-position", "0 -50px") : 75 >= a ? b.css("background-position", "0 -75px") : b.css("background-position", "0 -100px");
    OPTIONS.music_volume = a;
    AudioSetMusicVolume(a)
  }

  function InitSlider() {
    var a = $("#slidersection1 .slider"),
      b = $("#slidersection2 .slider"),
      c = $("#slidersection1 .tooltip"),
      d = $("#slidersection2 .tooltip"),
      e = $("#slidersection1 .volume"),
      f = $("#slidersection2 .volume");
    c.hide();
    d.hide();
    a.slider({
      range: "min",
      min: 0,
      max: 100,
      value: OPTIONS.sfx_volume,
      start: function(b, d) {
        c.fadeIn("fast");
        b.stopPropagation();
        var e = a.slider("value");
        c.css("left", e).text(d.value)
      },
      slide: function(a, b) {
        a.stopPropagation();
        var d = b.value;
        c.css("left", d).text(b.value);
        SetVolumeSFX(d)
      },
      stop: function(a, b) {
        a.stopPropagation();
        c.fadeOut("fast");
        AudioPlay(AUDIO_BUTTON_SELECT2)
      }
    });
    b.slider({
      range: "min",
      min: 0,
      max: 100,
      value: OPTIONS.music_volume,
      start: function(a, c) {
        d.fadeIn("fast");
        a.stopPropagation();
        var e = b.slider("value");
        d.css("left", e).text(c.value)
      },
      slide: function(a, b) {
        a.stopPropagation();
        var c = b.value;
        d.css("left", c).text(b.value);
        SetVolumeMusic(c)
      },
      stop: function(a, b) {
        a.stopPropagation();
        d.fadeOut("fast")
      }
    });
    var h = 50,
      k = 50;
    e.click(function(b) {
      b.stopPropagation();
      (b = a.slider("value")) ?
      (h = b, a.slider("value", 0), SetVolumeSFX(0)) : (a.slider("value", h), SetVolumeSFX(h), AudioPlay(AUDIO_BUTTON_SELECT2))
    });
    f.click(function(a) {
      a.stopPropagation();
      (a = b.slider("value")) ? (k = a, b.slider("value", 0), SetVolumeMusic(0)) : (b.slider("value", k), SetVolumeMusic(k))
    });
    SetVolumeSFX(OPTIONS.sfx_volume);
    SetVolumeMusic(OPTIONS.music_volume)
  }

  function InitShare() {
    $("#ShareURL").bind("focus select keydown click mousedown mouseup", function(a) {
      getSelected().toString() || this.select();
      var b = this;
      setTimeout(function() {
        getSelected().toString() || b.select()
      }, 10)
    });
    $(".ShareButton").tipsy({
      gravity: "s"
    });
    $("#ShareWindowClose").click(function() {
      $("#ShareWindow").hide("fast")
    })
  }

  function GameShare(a, b, c, d, e) {
    a = c[2];
    var f = c[3],
      h = c[9],
      k = c[11],
      m = 0;
    c = [];
    var n = [],
      p = [],
      q = [],
      r = "?",
      s = 0;
    DEBUG && console.log("my_user_id", d, ", won", h);
    for (var t = 0; t < k.length; t++) {
      var w = k[t],
        v = w[2],
        u = w[1];
      w[0] % 2 == h ? (m++, c.push(v), d == u ? r = "win" : n.push(v)) : (p.push(v), d == u ? r = "lose" : n.push(v));
      s++
    }
    var x;
    x = "win" == r ? e + " " + l.t("won") + " " + p.toString() : "lose" == r ? q.length ? e + " " + l.t("played with") + " " + q.toString() : e + " " + l.t("played with") + " " + c.toString() : e + " " + l.t("saw a game") + ": " + c.toString() + " - " + p.toString();
    d = 3 > s ? 1 : 5 > s ? 2 : 7 > s ? 3 : 4;
    var y = l.t("Server") + " " + a + " - " + l.t("Room") + " " + f + " <center></center>" + l.t("Win") + ": " + c.toString() + " <center></center>" + l.t("Lose") + ": " + p.toString(),
      A = "http://dragonbound.net/static/images/icon_endgame" + d + "v" + d + ".png",
      z = location.protocol + "//" + location.host + "/z/" + b;
    $("#ShareURL").val(z).focus();
    $("#ShareToFacebook").unbind("click").click(function() {
      FacebookShare(z, A, "www.DragonBound.net", x, y, function(a) {
        a ? (alertify.log("Share posted"), $("#ShareWindow").hide()) : alertify.log("Share canceled")
      })
    });
    $("#ShareToTwitter").unbind("click").click(function() {
      window.open("https://twitter.com/share?text=" + encodeURIComponent(x + " www.DragonBound.net") + "&url=" + encodeURIComponent(z), "_blank")
    });
    $("#ShareToGoogle").unbind("click").click(function() {
      window.open("https://plus.google.com/share?url=" + encodeURIComponent(x + " www.DragonBound.net") + "&url=" + encodeURIComponent(z), "_blank")
    });
    $("#ShareToEmail").unbind("click").click(function() {
      window.open("mailto:?subject=" + encodeURIComponent(x + " www.DragonBound.net") +
        "&body=" + encodeURIComponent(z), "_blank")
    });
    $("#ShareToClipboard").unbind("click").click(function() {
      $("#ShareURL").select().focus();
      alertify.log("Press Ctrl+C to Copy")
    });
    $("#ShareToNewTab").unbind("click").click(function() {
      window.open(z, "_blank")
    });
    $("#ShareWindow").show("fast");
    info("[Game Share Link]", z)
  }

  function UpdateSliceDragGUI() {
    g_is_game_slice ? $("#slice_drag_button").removeClass("drag") : $("#slice_drag_button").addClass("drag")
  }(function() {
    top == self || g_is_facebook_canvas || (top.location = self.location)
  })();
  DEBUG || (alert = void 0);

  function ExplodeDialog(a, b) {
    if (g_graphics_high && !b) {
      var c = $("#" + a + " .AlertBox");
      0 < c.length ? (c.effect("explode"), $("#" + a).fadeOut()) : $("#" + a).effect("explode")
    } else $("#" + a).hide()
  }

  function FadeInDialog(a) {
    g_graphics_high ? ($("#" + a + " .AlertBox").fadeIn(), $("#" + a).fadeIn()) : $("#" + a).show()
  }

  function ToggleOptionsDialog(a) {
    $("#OptionsDialog").is(":visible") ? ExplodeDialog("OptionsDialog") : (PrepareOptionsDialog(a), FadeInDialog("OptionsDialog"))
  }

  function AddToChatInput(a) {
    if ("" != a) {
      var b = $("#roomInput").val();
      b.length + a.length > CHAT_LENGTH_LIMIT || ($("#roomInput").focus(), $("#roomInput").val(b + a))
    }
  }

  function Smiley(a) {
    return '<img class="emo" src="/static/images/emo/' + a + '.png">'
  }

  function TextToEmo(a) {
    return ("" + a).replace(/(:\)|\(:)/g, Smiley("smile")).replace(/(\):|:\()/g, Smiley("sad")).replace(/:D/g, Smiley("laugh")).replace(/:P/g, Smiley("lick")).replace(/:\$/g, Smiley("money")).replace(/(:\*|\*:)/g, Smiley("kiss")).replace(/&lt;3/g, Smiley("heart")).replace(/&lt;\/3/g, Smiley("broken_heart")).replace(/(:O|O:)/g, Smiley("surprised")).replace(/([^pPsS]|^):\//g, Smiley("undecided")).replace(/;\)/g, Smiley("wink"))
  }

  function ChatReceived(a, b, c, d, e, f) {
    var h;
    if (c == CHAT_TYPE_AUDIO || c == CHAT_TYPE_AUDIO_PU || c == CHAT_TYPE_AUDIO_GM) h = !0, c = c == CHAT_TYPE_AUDIO_GM ? CHAT_TYPE_GM : c == CHAT_TYPE_AUDIO_PU ? CHAT_TYPE_POWER_USER : CHAT_TYPE_NORMAL;
    a && c != CHAT_TYPE_GOLD && c != CHAT_TYPE_DEAD && c != CHAT_TYPE_SYSTEM && !h && (a = text_filter(a.toString(), filtered_words));
    var k = a;
    a = TextToEmo(a);
    var m = "",
      n = "",
      p = "",
      q = "",
      r, s, t, w;
    void 0 != e ? e == GUI_LOCATION_CHANNEL ? r = !0 : e == GUI_LOCATION_ROOM ? s = !0 : e == GUI_LOCATION_SHOP ? w = !0 : e == GUI_LOCATION_GAME && (!f || f.game ?
      t = !0 : f.myPlayerInfo && f.myPlayerInfo.location_type == LOCATION_TYPE_CHANNEL ? r = !0 : s = !0) : (r = $("#channelScreen").is(":visible"), s = $("#roomScreen").is(":visible"), t = $("#gameScreen").is(":visible"), w = $("#shopScreen").is(":visible"));
    w && (f && f.myPlayerInfo && f.myPlayerInfo.location_type == LOCATION_TYPE_ROOM ? s = !0 : r = !0);
    w && s && alertify.log((b ? b + "] " : "") + a, 0, 2E3);
    if (r) n = "#channelTextHtml", m = "#channel";
    else if (s) n = "#roomChatHtml", m = "#roomChat", p = ".roomPlayerBalloon", q = ".roomPlayerBalloonTip", "" != p && "" != b && $(".roomPlayerName").each(function(d) {
      if ($(this).html().split("</span> ").pop() ==
        b) {
        var e = $(this).parents().children(p),
          f = $(this).parents().children(q);
        c == CHAT_TYPE_POWER_USER ? e.addClass("bg1") : e.removeClass("bg1");
        c == CHAT_TYPE_GM ? e.addClass("bg2") : e.removeClass("bg2");
        f.stop(!0, !0).fadeOut("slow");
        e.stop(!0, !0).hide("slow").promise().done(function() {
          e.html(h ? "[Voice Message]" : a).show("slow").animate({
            opacity: 0.9
          }, 5E3).fadeOut(2E3);
          f.fadeIn("slow").animate({
            opacity: 0.9
          }, 5E3).fadeOut(2E3)
        })
      }
    });
    else if (t) n = "#gameChatHtml", m = "#gameChat", f && f.game && c != CHAT_TYPE_AUDIO && f.game.ChatReceived(h ?
      "[Voice Message]" : k, b, c);
    else return;
    m && (h && (dlog("Received Audio text:", a.length, a), e = dataURLToBlob(a), dlog("Received Audio blob:", e), e = URL.createObjectURL(e), dlog("Received Audio url:", e), a = '<audio controls src="' + e + '">', dlog("Received Audio final:", a)), e = -1 != [1, 2, 3, 5, 6, 7, 8, 9, 12, 13].indexOf(c), d = '<div class="zotata-chat-line zotata-chat-type' + c + '" >' + (e ? '<div class="zotata-chat-icon zotata-chat-icon' + c + '"></div> ' : " ") + ("" != b ? BuildPlayerNameWithGuild(d, b) + "] " : "") + a + "</div>", m = $(m), e = m.tinyscrollbar_isAtLastScrollLine(),
      $(n).append(d).hide().show(0), m.tinyscrollbar_update(e ? "bottom" : "relative"))
  }
  DragonFreeze(Object);

  function GuiCloseChannelScreen() {
    $("#dialogCreateRoom").fadeOut(g_graphics_high ? "slow" : 0);
    $("#OptionsDialog").hide();
    $("#channelScreen").fadeOut(g_graphics_high ? "slow" : 0, function() {
      g_channel_player && (g_channel_player.remove(), g_channel_player = void 0);
      TabChangeTo(TAB_ALL);
      TournamentWaitingMsgHide()
    })
  }

  function GuiCloseRoomScreen(a) {
    $("#roomScreen").fadeOut(g_graphics_high ? "slow" : 0, function() {
      $("#roomButtonReady").hide();
      $("#roomButtonStart").hide();
      $("#roomButtonMobile").hide();
      a || $("#roomChatHtml").html("");
      $("#roomChat .scrollbar").hide();
      $(".roomPlayerBalloon, .roomPlayerBalloonTip").removeClass("text_anim");
      $("#playerInfoDialog").hide();
      $("#dialog_room_options").hide();
      RoomTabChangeTo(TAB_ALL);
      RoomRemoveAnimations();
      VortexStop();
      TeamSearchMsg(void 0, 0)
    })
  }

  function GuiCloseGameScreen(a) {
    $("#OptionsDialog").hide();
    $("#gameScreen,#Dragon2D").fadeOut(g_graphics_high ? "slow" : 0, function() {
      g_score_screen_timeout && (g_score_screen_timeout = clearTimeout(g_score_screen_timeout));
      $(".BonusMsg").remove();
      $("#game_back").removeClass("shake_anim");
      $("#container").removeClass("HandCursor");
      a.game && (DEBUG && log("GuiCloseGameScreen calling Destructor"), a.game.Destructor(), a.game = void 0)
    })
  }

  function GuiCloseShopScreen() {
    $("#shopScreen").fadeOut(g_graphics_high ? "slow" : 0, function() {
      g_shop_player.remove();
      g_shop_player = void 0
    })
  }

  function GuiCloseCurrentScreen(a, b) {
    a.location == GUI_LOCATION_CHANNEL ? GuiCloseChannelScreen() : a.location == GUI_LOCATION_ROOM ? GuiCloseRoomScreen(b) : a.location == GUI_LOCATION_GAME ? GuiCloseGameScreen(a) : a.location == GUI_LOCATION_SHOP && GuiCloseShopScreen();
    $("#friendsList").hide();
    $("#guildMembersList").hide()
  }
  var g_gui_location_target = GUI_LOCATION_CHANNEL;

  function SwitchToChannelScreen(a) {
    g_gui_location_target = GUI_LOCATION_CHANNEL;
    a.location != GUI_LOCATION_CHANNEL && $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
      a.location != GUI_LOCATION_CHANNEL && (GuiCloseCurrentScreen(a), $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
        a.location = GUI_LOCATION_CHANNEL;
        $("#channelInput").val("");
        $("#channelScreen").fadeIn(g_graphics_high ? 400 : 0);
        $("#channel").tinyscrollbar_update("bottom");
        ChannelPlayerInfoUpdate(a.myPlayerInfo,
          1 == g_server_type ? a.lobbyMobile : void 0);
        AudioPlayInLoop(AUDIO_MUSIC_CHANNEL, !0);
        $("#playersList").tinyscrollbar_update("top");
        TabChangeTo(TAB_FRIENDS);
        setTimeout(function() {
          DragonDialogPlayQueue()
        }, 300);
        if (g_gui_location_target == GUI_LOCATION_ROOM) return SwitchToRoomScreen(a)
      }))
    })
  }

  function SwitchToRoomScreen(a) {
    g_gui_location_target = GUI_LOCATION_ROOM;
    a.location != GUI_LOCATION_ROOM && $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
      a.location != GUI_LOCATION_ROOM && (GuiCloseCurrentScreen(a), $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
        a.location = GUI_LOCATION_ROOM;
        $("#roomInput").val("");
        $("#room_timer").hide();
        $("#select_bot_div").hide();
        AutoReadyStartTimer(a);
        $("#roomsList > .room").each(function(a) {
          $(this).hide()
        });
        $("#playerInfoDialog").hide();
        $("#roomScreen").fadeIn(g_graphics_high ? 400 : 0);
        AudioPlayInLoop(AUDIO_MUSIC_ROOM, !0);
        RoomTabChangeTo(TAB_ALL);
        VortexStart();
        RoomPlayerUpdateGUI(a.myPlayerInfo);
        setTimeout(function() {
          DragonDialogPlayQueue()
        }, 300);
        if (g_gui_location_target == GUI_LOCATION_CHANNEL) return SwitchToChannelScreen(a)
      }))
    })
  }

  function SwitchToGameScreen(a) {
    a.location != GUI_LOCATION_GAME && $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
      a.location != GUI_LOCATION_GAME && (GuiCloseCurrentScreen(a), $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
        a.location = GUI_LOCATION_GAME;
        $("#gameScreen,#Dragon2D").fadeIn(g_graphics_high ? 400 : 0, function() {
          $("#gameScreen").css("opacity", 1)
        });
        AudioPlayInLoop(GetRandomElementFromArray([AUDIO_MUSIC_STAGE1, AUDIO_MUSIC_STAGE2,
          AUDIO_MUSIC_STAGE3, AUDIO_MUSIC_STAGE4, AUDIO_MUSIC_STAGE5, AUDIO_MUSIC_STAGE6, AUDIO_MUSIC_STAGE7
        ]), !0)
      }))
    })
  }

  function SwitchToShopScreen(a) {
    a.location != GUI_LOCATION_SHOP && $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
      a.location != GUI_LOCATION_SHOP && (GuiCloseCurrentScreen(a, a.location == GUI_LOCATION_ROOM), a.location = GUI_LOCATION_SHOP, $("#channelScreen, #roomScreen, #gameScreen, #shopScreen").promise().done(function() {
        $("#shopScreen").fadeIn(g_graphics_high ? 400 : 0);
        ShopEntered(a)
      }))
    })
  }
  var DIALOG_BUTTONS_NONE = 0,
    DIALOG_BUTTONS_OK = 1,
    DIALOG_BUTTONS_OK_CANCEL = 2,
    g_dialog_graphic, g_dragondialogs_queue = [],
    g_is_dialog_open, g_open_dialog_buttons = DIALOG_BUTTONS_NONE;

  function DragonDialogOpen(a, b, c, d, e) {
    if (g_is_dialog_open && g_open_dialog_buttons != DIALOG_BUTTONS_NONE) return DragonDialogAddQueue(a, b, c, d, e);
    DragonDialogClose(!0);
    $("#myDialog .AlertBoxTitle").html(a);
    $("#myDialog .AlertBoxContent").html(b.replace(/\n/g, "<br>"));
    c == DIALOG_BUTTONS_NONE || void 0 == c ? ($("#myDialog .AlertBoxOK").hide(), $("#myDialog .AlertBoxCancel").hide()) : c == DIALOG_BUTTONS_OK ? ($("#myDialog .AlertBoxCancel").hide(), $("#myDialog .AlertBoxOK").show().unbind("click").bind("click", function(a) {
      d &&
        d(!0);
      a.stopPropagation();
      DragonDialogClose()
    })) : c == DIALOG_BUTTONS_OK_CANCEL && ($("#myDialog .AlertBoxOK").show().unbind("click").bind("click", function(a) {
      d && d(!0);
      a.stopPropagation();
      DragonDialogClose()
    }), $("#myDialog .AlertBoxCancel").show().unbind("click").bind("click", function(a) {
      d && d(!1);
      a.stopPropagation();
      DragonDialogClose()
    }));
    $("#myDialog").unbind("mousedown touchstart").bind("mousedown touchstart", function(a) {
      a.stopPropagation()
    });
    e && (g_dialog_graphic && g_dialog_graphic.remove(), g_dialog_graphic =
      new CPlayerGraphic("#dialog_graphic", -1, e[0], e[1], e[2], e[3], !1));
    $("#myDialog").removeClass("hide");
    $(".DialogLayer .AlertBox").show();
    $(".DialogLayer").show();
    $(".DialogLayer").css("z-index", g_draggable_z_index += 1);
    $(document.activeElement).blur();
    $("body").keydown(DragonDialogHandleEnter);
    g_is_dialog_open = !0;
    g_open_dialog_buttons = c
  }

  function DragonDialogHandleEnter(a) {
    a.which == KEY.Enter && $("#myDialog .AlertBoxOK").is(":visible") ? ($("#myDialog .AlertBoxOK").click(), a.stopPropagation()) : a.which == KEY.Esc && $("#myDialog .AlertBoxCancel").is(":visible") && ($("#myDialog .AlertBoxCancel").click(), a.stopPropagation())
  }

  function DragonDialogClose(a) {
    g_is_dialog_open && ($("body").unbind("keydown", DragonDialogHandleEnter), $(".DialogLayer .AlertBox").hide(), $(".DialogLayer").hide(), g_dialog_graphic && g_dialog_graphic.remove(), g_is_dialog_open = !1, DragonDialogPlayQueue())
  }

  function DragonDialogAddQueue(a, b, c, d, e) {
    g_dragondialogs_queue.push([a, b, c, d, e])
  }

  function DragonDialogPlayQueue() {
    !g_dragondialogs_queue.length || g_is_dialog_open && g_open_dialog_buttons != DIALOG_BUTTONS_NONE || DragonDialogOpen.apply(window, g_dragondialogs_queue.shift())
  }

  function CloseDialogs() {
    $("#dialog_change_name_div").fadeOut()
  }

  function GetServerType() {
    var a = location.hostname;
    if ("t.dragonbound.net" == a || "tt.dragonbound.net" == a) return "dev";
    if ("dragonbound-brasil.com" == a || "br.dragonbound.net" == a || "dragonbound.com.br" == a || "dragonbound.net.br" == a) return "br"; - 1 == a.indexOf("dragonbound") && (location.href = "https://dragonbound.net");
    return "gl"
  }
  var g_dirty = new Image,
    g_dirty1 = new Image;
  g_dirty1.onload = function() {
    g_dirty = g_dirty1
  };
  g_dirty1.src = "//2.dragonbound.net/static/images/hotlink-ok/trans.gif";
  var LANGUAGE = {
      EN: -1,
      ES: 0,
      PR: 1,
      FI: 2,
      VN: 3
    },
    LANGUAGE_REVERSE = {
      "-1": "EN",
      0: "ES",
      1: "PR",
      2: "FI",
      3: "VN"
    };

  function DragonLanguage(a, b) {
    if (void 0 == b || null == b || b < LANGUAGE.EN || b > LANGUAGE.VN) {
      b = LANGUAGE.EN;
      var c = navigator.language || navigator.userLanguage;
      c && (0 == c.indexOf("es") ? b = LANGUAGE.ES : 0 == c.indexOf("pt") ? b = LANGUAGE.PR : 0 == c.indexOf("vi") && (b = LANGUAGE.VN))
    }
    this.lang = b;
    this.strings = a
  }
  DragonLanguage.prototype.GetCurrentLang = function() {
    return LANGUAGE_REVERSE[this.lang]
  };
  DragonLanguage.prototype.GetCurrentLangNumber = function() {
    return Number(this.lang)
  };
  DragonLanguage.prototype.t = function(a) {
    if (this.lang == LANGUAGE.EN) return a;
    var b = this.strings[a];
    return b ? (b = b[this.lang]) ? b : a : a
  };
  DragonLanguage.prototype.SetAll = function() {
    $("#ranking_btn_type1").html(this.t("Top Players"));
    $("#ranking_btn_type2").html(this.t("Tournament"));
    $("#ranking_btn_type3").html(this.t("Friends"));
    $("#ranking_btn_ranks").html(this.t("Ranks"));
    $("#ranking_btn_howto").html(this.t("How to Play"));
    $("#ranking_btn_contact").html(this.t("Contact Us"));
    $("#ranking_btn_terms").html(this.t("Terms of Service"));
    $("#ranking_btn_privacy").html(this.t("Privacy Policy"));
    $("#BrokerChannel0 .BrokerChannelName").html(this.t("Server") +
      " 1 - " + this.t("High Ranks"));
    $("#BrokerChannel1 .BrokerChannelName").html(this.t("Server") + " 2 - " + this.t("Beginners"));
    $("#BrokerChannel2 .BrokerChannelName").html(this.t("Server") + " 3 - " + this.t("Beginners"));
    $("#BrokerChannel3 .BrokerChannelName").html(this.t("Server") + " 4");
    $("#BrokerChannel4 .BrokerChannelName").html(this.t("Server") + " 5");
    $("#BrokerChannel5 .BrokerChannelName").html(this.t("Server") + " 6 - " + this.t("English Please"));
    $("#BrokerChannel6 .BrokerChannelName").html(this.t("Server") +
      " 7");
    $("#BrokerChannel7 .BrokerChannelName").html(this.t("Server") + " 8");
    $("#BrokerChannel8 .BrokerChannelName").html(this.t("Server") + " 9 - " + this.t("On Port 80"));
    $("#BrokerChannel9 .BrokerChannelName").html(this.t("Server") + " 10");
    $("#BrokerChannel10 .BrokerChannelName").html(this.t("Server") + " 11");
    $("#BrokerChannel11 .BrokerChannelName").html(this.t("Server") + " 12 - " + this.t("Mid Ranks"));
    $("#BrokerChannel12 .BrokerChannelName").html(this.t("Server") + " 13");
    $("#BrokerChannel13 .BrokerChannelName").html(this.t("Server") +
      " 14");
    $("#BrokerChannel14 .BrokerChannelName").html(this.t("Server") + " 15");
    $("#BrokerChannel5 .BrokerDesc").html(this.t("Please talk English here"));
    $("#BrokerChannel8 .BrokerDesc").html(this.t("Bypass workplace firewall"));
    $("#dialog_change_name_div .AlertBoxTitle").html(this.t("Select Name & Photo"));
    $("#display_name_label").html(this.t("Change Name") + ":");
    $("#can_show_photo_label").html(this.t("Show my photo"));
    $("#join_room1").html(this.t("Number") + ":");
    $("#join_room2").html(this.t("Password") +
      ":");
    $("#friendsListExtra").html(this.t('You can add friends by clicking "Info" near them and then "Add".'));
    $("#guildRoomTabExtra").html(this.t('A guild leader can invite you to a guild by clicking on your "Info" and then "Guild Invite".'));
    $("#dialog_change_title_div .AlertBoxTitle").html(this.t("Room Title"));
    $("#dialog_change_title_div label").html(this.t("New Title"));
    $("#infoLoading").html(this.t("Loading") + "...");
    $("#infoKey1").html(this.t("Ranking"));
    $("#infoKey2").html(this.t("Gender"));
    $("#infoKey4").html(this.t("Win Rate %"));
    $("#infoKey5").html(this.t("Damage Avg"));
    $("#infoKey6").html(this.t("Win"));
    $("#infoKey7").html(this.t("Lose"));
    $("#infoKey8").html(this.t("Guild"));
    $("#infoKey9").html(this.t("Guild Job"));
    $("#turns_list .turn_list_title").html(this.t("Turn List"));
    $("#game_replay").html("&lt;&lt; " + this.t("Game Replay") + " &gt;&gt;");
    $("#roomButtonInvite .Text").html(this.t("Invite"));
    $("#dialog_join_room_div .AlertBoxTitle").html(l.t("Join Room"));
    $("#shopTitle").html(this.t("Items Shop"));
    $("#shopInvTitle").html(this.t("My Items"));
    $("#SortLabel").html(this.t("Sort:"));
    $("#buy_panel2").html(this.t("Need More Cash?"));
    $("#infoProfile").html(this.t("View Full Profile"));
    $("#myInfoProfile").html(this.t("My Page"));
    $("#changePassLink").html(this.t("Password / Photo / Settings"));
    $("#buttonCreateRoom").attr("original-title", l.t("Create a new room"));
    $("#buttonMyInfo").attr("original-title", l.t("Change name/photo/settings"));
    $("#buttonShop").attr("original-title", l.t("Buy items"));
    $("#buttonCharge2").attr("original-title",
      l.t("Get Free & Paid Cash"));
    $("#buttonJoin").attr("original-title", l.t("Join known room"));
    $("#buttonQuickJoin").attr("original-title", l.t("Join random room"));
    $("#facebook_post").attr("original-title", l.t("Share to Facebook"));
    $("#event_button").attr("original-title", l.t("Free Gold & Cash"));
    $("#buttonOptions").attr("original-title", l.t("Options"));
    $("#buttonChannels").attr("original-title", l.t("Change Server"));
    $("#filter_all").attr("original-title", l.t("Show all rooms"));
    $("#filter_waiting").attr("original-title",
      l.t("Show Waiting rooms"));
    $("#filter_normal").attr("original-title", l.t("Show Normal mode rooms"));
    $("#filter_boss").attr("original-title", l.t("Show Boss mode rooms"));
    $("#filter_same").attr("original-title", l.t("Show Same mode rooms"));
    $("#filter_score").attr("original-title", l.t("Show Score mode rooms"));
    $("#filter_friends").attr("original-title", l.t("Show your friends"));
    $("#filter_guild").attr("original-title", l.t("Show your guildmates"));
    $("#shop_delete_avatar").attr("original-title", l.t("Delete Avatar. Can undo at") +
      ": dragonbound.net/avatars");
    $("#Mic").attr("original-title", l.t("Send voice message"));
    $("#loginTitle").html(l.t("Login to") + " DragonBound");
    $("#LoginOR1").html("- " + l.t("OR") + " -");
    $("#LoginResetA").html(l.t("Reset password?"));
    $("#LoginPass,#password").attr("placeholder", l.t("Password"));
    $("#name").attr("placeholder", l.t("Name"));
    $("#LoginUsername").attr("placeholder", l.t("Name") + " / Email / UserID");
    $("#LoginSubmit").attr("value", l.t("Login"));
    $("#registerTitle").html(l.t("Create Account"));
    $("#male").next().html(l.t("Male"));
    $("#female").next().html(l.t("Female"));
    $("#RegisterBirthday").attr("placeholder", l.t("Birthday"));
    $("#RegisterSubmit").html(l.t("Create Account"))
  };
  var STRINGS = {
    "Top Players": ["Jugadores Top", "", "Nangungunang Manglalaro", "Cp cao nht"],
    ME: ["YO", "EU", "", ""],
    Search: ["Buscar", "Procurar", "", ""],
    Tournament: ["Torneo", "Torneio", "Paligsahan", ""],
    Ranks: ["Niveles", "", "Ranko", "Bng xp hng"],
    "How to Play": ["Cmo jugar", "Como Jogar", "Paano maglaro", "Hng dn"],
    "Contact Us": ["Contctanos", "Contate-nos", "Kontakin kami", "Lin h"],
    "Terms of Service": ["T. de Servicio", "Termos de servio", "Termino sa serbisyo",
      "iu khon"
    ],
    "Privacy Policy": ["P. de Privacidad", "Poltica de Privacidade", "Patakaran sa privacy", "Chnh sch bo mt"],
    Server: ["Servidor", "", "", ""],
    "High Ranks": ["Ranks Altos", "Ranks de cima", "Mataas na ranko", "Cp cao"],
    Beginners: ["Principiantes", "Iniciantes", "Baguhan", "Mi tp chi"],
    "English Please": ["Slo Ingls", "Ingls, por favor", "Ingles po", "Vui lng s dng ting Anh"],
    "On Port 80": ["En Puerto 80",
      "Na Porta 80", "Sa Port 80", "S dng port 80"
    ],
    "Mid Ranks": ["Ranks Medios", "Ranks Medianos", "Gitnang ranko", "Trung cp"],
    "Please talk English here": ["Por favor, hable en ingls aqu", "Por favor, fale Ingls aqui", "Maaari po lamang magsalita ng Ingles dito", "Vui lng s dng ting Anh ti y"],
    "Bypass workplace firewall": ["Evite el firewall de su trabajo", "Evite o firewall do seu local de trabalho", "Ibypass ang nagtatrabuhan na firewall",
      "B qua tng la"
    ],
    "Select Name & Photo": ["Seleccionar Nombre y Foto", "Selecione Nome & Foto", "Piliin ang iyong pangalan at Larawan", "Chn tn v hnh nh i din"],
    "Change Name": ["Cambiar Nombre", "Mude o Nome", "Palitan ang iyong pangalan", "i tn"],
    "Show my photo": ["Mostrar mi foto", "Mostre minha foto", "Ipakita ang larawan", "Hin th avatar"],
    "Join Room": ["Entrar a Sala", "Entre na Sala", "Sumali sa kwarto", "Tham gia phng"],
    Number: ["Numero", "Nmero", "Numero", "S"],
    Password: ["Contrasea", "Senha", "", "Mt khu"],
    'You can add friends by clicking "Info" near them and then "Add".': ['Puedes agregar amigos haciendo click en "Info" cerca de ellos y luego "Aadir"', 'Voc pode adicionar amigos clicando no boto "Info" prximo a eles e ento clicando no boto "Add".', 'Maaaring magdagdag ng mga kaibigan sa pamamagitan ng pagpindot ng "Info" sa tabi ng tao tapos pindutin ang "Add"',
      'Bn c th thm bn bng cch bm vo nt "Info" v sau  chn "Add" '
    ],
    'A guild leader can invite you to a guild by clicking on your "Info" and then "Guild Invite".': ['El lder de un guild puede invitarte haciendo click en tu "Info" y luego pulsando "Invitacin para Guild"', 'Um lder da guild pode convidar voc para a guild clicando em seu boto "Info" e ento clicando no boto "Convidar para Guild".',
      'Ang pinuno ng guild ay maaaring magimbita sa pamamagitan ng pagpindot ng "Info" tapos "Guild Invite"', 'Ch guild c th mi bn vo guild bng cch bm vo "Info" ca bn v sau  chn "Guild Invite"'
    ],
    "Room Title": ["Ttulo de Sala", "Ttulo da Sala", "Titolo ng Kwarto", "Tn phng"],
    "New Title": ["Nuevo Ttulo", "Novo Ttulo", "Bagong Titolo", "i tn phng"],
    Loading: ["Cargando",
      "Carregando", "Nagloload", "ang ti"
    ],
    Ranking: ["", "", "Ranko", "Xp hng"],
    Gender: ["Gnero", "Gnero", "Kasarian", "Gii tnh"],
    "Win Rate %": ["Victorias %", "Victrias %", "", "T l thng %"],
    "Damage Avg": ["Dao Prom.", "Dano Mdio"],
    Win: ["Ganadas", "Vitria", "Panalo", "Thng"],
    Lose: ["Perdidas", "Derrota", "Talo", "Thua"],
    "Guild Job": ["Cargo", "Cargo", "Trabaho", "Chc v"],
    "Turn List": ["Lista de turnos", "Lista de Turnos", "Lista ng mga Turn",
      "Danh sch cc lt"
    ],
    "Game Replay": ["Replay del Juego", "Replay do Jogo", "Replay ng Laro", "Xem li mn chi"],
    "Loading Facebook": ["Cargando Facebook", "Carregando Facebook", "Nagloload ang facebook", "ang ti d liu facebook"],
    "Checking FB login status": ["Verificando estado de inicio de sesin en FB", "Verificando status do login no FB", "Sinusuri ang FB login status", "Kim tra d liu ng nhp facebook"],
    "A Facebook pop-up has opened, please follow the instructions to sign in.": ["Se ha abierto un pop-up de Facebook , por favor siga las instruciones para ingresar",
      "Um pop-up do facebook foi aberto, por favor siga as instrues para entrar", "May bumukas na facebook pop-up, at sundin ang instruksiyon", "Mt popup ca facebook s xut hin, vui lng lm theo cc bc  ng nhp"
    ],
    "Loading your account": ["Cargando su cuenta", "Carregando sua conta", "Niloload ang iyong account", "ang ti d liu ti khon ca bn"],
    Timeout: ["Limite de tiempo agotado",
      "Tempo limite esgotado", "Timeout", "Qu thi gian ch"
    ],
    "Try Again?": ["Intentar de nuevo?", "Tentar novamente?", "Ulitin?", "Bn c mun th li ?"],
    "You Are Banned": ["Ests Baneado", "Voc est Banido", "Ikaw ay Banned", "Ti khon b kha"],
    Reason: ["Motivo", "Motivo", "Dahilan", "L do"],
    Forever: ["Para Siempre", "Para Sempre", "Walang Hanggan", "Mi mi"],
    "UTC Time Zone": ["Zona Horaria UTC", "Fuso Horrio UTC", "", "Mi gi UTC"],
    "We logged you out from your Facebook account too for your account safety.<br><br>Hope to see you again soon!": ["Hemos finalizado la sesin de su cuenta de facebook por la seguridad de su cuenta.<br><br> Esperamos verlo pronto!", "Ns samos da sua conta do Facebook tambm para a segurana da sua conta.<br><br>Esperamos ver voc novamente em breve!", "Nilogout namin ikaw sa iyong account para sa iyong kaligtasan. <br><br>Sana makita ulit namin kayo sa lalong madaling panahon!",
      ""
    ],
    "Bye Bye": ["Adis", "Tchau", "Paalam", "Tm bit"],
    "Your Web Browser Too Old": ["Su navegador es demasido viejo", "Seu Navegador  Muito Velho", "Ang iyong browser ay masyadong luma", "Trnh duyn ca bn qu c"],
    'Sorry but your browser does not support WebSockets.<br><br>Please change to the newest version of <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a> which has this feature.': ['Lo sentimos, pero su navegador no soporta WebSockets.<br><br>por favor, cambia a la nueva versin de <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> o <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a> que tengan esta caracterstica',
      'Desculpa, mas seu navegador no suporta WebSockets.<br><br>Por favor mude para uma das verses mais atuais do <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> ou <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a> que tm est funo.', 'Ikinalulungkot namin na ang inyong browser ay hindi sinusuportahan ang WebSockets.<br><br>Maaari po lamang na palitan ninyo ang <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a> na mayroong ganitong feature.',
      ""
    ],
    "Connecting to Server...": ["Conectando al Servidor...", "Conectando ao Servidor...", "Kumoconnect sa Server...", ""],
    'Please Wait...<br><br>If it takes too long:<br>&nbsp;&nbsp;Refresh (F5)<br>&nbsp;&nbsp;Change to <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> / <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a><br>&nbsp;&nbsp;Check our <a href="http://dragonbound-forums.com" target="_blank">Forums</a><br>&nbsp;&nbsp;Or come back later...': ['Por favor Espere...<br><br>Si esto demora mucho:<br>&nbsp;&nbsp;Actualizar (F5)<br>&nbsp;&nbsp;Cambie a <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> / <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a><br>&nbsp;&nbsp;Consultar nuestros <a href="http://dragonbound-forums.com" target="_blank">Foros</a><br>&nbsp;&nbsp;En todo caso regresa ms tarde...',
      'Por favor Espere...<br><br>Se isto demorar muito:<br>&nbsp;&nbsp;Recarregue (F5)<br>&nbsp;&nbsp;Mude para o <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> / <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a><br>&nbsp;&nbsp;Verifique nossa <a href="http://dragonbound-forums.com" target="_blank">Forums</a><br>&nbsp;&nbsp;Ou volte depois...', 'Maghintay lamangt...<br><br>pag masyadong matagal:<br>&nbsp;&nbsp;Refresh (F5)<br>&nbsp;&nbsp;Change to <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> / <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a><br>&nbsp;&nbsp;Check our <a href="http://dragonbound-forums.com" target="_blank">Forums</a><br>&nbsp;&nbsp;o bumalik mamaya...',
      ""
    ],
    Disconnected: ["Desconectado", "Desconectado", "Nadisconnect", "Mt kt ni"],
    "Press [OK] to go back to the Worlds List.": ["Presione [OK] para volver a la Lista de Servers", "Pressione [OK] para voltar para a Lista de Servidores.", "Pindutin ang [OK] para bumalik sa Worlds List", "Bm [OK]  tr li danh sch server"],
    "Can't Connect to Server :(": ["No se pudo conectar al servidor", "No consegue conectar ao servidor", "Hindi Makapasok sa Server", "Khng th kt ni n server"],
    'Please wait a few minutes and then try to reload the game.<br><br>If it keeps failing try <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>, try different ISP, or check our <a href="//dragonbound-forums.com" target="_blank">Forums</a>.': ['Por favor, espere unos minutos y luego intenta recargar el juego nuevamente.<br><br>Si continua fallando, intenta <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> o <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>, intenta con otro navegador, o verifica nuestra <a href="//dragonbound-forums.com" target="_blank">Foros</a>.',
      'Por favor espere alguns minutos e ento tente recarregar o jogo.<br><br>Se isto continuar falhando <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> ou <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>, tente uma diferente operadora de internet, ou verifique nossa <a href="//dragonbound-forums.com" target="_blank">Forums</a>.', 'Maghintay ng ilang minuto at muling subukang iload ang game.<br><br>Kapag nanatiling ayaw magload, subukan ang <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> o <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>, o gumamit ng ibang ISP, o icheck ang aming <a href="//dragonbound-forums.com" target="_blank">Forums</a>.',
      ""
    ],
    "Update Available": ["Actualizacin Disponible", "Atualizao Disponvel", "May Bagong Update", ""],
    'Please refresh - <font color="#FF9933">Press F5</font>\nto load the latest game client.': ['Por favor actualizar - <font color="#FF9933">Presione F5</font>\npara cargar la ltima versin del juego.', 'Por favor recarregue - <font color="#FF9933">Pressione F5</font>\npara carregar o cliente do jogo mais atual.', 'Paki refresh - <font color="#FF9933">Press F5</font>\npara maiload ang game client.',
      ""
    ],
    "Please Wait": ["Por favor espere", "Por favor Espere", "Pakihintay", "Vui lng ch"],
    Connected: ["Conectado", "Conectado", "Konektado", " kt ni"],
    Login: ["Ingresar", "", "", "ng nhp"],
    "Missed game start<br><br>Refresh (F5) or close the window for 30 seconds then come back to fix this.": ["No se pudo iniciar el juego<br><br>Actualice (F5) o cierre la ventana por 30 segudos y vuelva para solucionar el problema.", "Perdeu o incio do jogo<br><br>Recarregue (F5) ou feche a janela por 30 segundos e ento volte para solucionar isto.",
      "Namiss mo ang laro<br><br>Refresh (F5) o isarado ang browser ng 30 segundo at bumalik mamaya.", ""
    ],
    "Friend Request": ["Solicitud de Amistad", "Solicitao de Amizade", "Friend Request", ""],
    "Can you be my friend?": ["Te gustara ser mi amigo?", "Voc gostaria ser meu amigo?", "Pwede ba kitang maging kaibigan?", ""],
    "Guild Invite": ["Invitacin al Guild", "Convite de Guild", "Imbitasyon sa Guild", ""],
    "Would you join our guild?": ["Te gustara unirte a mi Guild?", "Voc gostaria de participar de nossa guild?",
      "Gusto mo bang sumali sa guild namin?", "Bn c mun vo guild ca chng ti khng?"
    ],
    "Joined a different world": ["Entraste a un server diferente", "Entrou em um servidor diferente", "Sa ibang world nagconnect", ""],
    "You joined a different world. Please continue on the other window, or press [OK] to go back to worlds list.": ["Entraste a un servidor diferente. Por favor continua en otra ventana o presiona [OK] para volver a la lista de servidores", "Voc entrou em um servidor diferente. Por favor continue na outra janela, ou pressione [OK] para voltar para a lista de servidores.",
      "Sumali ka sa ibang world. Tumuloy sa kabilang window, o pakipindot ang [OK] para bumalik sa server list.", ""
    ],
    "Here?": ["Ests Aqu?", "Aqui?", "Dito?", ""],
    "I think you are away...<br><br>Press [OK] to continue :)": ["Creo que ests ausente...", "Eu acho que voc est ausente...<br><br>Presione [OK] para continuar :)", "Tingin ko AFK ka...<br><br>Paki'indot ang [OK] para magpatuloy :)", ""],
    "Server is Full": ["Server Lleno", "Servidor est Cheio", "Full ang Server", "Server  y"],
    "We are sorry but the server is currently full.<br><br>Try to join a different one.": ["Lo sentimos, este server est lleno.<br><br>Intenta entrar a otro server", "Ns sentimos muito, mas o servidor est atualmente cheio.<br><br>Tente entrar em um diferente", "Pasensya na, ngunit puno ang server sa kasalukuyan.<br><br>Subukang sumali sa ibang server", ""],
    "Loading profile": ["Cargando perfil", "Carregando perfil", "Nagloload ang iyong profile", "ang ti thng tin"],
    "Loading your avatars": ["Cargando tus avatares",
      "Carregando seus avatars", "Nagloload ang iyong mga avatar", "ang ti avatar ca bn"
    ],
    "Loading Channels": ["Cargando canales", "Carregando Canais", "Nagloload ang mga channel", "ang ti cc knh"],
    "Error! Wait 30 seconds, then press this button": ["Error! Espere 30 segundos, luego presiona este botn", "Erro! Espere 30 segundos, ento pressione este boto", "Error! Maghintay ng 30 segundo, pagkatapos at pindutin ang botton na ito", "C li xy ra! i 30 giy, sau  bm nt ny"],
    "Select Server": ["Seleccionar Server", "Selecione o Server", "Piliin ang Server", ""],
    "Total Online Players": ["Total de jugadores conectados", "Total de Jogadores Online", "Mga online na manlalaro", "Tng s ngi chi ang online"],
    "All worlds are currently full. Press this button to refresh": ["Todos los servers estn llenos. Presiona este botn para actualizar", "Todos os servers esto cheios no momento. Pressione este boto para atualizar", "Ang lahat ng mga world ay puno sa kasalukuyan. Pindutin ang botton na ito para magrefresh",
      ""
    ],
    "Not Room Master": ["No tienes el Master de la sala", "No  o Master da Sala", "Hindi ikaw ang room master", ""],
    "Sorry, only the room master can change the room title.": ["Lo sentimos, solo el master de la sala puede cambiar el ttulo de la sala.", "Desculpe, apenas o master da sala pode mudar o ttulo da sala.", "Patawad, maaari lang ito gawin ng room master", ""],
    "Sorry, only the room master can change the room options.": ["Lo sentimos, solo el master de la sala puede cambiar las opciones de la sala",
      "Desculpe, apenas o master da sala pode mudar as opes da sala.", "Patawad, maaari lang tio gawin ng room master", ""
    ],
    "This mode is locked until you win at BOSS mode as room master.": ["Este modo est bloqueado, hasta que ganes en modo BOSS como master de la sala.", "Este modo est trancado at que voc vena no modo BOSS como master da sala.", "Ang mode na ito ay nakakandado hangga't manalo kayo sa mga BOSS bilang room master", ""],
    "This mode is locked until you win *ALL* BOSS mode levels as room master.": ["Este modo est bloqueado hasta que derrotes *TODOS* los niveles de que hay en el modo BOSS.",
      "Esse modo de jogo est bloqueado at que voc ganhe *TODOS* no modo BOSS sendo o dono da sala.", "Nakakandado ang room na ito hangga't manalo kayo sa lahat ng BOSS na level", ""
    ],
    "Kill the other team to win.": ["Derrote al otro equipo para ganar", "Elimine o outro time para vencer.", "Patayin ang kabilang team para manalo", ""],
    "Fight computer players at increasing difficulty.": ["Juega contra bots que incrementan su dificultad.", "Jogue contra o computador aumentando a dificuldade.", "Labanan ang mga computer player sa masmataas na kahirapan",
      ""
    ],
    "Everyone use the same mobile as the room master.": ["Todos utilizan el mismo mvil que el master de la sala", "Todos utilizam o mesmo mobile que o master da sala.", "Lahat ay gagamit ng pareho mobile kaparehas ng room master", ""],
    Male: ["Hombre", "Macho", "Lalaki", "Nam"],
    Female: ["Mujer", "Fmea", "Babae", "N"],
    Member: ["Miembro", "", "Miyembro", "Thnh vin"],
    Leader: ["Lder", "Lder", "Pinuno", "Hi ch"],
    "Semi-Leader": ["Semi-Lder", "Vice-Lder", "Semi-Pinuno",
      "Ph hi ch"
    ],
    ON: ["Encendido", "", "Bukas", "BT"],
    OFF: ["Apagado", "", "Sarado", "TT"],
    Team: ["Equipo", "Time", "", "i"],
    "If you win you will not get winning bonus because you already won this player many times today.<br>Play for fun, play with others, or continue tomorrow.": ["Si ganas ya no tendrs el bonus por victoria, porque ya has derrotado a este usuario mucha veces hoy.<br>Juega por diversin, con otros jugadores o contina maana", "", "Kapag ikaw ay nanalo, wala kang makukuha dahil nanalo ka na sa player na ito maraming beses sa araw na ito.<br>Maglaro para sa kasiyahan, kalaroin ang ibang mga tao, o subukan muli bukas.",
      "Bi v bn  thng qu nhiu ln trong ngy nn khng nhn c im thng.<br>Vui lng tr li vo ngy mai"
    ],
    "Old Browser": ["Navegador antiguo", "Navegador Velho", "Lumang Browser", "Trnh duyt c"],
    "Your browser is too old.<br>It does not have required features to run the game.": ["Tu navegador es muy antiguo.<br>No tiene los requisitos para poder jugar el juego",
      "", "Ang iyong browser ay masyado nang luma at wala ang mga kinakailangan upang paganahin ang laro", "Trnh duyt ca bn qu c.<br> N khng tch hp cc th vin cn thit  c th chi game"
    ],
    'Please change to <a href="https://www.google.com/chrome/">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a>': ['Por favor cmbiate a <a href="https://www.google.com/chrome/">Chrome</a> o <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a>',
      'Por favor mude para <a href="https://www.google.com/chrome/">Chrome</a> ou <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a>', 'Pakipalit sa <a href="https://www.google.com/chrome/">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a>', 'Vui lng i trnh duyt <a href="https://www.google.com/chrome/">Chrome</a> hay <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a>'
    ],
    "Event Game": ["Partida de Evento", "Partida de Evento",
      "Event Game", "S kin "
    ],
    "Losing Team Wins!<br>Double GP & Gold!": ["Equipo Perdedor Gana!<br>Doble GP & Gold!", "Time Derrotado Ganha!<br>GP & GOLD Dobrado!", "Panalo ang team na natalo!<br>Double GP & Gold!", "i thua  thng!<br> Nhn i GP & Vng"],
    "Winning Award": ["Premio por victoria", "Prmio pela Vitria", "Award para sa mga panalo", "Phn thng chin thng"],
    "Losing Consolation": ["Premio consuelo por derrota",
      "Consolao pela Derrota", "Gantimpalang Pampalubag-loob", "Phn thng an i"
    ],
    "was killed by": ["fue matado por", "foi morto por", "Pinatay ni", "b git bi"],
    "Ultra High Angle Bonus": ["Bonus ngulo Ultra Alto", "Bnus de ngulo Ultra Alto", "Bonus sa pag gawa ng Ultra High Angle", "Thng gc siu cao"],
    "High Angle Bonus": ["Bonus ngulo alto", "Bnus de ngulo Alto", "Bonus sa pag gawa ng tirang mataas ang angle",
      "Thng gc cao"
    ],
    "Excellent Shot Bonus": ["Bonus de Tiro Excelente", "Bnus de Tiro Excelente", "Bonus sa pag gawa ng Excellent Shot", "Thng bn xut sc"],
    "Good Shot Bonus": ["Bonus de Buen Tiro", "Bnus de Bom Tiro", "Bonus sa pag gawa ng magandang tira", "Thng bn tt"],
    "Shot Bonus": ["Bonus de Tiro", "Bnus de Tiro", "Bonus sa pag gawa ng tira", "Thng bn"],
    "Team Damage Penalty": ["Penalidad por Atacar Equipo",
      "Penalidade por Fogo Amigo", "Parusa sa pagdamage sa kakampi", "Bn trng ng i"
    ],
    "died by teleport": ["murio por teleport", "morto por teleporte", "Namatay sa pagteleport", "cht bi teleport"],
    "damage achieved": ["dao alcanzado", "dano alcanado", "nakuha ang damage", "st thng t"],
    "Triple Kill Bonus": ["Bonus Triple Matanza", "Bnus de Triple Kill", "Bonus sa pagpatay sa tatlo sabay-sabay", "Phn thng git 3 mng mt lc"],
    "Double Kill Bonus": ["Bonus de Double Matanza", "Bnus de Double Kill", "Bonus sa pagpatay sa dalawa nang sabay", "Phn thng git 2 mng mt lc"],
    "Ending Bonus": ["Bonus de Finalizacin", "Bnus de Encerramento", "Bonus sa pagpatay", "Thng kt thc"],
    "Bunge Shot Bonus": ["Bonus por Tiro Bunge", "Bnus de Bunge", "Bonus sa paghulog ng kalaban", "Thng bn ri"],
    "Suicide Penalty": ["Penalidad Por Suicdio",
      "Penalidade por Suicdio", "Parusa sa pagpakamatay", "T st"
    ],
    "Room Master unlocked a new challenge opponent ! :)": ["El Master de la sala ha desbloqueado un nuevo oponente", "Master da sala destravou um novo oponente", "Naunlock ng room master ang bagong kalaban", "Ch phng  m kha i th mi !:)"],
    "Free kill game detected - No winning bonus": ["Free Kill Detectado - No hay bonificacin por victoria", "Free kill detectado - Sem bnus de vitria",
      "Free kill game nadetect - Walang bonus sa pagpanalo", "Pht hin mn chi dn xp - khng c phn thng chin thng"
    ],
    bunge: ["", "", "hulog", "rt"],
    "Winning Bonus": ["Bonus de Victoria", "Bnus de Vitria", "Bonus sa pagkapanalo", "Phn thng chin thng"],
    "Early Suicide": ["Suicidio temprano", "Sucidio prematuro", "Maagang Pagpakamatay", ""],
    "No winning bonus (because you already won %% many times today. Play for fun, play with others, or continue tomorrow).": ["No hay bonificacin de victoria (porque usted ya ha ganado %% muchas veces hoy. Juega por diversin, juega con otros usuarios o continua maana).",
      "Sem bnus de vitria (por que voc j venceu %% muitas vezes hoje. Jogue por diverso, jogue com outros, ou continue amanh).", "Walang GP (dahil nanalo ka na ng %% maraming beses ngayong araw. Maglaro para sa katuwaan, makipaglaro sa iba o magpatuloy bukas)", ""
    ],
    "Sudden Death in %% turns": ["Muerte sbita en %% turnos", "Sudden Death em %% turnos", "%% turns bago mag Sudden Death", ""],
    Turns: ["Turnos", "Turnos", "", ""],
    "Sudden Death Started!": ["Muerte Sbita Iniciada!",
      "Sudden Death Iniciado!", "Simula na ang Biglaang Pagkamatay!", "Ch  Sudden Death bt u!"
    ],
    "Lobby Screen": ["Pantalla Lobby", "Tela do Lobby", "Screen ng Lobby", ""],
    "Join a game, chat or shop": ["Entra a un juego, chat o tienda", "Entre em um jogo, chat ou shop", "Sumali sa laro, makipagusap o pumunta sa tindahan", ""],
    "Quick Play": ["", "Jogo Rpido", "", ""],
    "Join to an available game room": ["Entrar a una sala disponible", "Entrar em uma sala disponvel", "Sumali sa kwarto na may bakante",
      ""
    ],
    Create: ["", "Criar", "", ""],
    "Create your own game room": ["Crea tu propia sala", "Crie sua prpria sala", "Gumawa ng iyong room", ""],
    Shop: ["", "Compras", "", ""],
    "Buy and use avatars (items)": ["Comprar y usar avatares (items)", "Comprar e usar avatars (items)", "Bumili at gumamit ng avatars (mga gamit)", ""],
    "My Info": ["", "Minha Info", "", ""],
    "Change Name & Photo": ["Cambia Nombre & Foto", "Mudar Nome & Foto", "Palitan ang Pangalan at Litrato", ""],
    Options: ["", "Opes", "", ""],
    "Music / Sound / Graphics": ["Msica / Sonido / Grficos",
      "Msica / Som / Grficos", "Kanta / Tugtog / Graphics", ""
    ],
    "Rooms List": ["Lista de Salas", "Lista de Salas", "Listahan ng kwarto", "Danh sach phng"],
    'Click on a "Waiting" room to join to a game': ['Clic en una sala "En Espera" para entrar en juego', 'Clique em uma sala "Em Espera" para entrar em um jogo', 'Magclick ng "Waiting" na kwarto upang makasali sa laro', ""],
    "Room Screen": ["Pantalla de Salas", "Tela do Jogo", "Room Screen", "Room Screen", "Mn hnh phng"],
    'When all players are "Ready" the room master can start a game': ['Cuando todos los jugadores estn "Listos" el master de la sala puede iniciar el juego',
      'Quando todos os jogadores estiverem "Prontos" o master da sala pode comear o jogo', 'Kapag "Ready" na ang lahat ng manlalaro, maaari nang i-start ng room master', ""
    ],
    "To ready": ["Listo", "Para ficar pronto", "Para magready", " sn sng"],
    "For room master to start a game": ["Para el master de la para comenzar el juego", "Para o master da sala comear o jogo", "Para ma-start ng master", ""],
    "Game Screen": ["Pantalla de Juego", "Tela do Jogo", "Game Screen", "Mn hnh game"],
    "You have to kill the other team to win. Shoot in your turn": ["Tienes que matar al otro equipo para ganar. Dispara en tu turno", "Mate o time oponente para vencer. Atire no seu turno", "Kailangang patayin ang kabilang kampo upang manalo", ""],
    "Up/Down": ["Arriba/Abajo", "Cima/Baixo", "Taas/Baba", "Ln/Xung"],
    "Change angle": ["Cambiar Angulo", "Mudar ngulo", "Palitan ang angle", "i gc"],
    "Left/Right": ["Izquierda/Derecha", "Esquerda/Direita", "Kaliwa/Kanan", "Tri/Phi"],
    "Walk (on your turn)": ["Caminar (en su turno)", "Ande (no seu turno)", "Lakad (sa turn mo)", "Di chuyn( trong lt ca bn)"],
    Space: ["Espacio", "Espao", "Space", ""],
    "Shoot. Hold down for more power": ["Dispara. Mantega presionado para mas poder", "Atire. Mantenha pressionado para mais fora", "Tira. Tagalan ang pindot para lumakas", ""],
    "COMPANY EMAILS": ["EMAILS DE EMPRESAS", "EMAILS DE EMPRESAS", "PANGKOMPANYANG MGA EMAIL", ""],
    Community: ["Comunidad", "Comunidade", "Komunidad",
      "Cng ng"
    ],
    "ENGLISH ONLY": ["SOLO INGLS", "APENAS INGLS", "INGLES LANG", ""],
    "English / Spanish": ["Ingls / Espaol", "Ingls / Espaol", "", ""],
    "Business Relations": ["Relacciones de Negocios", "Relaes de Negcios", "Usapang Pangnegosyo", ""],
    "COMPANIES ONLY, IN ENGLISH": ["SOLO EMPRESAS, EN INGLS", "EMPRESAS APENAS, EM INGLS", "Mga Kompanya lamang, sa Ingles", ""],
    "GM LIST": ["LISTA DE GMs", "LISTA DE GMs", "Listahan ng GMs", "Danh sch GM"],
    "Last Update": ["ltima Actualizacin", "ltima Atualizao", "Huling Update", ""],
    Rank: ["Nivel", "", "Ranggo", ""],
    Rule: ["Reglas", "Regra", "Patakaran", "Lut chi"],
    Players: ["Jugadores", "Jogadores", "Mga Manlalaro", ""],
    "Top 1": ["", "", "", ""],
    "Next 4": ["Prximos 4", "Prximos 4", "Sunod na 4", ""],
    "Next 16": ["Prximos 16", "Prximos 16", "Sunod na 16", ""],
    "% applied to all players with at least 6900 GP (except the first 21 players)": ["% aplica a todos los jugadores con al menos 6900 GP (excepto los primeros 21 jugadores)",
      "% aplicada para todos os players com pelo menos 6900 GP (exceto os 21 primeiros players)", "% nagaaplika sa lahat ng naglalaro na mayroong GP na hindi tataas ng 6900", ""
    ],
    "Ranking is updated every hour at about XX:10": ["El Rank se actualiza cada hora aproximadamente XX:10", "O Rank  atualizado de hora em hora s XX:10", "Ang listahan ng ranko ay naguupdate bawat oras sa oras ng XX:10", ""],
    "Refresh (F5) if you ranked up to see your new rank in game": ["Actualice (F5), si subi de nivel, para ver su nuevo nivel en el juego",
      "Recarregue (F5) se voc subiu de nvel para ver seu novo nvel no jogo", "Refresh (F50 kapag nagrank up ka, para makita ang bagong ranko mo", ""
    ],
    Sorry: ["Lo sentimos", "Desculpe", "Patawad", ""],
    "Room does not exist.<br>Please try a different room.": ["Esta sala no existe.<br>Porfavor entre en una sala diferente", "Sala no existe.<br>Por favor tente uma sala diferente.", "Walang room na ganito.<br>Subukan ang ibang room", ""],
    Full: ["Sala llena", "Cheia", "Puno", ""],
    "Too many users in the room.<br>Please try a different room.": ["Muchos jugadores en la sala.<br>Por favor entre a una sala diferente.",
      "Muitos jogadores na sala.<br>Por favor tente uma sala diferente.", "Masyadong marami nang mga player sa room na ito.<br>Kung maaari lamang ay subukan ang ibang mga kwarto.", ""
    ],
    Playing: ["En juego", "Jogando", "Naglalaro", ""],
    "The game has already started.<br>You cannot enter.": ["El juego ya comenz.<br>Ya no puedes ingresar.", "O jogo j comeou.<br>Voc no pode entrar.", "Ang larong ito ay nagsimula na.<br>Hindi ka maaaring sumali", ""],
    "Wrong Password": ["Contrasea Incorrecta",
      "Senha Incorreta", "Mali ang password", ""
    ],
    "Wrong Password.<br>Please check your password.": ["Contrasea incorrecta.<br>Por favor, verifica la contrasea.", "Senha Incorreta.<br>Por favor verifique sua senha.", "Mali ang password.<br>Pakitignan ulit ang iyong pa password", ""],
    "Kicked or Left Game": ["Expulsado o Dejaste el Juego", "Kickado ou Deixou o Jogo", "Nasipa o umalis sa laro", ""],
    "You will be able to join this room in %% seconds.": ["Podrs entrar a esta sala en %% segundos.", "Voc poder entrar nesta sala em %% segundos.",
      "Maaari ka sumali sa kwartong ito sa ilang %% segundo.", ""
    ],
    "minutes left for your mute": ["minutos le quedan a tu mute", "minutos restantes para o seu mute", "", ""],
    "Your mute is over. Please don't do this again.": ["Tu muteo ha terminado, por favor no lo hagas de nuevo", "Seu mute est encerrado. Por favor no faa isto novamente.", "Tapos na ang iyong mute. Maaari po lamang na huwag ulitin ang iyon ginawa", ""],
    "This avatar is missing in stock.": ["Este avatar ya no est a la venta",
      "Este avatar est faltando no estoque", "Ang avatar na ito ay wala nang stock", ""
    ],
    "This avatar is not available for sell right now.": ["Este avatar ya no est disponible a la venta", "Este avatar no est disponvel para venda no momento", "Ang avatar na ito ay hindi mabibili ngayon", ""],
    "The requested avatar can not be bought with this method of payment.": ["El avatar requerido ya no puede ser comprado en este mtodo de pago", "O avatar requerido no pode ser compro com este mtodo de pagamento",
      "Ang avatar na ito ay hindi mabibili sa ganitong metodo ng pagbabayad", ""
    ],
    "The requested price does not match this avatar and period.": ["El precio requerido no coincide con el avatar ni con el periodo", "O preo requerido no bate com este avatar e perodo", "Ang presyong ito ay hindi nagmamatch sa avatar at period", ""],
    "You are already buying something, please wait a while for previous purchase to finish and try again.": ["Usted ya compr algo, por favor espere unos momentos para adquirlo, finalice e intente otra vez.",
      "Voc j est comprando alguma coisa, por favor espere um momento para sua comprar anterior terminar e tente novamente.", "Ikaw ay bumibili na, maghintay lamang ng sandali upang matapos ang binili mo, tapos subukan muli.", ""
    ],
    "You already have this item. Why are you buying it again?": ["Usted ya compr este item. Por qu lo est comprando de nuevo?", "Voc j tem este item. Por que voc est comprando ele novamente?", "Binili mo na ang item na ito. Bakit mo binibili ulit?",
      ""
    ],
    "Thank You": ["Gracias", "Obrigado", "Salamat", ""],
    "You purchased": ["Usted ha comprado", "Voc comprou", "Binili mo", ""],
    Locked: ["Bloqueado", "Bloqueado", "Kandado", ""],
    "You did not open this challenge yet.\n\nTo unlock this one you have to win the previous one as room master.": ["Usted todava no ha desbloqueado este desafo.\n\nPara desbloquearlo, tienes que derrotar al anterior como master de la sala.", "Voc ainda no liberou este desafio.\n\nPara desbloquear este voc tem que vencer o anterior sendo master da sala.",
      "Hindi mo pa natatapos ang challenge na ito.\n\nPara mabuksan mo, kinakailangan mong manalo bilang room master.", ""
    ],
    "Already Playing": ["Ya estn jugando", "J est Jogando", "Naglalaro na", ""],
    "This player is already in the room.\n\nPlease select a different one.": ["Este jugador ya est en la sala.\n\nPor favor, seleccionar a otro diferente", "Este jogador j est na sala.\n\nPor favor selecione um diferente.", "Ang player na ito ay nasa kwarto na.\n\nMaaari lamang na pumili ng iba",
      ""
    ],
    Event: ["Evento", "Evento", "", ""],
    "You won the event!\nHere is a gift of <u>%% Cash</u> and <u>%% Gold": ["Ganaste el evento!\nAqu est tu premio de <u>%% Cash</u> y <u>%% Gold", "Voc venceu o evento!\nAqui est o seu prmio de <u>%% Cash</u> e <u>%% Gold", "Nanalo ka sa event!\nIto ang gantimpala na<u>%% Cash</u> at <u>%% Gold", ""],
    "Come back in at least <u>4 hours</u>\nto get another gift.": ["Vuelve en por lo menos <u>4 horas</u>\npara obtener otro premio.", "Volte em pelo menos <u>4 horas</u>\n para receber outro prmio.",
      "Bumalik sa hindi kukulang na <u> 4 hours</u>\n para makakuha ng panibagong regalo", ""
    ],
    "You can post again in at least <u>24 hours</u>\nto get another gift.": ["Puedes postear de nuevo en <u>24 horas</u>\npara obtener otro premio.", "Voc pode postar novamente em pelo menos <u>24 horas</u>\npara ganhar outro prmio.", "Maaari mong ipost muli nang hindi kukulang ng <u>24 oras</u>\npara makakuha ng panibagong regalo", ""],
    "You can not chat with yourself. Try to chat with someone else.": ["No puedes chatear contigo mismo. Intenta conversar con otra persona",
      "Voc no pode conversar com voc mesmo. Tente conversar com outra pessoa.", "Hindi mo maaaring kausapin ang iyong sarili. Subukan na magchat sa ibang tao", ""
    ],
    "You can not be friends with yourself. Try to friend someone else.": ["No puedes ser amigo de ti mismo. Intenta agregar a otra persona", "Voc no poder ser amigo de voc mesmo. Tente ser amigo de outra pessoa.", "Hindi mo puwedeng maging kaibigan ang iyong sarili. Humanap ka ng ibang kaibigan", ""],
    "This player is offline or does not exist.\nAdd the friend when you can see him.": ["Este usuario no est conectado o no existe.\nAgregalo como amigo cuando lo veas de nuevo.",
      "Este jogador est offline ou no existe.\nAdicione-o como amigo quando voc ver ele.", "Ang manlalarong ito ay offline o wala sa larong ito.\nMagadd ng kaibigan sa panahon na makita mo siya", ""
    ],
    "Already Friends": ["Ya son amigos", "J so amigos", "Kaibigan na", ""],
    "You are already friends.\n\nYou can see the friend in your Friends List.": ["Ustedes ya son amigos.\n\nPuedes verlo en tu Lista de Amigos.", "Vocs j so amigos.\n\nVoc pode ver seu amigo em sua Lista de Amigos.",
      "Kaibigan mo na ito.\n\nMakikita mo siya sa iyong friend list", ""
    ],
    "You can not add GM as a friend.": ["Usted no puede agregar a un GM como amigo.", "Voc no pode adicionar um GM como amigo.", "Hindi mo maaaring idagdag ang GM.", ""],
    "You sent a request to this player already.\n\nAsk him to add you, or change server to send him again.": ["Ya le enviaste una solictud de amistad a este usuario.\n\nDile si te puede agregar, o cambiar de servidor para enviarle una nueva solicitud.", "Voc j enviou um pedido de amizade para este jogador.\n\nPea para ele adicionar voc, ou re-entre no servidor para mandar um pedido novamente.",
      "Nagpadala ka ng request sa player na ito.\n\nTanong mo siya para iadd ka, o pumasok ka ulit sa server at subukan muli", ""
    ],
    "Too Many Friends": ["Demasiados Amigos", "Muitos Amigos", "Masyado ka nang maraming kaibigan", ""],
    "You have %% friends.\nLimit = %% (%% + %% Per Level)\n\nPlease delete some inactive friends first, and then invite again.": ["Usted tiene %% amigos.\nLimite = %% (%% + %% Por Nivel)\n\nPor favor, elimine a algunos amigos inactivos y luego manda invitaciones otra vez.", "Voc tem %% amigos.\nLimite = %% (%% + %% Por Level)\n\nPor favor delete alguns amigos inativos primeiro, e ento convide novamente.",
      "Mayroon ka nang %% na kaibigan.\nLimit = %% (%% + %% Per Level)\n\nMagdelete ng mga kaibigang hindi na naglalaro, at muling maginvite", ""
    ],
    "User Has Too Many Friends": ["Este usuario tiene muchos amigos", "O jogador tem muitos amigos", "Masyado nang maraming kaibigan ang user", ""],
    "That player has too many friends.\n\nAsk him to delete some friends to make space for you first.": ["Este usuario tiene muchos amigos.\n\nPregntale si puede eliminar a alguien para poder agregarte.", "Este jogador tem muitos amigos.\n\nPea para ele deletar algum amigo para liberar espao para voc primeiro.",
      "Masyado nang maraming kaibigan ang manlalarong iyon. Hilingin muna sa kanya na magbura ng ilang kaibigan para magawan ka nya ng lugar sa kanyang buddy list.", ""
    ],
    "Friend Request Sent": ["Solicitud de Amistad enviada", "Pedido de Amizade enviado", "Napadala na ang friend request", ""],
    "You asked %% to be friends.\n\nWhen he approves your request you will see the friend in your Buddy List.": ["Le pediste a %% ser amigos.\n\nCuando se apruebe tu solicitud podrs verlo como amigo en tu Lista de Amigos.",
      "Voc pediu %% para ser seu amigo.\n\nQuando ele aceitar seu pedido voc ir ver seu amigo em sua Lista de Amigos.", "Tinanong mo si %% upang maging iyong kaibigan.\n\n pag inaproba niya ay makikita mo siya sa iyong buddy list.", ""
    ],
    "Friend Added :)": ["Amigo agregado :)", "Amigo Adicionado :)", "Nadagdag na ang iyong kaibigan :)", ""],
    "You have a new friend.\n\nYou can now see where is your friend in your Buddy List, and private chat even at different rooms.": ["Tienes un nuevo amigo: %%\n\nAhora puedes ver dnde se encuentra en tu Lista de Amigos, y enviarle chats privados a diferentes servidores.",
      "Voc tem um novo amigo: %%\n\nVoc pode ver onde seu amigo est na sua Lista de Amigos e abrir um chat privado mesmo em uma sala diferente.", "Mayroon kang bagong kaibigan.\n\nMakikita mo na siya sa buddy list, at private chat sa ibang mga kwarto", ""
    ],
    "Sorry, you can send private messages to friends and guild members only.": ["Lo sentimos, solo puedes enviarles mensajes privados a tus amigos y miembres de tu guild.", "Desculpe, voc pode mandar mensagens privadas para amigos e membros da guild apenas.",
      "Patawad, maaari ka lamang magpadala ng mensahe sa iyong mga kaibigan o kaguild", ""
    ],
    "Friend Deleted :(": ["Amigo eliminado :(", "Amigo deletado :(", "Nadelete na ang iyong kaibigan", ""],
    "How sad...": ["Qu pena...", "Triste...", "Nakakalungkot...", ""],
    "You are not in a guild": ["Usted no est en un guild", "Voc no est em uma guild", "Wala kang guild", ""],
    "The user is not in your guild.": ["Este usuario no est en tu guild", "O usurio no est em sua guild", "Ang user na ito ay wala sa guild",
      ""
    ],
    "You do not have kick powers, ask the guild leader to kick.": ["Usted no puede sacar miembros de su guild, pregntale al lder del guild que lo haga", "Voc no tem poder para kickar, pea para o lder kickar.", "Walang kang power para manipa, itanong mo sa iyong pinuno upang siya ang manipa ng miyembro", ""],
    "You can not kick yourself.": ["No puedes kickearte a ti mismo.", "Voc no pode kickar voc mesmo.", "Hindi mo maaaring masipa ang iyong sarili", ""],
    Kicked: ["Kickeado", "Kickado", "Nasipa na", ""],
    "Can't set Boss mode if there are more than 4 players in the room.": ["No se puede jugar en modo Boss si hay en la sala ms de 4 jugadores", "No pode mudar para Modo Chefe se tiver mais de 4 jogadores na sala.", "Hindi maset ang boss mode dahil may apat na tao na sa iyong room", ""],
    "You are already in a guild. You have to leave your guild first.": ["Usted ya est en un guild. Tienes que dejar tu guild primero", "Voc j estar em uma guild. Voc tem que sair da sua guild primeiro.",
      "Nasa guild ka na. Kinakailangan mo magleave muna sa dati mong guild", ""
    ],
    "Guild name must be 2-6 letters.": ["El nombre del guild debe tener entre 2-6 letras.", "Nome da guild deve ter entre 2-6 letras.", "Ang guild name mo ay dapat 2-6 letters lamang.", ""],
    "Guild name must not contain filtered words.": ["El nombre del guild no debe tener palabras filtradas.", "O nome da guild no pode conter palavras filtradas.", "Ang guild name mo ay dapat walang mga filtered words.", ""],
    "Not enough gold.": ["No hay suficiente Gold.",
      "Sem gold suficiente.", "Hindi sapat ang ginto mo.", ""
    ],
    "Already Exists": ["Ya existe", "J Existe", "Mayroon na", ""],
    "There is already a guild at this name. Please select a different name.": ["Ya existe un guild con este nombre. Por favor escoja otro nombre", "J existe uma guild com este nome. Por favor selecione um nome diferente.", "Mayroon nang guild na ganito ang pangalan. Kung maaari lamang ay pumili ng iba", ""],
    Done: ["Listo", "Feito", "Tapos", ""],
    "Guild created! You are the guild leader. You can now invite players to join it.": ["Guild creado! Usted es el lder del guild. Ahora puedes invitar jugadores a que se unan",
      "Guild criada! Voc  o lder da guild. Voc pode convidar jogadores para se juntar a sua guild.", "Nagawa na ang guild! Ikaw ang pinuno. Maaari kang magimbita ng ibang manlalaro para sumali sayo.", ""
    ],
    "You can not invite yourself.": ["No puedes invitarte a ti mismo.", "Voc no pode convidar voc mesmo.", "Hindi mo maiimbita ang iyong sarili.", ""],
    "You do not have invite powers, ask the guild leader to invite.": ["Usted no tiene los poderes para invitar, pdele al lder del guild que lo invite.",
      "Voc no tem poder para convidar, pea para o lder da guild convidar.", "Wala kang power para magimbita, tanong mo ang iyong pinuno para gawin para sayo.", ""
    ],
    "You sent a request to this player already.\n\nRe-enter to the server to send him again.": ["Usted ya le ha enviado una solicitud a este usuario.\n\nRe-ingresa al server para invitarlo otra vez.", "Voc j enviou uma solicitao para este jogador.\n\nRe-entre no server para mandar novamente.", "Nagpadala ka ng request sa player na ito dati.\n\nSubukan na pumasok muli sa server at i-send muli",
      ""
    ],
    "Guild is full.": ["El guild est lleno.", "A guild est cheia.", "Puno na ang guild.", ""],
    "This player is already in a guild. Ask him to leave his current guild before you can invite him/her.": ["Este usuario ya tiene guild. Pregntale si puede dejar su actual guild antes de inivtarlo(a)", "Este jogador j possui uma guild. Pea para ele sair de sua guild atual antes de voc convidar ele/ela.", "Nasa guild na ang itong player, pakisabi na umalis muna siya sa kanyang guild upang maimbita mo siya",
      ""
    ],
    "Guild Invite Sent": ["Solicitud de guild enviada", "Convite de Guild enviado", "Napadala na ang guild invite", ""],
    "You asked %% to join your guild.\n\nWhen he approves your request he will join the guild.": ["Le pediste a %% que se una a tu Guild.\n\nCuando apruebe tu solicitud, se unir a tu guild.", "Voc pediu %% para se juntar a sua guild.\n\nQuando ele aceitar seu pedido, ele ir se juntar a guild.", "Tinanong mo si %% na sumali sa iyong guild.\n\n Pag nagaprove siya, kasali na siya sa iyong guild",
      ""
    ],
    "You have 1 Free name change": ["Tienes un cambio de nick gratis", "", "Mayroon kang isang libreng change name", ""],
    "Name Change costs 4,000 Cash": ["Cambiarte de nick cuesta 4,000 Cash", "", "Ang halaga ng pagpalit ng pangalan ay 4,000 cash", ""],
    "Joined Guild :)": ["Guild Registrado :)", "", "Nakasali sa guild", ""],
    "You have joined the guild.\n\nYou can now see where is your friend in your Guild Tab, and private chat even at different rooms.": ["Usted se a unido al guild.\n\nAhora puede ver donde esta tu amigo en tu Guild , chat privado incluso en sala diferentes.",
      "", "Nakasali ka na sa guild.\n\nMaaari mo nang makita ang mga kaibigan mo sa guild tab, sa private chat o sa ibang kwarto pa man", ""
    ],
    "Guild leader can not leave his guild while there are other members. If you are the last one to leave, the guild will be closed and deleted.": ["El lider no puede salir del Guild , mientras que hay otros miembros . si usted es el ultimo en salir , el Guild sera cerrado y eliminado", "", "Ang guild leader ay hindi maaaring umalis sa guild niya habang mayroon pang mga miyembro. Kapag ikaw ang huli na aalis, ang guild ay sasarado na",
      ""
    ],
    "Nobody left in the guild, so the guild was closed. The name is now available for new guilds.": ["Nadie se queda en el Guild , por que el Guild estaba cerrado . El nombre ya esta disponible para nuevos Guilds.", "", "Wala nang nasa guild, kaya sarado na ito. Maaari na ito kunin ng ibang mga tao", ""],
    "You left your guild...\n\nHow sad... :(": ["Dejo su Guild .... \n\n!Que Triste ... :(", "", "Umalis ka sa iyong guild...\n\nNakakalungkot...", ""],
    "Nothing to do": ["Nada que hacer", "", "Walang magawa", ""],
    "The new name is the same as your current name.": ["El nuevo nick es igual a tu actual nick.", "", "Ang bagong pangalan na pinili mo ay pareho sa pangalan mo sa kasalukuyan", ""],
    "Name length must be 2-15": ["El nombre debe contener 2-15", "", "Ang haba ng pangalan ay kinakailangan sa gitna ng 2-15", ""],
    "Name must contain at least 2 english letters a-z/A-Z": ["El nombre debe conecter aunque sea 2 letras a-z/A-Z", "", "Ang pangalan ay dapat mayroong hindi kukulang na 2 English letters a-z/A-Z", ""],
    "Name contains a character that is not allowed.<p>Allowed chars": ["El nombre contiene un caracter no permitido <p> caracteres permitidos.",
      "", "Ang pangalan ay mayroong letra na hindi maaaring gamitin.<p>Mga allowed na chars", ""
    ],
    "Not enough cash.<p>Name change costs 4,000 cash.": ["No Tiene suficiente cash.<p>El cambio de nick cuesta 4,000 Cash.", "", "Hindi sapat ang cash mo.<p>Ang name change ay 4,000 Cash", ""],
    "The new name contains a word which is not allowed. Please select a different one.": ["El nuevo nombre contiene una palabra que no esta permitida. Por favor seleccione uno diferente", "", "Ang bagong pangalan ay mayroong salita na hindi maaaring gamitin. Pumili ng iba",
      ""
    ],
    "Not enough time passed since last name change. Check that your name was not changed already, if you change again, it will cost you again.<br>Please wait 30 minutes before you can change again.": ["No a pasado mucho tiempo desde el ultimo cambio de nick. Compruebe si su nick no a cambiado ya, si lo cambia otra vez, le costara nuevamente.<br> Por favor espere 30 minutos antes de cambiar de nuevo.", "", "Kinulangan ng oras dahil sa pagchange name mo. Tignan muli, pagnagchange ka ulit ay kinakailangan mo bayaran muli.<br>Maghintay ng 30 minuto upang makapagpalit muli",
      ""
    ],
    "This name already exists, please select a different one.": ["Este nombre ya existe, por favor seleccione uno diferente.", "", "Mayroon nang ganitong pangalan, kung maaari lamang ay pumili ng iba", ""],
    "New Challenge Unlocked": ["Nuevo Desafio Desbloqueado", "", "Nagunlock ang bagong challenge", ""],
    "You killed my friend! Do you think you are so good?\n\nI challenge you for a duel!\n\nI will be waiting for you...": ["Usted mat a mi amigo! Te crees tan bueno?  ", "", "Pinatay mo ang aking kaibigan! Kala mo ang galing mo?\n\nI Gusto kitang kalabanin para sa duel!\n\nHihintayin kita...",
      ""
    ],
    "Not enough Cash. You can get more by charging.": ["No hay suficiente Cash. Puedes obtener mas recargando.", "", "Hindi sapat ang cash mo. Maaari kang makakuha ng masmarami sa paraan ng pagcharge", ""],
    "Not enough Gold. You can get more by playing.": ["No hay suficiente Oro. Puedes obtener mas jugando.", "", "Hindi sapat ang gold mo. Maaari kang makakuha pa sa paraan ng paglalaro", ""],
    "This avatar is not for your gender.": ["Este avatar no es para tu genero.", "", "Ang avatar na ito ay hindi para sa iyong kasarian",
      ""
    ],
    Days: ["Das", "Dias", "Araw", ""],
    Hours: ["Horas", "Horas", "Oras", ""],
    Minutes: ["Minutos", "Minutos", "Minuto", ""],
    Seconds: ["Segundos", "Segundos", "Segundo", ""],
    "Press F5 to reload": ["Presione F5 para recargar", "Pressione F5 para recarregar", "", ""],
    Your: ["Su", "Seu", "", ""],
    "20,000 first players with 1100+ GP will get the (RARE) Beta Flag!<br>200% GP & GOLD for 2 days since open time!<br>2000 Free Cash every day at the Post Button!": ["", "20000 primeros jugadores con 1,100 + GP tendrn la (RARE) Beta Flag!<br>200% de GP y Oro durante 2 das desde el tiempo de apertura!<br>2000 caja libre todos los das en el botn Poste!",
      "", ""
    ],
    "Welcome to DragonBound": ["Bienvenido a Dragonbound", "Bem-vindo ao DragonBound", "", ""],
    "Next generation online HTML5 realtime multiplayer game.<br><br>Click connect and start playing with your friends :)": ["Generacin en lnea HTML5 juego multijugador en Siguiente.<br>Haga clic en Conectar y empezar a jugar con tus amigos :)", "Prxima gerao on-line HTML5 jogo multiplayer.<br>Clique conectar e comear a jogar com os seus amigos :)", "", ""],
    "HTML5 online multiplayer game": ["HTML5 juego online multijugador",
      "HTML5 jogo online multijogador", "", ""
    ],
    "Play with or against your friends from your browser anywhere for free. Shop for avatars to make you stronger. Unlock hidden characters, game modes, and challenges. Meet new friends. Single player option too.": ["Juega gratis con o contra tus amigos desde tu navegador en cualquier lugar. Compra avatar para fortalecerte. Desbloquea personajes ocultos, modos de juego y desafos. Conoce nuevos amigos o utiliza la opcin de jugar solo.", " um jogo gratuito onde voc pode jogar com ou contra seus amigos a partir do seu navegador em qualquer lugar, loja de avatares para torn-lo mais forte, desbloquear personagens ocultos, modos de jogo e desafios. Conhecer novos amigos e jogar sozinho tambm.",
      "", ""
    ],
    "Waiting for an opponent": ["Esperando un oponente", "Esperando por um oponente", "", ""],
    "Tournament not started yet.": ["Torneo No Iniciado Aun.", "Torneio ainda no comeou.", "", ""],
    "Tournament ended.": ["Torneo Terminado.", "Torneio finalizado.", "", ""],
    "Games Now": ["Juegos Ahora", "Jogos Agora", "", ""],
    "Games Last 5 Minutes": ["Juegos en 5 minutos", "Jogos em 5 Minutos", "", ""],
    "Games Since Server Reset": ["Juegos desde el reinicio del servidor", "Jogos desde a reinicializao do servidor",
      "", ""
    ],
    "Average Waiting Time": ["Promedio de tiempo de espera", "Tempo mdio de espera", "", ""],
    "New Password": ["Nueva contrasea", "", "", ""],
    "Password Changed": ["Contrasea cambiada", "", "", ""],
    "Change Password": ["Cambiar Contrasea", "", "", ""],
    "Too Short": ["Demasiado corto", "", "", ""],
    "Too Easy": ["Demasiado facil", "", "", ""],
    Good: ["Bien", "", "", ""],
    "Secret Number": ["Numero Secreto", "", "", ""],
    "Password too short. Length 6+ needed.": ["Contrasea muy corta. Necesario 6+ caracteres.",
      "", "", ""
    ],
    "Password too easy to guess. Make it harder.": ["Contrasea muy fcil de adivinar. Ponga una mas dificil.", "", "", ""],
    "Secret number too short. Length 6+ needed.": ["Numero secreto muy corto. Necesario 6+ caracteres.", "", "", ""],
    "Secret number too easy to guess. Make it harder.": ["Numero secreto muy fcil de adivinar. Ponga una mas dificil.", "", "", ""],
    "Create Team": ["Crear Equipo", "Criar Equipe", "", ""],
    "Join Team": ["Unirse al Equipo", "Entrar Equipe", "", ""],
    "Start 1v1 Game": ["Iniciar Juego de 1v1",
      "Comear Jogo 1v1", "", ""
    ],
    "4v4 Guild vs Guild Games": ["Juegos de Guild vs Guild (4v4)", "Jogos 4v4 Guild vs Guild", "", ""],
    "^ Click ^<br><br>Want More DragonBound Cash?<br><br>There are many ways to get cash!<br><br>Select one and see how :)": ["^ Click ^<br><br>Quieres mas Dragonbound Cash?<br><br>Hay muchas maneras de obtener el cash!<br><br>Selecciona una de estas opciones y mira como hacerlo! :)", "^ Click ^<br><br>Quer mais Dragonbound Cash?<br><br>Existem muitas maneiras de ganhar cash<br><br>Selecione uma destas opes e veja como :)",
      "", ""
    ],
    "Need 4 players of the same guild to play on this server.": ["Necesita 4 jugadores del mismo Guild para jugar en ste servidor.", "Necessita de 4 jogadores da mesma guild para jogar neste servidor.", "", ""],
    Friends: ["Amigos", "Amigos", "Kaibigan", ""],
    "Show More Friends": ["Mostrar Mas Amigos", "Mostrar Mais Amigos", "", ""],
    "Showing Friends": ["Mostrando Amigos", "Mostrando Amigos", "", ""],
    "Refresh List": ["Actualizar Lista", "Atualizar Lista", "Panariwain ang listahan", ""],
    "I won": ["Yo gane", "Eu venci",
      "", ""
    ],
    won: ["gane", "venci", "", ""],
    "We won": ["Nosotros Ganamos", "Ns vencemos", "", ""],
    "I played with": ["Yo jugue con", "Eu joguei com", "", ""],
    "played with": ["jugue con", "joguei com", "", ""],
    "I saw a game": ["Yo vi un juego", "Eu assisti um jogo", "", ""],
    "DragonBound Results Screenshot (Verified)": ["Screenshot de los rsultados del DragonBound", "DragonBound Screenshot dos Resultados (Verificado)", "", ""],
    "View Last Game Results": ["Ver resultados del ultimo juego", "", "Tingnan ang huling resulta ng laro",
      ""
    ],
    "Quick Join": ["Entra Rpido", "", "", ""],
    Join: ["Entren", "", "", ""],
    "Let's Play Together!": ["Juguemos Juntos!", "", "Tayo nang maglaro ng magkakasama.", ""],
    "I am waiting at": ["Estoy esperando en", "", "", ""],
    "Click here to join my room": ["Dale click aqu para entrar a mi sala", "", "", ""],
    "Click here to enter my room": ["Dale click aqu para entrar a mi sala", "", "", ""],
    "Invitation posted": ["Invitacin enviada", "", "", ""],
    "Invitation canceled": ["Invitacin cancelada", "", "", ""],
    Invite: ["Invitar",
      "", "", ""
    ],
    Room: ["Sala", "", "", ""],
    "New User?<br>(1) Click Here": ["Eres Nuevo?<br>(1) Click Aqui", "", "", ""],
    NEW: ["NUEVO", "", "", ""],
    New: ["Nuevo", "", "", ""],
    'You are entering "Do Not Disturb" mode.<br>You will not see private messages while in this mode.<br>You can select an "Auto-Reply" message (empty for none):': ['Ests entrando al modo "No Molestar".<br>Mientras estes en este modo no podrs ver tus mensajes privados.<br>Puedes seleccionar una "Respuesta Automtica" (vaco para ninguna):',
      "", "", ""
    ],
    "Sorry, I am busy right now.": ["Disculpa, estoy ocupado en este momento.", "", "", ""],
    "You got a PM from": ["Has recibido un mensaje privado de", "", "", ""],
    "Sort:": ["Ordenar:", "", "Uriin:", ""],
    Name: ["Nombre", "", "Pangalan", ""],
    "Can't Buy": ["No Puede", "", "Hindi Mabibili", ""],
    "^ Click to buy ^": ["^ Click para Comprar ^", "", "^ Pindutin para Makabili ^", ""],
    "Need More Cash?": ["Necesitas Mas Cash?", "", "Kailangan ng maraming pera?", ""],
    "1 Week": ["1 Semana", "", "1 Linggo", ""],
    "1 Month": ["1 Mes", "", "1 Buwan",
      ""
    ],
    Limitless: ["Eterno", "", "Habang Buhay", ""],
    "Are you sure you want to purchase": ["Estas seguro que desea comprar", "", "", ""],
    "for": ["por", "", "", ""],
    "time at": ["de tiempo en", "", "", ""],
    at: ["a", "", "", ""],
    "Are you sure?": ["Estas seguro?", "", "", ""],
    "You were moved to lobby": ["Usted fue movido al lobby", "", "", ""],
    "Guild Disqualified": ["Guild Descalificado", "", "", ""],
    "Your guild can not participate in this tournament anymore because it has a score of %%.<br><br>The minimum score to participate is %%.": ["Su guild ya no puede participar ms en este torneo, pues tiene un puntaje de %%<br><br>El puntaje mnimo para participar es %%",
      "", "", ""
    ],
    Disqualified: ["Descalificado", "", "", ""],
    "You can not participate in this tournament anymore because you have a score of %%<br><br>The minimum score to participate is %%.": ["Ya no puedes participar ms en este torneo, pues tienes un puntaje de %%<br><br>El puntaje mnimo para participar es de %%", "", "", ""],
    "No Guild": ["No tienes Guild.", "", "", ""],
    "You need to have a guild to play on this server.": ["Necesitas un guild para jugar en este server.", "", "", ""],
    "Can't start": ["No puedes empezar.",
      "", "", ""
    ],
    "Need 4 players in your team.": ["Necesitas 4 jugadores en tu equipo.", "", "", ""],
    "Need 2-4 players in your team.": ["Necesitas 2-4 jugadores en tu equipo.", "", "", ""],
    "Someone is not ready.": ["Alguien an no est listo.", "", "", ""],
    "Guilds are locked during the tournament. Try again later.": ["Los Guilds estn bloqueados durante el torneo. Intntalo ms tarde.", "", "", ""],
    "Avatars Collection": ["Coleccin De Avatares", "", "", ""],
    "You do not have a guild yet.<br><br>To create a Guild select a name, pay 50,000 Gold, and press the button.<br><br>Guild Name": ["Usted no tiene guild todava.<br><br>Para crear un Guild selecciona un nombre, paga 50,000 de Gold y presiona el botn.<br><br>Nombre del Guild",
      "", "", ""
    ],
    "Are You Sure?": ["Ests seguro?", "", "", ""],
    "Bad Name": ["Mal Nombre", "", "", ""],
    "Can not use invisible letters in guild name.<br><br>Try a different name.": ["No puedes usar letras invisibles en el nombre de tu guild.<br><br>Intenta con un nombre diferente.", "", "", ""],
    "Are you sure you want to create the guild": ["Ests seguro de que quieres crear el guild", "", "", ""],
    'By clicking OK you will pay <font color="yellow">50,000 Gold</font> and create the guild.': ['Apretando OK pagars <font color ="yellow">50,000 Gold</font> y crears el guild.',
      "", "", ""
    ],
    "Are you sure you want to leave your guild?": ["Ests seguro de que quieres salir del guild?", "", "", ""],
    "You've logged into another account on the same computer.<br>Press [OK] to refresh the page and change account, or relog back to this account.": ["Has iniciado sesion en otra cuenta en el mismo equipo.<br>Pulse [OK] para actulizar la pagina para cambiar de cuenta o iniciar sesion de nuevo a esta cuenta.", "", "", ""],
    "View Full Profile": ["Ver Perfil Completo", "", "", ""],
    Profile: ["Perfil",
      "", "", ""
    ],
    "My Page": ["Mi Pgina", "", "", ""],
    "Password / Photo / Settings": ["Contrasea / Foto / Configuracin", "", "", ""],
    "when playing at same team": ["cuando jueguen en el mismo equipo", "", "", ""],
    "Change Photo & Settings": ["Cambiar Foto & Configuracin", "", "", ""],
    "Be My Boyfriend?": ["Quieres ser mi novio?", "", "", ""],
    "Be My Girlfriend?": ["Quieres ser mi novia?", "", "", ""],
    "Get Engaged": ["Comprometerse", "", "", ""],
    "Get Married": ["Casarse", "", "", ""],
    "Need Item": ["Necesitas un item",
      "", "", ""
    ],
    "For this action you need to use 1 item": ["Para esta accin necesitas usar 1 item", "", "", ""],
    "But you don't have any... Buy one?": ["Pero no tienes ninguno... Quieres comprar uno?", "", "", ""],
    "You received a gift from": ["Has recibido un regalo de", "", "", ""],
    "Received Gift": ["Regalo Recibido", "", "", ""],
    Boyfriend: ["Novio", "", "", ""],
    Girlfriend: ["Novia", "", "", ""],
    "mEngaged to": ["mComprometido con", "", "", ""],
    "fEngaged to": ["fComprometida con", "", "", ""],
    "mMarried to": ["mCasado con", "", "", ""],
    "fMarried to": ["fCasada con", "", "", ""],
    "Will you marry me?": ["Te casaras conmigo?", "", "", ""],
    "This is for you": ["Esto es para ti", "", "", ""],
    "Engagement Ring for you": ["Anillo de Compromiso para ti", "", "", ""],
    "Marriage Ring for you": ["Anillo de Bodas para ti", "", "", ""],
    "Relationship Request": ["Solicitud de Relacin", "", "", ""],
    "Relationship Request Sent": ["Solicitud de Relacin Enviada", "", "", ""],
    "You sent a relationship request to": ["Has enviado una solicitud de relacin a",
      "", "", ""
    ],
    "You are dead :(": ["Estas Muerto :(", "", "", ""],
    "You fell down :(": ["Te Caiste :(", "", "", ""],
    "Create a new room": ["Crear nueva sala", "", "", ""],
    "Change name/photo/settings": ["Cambiar nombre/foto/ajuste", "", "", ""],
    "Buy items": ["Comprar items", "", "", ""],
    "Get Free & Paid Cash": ["Cash Gratis & Cash Pago", "", "", ""],
    "Join known room": ["Unirse sala conocida", "", "", ""],
    "Join random room": ["Entrar al azar sala", "", "", ""],
    "Share to Facebook": ["Compartir en Facebook", "", "", ""],
    "Free Gold & Cash": ["Gold & Cash Gratis",
      "", "", ""
    ],
    "Change Server": ["Cambiar Server", "", "", ""],
    "Show all rooms": ["Mostrar todas las salas", "", "", ""],
    "Show Waiting rooms": ["Mostrar salas en Espera", "", "", ""],
    "Show Normal mode rooms": ["Mostrar salas con modo Normal", "", "", ""],
    "Show Boss mode rooms": ["Mostrar salas con modo Boss", "", "", ""],
    "Show Same mode rooms": ["Mostrar salas con modo Same", "", "", ""],
    "Show Score mode rooms": ["Mostrar salas con modo Score", "", "", ""],
    "Show your friends": ["Mostrar sus amigos", "", "", ""],
    "Show your guildmates": ["Mostrar miembros de tu guild",
      "", "", ""
    ],
    "This mode is locked until you win the 5 first boss levels.": ["", "", "", ""],
    "Revive after you die. First team to get to 0 points lose.": ["", "", "", ""],
    "Update Available!": ["", "", "", ""],
    "A newer version is available, refresh?": ["", "", "", ""],
    "Avatar Removed": ["Avatar Eliminado", "", "", ""],
    "You can UNDO and restore deleted avatars here": ["Puedes recuperar avatares eliminados aqui", "", "", ""],
    "Delete Avatar. Can undo at": ["Eliminar Avatar. Puedes recuperar aqui", "", "", ""],
    "Delete Avatar": ["Eliminar Avatar",
      "", "", ""
    ],
    "Select an avatar to delete": ["Selecione un avatar para eliminar", "", "", ""],
    "Are you sure you want to delete avatar": ["Seguro que quieres eliminar avatar", "", "", ""],
    "ON<br>SALE": ["OFERTA", "", "", ""],
    "Gift Sent": ["Ragalo Enviado", "", "", ""],
    "Gift sent": ["Ragalo enviado", "", "", ""],
    "Your friend already have this item. Please choose a different item.": ["Tu amigo ya tiene este avatar. Por favor elige uno distinto.", "", "", ""],
    "Gift to": ["Regalar a", "", "", ""],
    "Send Gift": ["Enviar Regalo", "", "", ""],
    "Send gift": ["Enviar regalo", "", "", ""],
    to: ["para", "", "", ""],
    "with message": ["con mensaje", "", "", ""],
    "^ Click to <font color=yellow>GIFT</font> ^": ["Click para <font color=yellow>ENVIAR</font>", "", "", ""],
    "Who will receive the gift? Please enter a name of a friend:": ["Quin recibir el regalo? Por favor escribe el nombre de un amigo:", "", "", ""],
    "Only high ranks can send gifts currently.": ["Por el momento, slo los de alto level pueden enviar regalos.", "", "", ""],
    "He is not your friend, please try again and enter a friend name.": ["No es su amigo, por favor escribe otra vez el nombre de un amigo.",
      "", "", ""
    ],
    "Wrong gender. Your friend can not wear this avatar. Please select another one.": ["Gnero incorrecto. Tu amigo no puede tener este avatar. Por favor escoja uno distitno.", "", "", ""],
    "Gifting to": ["Regalando a", "", "", ""],
    "OK<br>Now select a price.<br>You can also add a personal message.": ["OK<br>Ahora elige un precio.<br>Tambin puedes agregar un mensaje personal.", "", "", ""],
    "Write message for": ["Escribir mensaje para", "", "", ""],
    "Set a new password so you can always login to your account even without Facebook.<br><br>Write down your new username!<br><br>(You can change it at [My-Info])": ["Establezca una nueva contrasea para que siempre pueda acceder a su cuenta, incluso sin Facebook.<br><br>Escriba su nuevo nombre de usuario!<br><br>(Puede cambiarlo en [My-Info])",
      "", "", ""
    ],
    News: ["Noticias"],
    Forums: ["Foro"],
    "Facebook Group": ["Grupo de Facebook"],
    "Login to": ["Entrar a"],
    "Reset password?": ["Restablecer contrasea?"],
    "Create Account": ["Crear Cuenta"],
    Birthday: ["Cumpleaos"],
    "Please fill all fields": ["Por favor, rellene todos los campos"],
    Until: ["Hasta"],
    "Searching for other team": ["Buscando otro equipo"],
    Searching: ["Buscando"],
    "2v2 Couples (Boy+Girl Teams)": ["2v2 Parejas (hombre+mujer equipo)"],
    "Create Couple": ["Crear Pareja"],
    "Join Couple": ["Unirse a Pareja"],
    "Meet New Guy": ["Conocer Nuevo Chico"],
    "Meet New Girl": ["Conocer Nueva Chica"],
    "Can't Join": ["No Puedes Unirte"],
    "Same gender.<br><br>In this server you can only play together with someone of the opposite gender.": ["Mismo genero.<br><br>En este servidor slo se puede jugar con alguien del sexo opuesto."],
    "Use 1 Megaphone item to broadcast?": ["Usas 1 item Megaphone para realizar una emision?"],
    "Can't send broadcast longer than the limit of 150 letters. Yours is": ["No se puede enviar esa emisin ya que el limite es de 150 letras. El suyo es de"],
    "You have to be at least rank": ["Usted tiene que ser al menos nivel"],
    "to buy this item.": ["para poder comprar este item."],
    "Required Level": ["Nivel Requerido"],
    "The other player has blocked all friend requests. You can ask him to allow or to add you.": ["El otro jugador ha bloqueado todas la solicitudes de amistad. Puedes decirle que desbloquee la opcin o que te agregue."],
    "": [""],
    OR: ["O"]
  };
  Object.freeze(DragonLanguage.prototype);
  var ThemeDB = {
      lobby_bg: ".",
      room_bg: ".",
      shop_bg: ".",
      game_bg: "",
      ranks: "",
      lobby_stuff: "/static/images/lobby_stuff6.png",
      room_stuff: "/static/images/room_stuff2.png",
      game_stuff: "/static/images/game_stuff6.png",
      scores_stuff: "/static/images/scores_stuff2.png",
      shop_stuff: "/static/images/shop_stuff3.png",
      bg_full: "/static/images/themes/gl/bg_full.jpg",
      maps: ".",
      map_bg: ".",
      items: "/static/images/items2.png",
      classic_mobiles: 0,
      classic_maps: 0
    },
    ThemeClassic = {},
    DragonThemeDefault = {
      lobby_bg: "/static/images/themes/classic/lobby_bg.png",
      room_bg: "/static/images/themes/classic/room_bg.png",
      shop_bg: "/static/images/themes/classic/shop_bg.png",
      ranks: "",
      lobby_stuff: "/static/images/themes/classic/lobby_stuff.png",
      room_stuff: "/static/images/themes/classic/room_stuff.png",
      game_stuff: "/static/images/themes/classic/game_stuff.png",
      scores_stuff: "/static/images/scores_stuff2.png",
      shop_stuff: "/static/images/themes/classic/shop_stuff.png",
      bg_full: "/static/images/bg_full5.jpg",
      maps: "/static/images/themes/classic/maps.png",
      map_bg: ".",
      items: "/static/images/themes/classic/items.png",
      classic_mobiles: 1,
      classic_maps: 1
    },
    DragonThemeInUse = DragonThemeDefault;

  function DragonTheme_ReTheme() {
    DragonTheme_SetTheme(DragonThemeInUse)
  }

  function DragonTheme_SetTheme(a) {
    a || (a = {});
    a = DragonThemeInUse = a;
    var b = DragonTheme_Get2("lobby_bg"),
      c = DragonTheme_Get2("room_bg"),
      d = DragonTheme_Get2("shop_bg"),
      e = DragonTheme_Get2("lobby_stuff"),
      f = DragonTheme_Get2("room_stuff"),
      h = DragonTheme_Get2("game_stuff"),
      k = DragonTheme_Get2("scores_stuff"),
      m = DragonTheme_Get2("shop_stuff"),
      n = DragonTheme_Get2("bg_full"),
      p = DragonTheme_Get2("ranks"),
      q = DragonTheme_Get2("maps"),
      r = DragonTheme_Get2("items");
    p || (p = e);
    $("#DragonTheme").text("body {background-image: url(" +
      n + ");}\n" + ("." != b ? "#channelScreen {background-image: url(" + b + ");}\n" : "") + ("." != c ? "#roomScreen {background-image: url(" + c + ");}\n" : "") + ("." != d ? "#shopScreen {background-image: url(" + d + ");}\n" : "") + ".rank {background-image: url(" + p + ");background-repeat:no-repeat;}\n.itemDual,.itemTeleport {background-image: url(" + r + ");background-repeat:no-repeat;}\n.roomMap, #room_map, #RoomOptionsMapImage {background-image:url(" + (q ? q + "),url(" : "") + "/static/images/maps/minimaps.png?2);background-repeat:no-repeat;}\n.zotata-chat-icon,.room,.roomExtraInfo,.status,.roomLocked,#dialogCreateRoom,#BrokerLogout,.LobbyButton,.iconMode0,.iconMode1,.iconMode2,.iconMode3,#OptionsDialog,#BrokerRefresh,.players1v1,.players2v2,.players3v3,.players4v4,.players1vB,.players2vB,.players3vB,.players4vB,#CreateRoomPassword,.buttonOK,.buttonCancel,.buttonPrev,.buttonNext,.checkboxOff,.checkboxOn,.CheckboxOff,.CheckboxOn,.AlertBox,#ConnectWithFacebook,#ConnectWithPassword,#buttonRanking,#dialogCreateLocked,#RoomOptionsModeLocked,#OptionsOK,#OptionsLeave,.RadioOn,.RadioOff,#infoAddBuddy,#infoGuildInvite,.chatDialogDelete,.chatDialogGuildKick,.roomBuddy,.roomGuildMember,#guild_create,#guild_leave,.BrokerChannel,.paypal_corner,.buttonClose,#new_img,.BrokerChannelFullIcon,.imgLock {background-image: url(" +
      e + ");background-repeat:no-repeat;}\n#roomButtonBack,#roomButtonChangeTeam,.buttonMobile,.roomPlayerInfo,.roomPlayerNotReady,.roomPlayerReady,.roomPlayerMaster,.roomPlayerShadow,.roomBotSelect,.roomBotRemove,.roomPlayerBalloonTip,#room_timer,.GamePlayerBalloonTip,#room_change_title_button,#room_options_button,#add_bot_button,#playerInfoDialog,#infoRankingTab,.chatDialogProfile,#infoChat,#infoClose,.ChatDialog,.chatDialogClose,#room_item_buddy_tab1,#room_item_buddy_tab2,#room_item_buddy_tab3,#dialog_room_options {background-image: url(" +
      f + ");background-repeat:no-repeat;}\n.weather-0,.weather-1,#message_over_items.items_locked,#message_over_items.sudden_death,#gameui,#powerBar,#powerMark,.Turn,.DamageDigit,.LastAngleDigit,.UIGoldDigit,#btnShot1,#btnShot2,#btnShotSS,#btnPass,#btnEsc,#last_power_mark,#all_chat,#team_chat,.turn_line_number,#slice_drag_button,.imgS1 {background-image: url(" + h + ");background-repeat:no-repeat;}\n#game_over,#scores_lose_a,#scores_lose_b,.score,.score_me {background-image: url(" + k + ");background-repeat:no-repeat;}\n.shopButton,.shop_item,.shop_item_icon,.stat_icon,.stat_font,.shop_my_item,.shop_my_item_cash,.shop_my_item_gift,.shop_my_item_icon,.shop_my_item_equip.equipped,#shop_buy_dialog {background-image: url(" +
      m + ");background-repeat:no-repeat;}\n");
    e = $("#channelName,#channel,#channelInput");
    h = $("#playersList");
    f = $("#myInfoBox");
    "." == b || 1 == g_server_type ? (e.addClass("TBGnBorder"), h.addClass("TBG"), f.show()) : (e.removeClass("TBGnBorder"), h.removeClass("TBG"), f.hide());
    f = $("#shopOverly");
    "." == d ? f.show() : f.hide();
    e = $("#roomChat,#roomInput");
    b = $("#room_map");
    d = $("#room_options_button");
    f = $("#roomOverly");
    "." == c ? (e.addClass("TBGnBorder"), b.addClass("room_map_fix"), d.addClass("room_options_button_fix"), f.show()) :
      (e.removeClass("TBGnBorder"), b.removeClass("room_map_fix"), d.removeClass("room_options_button_fix"), f.hide());
    a.mobiles_hack || a.classic_mobiles || DragonThemeDefault.classic_mobiles && 0 != a.classic_mobiles ? (MOBILES[MOBILE.ARMOR] = {
        name: "Armor",
        file: "armor",
        player_x: 17,
        player_y: -28,
        explodes: [EXPLODE.ARMOR1, EXPLODE.ARMOR2, EXPLODE.ARMORSS],
        bullets: [BULLETS.ARMOR1, BULLETS.ARMOR2, BULLETS.ARMORSS, BULLETS.ARMOESS2],
        graphics: [
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37],
          [36, 40, 21, 37]
        ]
      }, MOBILES[MOBILE.ICE].name = "Ice", MOBILES[MOBILE.ICE].file = "ice", BULLET[BULLETS.ICE1].file = "ice1", BULLET[BULLETS.ICE2].file = "ice2", BULLET[BULLETS.ICESS].file = "iceSS", EXPLODES[EXPLODE.ICE1].file = "ice1", EXPLODES[EXPLODE.ICE2].file = "ice2", EXPLODES[EXPLODE.ICESS].file = "iceSS", EXPLODES[EXPLODE.ICESS].fileS = "iceSSs",
      BULLET[BULLETS.BIGFOOT1].file = "bigfoot1", BULLET[BULLETS.BIGFOOT2].file = "bigfoot2", MOBILES[MOBILE.JD] = {
        name: "J.D",
        file: "jd",
        player_x: 11,
        player_y: -34,
        explodes: [EXPLODE.LIGHTINING12_JD1, EXPLODE.JD2, EXPLODE.JDSS],
        bullets: [BULLETS.JD1, BULLETS.JD2, BULLETS.JDSS],
        graphics: [
          [35, 45, 17, 43],
          [35, 45, 17, 43],
          [34, 45, 17, 43],
          [35, 45, 18, 43],
          [35, 45, 18, 43],
          [35, 45, 18, 43],
          [35, 45, 18, 43],
          [35, 45, 18, 43],
          [35, 45, 18, 43],
          [35, 45, 18, 43],
          [34, 45, 17, 43],
          [35, 45, 17, 43],
          [35, 45, 17, 43],
          [35, 44, 17, 42],
          [35, 44, 17, 42],
          [35, 44, 17, 42],
          [35, 44, 17, 42],
          [35, 45, 17, 43],
          [35, 45, 17, 43],
          [35, 45, 17, 43]
        ]
      }, MOBILES[MOBILE.ASATE] = {
        name: "A.Sate",
        file: "asate",
        player_x: -2,
        player_y: -30,
        explodes: [EXPLODE.LIGHTINING12_JD1, EXPLODE.JD2, EXPLODE.JDSS],
        bullets: [BULLETS.JD1, BULLETS.JD2, BULLETS.JDSS],
        graphics: [
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 31, 25, 33],
          [44, 31, 25, 33],
          [44, 31, 25, 33],
          [44, 31, 25, 33],
          [44, 31, 25, 33],
          [44, 31, 25, 33],
          [44, 31, 25, 33],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32],
          [44, 30, 25, 32]
        ],
        ion_file: "asateIon",
        ion_graphics: [
          [32, 19, 16, 9],
          [32, 18, 16, 9],
          [32, 17, 16, 8],
          [32, 15, 16, 7],
          [32, 14, 16, 7],
          [32, 12, 16, 6],
          [32, 14, 16, 7],
          [32, 17, 16, 9],
          [32, 17, 16, 9],
          [32, 17, 16, 9],
          [32, 14, 16, 7],
          [32, 12, 16, 6],
          [32, 13, 16, 7],
          [32, 15, 16, 8],
          [32, 17, 16, 9],
          [32, 18, 16, 9],
          [32, 19, 16, 10],
          [32, 20, 16, 10],
          [32, 20, 16, 10],
          [32, 20, 16, 10]
        ]
      }, MOBILES[MOBILE.LIGHTNING] = {
        name: "Lightning",
        file: "lightning",
        player_x: 10,
        player_y: -34,
        explodes: [EXPLODE.LIGHTINING12_JD1, EXPLODE.LIGHTNINGSS],
        bullets: [BULLETS.LIGHTNING12, BULLETS.LIGHTNINGSS],
        graphics: [
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35],
          [42, 37, 19, 35]
        ]
      }, MOBILES[MOBILE.BIGFOOT] = {
        name: "BigFoot",
        file: "bigfoot",
        player_x: -2,
        player_y: -31,
        explodes: [EXPLODE.BIGFOOT1SS, EXPLODE.BIGFOOT2],
        bullets: [BULLETS.BIGFOOT1, BULLETS.BIGFOOT2, BULLETS.BIGFOOTSS],
        graphics: [
          [49, 45, 24,
            41
          ],
          [49, 45, 24, 41],
          [49, 45, 24, 41],
          [49, 45, 24, 41],
          [49, 45, 24, 41],
          [50, 45, 25, 41],
          [50, 45, 25, 41],
          [49, 45, 24, 41],
          [49, 45, 24, 41],
          [49, 45, 24, 41],
          [49, 45, 24, 41],
          [49, 46, 24, 42],
          [49, 46, 24, 42],
          [49, 46, 24, 42],
          [49, 46, 24, 42],
          [49, 46, 24, 42],
          [49, 46, 24, 42],
          [49, 46, 24, 42],
          [49, 46, 24, 42],
          [49, 46, 24, 42]
        ]
      }, MOBILES[MOBILE.RANDOM] = {
        name: "Random",
        file: "random",
        player_x: 4,
        player_y: -38,
        graphics: [
          [25, 45, 19, 50],
          [26, 45, 19, 50],
          [24, 45, 19, 50],
          [23, 45, 19, 50],
          [25, 45, 19, 50],
          [26, 45, 19, 50],
          [25, 45, 19, 50],
          [23, 45, 19, 50],
          [25, 45, 19, 50],
          [26, 45, 19, 50],
          [24,
            45, 19, 50
          ],
          [23, 45, 19, 50]
        ]
      }) : InitGlobals();
    DragonTheme_Save()
  }

  function DragonTheme_Save() {
    localStorage.theme = DragonTheme_ToJSON(!0)
  }

  function DragonTheme_Load() {
    1 != DragonTheme_SetThemeFromJSON(localStorage.theme) && DragonTheme_SetThemeFromJSON()
  }

  function DragonTheme_ChangeOneProperty(a, b, c) {
    if (void 0 == DragonThemeDefault[a]) return 0;
    b || (b = void 0);
    if (DragonThemeInUse[a] == b) return 0;
    b && c && DoesFileExist(b, !1, function(b) {
      c(a, b)
    });
    DragonThemeInUse[a] = b;
    DragonTheme_SetTheme(DragonThemeInUse);
    return 1
  }

  function DragonTheme_GetValue(a) {
    return DragonThemeInUse[a] != DragonThemeDefault[a] ? DragonThemeInUse[a] : ""
  }

  function DragonTheme_Get(a) {
    return void 0 !== DragonThemeInUse[a] && "" !== DragonThemeInUse[a] ? DragonThemeInUse[a] : DragonThemeDefault[a]
  }

  function DragonTheme_Get2(a) {
    return FixHTTPS(DragonThemeInUse[a] ? DragonThemeInUse[a] : DragonThemeDefault[a])
  }

  function DragonTheme_ToJSON(a) {
    var b = JSON.stringify(DragonThemeInUse);
    "{}" == b ? b = "" : a || (b = b.replace(/","/g, '",\n"'));
    return b
  }

  function DragonTheme_SetThemeFromJSON(a) {
    if (DragonTheme_ToJSON() == a) return 0;
    try {
      return DragonTheme_SetTheme(a ? JSON.parse(a) : {}), 1
    } catch (b) {
      return console.warn("[DragonTheme] Invalid JSON:", a), -1
    }
  }

  function mobiles_hack() {
    DragonThemeInUse.classic_mobiles = 1;
    DragonTheme_SetTheme(DragonThemeInUse);
    alertify.alert("Changed Mobiles Graphics! ;)<br><br>You can disable it at [Options]->[Change Graphics]<br><br>")
  }

  function DragonTheme_Init() {
    $("#ClassicTheme").click(function(a) {
      DragonTheme_SetTheme(ThemeClassic);
      DragonTheme_UpdateFields();
      DragonTheme_UpdateFullThemeField();
      a.stopPropagation()
    });
    $("#DBTheme").click(function(a) {
      DragonTheme_SetTheme(ThemeDB);
      DragonTheme_UpdateFields();
      DragonTheme_UpdateFullThemeField();
      a.stopPropagation()
    });
    $("#DefaultTheme").click(function(a) {
      DragonTheme_SetTheme({});
      DragonTheme_UpdateFields();
      DragonTheme_UpdateFullThemeField();
      a.stopPropagation()
    });
    DragonTheme_Load()
  }

  function DragonTheme_UpdateFields() {
    for (var a in DragonThemeDefault) $("#theme_" + a).val(DragonTheme_GetValue(a)).css("background-color", "")
  }

  function DragonTheme_UpdateFullThemeField() {
    $("#themeFull").val(DragonTheme_ToJSON()).css("background-color", "")
  };
  var DIV_TO_CREATE_GAME_OBJECTS = "#game_objects",
    g_last_shot_sound_time, CalcOrbitPoint = function(a, b, c, d) {
      return {
        x: a + c * Math.cos(AngleToRad(d)),
        y: b - c * Math.sin(AngleToRad(d))
      }
    },
    ZotataPhysics = function(a, b, c, d, e, f) {
      this.x0 = a;
      this.y0 = b;
      this.v = new Vector(c, d);
      this.ax = e;
      this.ay = f
    };
  ZotataPhysics.prototype.GetPosAtTime = function(a) {
    a /= 1E3;
    return {
      x: this.x0 + this.v.x * a + this.ax * a * a / 2,
      y: this.y0 + this.v.y * a + this.ay * a * a / 2
    }
  };
  ZotataPhysics.prototype.GetPosAtTimeOrbit = function(a, b, c, d, e) {
    a /= 1E3;
    return CalcOrbitPoint(this.x0 + this.v.x * a + this.ax * a * a / 2, this.y0 + this.v.y * a + this.ay * a * a / 2, a >= d ? e : e * a / d, b + c * a)
  };
  ZotataPhysics.prototype.GetPosAtTimeWave = function(a, b) {
    var c = a / 1E3,
      d = this.x0 + this.v.x * c + this.ax * c * c / 2,
      c = this.y0 + this.v.y * c + this.ay * c * c / 2,
      e = this.GetAngleAtTime(a),
      f;
    1 == b || 2 == b ? (f = 15 * Math.sin(a / 60), e = -e + (1 == b ? 90 : -90)) : 3 == b || 4 == b ? (e = -e + (3 == b ? 90 : -90), f = 400 > a ? a / 400 * 25 : 2200 > a ? 25 * Math.cos((a - 400) / 95) : 2600 > a ? 25 - (a - 1800 - 400) / 400 * 22 : 3) : e = f = 0;
    return CalcOrbitPoint(d, c, f, e)
  };
  ZotataPhysics.prototype.GetAngleAtTime = function(a) {
    var b = this.GetPosAtTime(a - 5);
    a = this.GetPosAtTime(a + 5);
    return RadToAngle(Math.atan2(a.y - b.y, a.x - b.x))
  };
  ZotataPhysics.prototype.GetAngleAtTimeWave = function(a, b) {
    var c = this.GetPosAtTimeWave(a - 5, b),
      d = this.GetPosAtTimeWave(a + 5, b);
    return RadToAngle(Math.atan2(d.y - c.y, d.x - c.x))
  };

  function CShot(a, b, c, d, e, f) {
    if (!(this instanceof arguments.callee)) throw Error("Constructor called as a function");
    this.shot = b;
    this.unique_id = a;
    this.div_id = "#Shot" + a;
    this.div_id2 = "#ShotB" + a;
    this.pic_div_id = this.div_id + " " + this.div_id2;
    this.start_time = get_time();
    this.zp = new ZotataPhysics(b.start.x, b.start.y, b.start.ang, b.start.power, b.start.ax, b.start.ay);
    this.callback_finish = d;
    this.created_div = !1;
    this.is_camera_focus = c;
    this.thor = b.thor;
    this.shooting_player = e;
    this.game = f;
    this.trace_divs = [];
    b.ss && $("#ss_shot_background").fadeIn();
    this.shot.start.t || this.CreateDiv();
    var h = this;
    this.interval = setInterval(function() {
      h.update()
    }, 30)
  }
  CShot.prototype.CreateDiv = function() {
    if (this.thor) {
      var a = 3E3;
      this.shot.hole && (a = Math.round(Dist2Points(this.shot.start.x, this.shot.start.y, this.shot.hole[0], this.shot.hole[1])));
      this.game.ThorShoot(this.shot.start.x, this.shot.start.y, this.shot.start.ang, a);
      this.Remove();
      this.callback_finish(this.unique_id)
    } else {
      var a = BULLET[this.shot.img],
        b;
      if (a && a.file && this.shot.img > BULLETS.ARMORSS2)
        if (a.trace) {
          b = -1 == a.file.indexOf("/") ? "/static/images/bullets/" + a.file + ".png" : a.file;
          for (var c = 0; c < a.trace; c++) {
            var d =
              $('<div class="ShotTrace"></div>').css({
                background: "url(" + b + ")",
                height: a.traceH,
                "margin-top": -a.traceH / 2
              });
            this.trace_divs.push(d);
            $(DIV_TO_CREATE_GAME_OBJECTS).append(d)
          }
        } else $(DIV_TO_CREATE_GAME_OBJECTS).append('<div class="Shot" id="' + this.div_id.slice(1) + '"><div id="' + this.div_id2.slice(1) + '"></div></div>'), b = -1 == a.file.indexOf("/") ? "bullets/" + a.file + ".png" : a.file, this.anim_obj = new CAnimatedObject2(b, a.graphics, 0, 0, this.div_id2, 1, 20, !1, LOOP_NORMAL, 0, 19, !0);
      else $(DIV_TO_CREATE_GAME_OBJECTS).append('<div class="Shot" id="' +
        this.div_id.slice(1) + '"><div class="shot_img shot_img_' + this.shot.img + '" id="' + this.div_id2.slice(1) + '"></div></div>');
      this.created_div = !0;
      if (a) {
        b = get_time();
        if (void 0 == g_last_shot_sound_time || b >= g_last_shot_sound_time + 10) g_last_shot_sound_time = b, !this.shot.is_lightning && a.sound && AudioPlay(a.sound);
        a.ion ? $("#ss_shot_background").is(":visible") ? this.shooting_player.SetIon(this.shot.start.ang, this.shot.start.x - this.shooting_player.x, this.shot.start.y - this.shooting_player.y, 100) : this.shooting_player.SetIon(this.shot.start.ang) :
          a.ion_height && this.shooting_player.SetIon(void 0, 0, 1 == a.ion_height ? -200 : -600, 500)
      }
    }
  };
  CShot.prototype.update = function() {
    var a = get_time() - this.start_time;
    if (void 0 != this.shot.start.t)
      if (a >= this.shot.start.t) a -= this.shot.start.t, this.created_div || this.CreateDiv();
      else return;
    if (!this.thor)
      if (a >= this.shot.time) this.Remove(), this.callback_finish(this.unique_id);
      else {
        var b;
        b = this.shot.orbit ? this.zp.GetPosAtTimeOrbit(a, this.shot.orbit[0], this.shot.orbit[1], this.shot.orbit[2], this.shot.orbit[3]) : this.zp.GetPosAtTime(a);
        var c = this.zp.GetAngleAtTime(a);
        $(this.div_id).css({
          left: b.x,
          top: b.y
        });
        $(this.pic_div_id).css({
          rotate: +c + "deg"
        });
        if (this.trace_divs.length)
          for (var c = BULLET[this.shot.img], d, e = c.traceTime / this.trace_divs.length, f = 256 / this.trace_divs.length, h = -c.traceY + (c.traceAlter ? c.traceH * (floor(a / 50) % c.traceAlter) : 0), k = 0; k < this.trace_divs.length; k++) {
            var m = a - k * e;
            if (m >= e) {
              var n = d || (this.shot.wave ? this.zp.GetPosAtTimeWave(m, this.shot.wave) : this.zp.GetPosAtTime(m)),
                p = this.shot.wave ? this.zp.GetAngleAtTimeWave(m - e / 2, this.shot.wave) : this.zp.GetAngleAtTime(m - e / 2);
              d = this.shot.wave ? this.zp.GetPosAtTimeWave(m -
                e, this.shot.wave) : this.zp.GetPosAtTime(m - e);
              m = ceil(Dist2Points(n.x, n.y, d.x, d.y)) + (32 <= c.traceH ? 1 : 0);
              this.trace_divs[k].css({
                width: f,
                left: round(n.x),
                top: round(n.y),
                rotate: 180 + p + "deg",
                "background-position-x": -f * k,
                "background-position-y": h,
                scaleX: m / f,
                scaleY: 32 == c.traceH ? 0.5 : 1
              }).show()
            } else this.trace_divs[k].hide()
          }
        this.shot.change && a >= this.shot.change.at && $(this.pic_div_id).removeClass().addClass("shot_img shot_img_" + this.shot.change.img);
        this.is_camera_focus && 400 < a && !this.game.isInMapDraggin && this.game.camera.FocusAt(b.x,
          b.y, !0, !0)
      }
  };
  CShot.prototype.Remove = function() {
    this.interval = clearInterval(this.interval);
    $(this.div_id).remove();
    this.anim_obj && this.anim_obj.remove();
    for (var a = 0; a < this.trace_divs.length; a++) this.trace_divs[a].remove();
    if (this.shot.ss) {
      var b = BULLET[this.shot.img],
        c = this.shooting_player;
      setTimeout(function() {
        b.ion_ss && c.SetIon(void 0, 0, -200, 400);
        $("#ss_shot_background").fadeOut()
      }, 1E3)
    }
  };
  CShot.prototype.SetCameraFocus = function() {
    this.is_camera_focus = !0
  };
  CShot.prototype.GetTimeLeft = function() {
    if (this.thor) return 0;
    var a = this.shot.time;
    void 0 != this.shot.start.t && (a += this.shot.start.t);
    var b = get_time() - this.start_time,
      a = a - b;
    return 0 > a ? 0 : a
  };
  DragonFreeze(CShot);

  function CDamageEffect(a, b, c, d, e, f) {
    if (!(this instanceof arguments.callee)) throw Error("Constructor called as a function");
    c = Math.round(c);
    var h = f ? "Blue" : "Red";
    !f && 0 < c && (h = "Green");
    var k = "#DamageEffect_" + d + "_" + e + "_" + h + (0 <= c ? "P" : "-"),
      m = $(k);
    0 < m.length && (c += Number(m.attr("damage")), a = Number(m.attr("x")), b = Number(m.attr("y")), $(k).remove());
    m = String(c);
    "Red" != h && 0 < c && (m = "+" + m);
    for (var n = '<div class="DamageEffect" damage=' + c + " x=" + a + " y=" + b + ' id="' + k.slice(1) + '" style="left: ' + a + "px; top: " + b + 'px;">',
        p = 0; p < m.length; p++) {
      var q = m.charCodeAt(p);
      45 == q ? n += '<div class="DamageDigit DamageDigit' + h + '-" style="left:' + 14 * p + 'px;"></div>' : 43 == q ? n += '<div class="DamageDigit DamageDigit' + h + 'P" style="left:' + 14 * p + 'px;"></div>' : 48 <= q && 57 >= q && (n += '<div class="DamageDigit DamageDigit' + h + (q - 48) + '" style="left:' + 14 * p + 'px;"></div>')
    }
    n += "</div>";
    $(DIV_TO_CREATE_GAME_OBJECTS).append(n);
    setTimeout(function() {
      $(k).animate({
        top: "-=30"
      })
    }, 10);
    setTimeout(function() {
      $(k).fadeOut(3E3, function() {
        $(k).remove()
      })
    }, 2E3)
  }

  function TeamChatOn() {
    $("#all_chat").hide();
    $("#team_chat").show()
  }

  function TeamChatOff() {
    $("#all_chat").show();
    $("#team_chat").hide()
  }

  function TeamChatStatus() {
    return $("#team_chat").is(":visible")
  }

  function TeamChatToggle() {
    TeamChatStatus() ? TeamChatOff() : TeamChatOn()
  }

  function GameGUI(a) {
    $("#gameChat").tinyscrollbar({
      size: 99
    });
    $("#btnShot1").click(function() {
      SelectShotType(0, a.game);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#btnShot2").click(function() {
      SelectShotType(1, a.game);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#btnShotSS").click(function() {
      SelectShotType(2, a.game);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#btnPass").click(function() {
      a.game && a.game.PassTurnClicked();
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#btnEsc").click(function() {
      ToggleOptionsDialog(!!a.game);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#btnFriends").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.game && a.game.F10Friends()
    });
    $("#all_chat").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      TeamChatOn()
    });
    $("#team_chat").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      TeamChatOff()
    });
    $("#gameItemSlot0").click(function() {
      a.game && a.game.UseItem(0)
    });
    $("#gameItemSlot1").click(function() {
      a.game && a.game.UseItem(1)
    });
    $("#gameItemSlot2").click(function() {
      a.game && a.game.UseItem(2)
    });
    $("#gameItemSlot3").click(function() {
      a.game && a.game.UseItem(3)
    });
    $("#gameItemSlot4").click(function() {
      a.game && a.game.UseItem(4)
    });
    $("#gameItemSlot5").click(function() {
      a.game && a.game.UseItem(5)
    });
    $("#slice_drag_button").click(function() {
      g_is_game_slice = !g_is_game_slice;
      UpdateSliceDragGUI();
      SetValue("slice", g_is_game_slice ? 1 : 0)
    });
    UpdateSliceDragGUI();
    $("#gameInput").keydown(function(b) {
      if (b.which == KEY.Enter) {
        if ("" != this.value) {
          var c = this.value;
          this.value = "";
          a.SendChat(c, TeamChatStatus())
        }
        $("#gameInput").blur();
        b.stopPropagation()
      }
    }).bind("mousedown", function(a) {
      a.stopPropagation &&
        a.stopPropagation()
    });
    var b;
    $("#powerMarkArea").bind("mousedown", function(a) {
      b = !0;
      a = a.offsetX;
      $("#powerMark").css("left", a + 1)
    }).bind("mouseup", function(a) {
      b = !1
    }).bind("mousemove", function(a) {
      b && 3 != a.eventPhase && (a = a.offsetX, 0 > a ? a = 0 : 400 < a && (a = 400), $("#powerMark").css("left", a + 1))
    });
    var c, d;
    $("#powerMarkArea").bind("touchstart", function(a) {
      a.stopPropagation();
      b = !0;
      a = Math.round((a.originalEvent.touches[0].pageX - g_no_aspect_left) / g_aspect_ratio) - 241;
      0 > a ? a = 0 : 400 < a && (a = 400);
      $("#powerMark").css("left", a +
        1).css({
        scaleX: 3,
        scaleY: 8,
        translateY: -4
      });
      c = clearTimeout(c);
      d = clearTimeout(d)
    }).bind("touchend", function(e) {
      b = !1;
      a.game && a.game.Shoot(Math.round(Number($("#powerMark").css("left").slice(0, -2))));
      e = function() {
        $("#powerMark").css({
          scaleX: 1,
          scaleY: 1,
          translateY: 0
        })
      };
      e();
      c = setTimeout(e, 5E3);
      d = setTimeout(e, 1E4)
    }).bind("touchmove", function(a) {
      b && (a = Math.round((a.originalEvent.touches[0].pageX - g_no_aspect_left) / g_aspect_ratio) - 241, 0 > a ? a = 0 : 400 < a && (a = 400), $("#powerMark").css("left", a + 1))
    });
    $("#GameShare").click(function(b) {
      a.SendGameShare();
      b.stopPropagation()
    });
    $("#game_dnd_btn").click(function(b) {
      DNDClicked(a)
    })
  }

  function DNDClicked(a) {
    var b = $(".dnd_btn");
    if (a.pm_dnd)
      for (b.html("PM"), b.removeClass("on"), a.pm_dnd = !1; 0 < a.pms_on_hold.length;) {
        var c = a.pms_on_hold.pop();
        FriendPrivateChat(c.user_id, c.name, c.text, a)
      } else a.dnd_msg || (a.dnd_msg = l.t("Sorry, I am busy right now.")), alertify.prompt(l.t('You are entering "Do Not Disturb" mode.<br>You will not see private messages while in this mode.<br>You can select an "Auto-Reply" message (empty for none):'), function(c, e) {
        c && (b.html("DND"), b.addClass("on"), a.pm_dnd = !0, a.dnd_msg = e)
      }, a.dnd_msg), $("#alertify-text").prop("maxlength", "150")
  }

  function SelectShotType(a, b) {
    2 != a || $("#btnShotSS").is(":visible") || (a = 0);
    switch (a) {
      case 0:
        $("#btnShot2, #btnShotSS").removeClass("Pressed");
        $("#btnShot1").addClass("Pressed");
        break;
      case 1:
        $("#btnShot1, #btnShotSS").removeClass("Pressed");
        $("#btnShot2").addClass("Pressed");
        break;
      case 2:
        $("#btnShot1, #btnShot2").removeClass("Pressed"), $("#btnShotSS").addClass("Pressed")
    }
    b && b.ChangedShot(a)
  }

  function GetSelectedShotType() {
    var a = 0;
    $("#btnShot2").hasClass("Pressed") ? a = 1 : $("#btnShotSS").hasClass("Pressed") && (a = 2);
    return a
  }
  var g_saw_auto_help;

  function DragonBound(a, b, c) {
    if (!(this instanceof arguments.callee)) throw Error("[DragonBound] Constructor called as a function");
    if (!a) throw Error("[DragonBound] missing my_user_id");
    var d = b[0],
      e = b[1],
      f = b[2],
      h = b[3],
      k = b[4],
      m = b[5],
      n = b[6],
      p = b[7],
      q = b[8],
      r = b[9],
      s = b[10],
      t = b[11],
      w = b[12],
      v = b[13],
      u = this;
    this.my_user_id = a;
    this.my_player_index = this.my_player_number = -1;
    this.queue = [];
    this.is_queue_executing = !1;
    this.players = [];
    this.shots = [];
    this.isInMapDraggin = !1;
    this.turn = -1;
    this.after_shot_chat = [];
    this.after_shot_gold =
      void 0;
    this.steps = this.no_ss_turns = 0;
    this.sudden_death_at_turn = 40;
    this.t = random(10, 20);
    this.s = random(60, 70);
    this.is_s1_disabled = s;
    this.game_mode = w;
    this.dn = c;
    this.WOX = random(0, 12);
    this.WOY = random(0, 6);
    this.my_start_gp = this.dn.myPlayerInfo.gp;
    this.my_start_gold = this.dn.myPlayerInfo.gold;
    this.HideClickToRevive();
    $("#game_back").html("").append(this.map_bg_div = $('<div id="map_bg"></div>')).append(this.ss_shot_background_div = $('<div id="ss_shot_background"></div>')).append(this.camera_div = $('<div id="camara"></div>').append(this.ground_canvas_div =
      $('<canvas id="ground_canvas"></canvas>')).append(this.thor_div = $('<div id="thor">').append($('<div id="thor_rotate"> <div id="thor_laser"></div> </div>')).append($('<div id="thor_lvl" class="blackShadow"></div>')).append($('<div id="thor_damage" class="blackShadow"></div>'))).append(this.game_objects_div = $('<div id="game_objects"></div>')));
    this.camera_div.css({
      position: "absolute"
    });
    this.camera = new CCamera(r, function(a, b) {
      u.OnCameraUpdate(a, b)
    }, this.camera_div);
    this.UnselectAllItems();
    this.UpdateGuiGold(0);
    $("#last_power_mark").css("left", 240);
    $("#game_over").hide();
    $("#game_replay").hide();
    this.UpdateScore(v, v);
    SetClass("#score_panel", "hide", this.game_mode != GAME_MODE_SCORE);
    $(".Player .GamePlayerBalloon").hide();
    $(".Player .GamePlayerBalloonTip").hide();
    $(".Player .Turn").hide();
    $("#powerBar").css("width", 1);
    $("#walkBar").css("width", 400);
    $("#gameInput").val("");
    $("#gameChatHtml").html("");
    $("#gameChat .scrollbar").hide();
    $("#ss_shot_background").removeClass("sudden_death").hide();
    $("#message_over_items").removeClass().hide();
    0 != c.myPlayerInfo.rank || g_saw_auto_help || GetValue("SawHowToPlay") || ($("#howtoplay").show(), g_saw_auto_help = !0, SetValue("SawHowToPlay", 1));
    if (Object.isFrozen(DragonBound)) {
      $("#thor").css({
        left: 680,
        top: 0
      });
      $("#thor_rotate").children().not("#thor_laser").remove();
      this.thor_obj = new CAnimatedObject("thor", "thor.png", 0, 0, 159, 99, 97, 58, "#thor_rotate", 1, 20, 50, !1, OPTIONS.anim ? 1 : 3);
      TeamChatOff();
      this.SetWeather(n);
      this.UpdateWind([p, q]);
      this.UpdateThor([f, h, k, m]);
      this.next_turn = e;
      this.ground = new CGround(r);
      "number" == typeof r ? $("#btnDownloadMap").hide() : $("#btnDownloadMap").show().click(function() {
        this.href = u.ground.dataUrl.replace(/^data:image\/[^;]/, "data:application/octet-stream");
        this.download = "map.png"
      });
      this.CreatePlayers(d);
      this.UpdateTurnList();
      s ? ($("#btnShot1").hide(), SelectShotType(1, void 0), this.ChangedShot(1)) : ($("#btnShot1").show(), SelectShotType(0, void 0), this.ChangedShot(0));
      $("#btnShotSS").show();
      $(".EventGameMsg1").remove();
      if (1 == t) $("#game_front").append($('<div class="EventGameMsg1 blackShadow">- ' +
        l.t("Event Game") + " -<br>" + l.t("Losing Team Wins!<br>Double GP & Gold!") + "</div>")), setTimeout(function() {
        $(".EventGameMsg1").remove()
      }, 15E3);
      else {
        var x = $('<div class="EventGameMsg2 blackShadow">Ready</div>');
        $("#game_front").append(x);
        setTimeout(function() {
          x.html("GO!")
        }, 2E3);
        setTimeout(function() {
          x.remove()
        }, 5E3)
      }
      setTimeout(function() {
        u.SetBinds();
        u.StartNextTurn();
        u.QueueUnblock()
      }, 2E3)
    }
  }
  DragonBound.prototype.UpdateScore = function(a, b) {
    $("#score_panel_a").html(a);
    $("#score_panel_b").html(b)
  };
  DragonBound.prototype.ChatReceived = function(a, b, c) {
    var d, e = this.players.length,
      f;
    for (d = 0; d < e; d++)(f = this.players[d]) && f.name.replace(/<font.*font> /, "") == b && 1E8 > f.user_id && f.Chat(a, c)
  };
  DragonBound.prototype.UIShootStart = function() {
    if (!(0 > this.my_player_index || this.turn != this.my_player_number || this.intervalDoSpace)) {
      this.UIWalkLeftEnd();
      this.UIWalkRightEnd();
      $("#powerBar").css("width", 0);
      var a = this,
        b = get_time();
      this.intervalDoSpace = setInterval(function() {
        var c = (get_time() - b) / 10;
        $("#powerBar").css("width", c);
        400 <= c && a.Shoot(400)
      }, 10)
    }
  };
  DragonBound.prototype.UIShootEnd = function() {
    0 > this.my_player_index || this.intervalDoSpace && this.Shoot(Number($("#powerBar").css("width").slice(0, -2)))
  };
  DragonBound.prototype.UIWalkLeftStart = function() {
    $("#btnLeft").addClass("active");
    if (!(0 > this.my_player_index))
      if (this.turn == this.my_player_number) {
        if (!this.intervalDoLeft) {
          var a = this,
            b = get_time(),
            c = 0;
          this.intervalDoLeft = setInterval(function() {
            var d = Math.floor((get_time() - b) / 20),
              e = d - c;
            200 < a.steps + e && (e = 200 - a.steps);
            if (200 <= a.steps) a.players[a.my_player_index].Look(PLAYER_LOOK_LEFT);
            else {
              for (var f = 0; f < e && !1 != a.players[a.my_player_index].Walk(PLAYER_LOOK_LEFT); f++);
              e = f
            }
            a.steps += e;
            c = d;
            $("#walkBar").css("width",
              400 - 2 * a.steps)
          }, 20)
        }
      } else this.players[this.my_player_index].Look(PLAYER_LOOK_LEFT)
  };
  DragonBound.prototype.UIWalkLeftEnd = function() {
    $("#btnLeft").removeClass("active");
    0 > this.my_player_index || (this.intervalDoLeft = clearInterval(this.intervalDoLeft))
  };
  DragonBound.prototype.UIWalkRightStart = function() {
    $("#btnRight").addClass("active");
    if (!(0 > this.my_player_index))
      if (this.turn == this.my_player_number) {
        if (!this.intervalDoRight) {
          var a = this,
            b = get_time(),
            c = 0;
          this.intervalDoRight = setInterval(function() {
            var d = Math.floor((get_time() - b) / 20),
              e = d - c;
            200 < a.steps + e && (e = 200 - a.steps);
            if (200 <= a.steps) a.players[a.my_player_index].Look(PLAYER_LOOK_RIGHT);
            else {
              for (var f = 0; f < e && !1 != a.players[a.my_player_index].Walk(PLAYER_LOOK_RIGHT); f++);
              e = f
            }
            a.steps += e;
            c = d;
            $("#walkBar").css("width",
              400 - 2 * a.steps)
          }, 20)
        }
      } else this.players[this.my_player_index].Look(PLAYER_LOOK_RIGHT)
  };
  DragonBound.prototype.UIWalkRightEnd = function() {
    $("#btnRight").removeClass("active");
    0 > this.my_player_index || (this.intervalDoRight = clearInterval(this.intervalDoRight))
  };
  DragonBound.prototype.UIAngleUpStart = function() {
    $("#btnUp").addClass("active");
    if (!(0 > this.my_player_index || this.intervalDoUp || this.intervalDoDown)) {
      var a = this,
        b = get_time(),
        c = this.players[this.my_player_index].ang;
      this.intervalDoUp = setInterval(function() {
        var d = c + Math.floor((get_time() - b) / a.s) * (90 < a.players[a.my_player_index].minang ? -1 : 1);
        a.players[a.my_player_index].ChangeAngleTo(d)
      }, this.t)
    }
  };
  DragonBound.prototype.UIAngleUpEnd = function() {
    $("#btnUp").removeClass("active");
    0 > this.my_player_index || (this.intervalDoUp = clearInterval(this.intervalDoUp))
  };
  DragonBound.prototype.UIAngleDownStart = function() {
    $("#btnDown").addClass("active");
    if (!(0 > this.my_player_index || this.intervalDoDown || this.intervalDoUp)) {
      var a = this,
        b = get_time(),
        c = this.players[this.my_player_index].ang;
      this.intervalDoDown = setInterval(function() {
        var d = c - Math.floor((get_time() - b) / a.s) * (90 < a.players[a.my_player_index].minang ? -1 : 1);
        a.players[a.my_player_index].ChangeAngleTo(d)
      }, this.t)
    }
  };
  DragonBound.prototype.UIAngleDownEnd = function() {
    $("#btnDown").removeClass("active");
    0 > this.my_player_index || (this.intervalDoDown = clearInterval(this.intervalDoDown))
  };
  DragonBound.prototype.UINextShot = function() {
    0 > this.my_player_index || (this.is_s1_disabled ? SelectShotType(1 == GetSelectedShotType() && $("#btnShotSS").is(":visible") ? 2 : 1, this) : SelectShotType((GetSelectedShotType() + 1) % 3, this))
  };
  DragonBound.prototype.ChangedShot = function(a) {
    0 > this.my_player_index || this.players[this.my_player_index].ChangedShot(a)
  };
  DragonBound.prototype.UIDragStart = function(a) {
    0 > this.my_player_index || (this.drag_start_x = a)
  };
  DragonBound.prototype.UIDragMove = function(a) {
    0 > this.my_player_index || (a = (a - this.drag_start_x) / 1.5, 1 > a && (a = 1), 400 < a && (a = 400), $("#powerBar").css("width", a), 400 <= a && this.UIDragEnd())
  };
  DragonBound.prototype.UIDragEnd = function() {
    0 > this.my_player_index || this.Shoot(Number($("#powerBar").css("width").slice(0, -2)))
  };
  DragonBound.prototype.UseItem = function(a) {
    if (!(0 > this.my_player_index)) {
      var b = $("#gameItemSlot" + a);
      b.hasClass("item") ? b.hasClass("Pressed") ? b.removeClass("Pressed") : ($(".item").removeClass("Pressed"), b.addClass("Pressed"), this.turn == this.my_player_number && this.UsePressedItem(a)) : 0 < a && (a--, $("#gameItemSlot" + a).hasClass("big") && this.UseItem(a))
    }
  };
  DragonBound.prototype.UsePressedItem = function(a) {
    if (!(0 > this.my_player_index))
      for (a = void 0 != a ? a : 0; 6 > a; a++)
        if ($("#gameItemSlot" + a).hasClass("Pressed")) {
          this.players[this.my_player_index].UseItem(a);
          break
        }
  };
  DragonBound.prototype.UnselectAllItems = function() {
    for (var a = 0; 6 > a; a++) $("#gameItemSlot" + a).removeClass("Pressed")
  };
  DragonBound.prototype.F10Friends = function() {
    $("#friendsList").is(":visible") ? $("#friendsList").hide() : ($("#friendsList").show(), TabChangeTo(TAB_FRIENDS), this.dn.SendTabWatch(1), 0 == $("#friendsListHtml").children().length && this.dn.SendRefreshFriends())
  };
  DragonBound.prototype.OnKeyDown = function(a) {
    if (!$(document.activeElement).is("input") || a.which == KEY.F8 || a.which == KEY.F9 || a.which == KEY.F10 || a.which == KEY.Esc) {
      var b;
      switch (a.which) {
        case KEY.A:
        case KEY.Left:
          this.UIWalkLeftStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.D:
        case KEY.Right:
          this.UIWalkRightStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.W:
        case KEY.Up:
          this.UIAngleUpStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.S:
        case KEY.Down:
          this.UIAngleDownStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.Space:
          g_is_game_slice && (this.UIShootStart(), a.preventDefault(), a.stopPropagation());
          b = 1;
          break;
        case KEY.F8:
          this.PassTurnClicked();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Tab:
          this.UINextShot();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F1:
          this.UseItem(0);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F2:
          this.UseItem(1);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F3:
          this.UseItem(2);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F4:
          this.UseItem(3);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F5:
          this.UseItem(4);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F6:
          this.UseItem(5);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F9:
          TeamChatToggle();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Esc:
          ToggleOptionsDialog(!0);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F10:
          this.F10Friends(), a.preventDefault(), a.stopPropagation()
      }
      b && $("#howtoplay").is(":visible") &&
        $("#howtoplay").fadeOut("slow")
    }
  };
  DragonBound.prototype.SetBinds = function() {
    function a(a) {
      a = a || window.event;
      a.preventDefault && a.preventDefault();
      a.stopPropagation && a.stopPropagation();
      a.cancelBubble = !0;
      return a.returnValue = !1
    }
    var b = this;
    $("#btnShoot,#btnLeft,#btnRight,#btnUp,#btnDown").unbind();
    $("#btnShoot").bind("mousedown touchstart", function(a) {
      b.UIShootStart()
    }).bind("mouseup touchend", function(a) {
      b.UIShootEnd()
    });
    $("#btnLeft").bind("mousedown touchstart", function(a) {
      b.UIWalkLeftStart()
    }).bind("mouseup touchend", function(a) {
      b.UIWalkLeftEnd()
    });
    $("#btnRight").bind("mousedown touchstart", function(a) {
      b.UIWalkRightStart()
    }).bind("mouseup touchend", function(a) {
      b.UIWalkRightEnd()
    });
    $("#btnUp").bind("mousedown touchstart", function(a) {
      b.UIAngleUpStart()
    }).bind("mouseup touchend", function(a) {
      b.UIAngleUpEnd()
    });
    $("#btnDown").bind("mousedown touchstart", function(a) {
      b.UIAngleDownStart()
    }).bind("mouseup touchend", function(a) {
      b.UIAngleDownEnd()
    });
    var c = $(document);
    c.unbind("keydown keyup click dblclick mousedown mousemove touchstart touchend touchmove");
    c.bind("keyup", function(a) {
      switch (a.which) {
        case KEY.A:
        case KEY.Left:
          b.UIWalkLeftEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.D:
        case KEY.Right:
          b.UIWalkRightEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.W:
        case KEY.Up:
          b.UIAngleUpEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.S:
        case KEY.Down:
          b.UIAngleDownEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Space:
          b.UIShootEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Ctrl:
          $(document.activeElement).is("input") ||
            a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F1:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F2:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F3:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F4:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F5:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F6:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F9:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Tab:
          a.preventDefault(), a.stopPropagation()
      }
    });
    $("#gameui").unbind().bind("mousedown",
      function(a) {
        a.stopPropagation();
        return !1
      });
    c.bind("mousedown", function(a) {
      if (2 == a.button) b.lastDragX = a.pageX, b.lastDragY = a.pageY, b.isInMapDraggin = !0, $("#container").addClass("HandCursor");
      else if (0 == a.button) {
        if ($("#howtoplay").is(":visible")) return $("#howtoplay").hide("slow");
        g_is_game_slice || b.turn != b.my_player_number || (b.isInDrag = !0, b.UIDragStart(a.pageX))
      }
    });
    this.func_mouseup = function(a) {
      2 == a.button ? (b.isInMapDraggin = !1, $("#container").removeClass("HandCursor")) : 0 == a.button && b.isInDrag && (b.isInDrag = !1, b.UIDragMove(a.pageX), b.UIDragEnd())
    };
    c.unbind("mouseup", this.func_mouseup).bind("mouseup", this.func_mouseup);
    c.bind("mousemove", function(a) {
      b.isInDrag && b.UIDragMove(a.pageX);
      b.isInMapDraggin && (b.camera.MoveBy(b.lastDragX - a.pageX, b.lastDragY - a.pageY, !1), b.lastDragX = a.pageX, b.lastDragY = a.pageY);
      a.stopPropagation()
    });
    (function(b) {
      b.ontouchstart = a;
      b.ontouchmove = a;
      b.ontouchend = a;
      b.ontouchcancel = a
    })(document.getElementById("touch_ui"));
    c.bind("touchstart", function(a) {
      $("#touch_ui").show();
      $("#howtoplay").is(":visible") &&
        $("#howtoplay").hide();
      if (!(b.intervalDoSpace || b.intervalDoLeft || b.intervalDoRight || b.intervalDoUp || b.intervalDoDown)) {
        if (a.originalEvent.touches && a.originalEvent.touches.length) a = a.originalEvent.touches[0];
        else if (a.originalEvent.changedTouches && a.originalEvent.changedTouches.length) a = a.originalEvent.changedTouches[0];
        else return;
        b.lastDragX = a.pageX;
        b.lastDragY = a.pageY;
        b.isInMapDraggin = !0;
        a.preventDefault && a.preventDefault()
      }
    });
    c.bind("touchend", function(a) {
      b.isInMapDraggin = !1
    });
    c.bind("touchmove",
      function(a) {
        a.preventDefault && a.preventDefault();
        if (b.intervalDoSpace || b.intervalDoLeft || b.intervalDoRight || b.intervalDoUp || b.intervalDoDown) b.isInMapDraggin = !1;
        else {
          if (a.originalEvent.touches && a.originalEvent.touches.length) a = a.originalEvent.touches[0];
          else if (a.originalEvent.changedTouches && a.originalEvent.changedTouches.length) a = a.originalEvent.changedTouches[0];
          else return;
          b.isInMapDraggin && (b.camera.MoveBy(b.lastDragX - a.pageX, b.lastDragY - a.pageY, !1), b.lastDragX = a.pageX, b.lastDragY = a.pageY)
        }
      })
  };
  DragonBound.prototype.Destructor = function() {
    var a = $(document);
    a.unbind("keyup");
    a.unbind("mousedown");
    a.unbind("mouseup", this.func_mouseup);
    a.unbind("mousemove");
    a.unbind("touchstart");
    a.unbind("touchend");
    a.unbind("touchmove");
    $("#btnShoot").unbind("mousedown touchstart mouseup touchend");
    $("#btnLeft").unbind("mousedown touchstart mouseup touchend");
    $("#btnRight").unbind("mousedown touchstart mouseup touchend");
    $("#btnUp").unbind("mousedown touchstart mouseup touchend");
    $("#btnDown").unbind("mousedown touchstart mouseup touchend");
    this.turnTimeout = clearTimeout(this.turnTimeout);
    this.intervalDoUp = clearInterval(this.intervalDoUp);
    this.intervalDoDown = clearInterval(this.intervalDoDown);
    for (a = 0; a < this.shots.length; a++) this.shots[a].shot.Remove();
    this.shots = [];
    this.EndTurn();
    for (a = 0; a < this.players.length; a++) this.players[a].Remove();
    $("#powerBar").css("width", 0);
    $("#turn_timer").hide();
    $("#game_over").hide();
    $(DIV_TO_CREATE_GAME_OBJECTS).children().remove();
    this.HideClickToRevive()
  };
  DragonBound.prototype.CreatePlayers = function(a) {
    for (var b = 0; b < a.length; b++) {
      var c = !1;
      a[b][1] == this.my_user_id && (this.my_player_number = a[b][0], this.my_player_index = b, c = !0);
      this.players.push(new CPlayer(a[b], c, this.ground, this.dn))
    }
  };
  DragonBound.prototype.UpdateAnim = function() {
    for (var a = 0; a < this.players.length; a++) {
      var b = this.players[a];
      b && b.UpdateAnim()
    }
    OPTIONS.anim ? $(".Turn").addClass("TurnAnim") : $(".Turn").removeClass("TurnAnim")
  };
  DragonBound.prototype.UpdateTurnList = function() {
    var a = [],
      b, c;
    0 > this.my_player_index ? c = b = 0 : (b = this.players[this.my_player_index].delay, c = this.players[this.my_player_index].delay_before);
    for (var d = 0; d < this.players.length; d++) {
      var e = this.players[d];
      e.is_alive && a.push({
        rank: e.rank,
        name: e.name,
        user_id: e.user_id,
        team: e.team,
        delay: e.delay,
        lastturn: e.lastturn,
        country: e.country
      })
    }
    a.sort(function(a, b) {
      return a.delay == b.delay ? a.lastturn - b.lastturn : a.delay - b.delay
    });
    for (d = 0; d < a.length; d++) {
      var e = a[d].delay - b,
        e = 0 < e ? "+" + e : e,
        f = OPTIONS.countries && a[d].country ? '<div class="country blackShadow">' + a[d].country + "</div>" : "";
      $("#turn_line" + d + " .turn_line_name").html(a[d].name);
      $("#turn_line" + d + " .turn_line_rank").removeClass().addClass("turn_line_rank rank rank" + a[d].rank).html(f);
      "A" == a[d].team ? ($("#turn_line" + d + " .turn_line_number").removeClass("turn_line_number_b").addClass("turn_line_number_a turn_line_number" + d), $("#turn_line" + d + " .turn_line_name").removeClass("turn_line_name_b").addClass("turn_line_name_a turn_line_number" +
        d)) : ($("#turn_line" + d + " .turn_line_number").removeClass("turn_line_number_a").addClass("turn_line_number_b turn_line_number" + d), $("#turn_line" + d + " .turn_line_name").removeClass("turn_line_name_a").addClass("turn_line_name_b turn_line_number" + d));
      a[d].user_id == this.my_user_id ? ($("#turn_line" + d).addClass("turn_line_me"), e = b - c) : $("#turn_line" + d).removeClass("turn_line_me");
      $("#turn_line" + d + " .turn_line_delay").html(e);
      $("#turn_line" + d).show()
    }
    for (; 8 > d; d++) $("#turn_line" + d).hide()
  };
  DragonBound.prototype.UpdatePlayer = function(a) {
    var b = a[0];
    if (b != this.my_player_number) {
      var c = a[1],
        d = a[2];
      a = a[3];
      this.GetPlayerByPlayerNumber(b).MoveTo(c, d, a)
    }
  };
  DragonBound.prototype.OnCameraUpdate = function(a, b) {
    if (!(20 > Math.abs(this.last_event_left - a) && 20 > Math.abs(this.last_event_top - b))) {
      this.last_event_left = a;
      this.last_event_top = b;
      for (var c = this.players.length, d = 0; d < c; d++) {
        var e = this.players[d];
        e && e.OnCameraUpdate(a, b)
      }
    }
  };
  DragonBound.prototype.CreateShot = function(a, b, c, d) {
    var e = this;
    a.hole && PreloadExplode(a.exp);
    var f = function(b) {
        var h, f;
        for (h = 0; h < e.shots.length; h++)
          if (e.shots[h].id == b) {
            f = e.shots[h].shot;
            e.shots.splice(h, 1);
            break
          }
        if (f && f.is_camera_focus && (OPTIONS.camfollowbullets || f.shot.img == BULLETS.TURTLESS))
          for (h = 0; h < e.shots.length; h++)
            if (b = e.shots[h].shot, 900 <= b.GetTimeLeft()) {
              b.SetCameraFocus();
              break
            }
        if (a.hole) {
          b = a.hole[0];
          f = a.hole[1];
          h = a.hole[2];
          var p = a.hole[3];
          void 0 == b && (b = a.hole.x);
          void 0 == f && (f = a.hole.y);
          void 0 == h && (h = a.hole.rx);
          void 0 == p && (p = a.hole.ry);
          0 < h && 0 < p && e.ground.AddGroundHole(b, f, h, p);
          a.is_lightning && e.CreateLightning(b, f, a.start.ang);
          CreateExplode(a.exp, b, f);
          if (OPTIONS.explodes) {
            var q = $("#game_back");
            q.removeClass("shake_anim");
            setTimeout(function() {
              q.addClass("shake_anim")
            }, 1);
            p = Math.round(h * p / 200);
            for (h = 0; h < p; h++) {
              var r = GetRandomElementFromArray(PARTICLES1.graphics2).css;
              r["background-image"] = "url(/static/images/" + PARTICLES1.file + ")";
              new DragonParticle(b, f, random(0, 359), random(100, 600),
                0, 800, 3E3, r)
            }
          }
          if (a.damages)
            for (h = 0; h < a.damages.length; h++) b = e.GetPlayerByPlayerNumber(a.damages[h].n), a.damages[h].hp && b.ChangeHPShield(a.damages[h].hp, a.damages[h].shield ? a.damages[h].shield : 0, c, !a.damages[h].heal), void 0 != a.damages[h].movex && b.MoveTo(a.damages[h].movex, void 0 != a.damages[h].movey ? a.damages[h].movey : b.y, void 0, !1), a.damages[h].rd && b.SetReducedDefence(a.damages[h].rd);
          for (h = 0; h < e.players.length; h++) e.players[h].Fall();
          e.UpdateTurnList()
        }
        if (a.tele)
          for (h = 0; h < a.tele.length; h += 5) {
            b = a.tele[h +
              1];
            f = a.tele[h + 2];
            var p = a.tele[h + 3],
              r = a.tele[h + 4],
              s = e.GetPlayerByPlayerNumber(a.tele[h]);
            s && (s.MoveTo(b, f, void 0, !0), s.MoveTo(p, r, void 0, !1), s.OnCameraUpdate(e.last_event_left, e.last_event_top), CreateExplode(a.exp, b, f))
          }
        0 == e.shots.length && (e.ReceivedChatArray(e.after_shot_chat, d.name), e.after_shot_gold && (AudioPlay(AUDIO_GOLD), e.UpdateGuiGold(e.after_shot_gold)), e.UpdateThor(e.after_shot_thor), e.PushWeather(e.after_shot_weather), e.UpdateWind(e.next_wind), 2 < e.queue.length ? (e.StartNextTurn(), e.QueueUnblock()) :
          setTimeout(function() {
            e.StartNextTurn();
            e.QueueUnblock()
          }, 1E3))
      },
      h = random(0, 999999);
    2 < this.queue.length ? f(h) : this.shots.push({
      id: h,
      shot: new CShot(h, a, b, f, d, this)
    })
  };
  var GAMEMSG = Object.freeze({
    winning_award: 0,
    losing_consolation: 1,
    x_killed_y: 2,
    x_bunge_y: 3,
    ultra_high_ang: 4,
    high_ang: 5,
    excellent_shot: 6,
    good_shot: 7,
    shot_bonus: 8,
    team_damage_penalty: 9,
    killed_by_sd: 10,
    died_by_tele: 11,
    damage_1000: 12,
    damage_2000: 13,
    damage_3000: 14,
    triple_kill: 15,
    double_kill: 16,
    ending_bonus: 17,
    bunge_bonus: 18,
    suicide_penalty: 19,
    unlocked_challenge: 20,
    free_kill_detected: 21,
    suicide_penalty_bunge: 22,
    team_kill_penalty: 23,
    winning_change: 24,
    early_suicide: 25,
    blocked_winning: 26,
    score_change: 27
  });
  DragonBound.prototype.ReceivedChatArray = function(a, b) {
    for (var c, d; 0 < a.length;) switch (a.shift()) {
      case GAMEMSG.winning_award:
        ChatReceived(this.GetPlayerByPlayerNumber(a.shift()).name + " [" + l.t("Winning Award") + "] +" + a.shift() + " Gold +" + a.shift() + " GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.losing_consolation:
        ChatReceived(this.GetPlayerByPlayerNumber(a.shift()).name + " [" + l.t("Losing Consolation") + "] +" + a.shift() + " Gold +" + a.shift() + " GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.x_killed_y:
        d = a.shift();
        c = this.GetPlayerByPlayerNumber(d).name;
        ChatReceived(c + " " + l.t("was killed by") + " " + b, "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#f33", d != this.my_player_number ? c + " " + l.t("Killed") : l.t("You are dead :("));
        break;
      case GAMEMSG.x_bunge_y:
        d = a.shift();
        c = this.GetPlayerByPlayerNumber(d).name;
        ChatReceived(c + " " + l.t("was killed by") + " " + b + " (" + l.t("bunge") + ")", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#f66", d != this.my_player_number ?
          c + " " + l.t("Bunged") : l.t("You fell down :("));
        break;
      case GAMEMSG.ultra_high_ang:
        ChatReceived(b + " [" + l.t("Ultra High Angle Bonus") + "] +100Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.high_ang:
        ChatReceived(b + " [" + l.t("High Angle Bonus") + "] +50Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.excellent_shot:
        ChatReceived(b + " [" + l.t("Excellent Shot Bonus") + "] +100Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.good_shot:
        ChatReceived(b + " [" +
          l.t("Good Shot Bonus") + "] +50Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.shot_bonus:
        ChatReceived(b + " [" + l.t("Shot Bonus") + "] +25Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.team_damage_penalty:
        ChatReceived(b + " [" + l.t("Team Damage Penalty") + "] -25Gold", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.killed_by_sd:
        ChatReceived(this.GetPlayerByPlayerNumber(a.shift()).name + " " + l.t("was killed by") + " Sudden Death", "", CHAT_TYPE_DEAD, void 0,
          GUI_LOCATION_GAME);
        break;
      case GAMEMSG.died_by_tele:
        ChatReceived(b + " [" + l.t("died by teleport") + "]", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.damage_1000:
        ChatReceived(b + " [1000 " + l.t("damage achieved") + "] +100Gold +1GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.damage_2000:
        ChatReceived(b + " [2000 " + l.t("damage achieved") + "] +200Gold +2GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.damage_3000:
        ChatReceived(b + " [3000 " + l.t("damage achieved") +
          "] +300Gold +4GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.triple_kill:
        ChatReceived(b + " [" + l.t("Triple Kill Bonus") + "] +999Gold +7GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#d9f", "Triple Kill");
        break;
      case GAMEMSG.double_kill:
        ChatReceived(b + " [" + l.t("Double Kill Bonus") + "] +500Gold +5GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#b7f", "Double Kill");
        break;
      case GAMEMSG.ending_bonus:
        ChatReceived(b + " [" + l.t("Ending Bonus") + "] +400Gold +2GP",
          "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.bunge_bonus:
        ChatReceived(b + " [" + l.t("Bunge Shot Bonus") + "] +200Gold +1GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.suicide_penalty:
        ChatReceived(b + " [" + l.t("Suicide Penalty") + "] -1000Gold -5GP", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.unlocked_challenge:
        ChatReceived(l.t("Room Master unlocked a new challenge opponent ! :)"), "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.free_kill_detected:
        ChatReceived(l.t("Free kill game detected - No winning bonus"),
          "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.suicide_penalty_bunge:
        ChatReceived(b + " [" + l.t("Suicide Penalty") + "] -1000Gold -5GP (" + l.t("bunge") + ")", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.team_kill_penalty:
        ChatReceived(b + " [Team Kill Penalty] -50Gold -1GP", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.winning_change:
        ChatReceived(l.t("Winning Bonus") + ": " + l.t("Team") + " A = " + a.shift() + " GP, " + l.t("Team") + " B = " + a.shift() + " GP.", "", CHAT_TYPE_SYSTEM,
          void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.early_suicide:
        ChatReceived(l.t("Early Suicide") + "! " + l.t("Team") + " A = " + a.shift() + " GP, " + l.t("Team") + " B = " + a.shift() + " GP.", "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.blocked_winning:
        c = a.shift();
        d = a.shift();
        ChatReceived(this.GetPlayerByPlayerNumber(c).name + " - " + l.t("No winning bonus (because you already won %% many times today. Play for fun, play with others, or continue tomorrow).").replace("%%", -1 == d ? "Computer Players" : this.GetPlayerByPlayerNumber(d).name),
          "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.score_change:
        this.ScoreLifeExpired(a.shift(), a.shift(), a.shift())
    }
  };
  DragonBound.prototype.ScoreLifeExpired = function(a, b, c) {
    DEBUG && console.log("[ScoreLifeExpired]", a, b, c);
    ChatReceived("Team " + (a == TEAM_A ? "A" : "B") + " life expired. (Score " + b + "-" + c + ")", "", CHAT_TYPE_LOSE_LIFE, void 0, GUI_LOCATION_GAME);
    this.UpdateScore(b, c)
  };
  DragonBound.prototype.ShowClickToRevive = function() {
    if (!this.click_to_revive) {
      $("#game_click_to_revive").html(l.t("Select Location to Return")).fadeIn();
      this.click_to_revive = !0;
      var a = $('<div id="revive_panel"></div>').css({
        width: this.ground.w,
        height: this.ground.h + 100,
        top: -100
      });
      this.camera_div.append(a);
      var b = $('<div id="revive_hand" class="blinkingGlow"></div>');
      a.append(b);
      var c = this;
      a.on("mousedown touchstart", function(a) {
        if ("mousedown" != a.type || 0 == a.button) {
          var e = void 0 === a.offsetY ? a.originalEvent.layerY :
            a.offsetY;
          a = Math.round(void 0 === a.offsetX ? a.originalEvent.layerX : a.offsetX);
          e = Math.round(e) - 100;
          b.css({
            left: a,
            top: e + 100
          });
          c.ground.IsPixel(a, e) || void 0 == c.ground.GetUnder(a, e) || (c.dn.SendRevive(a, e), b.removeClass("squeeze_anim"), setTimeout(function() {
            b.addClass("squeeze_anim")
          }, 1))
        }
      }).on("mousemove touchmove", function(d) {
        if (d.target == a[0]) {
          var e = void 0 === d.offsetY ? d.originalEvent.layerY : d.offsetY;
          d = Math.round(void 0 === d.offsetX ? d.originalEvent.layerX : d.offsetX);
          e = Math.round(e) - 100;
          b.css({
            left: d,
            top: e +
              100
          });
          e = !c.ground.IsPixel(d, e) && void 0 != c.ground.GetUnder(d, e);
          SetClass(b, "CanRevive", e)
        }
      });
      $("#gameChat").addClass("noPointerEvents")
    }
  };
  DragonBound.prototype.HideClickToRevive = function() {
    this.click_to_revive = !1;
    $("#game_click_to_revive").hide();
    $("#revive_panel").remove();
    $("#gameChat").removeClass("noPointerEvents")
  };
  DragonBound.prototype.ShowBigMsg = function(a, b) {
    OPTIONS.killmsg && ($(".BonusMsg").remove(), clearTimeout(this.msgTimeout), this.msgTimeout = setTimeout(function() {
      $("#game_front").append($('<div class="BonusMsg blackShadow" style="color:' + a + '">' + b + "</div>"))
    }, 1))
  };
  DragonBound.prototype.QueueAddCommand = function(a, b) {
    this.queue.push({
      opcode: a,
      params: b
    });
    this.QueueExecuteNext()
  };
  DragonBound.prototype.QueueUnblock = function() {
    this.is_queue_executing = !0;
    this.QueueExecuteNext()
  };
  var E_PLAY = Object.freeze({
      next_turn_number: 0,
      player_number: 1,
      x: 2,
      y: 3,
      look: 4,
      add_delay: 5,
      next_turn_of_player: 6,
      chat: 7,
      thor_x: 8,
      thor_y: 9,
      thor_angle: 10,
      thor_damage: 11,
      new_weather: 12,
      wind_power: 13,
      wind_angle: 14,
      shots: 15,
      gold: 16
    }),
    E_PASS = Object.freeze({
      next_turn_number: 0,
      player_number: 1,
      x: 2,
      y: 3,
      look: 4,
      add_delay: 5,
      next_turn_of_player: 6,
      chat: 7,
      thor_x: 8,
      thor_y: 9,
      thor_angle: 10,
      thor_damage: 11,
      new_weather: 12,
      wind_power: 13,
      wind_angle: 14
    });
  DragonBound.prototype.QueueExecuteNext = function() {
    for (; this.is_queue_executing && 0 < this.queue.length;) {
      var a = this.queue.shift(),
        b = a.params;
      switch (a.opcode) {
        case "play":
          var c = b[E_PLAY.player_number],
            d = this.GetPlayerByPlayerNumber(c),
            a = a.params[E_PLAY.next_turn_number];
          d.MoveTo(b[E_PLAY.x], b[E_PLAY.y], b[E_PLAY.look]);
          d.ChangeDelay(d.delay + b[E_PLAY.add_delay], a - 1);
          this.UpdateTurnList();
          this.turn_number = a;
          this.UpdateGhostsTurn();
          this.after_shot_chat = b[E_PLAY.chat];
          this.after_shot_gold = c == this.my_player_number ?
            b[E_PLAY.gold] : void 0;
          this.EndTurn();
          this.after_shot_thor = [b[E_PLAY.thor_x], b[E_PLAY.thor_y], b[E_PLAY.thor_angle], b[E_PLAY.thor_damage]];
          this.after_shot_weather = b[E_PLAY.new_weather];
          this.next_turn = b[E_PLAY.next_turn_of_player];
          this.next_wind = [b[E_PLAY.wind_power], b[E_PLAY.wind_angle]];
          if (b[E_PLAY.shots] && 0 < b[E_PLAY.shots].length) {
            for (var a = !1, e = 0; e < b[E_PLAY.shots].length; e++) {
              var f = !a && !b[E_PLAY.shots][e].orbit;
              f && (a = !0);
              this.CreateShot(b[E_PLAY.shots][e], f, this.turn_number, d);
              b[E_PLAY.shots][e].ss &&
                c == this.my_player_number && (this.no_ss_turns = 4, $("#btnShotSS").fadeOut(), 2 == GetSelectedShotType() && SelectShotType(this.is_s1_disabled ? 1 : 0, this))
            }
            this.is_queue_executing = !1;
            return
          }
          this.ReceivedChatArray(b[E_PLAY.chat], d.name);
          this.UpdateThor(this.after_shot_thor);
          this.PushWeather(this.after_shot_weather);
          this.UpdateWind(this.next_wind);
          this.StartNextTurn();
          break;
        case "pass":
          c = b[E_PASS.player_number];
          d = this.GetPlayerByPlayerNumber(c);
          a = a.params[E_PASS.next_turn_number];
          d.MoveTo(b[E_PASS.x], b[E_PASS.y],
            b[E_PASS.look]);
          d.ChangeDelay(d.delay + b[E_PASS.add_delay], a - 1);
          this.UpdateTurnList();
          this.turn_number = a;
          this.UpdateGhostsTurn();
          this.EndTurn();
          this.next_turn = b[E_PASS.next_turn_of_player];
          this.ReceivedChatArray(b[E_PASS.chat], d.name);
          this.UpdateThor([b[E_PASS.thor_x], b[E_PASS.thor_y], b[E_PASS.thor_angle], b[E_PASS.thor_damage]]);
          this.PushWeather(b[E_PASS.new_weather]);
          this.UpdateWind([b[E_PASS.wind_power], b[E_PASS.wind_angle]]);
          this.StartNextTurn();
          break;
        case "update":
          this.UpdatePlayer(b);
          break;
        case "game-over":
          this.ReceivedChatArray(b.chat);
          this.GameOver(b);
          break;
        case "dead":
          DEBUG && console.log("op dead", b);
          c = void 0 == b[0] ? b : b[0];
          if (d = this.GetPlayerByPlayerNumber(c)) d.ChangeAliveTo(!1), this.UpdateTurnList();
          void 0 != b[1] && void 0 != b[2] && this.ScoreLifeExpired(c % 2, b[1], b[2]);
          break;
        case "ghost":
          b = ArrayToObject(b, ["player_number", "x", "y", "revive_turn"]);
          (d = this.GetPlayerByPlayerNumber(b.player_number)) && d.SetGhost(b.x, b.y, b.revive_turn, this.turn_number);
          b.player_number == this.my_player_number && this.HideClickToRevive();
          break;
        case "revived":
          if (b =
            ArrayToObject(b, "player_number x y hp shield delay".split(" ")), d = this.GetPlayerByPlayerNumber(b.player_number)) d.Revived(b.x, b.y, b.hp, b.shield, b.delay, this.turn_number), d.ChangeDelay(b.delay, this.turn_number), this.UpdateTurnList()
      }
    }
  };
  DragonBound.prototype.UpdateGhostsTurn = function() {
    for (var a = this.players.length, b = 0; b < a; b++) this.players[b].UpdateGhostTurn(this.turn_number)
  };
  DragonBound.prototype.EndTurn = function() {
    var a = this.GetPlayerByPlayerNumber(this.turn);
    a && a.ChangeMyTurn(!1);
    this.turn = -1;
    this.intervalDoLeft = clearInterval(this.intervalDoLeft);
    this.intervalDoRight = clearInterval(this.intervalDoRight);
    this.intervalDoSpace = clearInterval(this.intervalDoSpace);
    this.turnTimeout = clearTimeout(this.turnTimeout);
    this.isInDrag = !1;
    $("#turn_timer").hide()
  };
  DragonBound.prototype.PassTurn = function() {
    if (!(0 > this.my_player_index)) {
      this.EndTurn();
      var a = Math.floor((get_time() - this.start_turn_time) / 1E3);
      if (20 < a || 0 > a) a = 20;
      this.players[this.my_player_index].PassTurn(a)
    }
  };
  DragonBound.prototype.Shoot = function(a) {
    if (!(0 > this.my_player_index) && this.turn == this.my_player_number) {
      this.EndTurn();
      var b = Math.floor((get_time() - this.start_turn_time) / 1E3);
      if (20 < b || 0 > b) b = 20;
      this.players[this.my_player_index].Shoot(a, b, GetSelectedShotType());
      $("#last_power_mark").animate({
        left: 240 + a
      });
      $("#powerBar").css("width", a)
    }
  };
  DragonBound.prototype.PassTurnClicked = function() {
    this.turn == this.my_player_number && this.PassTurn()
  };
  DragonBound.prototype.StartNextTurn = function() {
    if (this.turn_number == this.sudden_death_at_turn - 20) ChatReceived(l.t("Sudden Death in %% turns").replace("%%", 20), "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
    else if (this.turn_number == this.sudden_death_at_turn - 10) ChatReceived(l.t("Sudden Death in %% turns").replace("%%", 10), "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
    else if (this.turn_number == this.sudden_death_at_turn - 5) ChatReceived(l.t("Sudden Death in %% turns").replace("%%", 5), "", CHAT_TYPE_SYSTEM,
      void 0, GUI_LOCATION_GAME);
    else if (this.turn_number == this.sudden_death_at_turn) ChatReceived(l.t("Sudden Death Started!"), "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME), $("#ss_shot_background").addClass("sudden_death").fadeIn(), $("#btnShotSS").hide(), this.no_ss_turns = 999999, 2 == GetSelectedShotType() && SelectShotType(1, this), $("#message_over_items").removeClass("items_locked").addClass("sudden_death").show(), AudioPlayInLoop(AUDIO_MUSIC_SUDDEN, !0);
    else if (this.turn_number > this.sudden_death_at_turn)
      for (var a =
          0; a < this.players.length; a++) {
        var b = this.players[a];
        b.ReduceHPby(5 * (this.turn_number - this.sudden_death_at_turn), this.turn_number)
      }
    this.turn = this.next_turn;
    if (-1 != this.turn)
      if (b = this.GetPlayerByPlayerNumber(this.turn))
        if (b.ChangeMyTurn(!0), b.RegenShield(this.turn_number), 2 < this.queue.length ? $("#game_replay").show() : $("#game_replay").hide(), 0 == this.no_ss_turns && this.turn_number <= this.sudden_death_at_turn && $("#btnShotSS").show(), this.camera.FocusAt(b.x, b.y, !0), this.start_turn_time = get_time(), this.turn ==
          this.my_player_number) {
          0 < this.no_ss_turns && this.no_ss_turns--;
          this.steps = 0;
          $("#walkBar").css("width", 400);
          this.UsePressedItem();
          $("#turn_timer").stop(!0, !0).hide().css("background-position", "0 -1900px").show("slow");
          var c = this,
            d = function() {
              AudioPlay(AUDIO_TURN_TICK);
              if (c.turn == c.my_player_number) {
                var a = 20 - Math.floor((get_time() - c.start_turn_time) / 1E3);
                0 < a ? (OPTIONS.anim ? $("#turn_timer").animate({
                  backgroundPositionY: "-" + (a - 1) + "00px"
                }, 200, "linear") : $("#turn_timer").css({
                  backgroundPositionY: "-" + (a - 1) +
                    "00px"
                }), 0 == c.queue.length && b.SendPosUpdate(), c.turnTimeout = setTimeout(function() {
                  d()
                }, 1E3)) : c.PassTurn()
              }
            };
          this.turnTimeout = setTimeout(d, 1E3);
          AudioPlay(AUDIO_MY_TURN)
        } else $("#turn_timer").hide();
    else DEBUG && console.log("[DragonBound.StartNextTurn] ERROR: turn of unknown player number", this.turn)
  };
  DragonBound.prototype.GetPlayerByPlayerNumber = function(a) {
    if (-1 != a)
      for (var b = 0; b < this.players.length; b++)
        if (this.players[b].player_number_in_game == a) return this.players[b]
  };

  function GpForNextRank(a) {
    for (var b = [1100, 1200, 1500, 1800, 2300, 2800, 3500, 4200, 5100, 6E3, 6900], c = 0; c < b.length; c++)
      if (a < b[c]) return b[c] - a
  }
  DragonBound.prototype.GameOver = function(a) {
    $("#scores_lose_a,#scores_lose_b").removeClass();
    if (a.won == TEAM_A || "A" == a.won) $("#scores_lose_a").addClass("win"), $("#scores_lose_b").removeClass();
    else if (a.won == TEAM_B || "B" == a.won) $("#scores_lose_a").removeClass(), $("#scores_lose_b").addClass("win");
    var b = ["", "Computer", "Left", "Rank Up!"],
      c = ["", "score_state_computer", "score_state_left", "score_state_rankup"],
      d = this.my_start_gp,
      e = 0,
      f = this.my_start_gold,
      h = 0;
    $(".score").hide().removeClass("toShow");
    for (var k =
        0; k < a.scores.length; k++) {
      var m = a.scores[k],
        n = m[0],
        p = m[1],
        q = m[2],
        r = m[3],
        s = m[4],
        t = m[5],
        w = m[6],
        v = m[7] || 0,
        m = m[8] || 0;
      $("#score" + n + " .score_name").html(q);
      $("#score" + n + " .score_rank").removeClass().addClass("score_rank rank rank" + r);
      $("#score" + n + " .score_gp").html(s + " GP");
      $("#score" + n + " .score_gold").html(t + " GOLD");
      $("#score" + n + " .score_bonus_gp").html(v ? "+" + v + " GP" : "");
      $("#score" + n + " .score_bonus_gold").html(m ? "+" + m + " GOLD" : "");
      $("#score" + n + " .score_state").html(b[w]).removeClass().addClass("score_state blackShadow " +
        c[w]);
      p == this.my_user_id ? ($("#score" + n + " .score_me").show(), e = s + v, h = t + m) : $("#score" + n + " .score_me").hide();
      $("#score" + n).addClass("toShow")
    }
    DEBUG && console.log("[GameOver] start gp:", d, "add gp:", e);
    this.dn.myPlayerInfo.gp == d && (this.dn.myPlayerInfo.gp += e);
    this.dn.myPlayerInfo.gold == f && (this.dn.myPlayerInfo.gold += h);
    if (OPTIONS.gameendcounter) {
      var u, x, y = GpForNextRank(d);
      $("#GameOverMyGPGot").html((0 < e ? "+" : "") + Commatize(e) + " GP").show();
      $("#GameOverMyGP").html(Commatize(d) + " GP").removeClass("shake_anim").show();
      0 < y && $("#GameOverMyGPNext").html("Next Rank in " + Commatize(y) + " GP").show();
      $("#GameOverMyGoldGot").html((0 < h ? "+" : "") + Commatize(h) + " Gold").show();
      $("#GameOverMyGold").html(Commatize(f) + " Gold").removeClass("shake_anim").show();
      var A = function() {
        var a = (get_time() - u) / 2E3;
        1 < a && (a = 1);
        var b = 0.5 < a ? 2 * (a - 0.5) : 0,
          c = d + Math.round(e * (0.5 < a ? 1 : 2 * a)),
          b = f + Math.round(h * b);
        $("#GameOverMyGP").html(Commatize(c) + " GP");
        $("#GameOverMyGold").html(Commatize(b) + " Gold");
        y = GpForNextRank(c);
        0 < y ? $("#GameOverMyGPNext").html("Next Rank in " +
          Commatize(y) + " GP").show() : $("#GameOverMyGPNext").hide();
        0.5 < a && $("#GameOverMyGP").addClass("shake_anim");
        1 <= a && ($("#GameOverMyGold").addClass("shake_anim"), clearInterval(x), setTimeout(function() {
          $(".toShow").show("fast");
          $("#GameOverMyGP,#GameOverMyGold,#GameOverMyGPGot,#GameOverMyGoldGot,#GameOverMyGPNext").hide("fast")
        }, 800))
      };
      setTimeout(function() {
        u = get_time();
        x = setInterval(A, 25)
      }, 800)
    } else $(".toShow").show(), $("#GameOverMyGP,#GameOverMyGold,#GameOverMyGPGot,#GameOverMyGoldGot,#GameOverMyGPNext").hide();
    var z = this;
    $(".Player").promise().done(function() {
      function a() {
        $("#game_over").unbind();
        g_score_screen_timeout = clearTimeout(g_score_screen_timeout);
        var c = '<span id="ShareLastGame" class="opacity_button">[' + l.t("View Last Game Results") + "]</span><br>";
        b.location == GUI_LOCATION_GAME && (b.should_stay_in_game_screen = !1, b.myPlayerInfo.location_type == LOCATION_TYPE_CHANNEL ? (SwitchToChannelScreen(b), $("#channelTextHtml").append(c)) : ($("#roomChatHtml").append(c), SwitchToRoomScreen(b)), $("#ShareLastGame").click(function(a) {
          b.SendGameShare()
        }))
      }
      DEBUG && console.log("GameOver calling Destructor");
      var b = z.dn;
      z.Destructor();
      z.dn.game = void 0;
      g_score_screen_timeout = setTimeout(a, 12E3);
      $("#game_over").unbind().click(a).fadeIn(1E3)
    })
  };
  var g_score_screen_timeout;
  DragonBound.prototype.ChangePlayersInRoom = function(a) {
    var b, c;
    for (b = 0; b < this.players.length; b++) this.players[b].mark = !1;
    for (c = 0; c < a.length; c++)
      for (b = 0; b < this.players.length; b++) a[c][PLAYER_INDEX_USER_ID] == this.players[b].user_id && (this.players[b].mark = !0);
    for (b = 0; b < this.players.length; b++) this.players[b].mark || this.players[b].ChangeAliveTo(!1)
  };
  DragonBound.prototype.UpdateGuiGold = function(a) {
    var b = a.toString().split("").reverse();
    for (a = 0; a < b.length && 5 > a; a++) "-" == b[a] ? $("#UIGoldDigit" + a).animate({
      backgroundPositionY: "-154px"
    }, 1E3) : $("#UIGoldDigit" + a).animate({
      backgroundPositionY: -14 - 14 * Number(b[a]) + "px"
    }, 1E3);
    for (; 5 > a; a++) $("#UIGoldDigit" + a).animate({
      backgroundPositionY: "0"
    }, 1E3)
  };
  THOR_LEVEL = [0, 300, 900, 1800, 3200, 6E3];
  DragonBound.prototype.UpdateThor = function(a) {
    if (a) {
      var b = a[0],
        c = a[1],
        d = a[2];
      a = a[3];
      for (var e = 0; e + 1 < THOR_LEVEL.length && a >= THOR_LEVEL[e + 1];) e++;
      e++;
      $("#thor").stop(!0, !0).animate({
        left: b,
        top: c
      }, 2E3);
      $("#thor_rotate").stop(!0, !0).animate({
        rotate: "-" + d + "deg"
      }, 1E3);
      $("#thor_lvl").html("Lv." + e);
      $("#thor_damage").html(a);
      $("#thor_laser").fadeOut()
    }
  };
  DragonBound.prototype.ThorShoot = function(a, b, c, d) {
    $("#thor").stop(!0, !0).css({
      left: a,
      top: b
    });
    $("#thor_rotate").stop(!0, !0).css({
      rotate: "-" + c + "deg"
    });
    $("#thor_laser").stop(!0, !0).css({
      width: d
    }).show().fadeOut()
  };
  DragonBound.prototype.SetWeather = function(a) {
    this.weather = a;
    this.UpdateWeatherGUI()
  };
  DragonBound.prototype.PushWeather = function(a) {
    this.weather.shift();
    this.weather.push(a);
    this.UpdateWeatherGUI();
    1 == this.weather[1] && AudioPlay(AUDIO_WIND)
  };
  DragonBound.prototype.UpdateWeatherGUI = function() {
    $("#weatherSlot0").removeClass().addClass("weather-" + this.weather[0]);
    $("#weatherSlot1").removeClass().addClass("weather-" + this.weather[1]);
    $("#weatherSlot2").removeClass().addClass("weather-" + this.weather[2]);
    $("#weatherSlot3").removeClass().addClass("weather-" + this.weather[3]);
    $("#weatherSlot4").removeClass().addClass("weather-" + this.weather[4])
  };
  DragonBound.prototype.CreateLightning = function(a, b, c) {
    var d = "#lightning" + random(0, 999999),
      e = random(0, 3);
    $(DIV_TO_CREATE_GAME_OBJECTS).append('<div id="' + d.slice(1) + '" style="position:absolute; left:' + a + "px; top:" + b + 'px;"><div class="lightning lightning' + e + '"></div></div>');
    $(d).css({
      rotate: 270 - c + "deg"
    });
    setTimeout(function() {
      $(d).remove()
    }, 100)
  };
  DragonBound.prototype.UpdateWind = function(a) {
    var b = a[0],
      c = a[1];
    if (!this.gameStuffImage) {
      var d = this;
      a = this.gameStuffImage = new Image;
      a.onload = function() {
        d.DrawWind(b, c)
      };
      a.src = GetBackgroundImageUrl("#gameui")
    }
    this.DrawWind(b, c)
  };
  DragonBound.prototype.DrawWind = function(a, b) {
    var c = $("#wind_meter2")[0].getContext("2d"),
      d = this.gameStuffImage;
    c.clearRect(0, 0, 66, 60);
    var e = this.WOX,
      f = this.WOY;
    d && c.drawImage(d, 177, 159, 54, 54, e, f, 54, 54);
    c.save();
    c.translate(27 + e, 27 + f);
    c.rotate(AngleToRad(-b));
    d && c.drawImage(d, 483, 221, 86, 5, -35, -2, 70, 5);
    c.restore();
    c.save();
    d = 10 > a ? "#ffffff" : 20 > a ? "#ffff00" : "#ff0000";
    10 > a && (a = "0" + a);
    c.fillStyle = d;
    c.font = "20px verdana";
    c.shadowColor = "black";
    c.shadowOffsetX = 0;
    c.shadowOffsetY = 0;
    c.shadowBlur = 4;
    c.strokeStyle =
      "black";
    c.lineWidth = 1;
    c.strokeText(a, 14 + e, 34 + f);
    c.fillText(a, 14 + e, 34 + f);
    c.restore();
    c.drawImage(g_dirty, -1, -1, 1, 1)
  };
  DragonFreeze(DragonBound);

  function DragonLogin(a) {
    this.dn = a;
    this.CheckStatus();
    this.Init()
  }
  DragonLogin.prototype.Init = function() {
    var a = this;
    $("#ConnectWithFacebook").click(function() {
      window.FB ? ($("#LoginWindowBG").hide(), $("#container").removeClass("behindDialog"), a.FacebookLoginButtonClicked()) : alertify.alert("Facebook could not be loaded right now, use password login.")
    });
    $("#ConnectWithPassword").click(function() {
      $("#LoginWindowBG").hide();
      $("#container").removeClass("behindDialog");
      a.PasswordLoginButtonClicked(2)
    });
    $("#LoginSubmit").click(function() {
      if (!$("#LoginSubmit").hasClass("grayspin") && !$("#RegisterSubmit").hasClass("grayspin")) {
        var b =
          $("#LoginUsername").val(),
          c = $("#LoginPass").val(),
          d = $("#LoginRemember").is(":checked") ? 1 : 0;
        b ? c ? ($("#LoginSubmit").addClass("grayspin"), $.ajax({
          type: "POST",
          url: "dev" == SERVER_TYPE ? "http://" + location.host + "/ajaxLogin" : "https://" + location.host + "/ajaxLogin",
          data: {
            u: b,
            p: c,
            r: d
          },
          success: function(b) {
            $("#LoginSubmit").removeClass("grayspin");
            0 == b ? alertify.alert(l.t("Bad username or password. Try again.")) : ($("#LoginWindowBG").hide(), $("#container").removeClass("behindDialog"), a.GotLoginData(b), $("#LoginUsername,#LoginPass").val(""))
          },
          dataType: "json",
          xhrFields: {
            withCredentials: !0
          },
          crossDomain: !0
        }).error(function(a) {
          $("#LoginSubmit").removeClass("grayspin");
          alertify.error("Network Error. Try Again.")
        })) : alertify.alert(l.t("Please fill password.")) : alertify.alert(l.t("Please fill Email / UserID / Username."))
      }
    });
    $("#RegisterSubmit").click(function() {
      if (!$("#RegisterSubmit").hasClass("grayspin") && !$("#LoginSubmit").hasClass("grayspin")) {
        var b = $("#name").val(),
          c = $("#email").val(),
          d = $("#password").val(),
          e = $("input[name=gender]:checked").val(),
          f = $("#RegisterBirthday").datepicker("getDate"),
          h = f ? f.getFullYear() : 0,
          k = f ? f.getMonth() + 1 : 0,
          f = f ? f.getDate() : 0;
        if (!(b && c && d && h)) return alertify.alert(l.t("Please fill all fields"));
        $("#RegisterSubmit").addClass("grayspin");
        $.post("/ajaxRegister", {
          name: b,
          email: c,
          password: d,
          gender: e,
          year: h,
          month: k,
          day: f
        }, function(b) {
          $("#RegisterSubmit").removeClass("grayspin");
          "string" == typeof b || "<" == b[0] || "I" == b[0] ? alertify.alert(b) : ($("#LoginWindowBG").hide(), $("#container").removeClass("behindDialog"), a.GotLoginData(b),
            $("#name,#email,#password").val(""), $("input[name=gender]").removeAttr("checked"), $("#year,#month,#day").val("0"))
        }, "json").error(function(a) {
          $("#RegisterSubmit").removeClass("grayspin");
          alertify.error("Network Error. Try Again.")
        })
      }
    });
    $("#LoginUsername").keydown(function(a) {
      13 == a.which && ($("#LoginPass").focus(), a.stopPropagation())
    });
    $("#LoginPass").keydown(function(a) {
      13 == a.which && $("#LoginSubmit").click();
      a.stopPropagation()
    });
    $("#name").keydown(function(a) {
      13 == a.which && ($("#email").focus(), a.stopPropagation())
    });
    $("#email").keydown(function(a) {
      13 == a.which && ($("#password").focus(), a.stopPropagation())
    });
    $("#RegisterBirthday").datepicker({
      changeMonth: !0,
      changeYear: !0,
      dateFormat: "yy-mm-dd",
      minDate: new Date(1905, 0, 1),
      maxDate: new Date(2013, 11, 31),
      yearRange: "1905:2013"
    });
    $("#name").on("focus", function() {
      $("#male").parent().slideDown()
    });
    $("#male,#female").on("focus", function() {
      $("#password").parent().slideDown()
    });
    $("#password").on("focus", function() {
      $("#email").parent().slideDown()
    });
    $("#email").on("focus", function() {
      $("#RegisterBirthday").parent().slideDown()
    });
    $("#RegisterBirthday").on("focus", function() {
      $("#RegisterSubmit").parent().slideDown()
    });
    $("#password,#email,#male,#RegisterBirthday,#RegisterSubmit").parent().hide()
  };
  DragonLogin.prototype.LoginMessage = function(a) {
    DragonDialogOpen(l.t("Login"), a, DIALOG_BUTTONS_NONE, void 0, [35, 52])
  };
  DragonLogin.prototype.ShowConnectToFacebookButton = function() {
    DragonDialogClose(!0);
    $("#LoginWindowBG").show();
    $("#container").addClass("behindDialog");
    $("#LoginUsername").focus();
    g_is_facebook_canvas && ($("#LoginOR1,#LoginPart,#RegisterPart,#registerTitle,#LoginSap").hide(), $("#LoginWindow").addClass("InFacebookCanvas"))
  };
  DragonLogin.prototype.CheckStatus = function() {
    var a = this,
      b = !1,
      c = !1,
      d = !1;
    a.LoginMessage("Checking Login Status...");
    "dev" == SERVER_TYPE || navigator.userAgent.indexOf("FireFox"); - 1 == location.hostname.indexOf("dragonbound") && (location.href = "https://dragonbound.net");
    $.ajax({
      url: "/s",
      success: function(e) {
        !e || 2 > e.length ? c ? a.FacebookLogin() : b = !0 : (d = !0, a.GotLoginData(e))
      },
      dataType: "json",
      xhrFields: {
        withCredentials: !0
      },
      crossDomain: !0
    }).error(function(b) {
      DEBUG && console.log("ERROR /s:", b);
      a.LoginMessage("Please wait a few seconds...<br>(Por favor espere unos segundos)<br><br>Fixing your connection... :)<br>(Arreglando su conexion)<br><br>" +
        b.status);
      setTimeout(function() {
        location.replace("/test")
      }, 1E4)
    });
    var e = setTimeout(function() {
      d || a.ShowConnectToFacebookButton()
    }, 3E4);
    window.fbAsyncInit = function() {
      clearTimeout(e);
      FB.init({
        appId: FB_APP_ID,
        version: FB_API_VERSION,
        status: !0,
        cookie: !0,
        xfbml: !0,
        oauth: !0,
        channelUrl: location.protocol + "//" + location.host + "/channel.html"
      });
      c = !0;
      b && a.FacebookLogin()
    };
    if (!document.getElementById("facebook-jssdk")) {
      var f = document.createElement("script");
      f.id = "facebook-jssdk";
      f.async = !0;
      f.src = "https://connect.facebook.com/en_US/sdk.js#xfbml=1&appId=" +
        FB_APP_ID + "&version=" + FB_API_VERSION;
      document.getElementsByTagName("head")[0].appendChild(f)
    }
  };
  DragonLogin.prototype.FacebookLogin = function() {
    DEBUG && console.log(" >> FacebookLogin");
    var a = this;
    a.LoginMessage(l.t("Checking FB login status") + "...");
    var b = setTimeout(function() {
      a.ShowConnectToFacebookButton()
    }, 3E4);
    FB.getLoginStatus(function(c) {
      DEBUG && console.log("FB.getLoginStatus:", c);
      b = clearTimeout(b);
      c && "connected" == c.status ? (DEBUG && console.log(" >> Connected and authorized the app!"), a.Login({
        t: 1
      })) : (DEBUG && console.log(' >> Not connected or authorized the app... Showing "Connect To Facebook" Button'),
        a.ShowConnectToFacebookButton())
    })
  };
  DragonLogin.prototype.FacebookLoginButtonClicked = function() {
    DEBUG && console.log(" >> FacebookLoginButtonClicked");
    var a = this;
    a.LoginMessage(l.t("A Facebook pop-up has opened, please follow the instructions to sign in."));
    if (g_is_mobile_device || g_is_installed_app) return location.href = "https://www.facebook.com/dialog/oauth?client_id=" + FB_APP_ID + "&redirect_uri=" + location.href;
    FB.login(function(b) {
      DEBUG && console.log(" >> FB.Login:", b);
      b.authResponse ? (DEBUG && console.log(" >> FB.Login: Connected"), a.Login({
          t: 1
        })) :
        (DEBUG && console.log(" >> FB.Login: Cancelled"), a.ShowConnectToFacebookButton())
    }, {
      scope: FB_PERMISSIONS
    })
  };
  DragonLogin.prototype.Login = function(a) {
    DEBUG && console.log(" >> Login");
    var b = this;
    b.LoginMessage(l.t("Loading your account") + "...");
    $.post("/f", a, function(a) {
      b.GotLoginData(a)
    }, "json").error(function(a) {
      console && console.log("Error: Got Server Status:", a);
      DragonDialogOpen("Facebook Error", "MSG: " + a[0] + (a[1] ? "<br><br>" + a[1] : ""), DIALOG_BUTTONS_OK, function() {
        b.ShowConnectToFacebookButton()
      }, [35, 52])
    })
  };
  DragonLogin.prototype.GotLoginData = function(a) {
    var b = this;
    $("#channelInput").blur();
    3 == a.length ? (DEBUG && console.log(" >> Banned Message"), DragonDialogOpen(l.t("You Are Banned"), l.t("Reason") + ": " + a[0].replace(" Days", " " + l.t("Days")) + "<br><br>" + l.t("Until") + ": " + ("Forever" == a[1] ? l.t("Forever") : new Date(a[1] + " UTC")), DIALOG_BUTTONS_OK, function() {
      b.ShowConnectToFacebookButton()
    }, [35, 52])) : 4 == a.length ? (DEBUG && console.log(" >> Show server open timer"), DragonDialogClose(!0), a[2] && $("#ranking_title2").html(Commatize(a[2]) +
      " " + l.t("Players")), ShowServerOpenTimer(a[0], a[1], a[3])) : 5 == a.length || 6 == a.length ? (DragonDialogClose(!0), a[2] && $("#ranking_title2").html(Commatize(a[2]) + " " + l.t("Players")), b.dn.SetLoginUserDetails(a[0], a[1], a[3], a[4], a[5]), b.dn.OpenBrokerWindow()) : 2 == a.length && -5 == a[0] ? (DEBUG && console.log(" >> Password needed too"), DragonDialogOpen("Facebook Login Good :)", "Your account require both to use Facebook login and Password login. Please enter your password too ->", DIALOG_BUTTONS_OK, function() {
      b.PasswordLoginButtonClicked(3,
        a[1])
    }, [35, 52])) : 1 == a.length && -9 == a[0] ? (DEBUG && console.log(" >> Password change needed"), DragonDialogOpen("Facebook Login Good :)", "Please set a password to your GM account now -><br><br>(You can change it later at [My Info] button in the lobby)", DIALOG_BUTTONS_OK, function() {
      b.ChangePassword(1)
    }, [35, 52])) : 1 == a.length && -11 == a[0] ? (DEBUG && console.log(" >> Password change needed"), DragonDialogOpen(l.t("New Password"), l.t("Set a new password so you can always login to your account even without Facebook.<br><br>Write down your new username!<br><br>(You can change it at [My-Info])"),
      DIALOG_BUTTONS_OK,
      function() {
        b.ChangePassword(1)
      }, [35, 52])) : (DragonDialogOpen(l.t("Login"), "MSG: " + a[0] + (a[1] ? "<br><br>" + a[1] : ""), DIALOG_BUTTONS_OK, function() {
      b.ShowConnectToFacebookButton()
    }, [35, 52]), DEBUG && console.log("ERROR MSG:", a))
  };
  DragonLogin.prototype.Logout = function() {
    var a = this;
    $.post("/g", {}, function() {});
    $("#BrokerScreen").hide();
    DragonDialogOpen(l.t("Bye Bye"), l.t("We logged you out from your Facebook account too for your account safety.<br><br>Hope to see you again soon!"), DIALOG_BUTTONS_OK, function() {
      a.ShowConnectToFacebookButton()
    }, [35, 52]);
    FB.logout(function(a) {
      DEBUG && console.log("FB.logout", a)
    })
  };
  DragonLogin.prototype.PasswordLoginButtonClicked = function(a, b) {
    var c = this;
    DEBUG && console.log(" >> PasswordLoginButtonClicked", a, b);
    var d = "";
    DragonDialogOpen("Password Login", 'Username: <input id="DragonLoginUsername"><br>Password: <input type="password" id="DragonLoginPassword"><br>Secret Number: <input type="password" id="DragonLoginSecret" readonly><div id="DragonC0de"></div>', DIALOG_BUTTONS_OK_CANCEL, function(b) {
      if (b) {
        b = $("#DragonLoginUsername").val();
        var e = $("#DragonLoginPassword").val(),
          e = e +
          ("|" + d),
          e = CryptoJS.SHA256(e).toString() + get_time();
        c.Login({
          t: a,
          u: b,
          p: e
        })
      } else c.ShowConnectToFacebookButton()
    });
    b && $("#DragonLoginUsername").val(b);
    var e = shuffle([1, 2, 3, 4, 5, 6, 7, 8, 9, 0]),
      f = $("#DragonC0de"),
      h = $("#DragonLoginSecret");
    f.append($("<button>" + e[0] + "</button>").click(function() {
      d += e[0];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[1] + "</button>").click(function() {
      d += e[1];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[2] + "</button>").click(function() {
      d += e[2];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[3] + "</button>").click(function() {
      d += e[3];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[4] + "</button>").click(function() {
      d += e[4];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[5] + "</button>").click(function() {
      d += e[5];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[6] + "</button>").click(function() {
      d += e[6];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[7] + "</button>").click(function() {
      d += e[7];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" +
      e[8] + "</button>").click(function() {
      d += e[8];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[9] + "</button>").click(function() {
      d += e[9];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>&#8592;</button>").click(function() {
      d = d.slice(0, -1);
      h.val(h.val().slice(0, -1));
      return !1
    }))
  };
  DragonLogin.prototype.ChangePassword = function(a) {
    var b = this;
    DEBUG && console.log(" >> ChangePassword", a);
    var c = "",
      d = "";
    DragonDialogOpen(l.t("Change Password"), 'Username: <span id="MyDragonLoginUsername"></span><br>' + l.t("Password") + ': <input type="password" id="DragonLoginPassword"><br>' + l.t("Secret Number") + ': <input type="password" id="DragonLoginSecret" readonly><div id="DragonC0de"></div>', DIALOG_BUTTONS_OK_CANCEL, function(e) {
      e ? (DEBUG && console.log(" >> ChangePassword [OK]", a), e = $("#DragonLoginPassword").val(),
        6 > e.length ? DragonDialogOpen(l.t("Too Short"), l.t("Password too short. Length 6+ needed."), DIALOG_BUTTONS_OK, function() {
          b.ChangePassword(a)
        }) : /^(.)\1+$/.test(e) || "123456" == e || "1234567" == e || "12345678" == e || e == d ? DragonDialogOpen(l.t("Too Easy"), l.t("Password too easy to guess. Make it harder."), DIALOG_BUTTONS_OK, function() {
          b.ChangePassword(a)
        }) : 6 > c.length ? DragonDialogOpen(l.t("Too Short"), l.t("Secret number too short. Length 6+ needed."), DIALOG_BUTTONS_OK, function() {
          b.ChangePassword(a)
        }) : /^(.)\1+$/.test(c) ||
        "123456" == c || "1234567" == c || "12345678" == c || c == e ? DragonDialogOpen(l.t("Too Easy"), l.t("Secret number too easy to guess. Make it harder."), DIALOG_BUTTONS_OK, function() {
          b.ChangePassword(a)
        }) : (e += "|" + c, e = CryptoJS.SHA256(e).toString() + get_time(), $.post("/change_password", {
          u: d,
          p: e
        }, function(c) {
          "1" == c ? DragonDialogOpen(l.t("Good") + " :)", l.t("Password Changed"), DIALOG_BUTTONS_OK, function() {
            a && b.ShowConnectToFacebookButton()
          }) : DragonDialogOpen("Failed :(", c, DIALOG_BUTTONS_OK, function() {
            b.ChangePassword(a)
          })
        }).error(function() {
          DragonDialogOpen("Sorry :(",
            "Error. Could not change your password. Try again.", DIALOG_BUTTONS_OK,
            function() {
              b.ChangePassword(a)
            })
        }))) : (DEBUG && console.log(" >> ChangePassword [Cancel]", a), a && b.ShowConnectToFacebookButton())
    });
    $.get("/my_username", function(a) {
      2 != a.length ? DragonDialogOpen("Sorry :(", "Please re-login before changing password.", DIALOG_BUTTONS_OK, function() {
        location.reload()
      }) : (d = a[0], setCookie("csrftoken", a[1]), $("#MyDragonLoginUsername").html(a[0]))
    }, "json").error(function() {
      DragonDialogOpen("Sorry :(", "Error while getting username. Please re-login.",
        DIALOG_BUTTONS_OK,
        function() {
          b.ChangePassword()
        })
    });
    var e = shuffle([1, 2, 3, 4, 5, 6, 7, 8, 9, 0]),
      f = $("#DragonC0de"),
      h = $("#DragonLoginSecret");
    f.append($("<button>" + e[0] + "</button>").click(function() {
      c += e[0];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[1] + "</button>").click(function() {
      c += e[1];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[2] + "</button>").click(function() {
      c += e[2];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[3] + "</button>").click(function() {
      c += e[3];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" +
      e[4] + "</button>").click(function() {
      c += e[4];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[5] + "</button>").click(function() {
      c += e[5];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[6] + "</button>").click(function() {
      c += e[6];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[7] + "</button>").click(function() {
      c += e[7];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[8] + "</button>").click(function() {
      c += e[8];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>" + e[9] + "</button>").click(function() {
      c +=
        e[9];
      h.val(h.val() + "*");
      return !1
    })).append($("<button>&#8592;</button>").click(function() {
      c = c.slice(0, -1);
      h.val(h.val().slice(0, -1));
      return !1
    }))
  };

  function BuildTimeLeftString(a, b, c) {
    for (b -= c; 0 > b;) a--, b += 86400;
    if (0 > a) return l.t("Press F5 to reload");
    c = Math.floor(b / 3600);
    b %= 3600;
    var d = Math.floor(b / 60);
    b %= 60;
    var e = "";
    0 < a && (e += a + " " + l.t("Days") + " ");
    return e += c + " " + l.t("Hours") + " " + d + " " + l.t("Minutes") + " " + b + " " + l.t("Seconds")
  }

  function ShowServerOpenTimer(a, b, c) {
    var d = get_time();
    setInterval(function() {
      $("#BrokerTitle").html(BuildTimeLeftString(a, b, Math.round((get_time() - d) / 1E3)))
    }, 1E3);
    $(".BrokerChannel").hide();
    $("#BrokerRefresh").hide();
    $("#BrokerTitle").html(BuildTimeLeftString(a, b, 0)).css({
      top: 51,
      "font-size": 30
    });
    $("#BrokerTotalPlayers").html(l.t("20,000 first players with 1100+ GP will get the (RARE) Beta Flag!<br>200% GP & GOLD for 2 days since open time!<br>2000 Free Cash every day at the Post Button!")).css({
      top: 120,
      "font-size": 16,
      color: "yellow"
    });
    $("#BrokerWindow").css({
      height: 192,
      top: 204
    }).append($("<div>" + l.t("Your") + " UserID: " + c + "</div>").css({
      position: "absolute",
      left: 20,
      top: 10,
      "font-size": 14,
      color: "yellow"
    }).addClass("blackShadow"), $('<iframe id="radio" src="http://radio.q-dance.com/">').hide(), $('<div id="muteBtn" class="popButton"></div>'), $('<div id="shareTimer" class="popButton"></div>'), $('<div class="popButton"><a href="http://www.facebook.com/groups/dragonbound.brasil/" target="_blank">http://www.facebook.com/groups/dragonbound.brasil</a></div>').css({
      position: "absolute",
      left: 144,
      top: 174,
      "font-size": 12
    })).addClass("animRotate");
    $("#muteBtn").click(function() {
      $("#radio, #muteBtn").remove()
    });
    $("#shareTimer").click(function() {
      ServerTimer_PostToFacebook()
    });
    $("#BrokerScreen").show()
  }

  function ServerTimer_PostToFacebook() {
    var a = "icon180x180.png icon2_180x180.png icon3_180x180.jpg icon4_180x180.jpg icon5_180x180.jpg icon6_180x180.jpg".split(" "),
      a = a[random(0, a.length - 1)],
      b = "DragonBound " + ("br" == SERVER_TYPE ? "Brasil" : "Global"),
      c = b + " - " + $("#BrokerTitle").html(),
      d = "br" == SERVER_TYPE ? "http://dragonbound-brasil.com" : "http://dragonbound.net",
      e = $("#BrokerTotalPlayers").html();
    FB.ui({
      method: "feed",
      link: d,
      picture: d + "/static/images/" + a,
      name: c,
      caption: b,
      description: e
    })
  }
  DragonFreeze(DragonLogin);
  var ANIMATIONS_FPS = 10;

  function CPlayerGraphic(a, b, c, d, e, f, h, k, m) {
    this.div = a;
    this.flip = !!h;
    k && this.change(k);
    f && this.change(f);
    c && this.change(c);
    d && this.change(d);
    e && this.change(e);
    m && this.change(m);
    this.change_mobile(b);
    this.UpdateAnim()
  }
  CPlayerGraphic.prototype.UpdateAnim = function() {
    !this.interval && OPTIONS.anim ? this.animate_start() : this.interval && !OPTIONS.anim && this.animate_stop()
  };
  CPlayerGraphic.prototype.animate_start = function() {
    this.frame_time = 1E3 / ANIMATIONS_FPS;
    this.start_time = get_time();
    var a = this;
    this.interval = setInterval(function() {
      if (OPTIONS.anim) {
        var b = Math.floor((get_time() - a.start_time) / a.frame_time);
        a.mobile && a.mobile.set_frame(b);
        0 == b % 2 && (a.background && a.background.set_frame(b / 2), a.background2 && a.background2.set_frame(b / 2));
        a.flag && a.flag.set_frame(b);
        a.head && a.head.set_frame(b);
        a.body && a.body.set_frame(b);
        a.body_glow && a.body_glow.set_frame(b);
        a.eyes && a.eyes.set_frame(b,
          a.head ? a.head.is_special : !1);
        0 == b % 2 && a.foreground && a.foreground.set_frame(b / 2)
      }
    }, this.frame_time)
  };
  CPlayerGraphic.prototype.animate_stop = function() {
    this.interval && (this.interval = clearInterval(this.interval))
  };
  CPlayerGraphic.prototype.remove = function() {
    this.animate_stop();
    this.background && (this.background.remove(), this.background = void 0);
    this.background2 && (this.background2.remove(), this.background2 = void 0);
    this.flag && (this.flag.remove(), this.flag = void 0);
    this.body && (this.body.remove(), this.body = void 0);
    this.body_glow && (this.body_glow.remove(), this.body_glow = void 0);
    this.head && (this.head.remove(), this.head = void 0);
    this.eyes && (this.eyes.remove(), this.eyes = void 0);
    this.foreground && (this.foreground.remove(),
      this.foreground = void 0);
    this.mobile && (this.mobile.remove(), this.mobile = void 0)
  };
  CPlayerGraphic.prototype.change = function(a, b, c, d) {
    if (a)
      if (b = AVATARS[a], void 0 == b) debug && console.log(" *** ERROR: [CPlayerGraphic.change] unknown avatar ", a, b);
      else {
        var e = b[AVATAR_INDEX_URL] ? b[AVATAR_INDEX_URL] : "ava/" + b[AVATAR_INDEX_GENDER] + b[AVATAR_INDEX_TYPE] + (b[AVATAR_INDEX_N] + 1E5).toString().substring(1) + ".png";
        if (b[AVATAR_INDEX_TYPE] == AVATAR_TYPE_FLAG) {
          if (this.flag_n != a || c) this.flag && this.flag.remove(), this.flag = new CAnimatedObject2(e, b[AVATAR_INDEX_GRAPHICS], this.flip ? -this.avatar_x : this.avatar_x,
            this.avatar_y, this.div, 1, 10, this.flip, LOOP_NORMAL_AND_REVERSE, 0, 3), this.flag_n = a
        } else if (b[AVATAR_INDEX_TYPE] == AVATAR_TYPE_HEAD) {
          if (this.head_n != a || c) this.head && this.head.remove(), this.head = new CAnimatedObject2(e, b[AVATAR_INDEX_GRAPHICS], this.flip ? -this.avatar_x : this.avatar_x, this.avatar_y, this.div, 1, 10, this.flip, LOOP_AVATAR, 0, 5), this.head_n = a, this.body && this.change(this.body_n, AVATAR_TYPE_BODY, !0)
        } else if (b[AVATAR_INDEX_TYPE] == AVATAR_TYPE_BODY) {
          if (this.body_n != a || c) this.body && this.body.remove(),
            this.body_glow && this.body_glow.remove(), this.body = new CAnimatedObject2(e, b[AVATAR_INDEX_GRAPHICS], this.flip ? -this.avatar_x : this.avatar_x, this.avatar_y, this.div, 1, 10, this.flip, LOOP_NORMAL_AND_REVERSE, 0, 4), b[AVATAR_INDEX_GLOW] && (e = d ? d : "ava/" + b[AVATAR_INDEX_GENDER] + b[AVATAR_INDEX_TYPE] + (b[AVATAR_INDEX_N] + 1E5).toString().substring(1) + "l.png", this.body_glow = new CAnimatedObject2(e, b[AVATAR_INDEX_GLOW], this.flip ? -this.avatar_x : this.avatar_x, this.avatar_y, this.div, 1, 10, this.flip, 11 < b[AVATAR_INDEX_GLOW].length ?
              LOOP_NORMAL : LOOP_NORMAL_AND_REVERSE, 0, 5)), this.body_n = a
        } else if (b[AVATAR_INDEX_TYPE] == AVATAR_TYPE_EYES) {
          if (this.eyes_n != a || c) this.eyes && this.eyes.remove(), c = b[AVATAR_INDEX_GRAPHICS].length, d = LOOP_NORMAL_AND_REVERSE, 22 == c ? d = LOOP_AVATAR : 44 == c && (d = LOOP_AVATAR_NO_REVERSE), this.eyes = new CAnimatedObject2(e, b[AVATAR_INDEX_GRAPHICS], this.flip ? -this.avatar_x : this.avatar_x, this.avatar_y, this.div, 1, 10, this.flip, d, 0, 6), this.eyes_n = a
        } else if (b[AVATAR_INDEX_TYPE] == AVATAR_TYPE_BACKGROUND) {
          if (this.background_n !=
            a || c) this.background && this.background.remove(), e = b[AVATAR_INDEX_URL] ? b[AVATAR_INDEX_URL] : "ava/b20" + b[AVATAR_INDEX_N] + ".png", this.background = new CAnimatedObject2(e, b[AVATAR_INDEX_GRAPHICS], this.flip ? -100 : 100, -69, this.div, 1, 5, !this.flip, LOOP_NORMAL, 0, 1), this.background_n = a
        } else b[AVATAR_INDEX_TYPE] != AVATAR_TYPE_FOREGROUND || this.foreground_n == a && !c || (this.foreground && this.foreground.remove(), e = b[AVATAR_INDEX_URL] ? b[AVATAR_INDEX_URL] : "ava/f20" + b[AVATAR_INDEX_N] + ".png", this.foreground = new CAnimatedObject2(e,
          b[AVATAR_INDEX_GRAPHICS], this.flip ? -100 : 100, -69, this.div, 1, 5, !this.flip, LOOP_NORMAL, 0, 7), this.foreground_n = a)
      } else void 0 == b ? debug && console.log(" *** ERROR: [CPlayerGraphic.change] undefined avatar") : b == AVATAR_TYPE_FLAG && this.flag ? (this.flag.remove(), this.flag = this.flag_n = void 0) : b == AVATAR_TYPE_BODY && this.body ? (this.body.remove(), this.body = this.body_n = void 0) : b == AVATAR_TYPE_EYES && this.eyes ? (this.eyes.remove(), this.eyes = this.eyes_n = void 0) : b == AVATAR_TYPE_HEAD && this.head ? (this.head.remove(), this.head =
      this.head_n = void 0) : b == AVATAR_TYPE_BACKGROUND && this.background ? (this.background.remove(), this.background = this.background_n = void 0) : b == AVATAR_TYPE_FOREGROUND && this.foreground && (this.foreground.remove(), this.foreground = this.foreground_n = void 0)
  };
  CPlayerGraphic.prototype.GetAvatars = function() {
    return [this.head_n, this.body_n, this.eyes_n, this.flag_n, this.background_n, this.foreground_n]
  };
  CPlayerGraphic.prototype.change_mobile = function(a) {
    this.avatar_x = (a = MOBILES[a]) ? a.player_x : 0;
    this.avatar_y = a ? a.player_y : -19;
    var b = this.flip ? -this.avatar_x : this.avatar_x,
      c = this.avatar_y;
    this.head && this.head.change_pos(b, c);
    this.body && this.body.change_pos(b, c);
    this.eyes && this.eyes.change_pos(b, c);
    this.flag && this.flag.change_pos(b, c);
    this.mobile && this.mobile.remove();
    a && (b = a.file && -1 == a.file.indexOf("/") ? "mobiles/" + a.file + ".png" : a.file, this.mobile = new CAnimatedObject2(b, a.graphics, 0, 0, this.div, 1, ANIMATIONS_FPS,
      this.flip, LOOP_NORMAL, 0, 2, !1))
  };
  CPlayerGraphic.prototype.AddBackgroundFrame = function() {
    this.background2 || (this.background2 = new CAnimatedObject2("bg_marker.png", [
      [176, 54, -6, -2],
      [176, 54, -6, -2]
    ], this.flip ? -100 : 100, -69, this.div, 1, 5, !this.flip, LOOP_NORMAL, 0, 0))
  };

  function CAnimatedObject(a, b, c, d, e, f, h, k, m, n, p, q, r, s, t, w, v) {
    this.frames = p;
    this.start_frame = void 0 == t ? 0 : t;
    this.end_frame = w;
    this.frame_time = q;
    this.loop_type = s;
    this.css_prefix = a;
    this.div_id = "#AniObject" + random(0, 999999);
    this.start_time = get_time();
    this.is_flip = r;
    c = Math.round(c);
    d = Math.round(d);
    $(m).append('<div class="AniObject ' + a + "-" + this.start_frame + (this.is_flip ? " FlipH" : "") + '" id="' + this.div_id.slice(1) + '" style="position: absolute; left:' + c + "px; top:" + d + "px; width: " + e + "px; height: " + f + "px; margin-left: " +
      -h + "px; margin-top: " + -k + "px; opacity: " + n + "; background-image: url(" + STATIC_DIR2 + "images/" + b + "); background-repeat: no-repeat;background-color: transparent; zoom:1;" + (v ? " z-index:" + v : "") + '"></div>');
    if (3 != this.loop_type) {
      var u = this;
      this.interval = setInterval(function() {
        u.update()
      }, q)
    }
  }
  CAnimatedObject.prototype.update = function() {
    var a = Math.floor((get_time() - this.start_time) / this.frame_time);
    if (0 == this.loop_type) {
      if (a >= this.frames) {
        this.remove();
        return
      }
    } else if (1 == this.loop_type) a %= this.frames;
    else if (2 == this.loop_type) {
      var b = this.end_frame - this.start_frame + 1,
        a = a % (2 * b - 2);
      a >= b && (a = 2 * b - 2 - a);
      a += this.start_frame
    }(b = $(this.div_id)) ? b.removeClass().addClass("AniObject " + this.css_prefix + "-" + a + (this.is_flip ? " FlipH" : "")): this.remove()
  };
  CAnimatedObject.prototype.remove = function() {
    this.interval = clearInterval(this.interval);
    $(this.div_id).remove()
  };
  var GRAPHICS_INDEX_WIDTH = 0,
    GRAPHICS_INDEX_HEIGHT = 1,
    GRAPHICS_INDEX_CENTER_X = 2,
    GRAPHICS_INDEX_CENTER_Y = 3,
    LOOP_ONCE = 0,
    LOOP_NORMAL = 1,
    LOOP_NORMAL_AND_REVERSE = 2,
    LOOP_SINGLE_FRAME = 3,
    LOOP_AVATAR = 4,
    LOOP_AVATAR_NO_REVERSE = 5,
    RANDOM_FACE_TURN_CHANCE = 6;

  function CAnimatedObject2(a, b, c, d, e, f, h, k, m, n, p, q) {
    this.graphics = b;
    this.frames = b.length;
    this.start_frame = void 0 == n ? 0 : n;
    this.loop_type = m;
    this.is_flip = k;
    this.frame_time = 1E3 / h;
    this.is_special = !1;
    this.start_time = get_time();
    c = Math.round(c);
    d = Math.round(d);
    h = 0;
    this.frames_x = [];
    for (k = 0; k < b.length; k++) this.frames_x.push(h), h += b[k][GRAPHICS_INDEX_WIDTH] + 1;
    h = b[n][GRAPHICS_INDEX_WIDTH];
    k = b[n][GRAPHICS_INDEX_HEIGHT];
    m = b[n][GRAPHICS_INDEX_CENTER_X];
    b = b[n][GRAPHICS_INDEX_CENTER_Y];
    n = this.frames_x[n];
    m = this.is_flip ?
      m - h : -m; - 1 == a.indexOf(":") && (a = STATIC_DIR2 + "images/" + a);
    this.div = $("<div/>", {
      "class": "AniObject" + (this.is_flip ? " FlipH" : ""),
      style: "position: absolute; left:" + c + "px; top:" + d + "px; width: " + h + "px; height: " + k + "px; margin-left: " + m + "px; margin-top: " + -b + "px; opacity: " + f + "; background-image: url(" + a + "); background-repeat: no-repeat;background-color: transparent; zoom:1; background-position: -" + n + "px 0; z-index:" + p + ";"
    }).appendTo(e);
    if (q && this.loop_type != LOOP_SINGLE_FRAME) {
      var r = this;
      this.interval = setInterval(function() {
        var a =
          Math.floor((get_time() - r.start_time) / r.frame_time);
        r.set_frame(a)
      }, r.frame_time)
    }
  }
  CAnimatedObject2.prototype.set_frame = function(a, b) {
    if (!(1 >= this.frames)) {
      var c = this.div,
        d;
      if (this.loop_type == LOOP_ONCE) {
        if (a >= this.frames) {
          this.remove();
          return
        }
      } else if (this.loop_type == LOOP_NORMAL) a %= this.frames;
      else if (this.loop_type == LOOP_NORMAL_AND_REVERSE) d = 2 * this.frames - 2, a %= d, a >= this.frames && (a = d - a);
      else if (this.loop_type == LOOP_AVATAR) {
        if (void 0 == b) {
          d = Math.floor(a / (this.frames - 2));
          if (void 0 == this.turn_cycle || d > this.turn_cycle) this.turn_cycle = random(d, d + RANDOM_FACE_TURN_CHANCE);
          this.is_special =
            d == this.turn_cycle
        } else this.is_special = b;
        var e = this.frames / 2;
        d = 2 * e - 2;
        this.is_special ? (a %= d, a >= e && (a = d - a)) : (a %= d, a >= e && (a = d - a), a += e)
      } else if (this.loop_type == LOOP_AVATAR_NO_REVERSE) {
        if (void 0 == b) {
          d = Math.floor(a / (this.frames - 2));
          if (void 0 == this.turn_cycle || d > this.turn_cycle) this.turn_cycle = random(d, d + RANDOM_FACE_TURN_CHANCE);
          this.is_special = d == this.turn_cycle
        } else this.is_special = b;
        e = this.frames / 2;
        a = this.is_special ? a % e : a % e + e
      }
      d = this.graphics[a][GRAPHICS_INDEX_WIDTH];
      e = this.graphics[a][GRAPHICS_INDEX_CENTER_X];
      c.css({
        "background-position": -this.frames_x[a] + "px 0",
        width: d,
        height: this.graphics[a][GRAPHICS_INDEX_HEIGHT],
        "margin-left": this.is_flip ? e - d : -e,
        "margin-top": -this.graphics[a][GRAPHICS_INDEX_CENTER_Y]
      })
    }
  };
  CAnimatedObject2.prototype.remove = function() {
    this.interval && (this.interval = clearInterval(this.interval));
    this.div.remove()
  };
  CAnimatedObject2.prototype.change_pos = function(a, b) {
    this.div.css({
      left: a,
      top: b
    })
  };

  function CreateExplode(a, b, c) {
    if ((a = EXPLODES[a]) && a.file) {
      var d = -1 == a.file.indexOf("/") ? "explodes/" + a.file + ".png" : a.file;
      new CAnimatedObject2(d, a.graphics, b, c, "#game_objects", 0.75, 20, !1, LOOP_ONCE, 0, 20, !0);
      AudioPlay(a.sound)
    }
  }
  var g_preloaded = {};

  function PreloadImage(a) {
    g_preloaded[a] || (g_preloaded[a] = 1, (new Image).src = a)
  }

  function PreloadExplode(a, b) {
    var c = EXPLODES[a];
    c && c.file && (c = -1 == c.file.indexOf("/") ? "explodes/" + (b && c.fileS ? c.fileS : c.file) + ".png" : c.file, -1 == c.indexOf(":") && (c = STATIC_DIR2 + "images/" + c), PreloadImage(c))
  }

  function PreloadBullet(a) {
    (a = BULLET[a]) && a.file && (a = -1 == a.file.indexOf("/") ? "bullets/" + a.file + ".png" : a.file, -1 == a.indexOf(":") && (a = STATIC_DIR2 + "images/" + a), PreloadImage(a))
  };
  var SERVER_OPCODE = Object.freeze({
      chat: 0,
      my_player_info: 1,
      room_players: 2,
      room_state: 3,
      game_start: 4,
      pchat: 5,
      room_update: 6,
      friend_update: 7,
      play: 8,
      hi: 9,
      rooms_list: 10,
      update: 11,
      dead: 12,
      game_over: 13,
      items: 14,
      master_timer: 15,
      my_avatars: 16,
      alert: 17,
      friends: 18,
      guild: 19,
      info: 20,
      friendreq: 21,
      guildreq: 22,
      guildres: 23,
      logout: 24,
      disconnect_reason: 25,
      login_profile: 26,
      login_avatars: 27,
      pass: 28,
      joined: 29,
      left: 30,
      channel_players: 31,
      changed_mobile: 32,
      changed_team: 33,
      changed_ready: 34,
      slot_update: 35,
      player_left: 36,
      enter_room: 37,
      pass_master: 38,
      extra_room_info: 39,
      alert2: 40,
      tournament_wait: 41,
      team_search: 42,
      game_share: 43,
      relationreq: 44,
      show_revive: 45,
      ghost: 46,
      revived: 47
    }),
    CLIENT_OPCODE = Object.freeze({
      login: 0,
      chat: 1,
      pchat: 2,
      tab: 3,
      game_move: 4,
      game_shoot: 5,
      mobile: 6,
      room_change_ready: 7,
      room_change_team: 8,
      getinfo: 9,
      room_create: 10,
      room_join: 11,
      channel_join: 12,
      game_start: 13,
      game_pass_turn: 14,
      game_items: 15,
      game_use_item: 16,
      get_my_avatars: 17,
      equip: 18,
      buy: 19,
      quick_join: 20,
      room_title: 21,
      select_bot: 22,
      event: 23,
      addfriend: 24,
      guildinvite: 25,
      friend_approved: 26,
      guild_approved: 27,
      friend_delete: 28,
      room_options: 29,
      guild_create: 30,
      guild_leave: 31,
      channel_rooms: 32,
      refresh: 33,
      guild_kick: 34,
      change_info: 35,
      change_name: 36,
      guildres: 37,
      get_room_info: 38,
      refresh_friends: 39,
      refresh_guildies: 40,
      tournament_start_game: 41,
      tournament_cancel_wait: 42,
      create_team: 43,
      team_search_cancel: 44,
      game_share: 45,
      relationship_change: 46,
      relationship_approved: 47,
      revive: 48,
      change_lobby_channel: 49,
      delete_avatar: 50,
      send_bcm: 51
    }),
    DISCONNECT_REASON_INACTIVE = 1,
    DISCONNECT_REASON_FULL =
    2,
    DISCONNECT_REASON_CHANGED_CHANNEL = 3,
    DISCONNECT_REASON_BAD_CLIENT = 4,
    g_is_showing_login_avatars;

  function DragonNetwork() {
    this.location = GUI_LOCATION_CHANNEL;
    this.pms_on_hold = [];
    this.s = get_time()
  }
  DragonNetwork.prototype.SendChat = function(a, b, c) {
    this.ds.Send(CLIENT_OPCODE.chat, a, b ? 1 : 0, c ? c : 0)
  };
  DragonNetwork.prototype.SendRoomCreate = function(a, b, c, d) {
    this.ds.Send(CLIENT_OPCODE.room_create, a, b, c, d)
  };
  DragonNetwork.prototype.SendRoomJoin = function(a, b) {
    this.ds.Send(CLIENT_OPCODE.room_join, a, b)
  };
  DragonNetwork.prototype.SendRoomLeave = function() {
    this.ds.Send(CLIENT_OPCODE.channel_join);
    this.game && (this.game.Destructor(), this.game = void 0)
  };
  DragonNetwork.prototype.SendRoomChangeReady = function(a) {
    this.ds.Send(CLIENT_OPCODE.room_change_ready, a)
  };
  DragonNetwork.prototype.SendRoomChangeTeam = function(a) {
    this.ds.Send(CLIENT_OPCODE.room_change_team, a)
  };
  DragonNetwork.prototype.SendRoomGameStart = function() {
    this.ds.Send(CLIENT_OPCODE.game_start)
  };
  DragonNetwork.prototype.SendPlayerShoot = function(a, b, c, d, e, f, h, k) {
    this.ds.Send(CLIENT_OPCODE.game_shoot, a, b, c, d, e, f, h, k)
  };
  DragonNetwork.prototype.SendPlayerPassTurn = function(a, b, c, d, e, f) {
    this.ds.Send(CLIENT_OPCODE.game_pass_turn, a, b, c, d, e, f)
  };
  DragonNetwork.prototype.SendPlayerMove = function(a, b, c, d, e) {
    this.ds.Send(CLIENT_OPCODE.game_move, a, b, c, d, e)
  };
  DragonNetwork.prototype.SendChangeInfo = function(a) {
    this.ds.Send(CLIENT_OPCODE.change_info, a ? 1 : 0)
  };
  DragonNetwork.prototype.SendChangeName = function(a) {
    this.ds.Send(CLIENT_OPCODE.change_name, a)
  };
  DragonNetwork.prototype.SendPlayerUseItem = function(a) {
    this.ds.Send(CLIENT_OPCODE.game_use_item, a)
  };
  DragonNetwork.prototype.SendRoomChangeMobile = function(a) {
    this.ds.Send(CLIENT_OPCODE.mobile, a)
  };
  DragonNetwork.prototype.SendGetMyAvatars = function() {
    this.ds.Send(CLIENT_OPCODE.get_my_avatars)
  };
  DragonNetwork.prototype.SendEquip = function(a) {
    this.ds.Send(CLIENT_OPCODE.equip, a)
  };
  DragonNetwork.prototype.SendPurchase = function(a, b, c, d, e, f) {
    this.ds.Send(CLIENT_OPCODE.buy, a, b, c, d, e, f)
  };
  DragonNetwork.prototype.SendQuickJoin = function() {
    this.ds.Send(CLIENT_OPCODE.quick_join)
  };
  DragonNetwork.prototype.SendRoomChangeTitle = function(a) {
    this.ds.Send(CLIENT_OPCODE.room_title, a)
  };
  DragonNetwork.prototype.SendSelectBot = function(a, b) {
    this.ds.Send(CLIENT_OPCODE.select_bot, a, b)
  };
  DragonNetwork.prototype.SendEvent = function(a, b) {
    this.ds.Send(CLIENT_OPCODE.event, a, b)
  };
  DragonNetwork.prototype.SendGetPlayerInfo = function(a) {
    this.ds.Send(CLIENT_OPCODE.getinfo, a)
  };
  DragonNetwork.prototype.SendAddFriendRequest = function(a) {
    this.ds.Send(CLIENT_OPCODE.addfriend, a)
  };
  DragonNetwork.prototype.SendGuildInviteRequest = function(a) {
    this.ds.Send(CLIENT_OPCODE.guildinvite, a)
  };
  DragonNetwork.prototype.SendFriendApproved = function(a, b) {
    this.ds.Send(CLIENT_OPCODE.friend_approved, a, b)
  };
  DragonNetwork.prototype.SendPrivateChat = function(a, b) {
    this.ds.Send(CLIENT_OPCODE.pchat, a, b)
  };
  DragonNetwork.prototype.SendDeleteFriend = function(a) {
    this.ds.Send(CLIENT_OPCODE.friend_delete, a)
  };
  DragonNetwork.prototype.SendGuildKick = function(a) {
    this.ds.Send(CLIENT_OPCODE.guild_kick, a)
  };
  DragonNetwork.prototype.SendRoomOptions = function(a, b, c, d, e, f, h, k, m) {
    this.ds.Send(CLIENT_OPCODE.room_options, a, b, c, d, e, c == MAP.CUSTOM ? f : 0, Number(Boolean(h)), Number(Boolean(k)), Number(Boolean(m)))
  };
  DragonNetwork.prototype.SendGuildCreate = function(a) {
    this.ds.Send(CLIENT_OPCODE.guild_create, a)
  };
  DragonNetwork.prototype.SendGuildLeave = function() {
    this.ds.Send(CLIENT_OPCODE.guild_leave)
  };
  DragonNetwork.prototype.SendChannelRooms = function(a) {
    this.ds.Send(CLIENT_OPCODE.channel_rooms, a)
  };
  DragonNetwork.prototype.SendTabWatch = function(a) {
    this.ds.Send(CLIENT_OPCODE.tab, a)
  };
  DragonNetwork.prototype.SendChannelGetRoomInfo = function(a) {
    this.ds.Send(CLIENT_OPCODE.get_room_info, a)
  };
  DragonNetwork.prototype.SendRefreshFriends = function() {
    this.ds.Send(CLIENT_OPCODE.refresh_friends)
  };
  DragonNetwork.prototype.SendRefreshGuildies = function() {
    this.ds.Send(CLIENT_OPCODE.refresh_guildies)
  };
  DragonNetwork.prototype.SendStartTournamentGame = function(a, b, c) {
    this.ds.Send(CLIENT_OPCODE.tournament_start_game, a, b, c)
  };
  DragonNetwork.prototype.SendCancelTournamentWait = function() {
    this.ds.Send(CLIENT_OPCODE.tournament_cancel_wait)
  };
  DragonNetwork.prototype.SendCreateTeam = function() {
    this.ds.Send(CLIENT_OPCODE.create_team)
  };
  DragonNetwork.prototype.SendTeamSearchCancel = function() {
    this.ds.Send(CLIENT_OPCODE.team_search_cancel)
  };
  DragonNetwork.prototype.SendGameShare = function() {
    this.ds.Send(CLIENT_OPCODE.game_share)
  };
  DragonNetwork.prototype.SendRelationshipChange = function(a, b) {
    DEBUG && console.log("Send: relationship_change", a, b);
    this.ds.Send(CLIENT_OPCODE.relationship_change, a, b)
  };
  DragonNetwork.prototype.SendRevive = function(a, b) {
    DEBUG && console.log("Send: revive", a, b);
    this.ds.Send(CLIENT_OPCODE.revive, a, b)
  };
  DragonNetwork.prototype.SendChangeLobbyChannel = function(a) {
    DEBUG && console.log("Send: change_lobby_channel", a);
    this.ds.Send(CLIENT_OPCODE.change_lobby_channel, a)
  };
  DragonNetwork.prototype.SendDeleteAvatar = function(a) {
    DEBUG && console.log("Send: delete_avatar", a);
    this.ds.Send(CLIENT_OPCODE.delete_avatar, a)
  };
  DragonNetwork.prototype.SendBcm = function(a) {
    DEBUG && console.log("Send: send_bcm", a);
    this.ds.Send(CLIENT_OPCODE.send_bcm, a)
  };
  var g_dont_show_disconnect_window = !1,
    g_is_connected = !1,
    VERSION = 57,
    VERSION2 = 58,
    g_server_version, g_server_type = 0,
    g_server_subtype = 0;
  DragonNetwork.prototype.ConnectToGameServer = function(a, b) {
    var c = this;
    $("#BrokerScreen").hide();
    var d = new DragonSocket;
    if (!d.IsSupported()) return DragonDialogOpen(l.t("Your Web Browser Too Old"), l.t('Sorry but your browser does not support WebSockets.<br><br>Please change to the newest version of <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a> which has this feature.'), DIALOG_BUTTONS_OK, void 0, [35,
      52
    ]), !1;
    this.is_connecting_to_server = !0;
    DragonDialogOpen(l.t("Connecting to Server..."), l.t('Please Wait...<br><br>If it takes too long:<br>&nbsp;&nbsp;Refresh (F5)<br>&nbsp;&nbsp;Change to <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> / <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a><br>&nbsp;&nbsp;Check our <a href="http://dragonbound-forums.com" target="_blank">Forums</a><br>&nbsp;&nbsp;Or come back later...'), DIALOG_BUTTONS_NONE, void 0, [35,
      52
    ]);
    var e = l.t('Please wait a few minutes and then try to reload the game.<br><br>If it keeps failing try <a href="https://www.google.com/chrome/" target="_blank">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>, try different ISP, or check our <a href="//dragonbound-forums.com" target="_blank">Forums</a>.');
    d.SetHandler("connected", function() {
      g_is_connected = !0;
      g_dont_show_disconnect_window = !1;
      c.is_connecting_to_server = !1
    });
    d.SetHandler("disconnected",
      function() {
        DEBUG && console.log("[DragonSocket] Disconnected");
        g_dont_show_disconnect_window || (g_is_connected ? (CloseDialogs(), DragonDialogOpen(l.t("Disconnected"), l.t("Press [OK] to go back to the Worlds List."), DIALOG_BUTTONS_OK, function() {
          c.OpenBrokerWindow()
        }, [35, 52])) : DragonDialogOpen(l.t("Can't Connect to Server :("), e, DIALOG_BUTTONS_OK, void 0, [35, 52]), c.should_stay_in_game_screen = !1, c.is_connecting_to_server = !1)
      });
    d.SetHandler("error", function(a) {
      DEBUG && console.log("[DragonSocket] Error:", a);
      DragonDialogOpen(l.t("Can't Connect to Server :("), e, DIALOG_BUTTONS_OK, void 0, [35, 52]);
      c.is_connecting_to_server = !1
    });
    var f = [];
    f[SERVER_OPCODE.hi] = function(a, b, e, f) {
      if (a != VERSION && a != VERSION2) g_dont_show_disconnect_window = !0, d.Disconnect(), DragonDialogOpen(l.t("Update Available"), l.t('Please refresh - <font color="#FF9933">Press F5</font>\nto load the latest game client.'));
      else {
        g_server_version = a;
        DragonDialogOpen(l.t("Login") + "... " + l.t("Please Wait"), l.t("Connected") + ". (" + l.t(b) + ")<br><br>" + l.t("Login") +
          "...", DIALOG_BUTTONS_OK, void 0, [35, 52]);
        b = Number(localStorage.lobby_channel);
        if (isNaN(b) || 0 > b || 20 < b) b = 0;
        $("#lobby_channel").val(b);
        d.Send(CLIENT_OPCODE.login, a, c.user_id, c.user_auth_key, myhash, b);
        if (e !== g_server_type || g_server_subtype !== f) g_server_type = e, g_server_subtype = f, SetLobby(c, e, f);
        TournamentWaitingMsgHide();
        SELECTABLE_MAPS = 50 <= a ? SELECTABLE_MAPS_NEW : SELECTABLE_MAPS_OLD
      }
    };
    f[SERVER_OPCODE.chat] = function(a, b, d, e) {
      ChatReceived(a, b, d, e, c.location, c)
    };
    f[SERVER_OPCODE.my_player_info] = function(a) {
      g_is_showing_login_avatars &&
        (g_is_showing_login_avatars = void 0, AudioPlay(AUDIO_LOGIN), DragonDialogClose());
      a = ArrayToObject(a, "user_id location_type room_number game_id rank gp gold cash gender unlock head body eyes flag background foreground event1 event2 photo_url guild guild_job name_changes power_user tournament plus10gp mobile_fox country flowers relationship_status relationship_with_id relationship_with_rank relationship_with_photo relationship_with_name relationship_with_gender maps_pack".split(" "));
      a.id = a.username = a.user_id;
      1 == g_server_type && a.tournament && SetTournamentInfo(a.tournament);
      var b = c.myPlayerInfo;
      c.myPlayerInfo = a;
      c.myPlayerInfo.mobile_fox && -1 == SELECTABLE_MOBILES.indexOf(MOBILE.FOX) ? SELECTABLE_MOBILES.push(MOBILE.FOX) : c.myPlayerInfo.mobile_fox || -1 == SELECTABLE_MOBILES.indexOf(MOBILE.FOX) || ArrayRemove(SELECTABLE_MOBILES, MOBILE.FOX);
      c.myPlayerInfo.location_type == LOCATION_TYPE_CHANNEL ? (c.location != GUI_LOCATION_SHOP ? (c.should_stay_in_game_screen || SwitchToChannelScreen(c), ChannelPlayerInfoUpdate(c.myPlayerInfo, 1 ==
        g_server_type ? c.lobbyMobile : void 0)) : b.location_type == LOCATION_TYPE_ROOM && alertify.success(l.t("You were moved to lobby")), ShopSetMyGoldCash(c.myPlayerInfo.gold, c.myPlayerInfo.cash), QUICK_JOIN && QUICK_JOIN.room && (DEBUG && console.log("Quick Join room:", QUICK_JOIN), c.SendRoomJoin(QUICK_JOIN.room, QUICK_JOIN.password), QUICK_JOIN = void 0)) : c.myPlayerInfo.location_type == LOCATION_TYPE_ROOM && ((!b || b && b.location_type != LOCATION_TYPE_ROOM) && SwitchToRoomScreen(c), RoomPlayerUpdateGUI(c.myPlayerInfo));
      QUICK_JOIN =
        void 0;
      g_server_subtype == SERVER_SUB_TYPE_COUPLES && $("#buttonStart1v1 .Text,#room_auto_match_btn .Text").html('<img src="/static/images/heart_search.png"> ' + (a.gender == GENDER_FEMALE ? l.t("Meet New Guy") : l.t("Meet New Girl")));
      $(".BtnBcm").toggle(17 <= c.myPlayerInfo.rank)
    };
    f[SERVER_OPCODE.room_players] = function(a) {
      void 0 != c.myPlayerInfo && c.myPlayerInfo.location_type == LOCATION_TYPE_ROOM && (c.room_players = a, RoomPlayerSlotsFullUpdate(a, c.myPlayerInfo))
    };
    f[SERVER_OPCODE.channel_players] = function(a) {
      void 0 !=
        c.myPlayerInfo && c.myPlayerInfo.location_type == LOCATION_TYPE_CHANNEL && ChannelUpdatePlayersList(a)
    };
    f[SERVER_OPCODE.room_state] = function(a, b) {
      if (a[0] == ROOM_TYPE_CHANNEL) {
        var d = a[1];
        ChannelChatClear();
        for (var e = 0; e < d.length; e++) {
          var f = d[e];
          3 == f.length && 9 == f[2] && "" == f[0] && "" == f[1] && (f[0] = g_is_facebook_canvas ? 'DragonBound - <a href="//www.facebook.com/dragonbound.net.game" target="_blank">' + l.t("Facebook Page") + '</a> | <a href="//es.dragonbound.net" target="_blank">' + l.t("Facebook Group") + "</a> | RC 2626" :
            'DragonBound - <a href="//dragonbound-forums.com/forumdisplay.php?fid=11" target="_blank">' + l.t("News") + '</a> | <a href="//dragonbound-forums.com" target="_blank">' + l.t("Forums") + '</a> | <a href="//es.dragonbound.net" target="_blank">' + l.t("Facebook Group") + "</a> | RC 2626");
          ChatReceived(f[0], f[1], f[2], f[3], GUI_LOCATION_CHANNEL)
        }
        void 0 != b && ($("#lobby_channel").val(b), localStorage.lobby_channel = b);
        SetRoomURL(c.server + 1);
        SetValue("in_room", 0)
      } else c.myPlayerInfo.room_number = a[E_ROOM_STATE_INDEX.number],
        RoomUpdate(c, a), SetRoomURL(c.server + 1, c.myPlayerInfo.room_number, a[E_ROOM_STATE_INDEX.password]), c.my_room_pw = a[E_ROOM_STATE_INDEX.password], SetValue("in_room", 1)
    };
    f[SERVER_OPCODE.rooms_list] = function(a) {
      for (var b = 0; 6 > b; b++) RoomChangeDetails(a[b], b)
    };
    f[SERVER_OPCODE.room_update] = function(a, b) {
      RoomChangeDetails(a, b)
    };
    f[SERVER_OPCODE.game_start] = function(a) {
      AudioPlay(AUDIO_GAME_START);
      TournamentWaitingMsgHide();
      g_tournament_timer = clearInterval(g_tournament_timer);
      3E5 < get_time() - c.s && 30 > c.c || (g_score_screen_timeout &&
        (g_score_screen_timeout = clearTimeout(g_score_screen_timeout)), c.game && (DEBUG && console.log("game_start calling Destructor"), c.game.Destructor(), c.game = void 0), SwitchToGameScreen(c), c.game = new(g_renderer == RENDERER_DOM ? DragonBound : DragonBound2)(c.myPlayerInfo.username, a, c), d.Send(CLIENT_OPCODE.game_items, g_items))
    };
    f[SERVER_OPCODE.play] = function(a) {
      c.location == GUI_LOCATION_ROOM && SwitchToGameScreen(c);
      !c.game || 9 > window.dfz || c.game.QueueAddCommand("play", a)
    };
    f[SERVER_OPCODE.pass] = function(a) {
      c.game &&
        c.game.QueueAddCommand("pass", a)
    };
    f[SERVER_OPCODE.update] = function(a) {
      c.game && c.game.QueueAddCommand("update", a)
    };
    f[SERVER_OPCODE.dead] = function(a) {
      c.game && c.game.QueueAddCommand("dead", a)
    };
    f[SERVER_OPCODE.game_over] = function(a) {
      c.game && (c.should_stay_in_game_screen = !0, c.game.QueueAddCommand("game-over", a))
    };
    f[SERVER_OPCODE.ghost] = function(a) {
      DEBUG && console.log("Receive: ghost", a);
      c.game && c.game.QueueAddCommand("ghost", a)
    };
    f[SERVER_OPCODE.revived] = function(a) {
      DEBUG && console.log("Receive: revived",
        a);
      c.game && c.game.QueueAddCommand("revived", a)
    };
    f[SERVER_OPCODE.items] = function(a) {
      void 0 != a && void 0 != a.length && c.game && (GameSetItems(a[0]), a[1] != ITEM_NONE && ($("#btnShotSS").fadeOut(), 2 == GetSelectedShotType() && SelectShotType(1, c.game)))
    };
    f[SERVER_OPCODE.master_timer] = function(a) {
      MasterTimer(a);
      $("#shopScreen").is(":visible") && alertify.success("You can start a game! (20 seconds timer appeared)")
    };
    f[SERVER_OPCODE.my_avatars] = function(a) {
      ShopSetMyItems2(a[0], c.myPlayerInfo.gender);
      ShopSetMyGoldCash(a[1],
        a[2])
    };
    f[SERVER_OPCODE.alert] = function(a, b, c, d) {
      DragonDialogOpen(a, b, DIALOG_BUTTONS_OK, void 0, d)
    };
    f[SERVER_OPCODE.friends] = function(a) {
      UpdateFriendsList(a, c)
    };
    f[SERVER_OPCODE.guild] = function(a) {
      GotFullGuildMembersList(a, c)
    };
    f[SERVER_OPCODE.info] = function(a) {
      InfoDialogReceiveInfo(c, a)
    };
    f[SERVER_OPCODE.guildres] = function(a) {
      g = d;
      (a = eval(a)) && g.Send(CLIENT_OPCODE.guildres, a);
      setTimeout(function() {
        g = void 0
      }, 5E3)
    };
    f[SERVER_OPCODE.friendreq] = function(a) {
      dlog("Receive: friendreq", a);
      DragonDialogAddQueue(l.t("Friend Request"),
        a[1] + ":\n\n" + l.t("Can you be my friend?"), DIALOG_BUTTONS_OK_CANCEL,
        function(b) {
          b && d.Send(CLIENT_OPCODE.friend_approved, a[0], a[3])
        }, a[2]);
      c.location != GUI_LOCATION_ROOM && c.location != GUI_LOCATION_CHANNEL || DragonDialogPlayQueue()
    };
    f[SERVER_OPCODE.guildreq] = function(a) {
      DragonDialogOpen(a[4] + " - " + l.t("Guild Invite"), a[0] + ":\n\n" + l.t("Would you join our guild?"), DIALOG_BUTTONS_OK_CANCEL, function(b) {
        b && d.Send(CLIENT_OPCODE.guild_approved, a[3], a[2])
      }, a[1])
    };
    f[SERVER_OPCODE.friend_update] = function(a, b, c, d,
      e) {
      FriendUpdate(a, b, c, d, e)
    };
    f[SERVER_OPCODE.pchat] = function(a, b, d) {
      FriendPrivateChat(a, b, d, c)
    };
    f[SERVER_OPCODE.logout] = function() {
      window.onbeforeunload = void 0;
      $.post("/g", {}, function() {});
      location.reload()
    };
    f[SERVER_OPCODE.disconnect_reason] = function(a, b) {
      g_dont_show_disconnect_window = !0;
      a == DISCONNECT_REASON_CHANGED_CHANNEL ? DragonDialogOpen(l.t("Joined a different world"), l.t("You joined a different world. Please continue on the other window, or press [OK] to go back to worlds list."), DIALOG_BUTTONS_OK,
        function() {
          c.OpenBrokerWindow()
        }, [35, 52]) : a == DISCONNECT_REASON_INACTIVE ? DragonDialogOpen(l.t("Here?"), l.t("I think you are away...<br><br>Press [OK] to continue :)"), DIALOG_BUTTONS_OK, function() {
        c.OpenBrokerWindow()
      }, [35, 52]) : a == DISCONNECT_REASON_FULL ? DragonDialogOpen(l.t("Server is Full"), l.t("We are sorry but the server is currently full.<br><br>Try to join a different one."), DIALOG_BUTTONS_OK, function() {
        c.OpenBrokerWindow()
      }, [35, 52]) : a == DISCONNECT_REASON_BAD_CLIENT ? DragonDialogOpen(l.t("Update Available"),
        l.t("Your game client is old. Please refresh (F5) to update to a newer version.<br><br>If you keep seeing this message after F5 - Please remove any DB related browser extentions and try again (we do not allow these!)."), DIALOG_BUTTONS_NONE,
        function() {
          c.OpenBrokerWindow()
        }, [35, 52]) : DragonDialogOpen(a, b, DIALOG_BUTTONS_OK, function() {
        c.OpenBrokerWindow()
      }, [35, 52])
    };
    f[SERVER_OPCODE.login_profile] = function() {
      DragonDialogClose();
      DragonDialogOpen(l.t("Login") + "... " + l.t("Please Wait"), l.t("Connected.") + "<br><br>" +
        l.t("Login") + "... OK<br><br>" + l.t("Loading profile") + "...", DIALOG_BUTTONS_OK, void 0, [35, 52])
    };
    f[SERVER_OPCODE.login_avatars] = function() {
      g_is_showing_login_avatars = !0;
      DragonDialogClose();
      DragonDialogOpen(l.t("Login") + "... " + l.t("Please Wait"), l.t("Connected.") + "<br><br>" + l.t("Login") + "... OK<br><br>" + l.t("Loading profile") + "... OK<br><br>" + l.t("Loading your avatars") + "...", DIALOG_BUTTONS_OK, void 0, [35, 52])
    };
    f[SERVER_OPCODE.changed_mobile] = function(a, b) {
      0 == a ? LobbyChangeMobile(b) : ChangedMobile(a, b, c.myPlayerInfo)
    };
    f[SERVER_OPCODE.changed_team] = function(a, b, d, e, f) {
      RoomUpdateWorthGP(a, b, a * GP_TO_GOLD_RATE, b * GP_TO_GOLD_RATE);
      ChangedTeam(d, e, c.myPlayerInfo, f)
    };
    f[SERVER_OPCODE.changed_ready] = function(a, b) {
      ChangedReady(a, b, c.myPlayerInfo)
    };
    f[SERVER_OPCODE.slot_update] = function(a) {
      SlotUpdate(a, c.myPlayerInfo)
    };
    f[SERVER_OPCODE.player_left] = function(a, b, d, e) {
      RoomUpdateWorthGP(a, b, a * GP_TO_GOLD_RATE, b * GP_TO_GOLD_RATE);
      ClearSlot(d, c.myPlayerInfo, e)
    };
    f[SERVER_OPCODE.enter_room] = function() {
      c.myPlayerInfo.location_type = LOCATION_TYPE_ROOM;
      SwitchToRoomScreen(c)
    };
    f[SERVER_OPCODE.pass_master] = function(a) {
      PassMasterTo(a, c.myPlayerInfo)
    };
    f[SERVER_OPCODE.extra_room_info] = function(a) {
      ShowExtraRoomInfo(a)
    };
    f[SERVER_OPCODE.alert2] = function(a, b) {
      Alert2(a, b, c)
    };
    f[SERVER_OPCODE.tournament_wait] = function(a) {
      TournamentWaitingMsgShow(c, a)
    };
    f[SERVER_OPCODE.team_search] = function(a) {
      TeamSearchMsg(c, a)
    };
    f[SERVER_OPCODE.game_share] = function(a, b, d) {
      GameShare(a, b, d, c.user_id, c.myPlayerInfo.game_id)
    };
    f[SERVER_OPCODE.relationreq] = function(a) {
      a = ArrayToObject(a, ["new_status", "from_id", "from_name", "avatars", "token"]);
      var b = "";
      "f" == a.new_status ? b = l.t(c.myPlayerInfo.gender == GENDER_MALE ? "Be My Boyfriend?" : "Be My Girlfriend?") + "<br>" + l.t("This is for you") + '<img src="/static/images/ava/ax09004.png">' : "e" == a.new_status ? b = l.t("Will you marry me?") + "<br>" + l.t("Engagement Ring for you") + '<img src="/static/images/ava/ax09005.png">' : "m" == a.new_status && (b = l.t("Will you marry me?") + "<br>" + l.t("Marriage Ring for you") + '<img src="/static/images/ava/ax09006.png">');
      DragonDialogOpen(l.t("Relationship Request"),
        '<font color="yellow">' + a.from_name + "</font>: " + b, DIALOG_BUTTONS_OK_CANCEL,
        function(b) {
          b && d.Send(CLIENT_OPCODE.relationship_approved, a.new_status, a.from_id, a.token)
        }, a.avatars)
    };
    f[SERVER_OPCODE.show_revive] = function() {
      c.game.ShowClickToRevive()
    };
    d.SetHandler("receive", Object.freeze(f));
    d.Connect("https:" == location.protocol || localStorage.forceWSS ? "wss://" + a + ":" + (80 == b ? 443 : b + 100) : "ws://" + a + ":" + b);
    this.ds = d;
    return !0
  };

  function Alert2(a, b, c) {
    var d = "",
      e = "",
      f = DIALOG_BUTTONS_OK,
      h = void 0,
      k = void 0;
    Array.isArray(b) || (b = [b]);
    switch (a) {
      case ALERT2_TYPES.ROOM_DOES_NOT_EXIST:
        d = l.t("Sorry");
        e = l.t("Room does not exist.<br>Please try a different room.");
        break;
      case ALERT2_TYPES.ROOM_FULL:
        d = l.t("Full");
        e = l.t("Too many users in the room.<br>Please try a different room.");
        break;
      case ALERT2_TYPES.ROOM_PLAYING:
        d = l.t("Playing");
        e = l.t("The game has already started.<br>You cannot enter.");
        break;
      case ALERT2_TYPES.WRONG_PASSWORD:
        d = l.t("Wrong Password");
        e = l.t("Wrong Password.<br>Please check your password.");
        break;
      case ALERT2_TYPES.KICKED:
        d = l.t("Kicked or Left Game");
        e = l.t("You will be able to join this room in %% seconds.").replace("%%", b[0]);
        break;
      case ALERT2_TYPES.MISSING_AVATAR:
        d = l.t("Sorry");
        e = l.t("This avatar is missing in stock.");
        break;
      case ALERT2_TYPES.NOT_FOR_SELL:
        d = l.t("Sorry");
        e = l.t("This avatar is not available for sell right now.");
        break;
      case ALERT2_TYPES.BAD_PAYMENT_METHOD:
        d = l.t("Sorry");
        e = l.t("The requested avatar can not be bought with this method of payment.");
        break;
      case ALERT2_TYPES.BAD_PRICE:
        d = l.t("Sorry");
        e = l.t("The requested price does not match this avatar and period.");
        break;
      case ALERT2_TYPES.ALREADY_BUYING:
        d = l.t("Sorry");
        e = l.t("You are already buying something, please wait a while for previous purchase to finish and try again.");
        break;
      case ALERT2_TYPES.ALREADY_HAVE:
        d = l.t("Sorry");
        e = l.t("You already have this item. Why are you buying it again?");
        break;
      case ALERT2_TYPES.PURCHASED:
        var m = b[0],
          d = l.t("Thank You"),
          e = l.t("You purchased") + " " + BuildAvatarName(m),
          h = function() {
            ShopBuyCloseDialog();
            c.after_purchase_action && c.after_purchase_of_item == m && (1 == c.after_purchase_action && c.after_purchase_params ? (ShopClose(c), setTimeout(function() {
              c.SendRelationshipChange(c.after_purchase_params[0], c.after_purchase_params[1])
            }, 1500)) : 2 == c.after_purchase_action && (ShopClose(c), setTimeout(function() {
              RoomOptionsDialogSetMap(g_options_map, c.myPlayerInfo.maps_pack);
              $("#room_options_button").click()
            }, 1E3)))
          };
        break;
      case ALERT2_TYPES.LOCKED_CHALLENGE:
        d = l.t("Locked");
        e = l.t("You did not open this challenge yet.\n\nTo unlock this one you have to win the previous one as room master.");
        k = b;
        break;
      case ALERT2_TYPES.ALREADY_IN_ROOM:
        d = l.t("Already Playing");
        e = l.t("This player is already in the room.\n\nPlease select a different one.");
        break;
      case ALERT2_TYPES.WON_EVENT1:
        d = l.t("Event");
        e = l.t("You won the event!\nHere is a gift of <u>%% Cash</u> and <u>%% Gold").replace("%%", b[0]).replace("%%", b[1]) + "</u>.\n\n" + l.t("Come back in at least <u>4 hours</u>\nto get another gift.");
        k = [b[2], b[3]];
        break;
      case ALERT2_TYPES.WON_EVENT2:
        d = l.t("Event");
        e = l.t("You won the event!\nHere is a gift of <u>%% Cash</u> and <u>%% Gold").replace("%%",
          b[0]).replace("%%", b[1]) + "</u>.\n\n" + l.t("You can post again in at least <u>24 hours</u>\nto get another gift.");
        k = [b[2], b[3]];
        break;
      case ALERT2_TYPES.CANT_FRIEND_YOURSELF:
        d = l.t("Sorry");
        e = l.t("You can not be friends with yourself. Try to friend someone else.");
        break;
      case ALERT2_TYPES.ADD_FRIEND_OFFLINE:
        d = l.t("Sorry");
        e = l.t("This player is offline or does not exist.\nAdd the friend when you can see him.");
        break;
      case ALERT2_TYPES.ALREADY_FRIENDS:
        d = l.t("Already Friends");
        e = l.t("You are already friends.\n\nYou can see the friend in your Friends List.");
        break;
      case ALERT2_TYPES.CANT_FRIEND_GM:
        d = l.t("Sorry");
        e = l.t("You can not add GM as a friend.");
        break;
      case ALERT2_TYPES.ALREADY_ASKED:
        d = l.t("Sorry");
        e = l.t("You sent a request to this player already.\n\nAsk him to add you, or change server to send him again.");
        break;
      case ALERT2_TYPES.TOO_MANY_FRIENDS_ME:
        d = l.t("Too Many Friends");
        e = l.t("You have %% friends.\nLimit = %% (%% + %% Per Level)\n\nPlease delete some inactive friends first, and then invite again.").replace("%%", b[0]).replace("%%", b[1]).replace("%%",
          b[2]).replace("%%", b[3]);
        break;
      case ALERT2_TYPES.TOO_MANY_FRIENDS_HIM:
        d = l.t("User Has Too Many Friends");
        e = l.t("That player has too many friends.\n\nAsk him to delete some friends to make space for you first.");
        break;
      case ALERT2_TYPES.FRIEND_REQUEST_SENT:
        d = l.t("Friend Request Sent");
        e = l.t("You asked %% to be friends.\n\nWhen he approves your request you will see the friend in your Buddy List.").replace("%%", b[0]);
        break;
      case ALERT2_TYPES.FRIEND_ADDED:
        d = l.t("Friend Added :)");
        e = l.t("You have a new friend: %%\n\nYou can now see where is your friend in your Buddy List, and private chat even at different rooms.").replace("%%",
          b[0]);
        k = b[1];
        break;
      case ALERT2_TYPES.CANT_CHAT_YOURSELF:
        d = l.t("Sorry");
        e = l.t("You can not chat with yourself. Try to chat with someone else.");
        break;
      case ALERT2_TYPES.FRIEND_DELETED:
        d = l.t("Friend Deleted :(");
        e = l.t("How sad...");
        break;
      case ALERT2_TYPES.NOT_IN_GUILD:
        d = l.t("Sorry");
        e = l.t("You are not in a guild");
        break;
      case ALERT2_TYPES.NOT_IN_MY_GUILD:
        d = l.t("Sorry");
        e = l.t("The user is not in your guild.");
        break;
      case ALERT2_TYPES.NO_KICK_POWER:
        d = l.t("Sorry");
        e = l.t("You do not have kick powers, ask the guild leader to kick.");
        break;
      case ALERT2_TYPES.CANT_KICK_YOURSELF:
        d = l.t("Sorry");
        e = l.t("You can not kick yourself.");
        break;
      case ALERT2_TYPES.KICKED_GUILD:
        d = l.t("Kicked");
        e = l.t("How sad... :(");
        break;
      case ALERT2_TYPES.CANT_BOSS_PLAYERS:
        d = l.t("Sorry");
        e = l.t("Can't set Boss mode if there are more than 4 players in the room.");
        break;
      case ALERT2_TYPES.ALREADY_IN_GUILD:
        d = l.t("Sorry");
        e = l.t("You are already in a guild. You have to leave your guild first.");
        break;
      case ALERT2_TYPES.GUILD_BAD_NAME_LEN:
        d = l.t("Sorry");
        e = l.t("Guild name must be 2-6 letters.");
        break;
      case ALERT2_TYPES.GUILD_NAME_BAD_WORD:
        d = l.t("Sorry");
        e = l.t("Guild name must not contain filtered words.");
        break;
      case ALERT2_TYPES.GUILD_NO_MONEY:
        d = l.t("Sorry");
        e = l.t("Not enough gold.");
        break;
      case ALERT2_TYPES.GUILD_ALREADY_EXISTS:
        d = l.t("Already Exists");
        e = l.t("There is already a guild at this name. Please select a different name.");
        break;
      case ALERT2_TYPES.GUILD_CREATED:
        d = l.t("Done");
        e = l.t("Guild created! You are the guild leader. You can now invite players to join it.");
        break;
      case ALERT2_TYPES.CANT_INVITE_YOURSELF:
        d =
          l.t("Sorry");
        e = l.t("You can not invite yourself.");
        break;
      case ALERT2_TYPES.NO_INVITE_POWERS:
        d = l.t("Sorry");
        e = l.t("You do not have invite powers, ask the guild leader to invite.");
        break;
      case ALERT2_TYPES.ALREADY_SENT_REQUEST:
        d = l.t("Sorry");
        e = l.t("You sent a request to this player already.\n\nRe-enter to the server to send him again.");
        break;
      case ALERT2_TYPES.GUILD_IS_FULL:
        d = l.t("Sorry");
        e = l.t("Guild is full.");
        break;
      case ALERT2_TYPES.GUILD_INVITE_PLAYER_OFFLINE:
        d = l.t("Sorry");
        e = l.t("This player is offline or does not exist.\nInvite to guild when you can see him/her.");
        break;
      case ALERT2_TYPES.CANT_INVITE_ALREADY_IN_GUILD:
        d = l.t("Sorry");
        e = l.t("This player is already in a guild. Ask him to leave his current guild before you can invite him/her.");
        break;
      case ALERT2_TYPES.GUILD_INVITE_SENT:
        d = l.t("Guild Invite Sent");
        e = l.t("You asked %% to join your guild.\n\nWhen he approves your request he will join the guild.").replace("%%", b[0]);
        break;
      case ALERT2_TYPES.JOINED_GUILD:
        d = l.t("Joined Guild :)");
        e = l.t("You have joined the guild.\n\nYou can now see where is your friend in your Guild Tab, and private chat even at different rooms.");
        break;
      case ALERT2_TYPES.GUILD_LEADER_CANT_LEAVE:
        d = l.t("Sorry");
        e = l.t("Guild leader can not leave his guild while there are other members. If you are the last one to leave, the guild will be closed and deleted.");
        break;
      case ALERT2_TYPES.CLOSED_GUILD:
        d = l.t("Closed Guild");
        e = l.t("Nobody left in the guild, so the guild was closed. The name is now available for new guilds.");
        break;
      case ALERT2_TYPES.LEFT_GUILD:
        d = l.t("Left Guild");
        e = l.t("You left your guild...\n\nHow sad... :(");
        break;
      case ALERT2_TYPES.NAME_SAME:
        d =
          l.t("Nothing to do");
        e = l.t("The new name is the same as your current name.");
        break;
      case ALERT2_TYPES.NAME_BAD_LEN:
        d = l.t("Sorry");
        e = l.t("Name length must be 2-15");
        break;
      case ALERT2_TYPES.NAME_FEW_LETTERS:
        d = l.t("Sorry");
        e = l.t("Name must contain at least 2 english letters a-z/A-Z");
        break;
      case ALERT2_TYPES.NAME_BAD_CHAR:
        d = l.t("Sorry");
        e = l.t("Name contains a character that is not allowed.<p>Allowed chars") + ": a-z A-Z 0-9 -+$^*~!@#=";
        break;
      case ALERT2_TYPES.NAME_NOT_ENOUGH_CASH:
        d = l.t("Sorry");
        e = l.t("Not enough cash.<p>Name change costs 4,000 cash.");
        break;
      case ALERT2_TYPES.NAME_BAD_WORD:
        d = l.t("Sorry");
        e = l.t("The new name contains a word which is not allowed. Please select a different one.");
        break;
      case ALERT2_TYPES.NAME_NOT_ENOUGH_TIME:
        d = l.t("Sorry");
        e = l.t("Not enough time passed since last name change. Check that your name was not changed already, if you change again, it will cost you again.<br>Please wait 30 minutes before you can change again.");
        break;
      case ALERT2_TYPES.STILL_PROCESSING_YOUR_LAST_REQUEST:
        d = l.t("Sorry");
        e = l.t("Still processing your last request. Please wait a few minutes.");
        break;
      case ALERT2_TYPES.NAME_ALREADY_EXISTS:
        d = l.t("Sorry");
        e = l.t("This name already exists, please select a different one.");
        break;
      case ALERT2_TYPES.NEW_CHALLENGE_UNLOCKED:
        d = l.t("New Challenge Unlocked");
        e = "[" + b[0] + "]\n" + l.t("You killed my friend! Do you think you are so good?\n\nI challenge you for a duel!\n\nI will be waiting for you...");
        k = b[1];
        break;
      case ALERT2_TYPES.NOT_ENOUGH_CASH:
        d = l.t("Sorry");
        e = l.t("Not enough Cash. You can get more by charging.");
        break;
      case ALERT2_TYPES.NOT_ENOUGH_GOLD:
        d =
          l.t("Sorry");
        e = l.t("Not enough Gold. You can get more by playing.");
        break;
      case ALERT2_TYPES.AVATAR_WRONG_GENDER:
        d = l.t("Sorry");
        e = l.t("This avatar is not for your gender.");
        break;
      case ALERT2_TYPES.TOURNAMENT_NOT_STARTED:
        d = l.t("Sorry");
        e = l.t("Tournament not started yet.");
        break;
      case ALERT2_TYPES.TOURNAMENT_ENDED:
        d = l.t("Sorry");
        e = l.t("Tournament ended.");
        break;
      case ALERT2_TYPES.GUILDS_LOCK:
        d = l.t("Sorry");
        e = l.t("Guilds are locked during the tournament. Try again later.");
        break;
      case ALERT2_TYPES.SOMEONE_NOT_READY:
        d =
          l.t("Can't start");
        e = l.t("Someone is not ready.");
        break;
      case ALERT2_TYPES.FEW_PLAYERS:
        d = l.t("Can't start");
        e = l.t("Need 2-4 players in your team.");
        break;
      case ALERT2_TYPES.NOT_4_SAME_GUILD:
        d = l.t("Can't start");
        e = l.t("Need 4 players of the same guild to play on this server.");
        break;
      case ALERT2_TYPES.FEW_PLAYERS4:
        d = l.t("Can't start");
        e = l.t("Need 4 players in your team.");
        break;
      case ALERT2_TYPES.DISQUALIFIED_GUILD:
        d = l.t("Guild Disqualified");
        e = l.t("Your guild can not participate in this tournament anymore because it has a score of %%.<br><br>The minimum score to participate is %%.").replace("%%",
          b[0]).replace("%%", b[1]);
        break;
      case ALERT2_TYPES.DISQUALIFIED_PLAYER:
        d = l.t("Disqualified");
        e = l.t("You can not participate in this tournament anymore because you have a score of %%<br><br>The minimum score to participate is %%.").replace("%%", b[0]).replace("%%", b[1]);
        break;
      case ALERT2_TYPES.NO_GUILD:
        d = l.t("No Guild");
        e = l.t("You need to have a guild to play on this server");
        break;
      case ALERT2_TYPES.CREATE_ROOM_TOO_FAST:
        d = l.t("Too Fast");
        e = l.t("You are creating rooms too fast. Please wait a few seconds between creates. Try again.");
        break;
      case ALERT2_TYPES.RECEIVED_AVATAR:
        d = l.t("Received Gift");
        e = l.t("You received a gift from") + '<br><font color="yellow">' + FixHTML(b[0]) + '</font><br><br><font color="#adff2f">' + BuildAvatarName(b[1]) + "</font>";
        void 0 != b[4] && ("forever" == b[4] ? a = l.t("Limitless") : (a = round(b[4] / 60 / 60 / 24), a = 7 == a ? l.t("1 Week") : 30 == a ? l.t("1 Month") : a + (" " + l.t("Days"))), e += '<br><font color="yellow">' + a + "</font>");
        b[3] && (e += '<br><br><font color="yellow">' + FixHTML(b[0]) + '</font>: "' + FixHTML(b[3]) + '"');
        info("RECEIVED GIFT:",
          b);
        k = [b[1]];
        break;
      case ALERT2_TYPES.NEED_ITEM:
        m = b[0];
        e = BuildAvatarName(m);
        d = l.t("Need Item");
        e = l.t("For this action you need to use 1 item") + ': <font color="yellow">' + e + "</font><br><br>" + l.t("But you don't have any... Buy one?");
        k = [m];
        f = DIALOG_BUTTONS_OK_CANCEL;
        h = function(a) {
          a && c.location != GUI_LOCATION_GAME && (AutoReadyStop(), c.SendRoomChangeReady(!1), GoToBuyShopItem(c, m, b[1], b[2]))
        };
        break;
      case ALERT2_TYPES.RELATIONSHIP_REQUEST_SENT:
        d = l.t("Relationship Request Sent");
        e = l.t("You sent a relationship request to") +
          ' <font color="yellow">' + b[0] + "</font>";
        break;
      case ALERT2_TYPES.CANT_KICK_NON_MEMBER:
        d = l.t("Can't Kick");
        e = l.t("Can't kick leader or semi-leader.\nDemote user to to normal member before kick.\nGuild leader can do this in the guild shop.");
        break;
      case ALERT2_TYPES.AVATAR_DELETED:
        d = l.t("Avatar Removed");
        e = l.t("You can UNDO and restore deleted avatars here") + ': <a href="/avatars" target="_blank">https://dragonbound.net/avatars</a>';
        break;
      case ALERT2_TYPES.GIFT_SENT:
        m = b[0];
        d = l.t("Gift Sent");
        e = l.t("Gift sent") +
          " " + BuildAvatarName(m);
        h = function() {
          ShopBuyCloseDialog()
        };
        break;
      case ALERT2_TYPES.RECEIVER_ALREADY_HAVE:
        d = l.t("Sorry");
        e = l.t("Your friend already have this item. Please choose a different item.");
        break;
      case ALERT2_TYPES.CANT_JOIN_GENDER:
        d = l.t("Can't Join");
        e = l.t("Same gender.<br><br>In this server you can only play together with someone of the opposite gender.");
        break;
      case ALERT2_TYPES.CANT_FRIEND_BLOCKED:
        d = l.t("Sorry");
        e = l.t("The other player has blocked all friend requests. You can ask him to allow or to add you.");
        break;
      default:
        d = "Msg " + a, e = "Unknown Msg " + a
    }
    DragonDialogOpen(d, e, f, h, k)
  }
  var ALERT2_TYPES = Object.freeze({
    ROOM_DOES_NOT_EXIST: 0,
    ROOM_FULL: 1,
    ROOM_PLAYING: 2,
    WRONG_PASSWORD: 3,
    KICKED: 4,
    MISSING_AVATAR: 5,
    NOT_FOR_SELL: 6,
    BAD_PAYMENT_METHOD: 7,
    BAD_PRICE: 8,
    ALREADY_BUYING: 9,
    ALREADY_HAVE: 10,
    PURCHASED: 11,
    LOCKED_CHALLENGE: 12,
    ALREADY_IN_ROOM: 13,
    WON_EVENT1: 14,
    WON_EVENT2: 15,
    CANT_FRIEND_YOURSELF: 16,
    ADD_FRIEND_OFFLINE: 17,
    ALREADY_FRIENDS: 18,
    CANT_FRIEND_GM: 19,
    ALREADY_ASKED: 20,
    TOO_MANY_FRIENDS_ME: 21,
    TOO_MANY_FRIENDS_HIM: 22,
    FRIEND_REQUEST_SENT: 23,
    FRIEND_ADDED: 24,
    CANT_CHAT_YOURSELF: 25,
    FRIEND_DELETED: 26,
    NOT_IN_GUILD: 27,
    NOT_IN_MY_GUILD: 28,
    NO_KICK_POWER: 29,
    CANT_KICK_YOURSELF: 30,
    KICKED_GUILD: 31,
    CANT_BOSS_PLAYERS: 32,
    ALREADY_IN_GUILD: 33,
    GUILD_BAD_NAME_LEN: 34,
    GUILD_NAME_BAD_WORD: 35,
    GUILD_NO_MONEY: 36,
    GUILD_ALREADY_EXISTS: 37,
    GUILD_CREATED: 38,
    CANT_INVITE_YOURSELF: 39,
    NO_INVITE_POWERS: 40,
    ALREADY_SENT_REQUEST: 41,
    GUILD_IS_FULL: 42,
    GUILD_INVITE_PLAYER_OFFLINE: 43,
    CANT_INVITE_ALREADY_IN_GUILD: 44,
    GUILD_INVITE_SENT: 45,
    JOINED_GUILD: 46,
    GUILD_LEADER_CANT_LEAVE: 47,
    CLOSED_GUILD: 48,
    LEFT_GUILD: 49,
    NAME_SAME: 50,
    NAME_BAD_LEN: 51,
    NAME_FEW_LETTERS: 52,
    NAME_BAD_CHAR: 53,
    NAME_NOT_ENOUGH_CASH: 54,
    NAME_BAD_WORD: 55,
    NAME_NOT_ENOUGH_TIME: 56,
    STILL_PROCESSING_YOUR_LAST_REQUEST: 57,
    NAME_ALREADY_EXISTS: 58,
    NEW_CHALLENGE_UNLOCKED: 59,
    NOT_ENOUGH_CASH: 60,
    NOT_ENOUGH_GOLD: 61,
    AVATAR_WRONG_GENDER: 62,
    TOURNAMENT_NOT_STARTED: 63,
    TOURNAMENT_ENDED: 64,
    GUILDS_LOCK: 65,
    SOMEONE_NOT_READY: 66,
    FEW_PLAYERS: 67,
    NOT_4_SAME_GUILD: 68,
    FEW_PLAYERS4: 69,
    DISQUALIFIED_GUILD: 70,
    DISQUALIFIED_PLAYER: 71,
    NO_GUILD: 72,
    CREATE_ROOM_TOO_FAST: 73,
    RECEIVED_AVATAR: 74,
    NEED_ITEM: 75,
    RELATIONSHIP_REQUEST_SENT: 76,
    CANT_KICK_NON_MEMBER: 77,
    AVATAR_DELETED: 78,
    GIFT_SENT: 79,
    RECEIVER_ALREADY_HAVE: 80,
    CANT_JOIN_GENDER: 81,
    CANT_FRIEND_BLOCKED: 82
  });

  function BuildAvatarName(a) {
    var b = AVATARS[a];
    if (!b) return "Unknown Avatar";
    a = b[AVATAR_INDEX_TYPE];
    var c = b[AVATAR_INDEX_GENDER],
      b = b[AVATAR_INDEX_NAME],
      d = [];
    a == AVATAR_TYPE_HEAD ? d.push("Head") : a == AVATAR_TYPE_BODY ? d.push("Body") : a == AVATAR_TYPE_EYES ? d.push("Glass") : a == AVATAR_TYPE_FLAG ? d.push("Flag") : a == AVATAR_TYPE_BACKGROUND ? d.push("Background") : a == AVATAR_TYPE_FOREGROUND ? d.push("Foreground") : a == AVATAR_TYPE_EXITEM && d.push("ExItem");
    if (a == AVATAR_TYPE_HEAD || a == AVATAR_TYPE_BODY || a == AVATAR_TYPE_EYES) c == GENDER_MALE &&
      d.push("Male"), c == GENDER_FEMALE && d.push("Female");
    return b + " [" + d.join(" ") + "]"
  }
  DragonNetwork.prototype.SetLoginUserDetails = function(a, b, c, d, e) {
    void 0 == e && (e = 10);
    this.user_id = a;
    this.user_rank = b;
    this.user_auth_key = c;
    this.user_country = d;
    this.wins_at_login = e;
    SetValue("y", a)
  };
  DragonNetwork.prototype.OpenBrokerWindow = function() {
    this.BrokerConnect();
    $("#channelTextHtml").html("");
    for (var a = 0; 6 > a; a++) RoomChangeDetails(void 0, a);
    SetRoomURL()
  };
  DragonNetwork.prototype.BrokerConnect = function() {
    g_dont_show_disconnect_window = !0;
    this.ds && this.ds.Disconnect();
    var a = this,
      b;
    b = "gl" == SERVER_TYPE ? "/w2" : "http://" + location.host + ":9000/w";
    $("#BrokerScreen").is(":visible") || AudioPlay(AUDIO_BROKER);
    $("#BrokerTitle").html(l.t("Loading Channels") + "... " + l.t("Please Wait") + "...");
    $(".BrokerChannel").removeClass("BrokerChannelOnline BrokerChannelFull opacity_button LoveLobbyServer");
    $("#BrokerScreen").show();
    $.get(b, {}, function(b, d, e) {
        a.BrokerResponse2(b)
      },
      "json").fail(function(a, b, e) {
      DEBUG && console.log("WORLDS ERROR:", a, b, e);
      $("#BrokerTitle").html(l.t("Error! Wait 30 seconds, then press this button") + " ->")
    });
    57 == window.gfpdsumer && console.log(myhash)
  };
  DragonNetwork.prototype.EnterServer = function(a) {
    dlog("EnterServer", a);
    var b = "dev" == SERVER_TYPE ? "t.dragonbound.net" : "game9.dragonbound.net",
      c = this.channels[a][2],
      d = $("#BrokerChannel" + a + " .BrokerChannelName").html();
    $("#channelName").html(d);
    this.server = Number(a);
    this.ConnectToGameServer(b, c)
  };
  DragonNetwork.prototype.BrokerResponse2 = function(a) {
    var b = a[0];
    if (b != VERSION && b != VERSION2) DragonDialogOpen(l.t("Update Available"), l.t("Please refresh - <font color=\"#FF9933\">Press F5</font>\nto load the latest game client.\n\nIf it doesn't help try Shift+F5 or clear your browser's cache."));
    else {
      var c = 0,
        d = 0,
        e = 0,
        b = this.user_rank;
      $("#BrokerTitle").html(l.t("Select Server"));
      this.channels = [];
      for (var f = this, h = 3; 18 > h; h++) {
        var k = h - 3,
          m = $("#BrokerChannel" + k);
        m.removeClass("FastLobbyServer").removeClass("LoveLobbyServer");
        if (Array.isArray(a[h])) {
          var d = k + 1,
            n = a[h][0],
            p = a[h][3],
            q = a[h][4],
            r = a[h][5],
            s = a[h][6],
            t = !1;
          this.channels[k] = a[h];
          m.unbind();
          0 < q && (b == GM_RANK || b == PRO_GM_RANK || p < q && (void 0 == r || r <= b) && (void 0 == s || b <= s)) ? (m.addClass("BrokerChannelOnline opacity_button"), t = !0, m.click(function(a) {
            return function() {
              f.EnterServer(a)
            }
          }(k))) : (p >= q && 0 < q && m.addClass("BrokerChannelFull"), e++);
          c++;
          var w = "";
          void 0 != r && void 0 != s && (w = '<div class="BrokerRanks"><span class="InlineRank rank rank' + r + '"></span> - <span class="InlineRank rank rank' +
            s + '"></span></div>');
          p = 74 * p / q;
          74 < p && (p = 74); - 1 != n.indexOf("Love") || -1 != n.indexOf("Valentine") ? t && m.addClass("LoveLobbyServer") : "." == n.slice(-1) ? t && m.addClass("FastLobbyServer") : (-1 != n.indexOf("Fast") || -1 != n.indexOf("Avatar") || -1 != n.indexOf("Guilds")) && t && m.addClass("FastLobbyServer");
          "." == n.slice(-1) && (n = n.slice(0, -1));
          m.html('<div class="BrokerChannelName blackShadow">' + l.t("Server") + " " + (k + 1) + " - " + l.t(n) + '</div> <div class="BrokerMaxPlayers2"></div> <div class="BrokerNumPlayers2" style="width:' +
            p + 'px"></div><div class="BrokerChannelFullIcon"></div>' + w + '<div class="Alt">' + (k + 1).toString(16).toUpperCase() + "</div>")
        } else m.html('<div class="BrokerChannelName blackShadow">' + l.t("Server") + " " + (k + 1) + " - Offline</div>")
      }
      $(".Alt").is(":visible") && $(".Alt").show();
      e >= c && $("#BrokerTitle").html(l.t("All worlds are currently full. Press this button to refresh") + " ->");
      a = $("#BrokerWindow");
      $(".BrokerChannel").hide();
      1 == d ? ($("#BrokerChannel0").css("left", 223).show(), a.css({
          height: 192,
          top: 204
        })) : 2 == d ?
        ($("#BrokerChannel0").css("left", 119).show(), $("#BrokerChannel1").css("left", 326).show(), a.css({
          height: 192,
          top: 204
        })) : 3 == d || 0 == d ? ($("#BrokerChannel0,#BrokerChannel1,#BrokerChannel2").css("left", "").show(), a.css({
          height: 192,
          top: 204
        })) : 6 >= d ? ($("#BrokerChannel0,#BrokerChannel1,#BrokerChannel2,#BrokerChannel3,#BrokerChannel4,#BrokerChannel5").css("left", "").show(), a.css({
          height: 272,
          top: 165
        })) : 9 >= d ? ($("#BrokerChannel0,#BrokerChannel1,#BrokerChannel2,#BrokerChannel3,#BrokerChannel4,#BrokerChannel5,#BrokerChannel6,#BrokerChannel7,#BrokerChannel8").css("left",
          "").show(), a.css({
          height: 354,
          top: 123
        })) : 12 >= d ? ($("#BrokerChannel0,#BrokerChannel1,#BrokerChannel2,#BrokerChannel3,#BrokerChannel4,#BrokerChannel5,#BrokerChannel6,#BrokerChannel7,#BrokerChannel8,#BrokerChannel9,#BrokerChannel10,#BrokerChannel11").css("left", "").show(), a.css({
          height: 436,
          top: 82
        })) : ($(".BrokerChannel").show(), $("#BrokerChannel0,#BrokerChannel1,#BrokerChannel2").css("left", ""), a.css({
          height: "",
          top: ""
        }));
      if (QUICK_JOIN && QUICK_JOIN.server && $("#BrokerChannel" + (QUICK_JOIN.server - 1)).hasClass("BrokerChannelOnline")) {
        this.dont_auto_enter_server = !0;
        if ("1" == GetValue("in_room")) {
          var v = QUICK_JOIN.server;
          DragonDialogOpen(l.t("Quick Join"), l.t("Join") + " " + l.t("Server") + " " + QUICK_JOIN.server + (QUICK_JOIN.room ? " " + l.t("Room") + " " + QUICK_JOIN.room : "") + " ?", DIALOG_BUTTONS_OK_CANCEL, function(a) {
            a ? f.EnterServer(v - 1) : QUICK_JOIN = {}
          })
        } else this.EnterServer(QUICK_JOIN.server - 1);
        delete QUICK_JOIN.server
      } else a = $("#BrokerChannel11"), 0 == b && a.hasClass("BrokerChannelOnline") ? $("#BrokerHelp").css({
          left: a.css("left"),
          top: a.css("top")
        }).html('<div id="NewUser2"><div id="NewUser2Text" class="blackShadow">New User?<br>Join Server 12</div></div>').show() :
        $("#BrokerHelp").hide()
    }
  };

  function SetRoomURL(a, b, c) {
    history && history.replaceState && (void 0 == a ? a = location.pathname : (a = "#server-" + a, void 0 != b && (a += "/room-" + b, c && (a += "/password-" + encodeURIComponent(c)))), history.replaceState("", "", a))
  }
  DragonFreeze(DragonNetwork);

  function GetMapAfter(a) {
    a = SELECTABLE_MAPS.indexOf(a);
    return -1 == a ? SELECTABLE_MAPS[0] : SELECTABLE_MAPS[(a + 1) % SELECTABLE_MAPS.length]
  }

  function GetMapBefore(a) {
    a = SELECTABLE_MAPS.indexOf(a);
    return -1 == a ? SELECTABLE_MAPS[0] : SELECTABLE_MAPS[(a + SELECTABLE_MAPS.length - 1) % SELECTABLE_MAPS.length]
  }

  function MapNumberToObject(a) {
    var b;
    if ("number" == typeof a) {
      b = {
        name: MAPS[a].name,
        fg: MAPS[a].fg,
        bg: MAPS[a].bg,
        bgcolor: MAPS[a].bgcolor,
        w: MAPS[a].w,
        h: MAPS[a].h,
        ground_size: MAPS[a].ground_size,
        offset_x: MAPS[a].offset_x,
        offset_y: MAPS[a].offset_y,
        is_cave: MAPS[a].is_cave,
        is_shadow: MAPS[a].is_shadow,
        data: MAPS[a].data
      };
      if (DragonTheme_Get("classic_maps")) {
        var c = CLASSIC_MAPS[a];
        c && (b.name = c.name, b.fg = c.fg, b.bg = c.bg)
      }
      DragonThemeInUse["map" + a + "_name"] && (b.name = DragonThemeInUse["map" + a + "_name"]);
      DragonThemeInUse["map" +
        a + "_fg"] && (b.fg = DragonThemeInUse["map" + a + "_fg"]);
      DragonThemeInUse["map" + a + "_bg"] && (b.bg = DragonThemeInUse["map" + a + "_bg"]);
      DragonThemeInUse["map" + a + "_bgcolor"] && (b.bgcolor = DragonThemeInUse["map" + a + "_bgcolor"])
    } else b = {
      name: "Custom",
      fg: a[6] || "bricks",
      bg: "sea_bg2",
      bgcolor: "#84b6ce",
      w: a[0],
      h: a[1],
      ground_size: a[2],
      offset_x: a[3],
      offset_y: a[4],
      is_cave: 0,
      data: a[5],
      is_shadow: !0,
      is_custom_map: !0
    }, DragonThemeInUse.custom_map_bg && (b.bg = DragonThemeInUse.custom_map_bg), DragonThemeInUse.custom_map_bgcolor && (b.bgcolor =
      DragonThemeInUse.custom_map_bgcolor);
    return b
  }

  function GetMapName(a) {
    return a == MAP.RANDOM ? "Random" : a == MAP.CUSTOM ? "Custom" : DragonThemeInUse["map" + a + "_name"] ? DragonThemeInUse["map" + a + "_name"] : DragonTheme_Get("classic_maps") && CLASSIC_MAPS[a] ? CLASSIC_MAPS[a].name : MAPS[a] ? MAPS[a].name : "Unknown"
  }

  function GetMapImageOffset(a) {
    return -50 * (a + 1)
  }

  function CGround(a) {
    var b = "number" != typeof c,
      c = MapNumberToObject(a),
      d = this.canvas = document.getElementById("ground_canvas"),
      e = c.w,
      f = c.h;
    this.w = d.width = e;
    this.h = d.height = f;
    $("#ground_canvas").css({
      width: e,
      height: f
    });
    a = DragonDecompress(c.data);
    var h = d.getContext("2d");
    this.imageData = h.createImageData(e, f);
    BooleanArrayToImageData(a, this.imageData);
    h.putImageData(this.imageData, 0, 0);
    var k = new Image,
      m = this;
    k.onload = function() {
      var a = ImageDataToBooleanArray(m.imageData);
      h.drawImage(k, 0, 0, Math.max(c.w, k.width),
        Math.max(c.h, k.height));
      m.imageData = h.getImageData(0, 0, e, f);
      b && (BooleanArrayToImageData(a, m.imageData, !1), h.putImageData(m.imageData, 0, 0), m.dataUrl = d.toDataURL("image/png"));
      BooleanArrayToImageData(a, m.imageData, b);
      h.putImageData(m.imageData, 0, 0)
    }; - 1 == c.fg.indexOf("/") ? -1 == c.fg.indexOf(".") ? k.src = "/static/images/maps/" + c.fg + ".jpg" : k.src = "/static/images/maps/" + c.fg : k.src = c.fg;
    a = c.bg; - 1 == a.indexOf("/") && (a = -1 == c.fg.indexOf(".") ? "/static/images/maps/" + a + ".jpg" : "/static/images/maps/" + a);
    this.bg = a;
    this.bgcolor =
      c.bgcolor;
    this.SetMapBackground();
    $("#gameScreen").css("background-color", c.bgcolor)
  }
  CGround.prototype.SetMapBackground = function() {
    OPTIONS.background ? $("#map_bg").css({
      width: MAP_BACKGROUND_W,
      height: MAP_BACKGROUND_H,
      background: this.bgcolor + " url(" + this.bg + ")"
    }).show() : $("#map_bg").hide()
  };
  CGround.prototype.IsPixel = function(a, b) {
    return 0 > a || a >= this.w || 0 > b || b >= this.h ? !1 : 0 < this.imageData.data[4 * (b * this.w + a) + 3]
  };
  CGround.prototype.GetPosForWalking = function(a, b, c) {
    var d = c == PLAYER_LOOK_LEFT ? a - 1 : a + 1;
    if (0 > d || d >= this.w) return {
      x: a,
      y: b,
      stuck: !0
    };
    if (this.IsPixel(d, b)) {
      for (c = b; c > b - 10; c--)
        if (!this.IsPixel(d, c)) return {
          x: d,
          y: c
        };
      return {
        x: a,
        y: b,
        stuck: !0
      }
    }
    for (c = b + 1; c < this.h; c++)
      if (this.IsPixel(d, c)) return {
        x: d,
        y: c - 1
      };
    return {
      x: d,
      y: this.h + 100,
      fall_and_die: !0
    }
  };
  CGround.prototype.GetUnder = function(a, b, c) {
    if (void 0 == this.imageData) throw Error("GetUnder - imageData = undefined");
    for (c = c ? b + c : this.h; b < c; b++)
      if (this.IsPixel(a, b)) return b - 1
  };
  CGround.prototype.GetAngle = function(a, b) {
    if (this.IsPixel(a, b)) return DEBUG && console.log("[CGround.GetAngle] IN-GROUND"), 0;
    var c = this.GetUnder(a, b, 10);
    if (void 0 == c) return DEBUG && console.log("[CGround.GetAngle] FALLING"), 0;
    if (c != b) return DEBUG && console.log("[CGround.GetAngle] FLYING"), 0;
    for (var d = c, e = 1, f = c, h = 1, k = 1; 9 >= k; k++) c = this.GetUnder(a - k, b - 10, 20), void 0 != c && (d += c, e++), c = this.GetUnder(a + k, b - 10, 20), void 0 != c && (f += c, h++);
    return Math.round(RadToAngle(Math.atan2((0 < h ? f / h : b) - (0 < e ? d / e : b), 19)))
  };
  CGround.prototype.AddGroundHole = function(a, b, c, d) {
    var e, f, h, k, m = c * c,
      n = d * d,
      p, q, r;
    for (e = a - c - 10; e <= a; e++)
      for (r = !1, c = b - d - 10; c < b; c++)
        if (f = e - a, h = c - b, k = f * f / m + h * h / n, !r && 1.2 > k) {
          if (r = !0, p = e, q = c, h = b - h, this.AddGroundShadowColumn(p, q, h), 0 != f && (p = a - f, this.AddGroundShadowColumn(p, q, h)), 1.2 <= k && r) break
        } else if (1 > k) {
      p = e;
      q = c;
      h = b - h;
      this.AddGroundHoleColumn(p, q, h);
      0 != f && (p = a - f, this.AddGroundHoleColumn(p, q, h));
      break
    }
    this.canvas.getContext("2d").putImageData(this.imageData, 0, 0)
  };
  CGround.prototype.AddGroundHoleColumn = function(a, b, c) {
    if (!(0 > a || a >= this.w || (0 > b && (b = 0), c >= this.h && (c = this.h - 1), c < b)))
      for (var d = this.w, e = b; e <= c; e++) b = 4 * (e * d + a), this.imageData.data[b + 3] = 0
  };
  CGround.prototype.AddGroundShadowColumn = function(a, b, c) {
    if (!(0 > a || a >= this.w || (0 > b && (b = 0), c >= this.h && (c = this.h - 1), c < b)))
      for (var d = this.w, e = b; e <= c; e++) b = 4 * (e * d + a), this.imageData.data[b] /= 2, this.imageData.data[b + 1] /= 2, this.imageData.data[b + 2] /= 2
  };
  DragonFreeze(CGround);

  function CCamera(a, b, c) {
    this.camera_div = c;
    a = MapNumberToObject(a);
    this.min_x = -a.offset_x + 400;
    this.max_x = a.ground_size - 400;
    this.min_y = -a.offset_y + 300;
    this.max_y = a.ground_size - a.offset_y - 300 + 84;
    this.max_y = (a.is_cave ? a.h + a.offset_y : a.ground_size - a.offset_y) - 300 + 84;
    this.bg_aspect_ratio_x = (MAP_BACKGROUND_W - 800) / (a.ground_size - 500);
    this.bg_aspect_ratio_y = (MAP_BACKGROUND_H - 600) / (a.ground_size - 500);
    this.bg_offset_x = a.offset_x;
    this.bg_offset_y = a.offset_y;
    this.onChange = b
  }
  CCamera.prototype.FocusAt = function(a, b, c, d) {
    var e;
    c && (void 0 == this.x ? c = !1 : (e = Math.sqrt((this.x - a) * (this.x - a) + (this.y - b) - (this.y - b)), 30 > e && (c = !1)));
    a < this.min_x ? a = this.min_x : a > this.max_x && (a = this.max_x);
    b < this.min_y ? b = this.min_y : b > this.max_y && (b = this.max_y);
    this.x = a;
    this.y = b;
    if (d) {
      var f = this;
      this.camera_div.promise().done(function() {
        f.Set(a, b, c, e)
      })
    } else this.Set(a, b, c, e)
  };
  CCamera.prototype.MoveBy = function(a, b, c) {
    this.FocusAt(this.x + a, this.y + b, c)
  };
  CCamera.prototype.Set = function(a, b, c, d) {
    a = Math.round(a);
    b = Math.round(b);
    var e = -(a - 400),
      f = -(b - 300),
      h = (e - this.bg_offset_x) * this.bg_aspect_ratio_x,
      k = (f - this.bg_offset_y) * this.bg_aspect_ratio_y,
      m = this.camera_div,
      n = $("#map_bg"),
      p = this.onChange;
    c ? (m.stop(!0).animate({
      left: e,
      top: f
    }, {
      duration: d,
      progress: function() {
        if (p) {
          var a = -parseInt(m.css("left")),
            b = -parseInt(m.css("top"));
          p(a, b)
        }
      }
    }), n.stop(!0).animate({
      left: h,
      top: k
    }, d)) : (m.stop(!0).css({
      left: e,
      top: f
    }), n.stop(!0).css({
      left: h,
      top: k
    }), p && p(a - 400, b - 300))
  };
  DragonFreeze(CCamera);
  var START_GAME_PLAYER = Object.freeze({
    n: 0,
    user_id: 1,
    name: 2,
    guild: 3,
    rank: 4,
    x: 5,
    y: 6,
    hp: 7,
    shield: 8,
    shield_regen: 9,
    minang: 10,
    maxang: 11,
    lastturn: 12,
    mobile: 13,
    avatars: 14,
    aim_s1_ang: 15,
    aim_s1_len: 16,
    aim_s2_ang: 17,
    aim_s2_len: 18,
    aim_ss_ang: 19,
    aim_ss_len: 20,
    relationship_status: 21,
    country: 22
  });

  function CPlayer(a, b, c, d) {
    if (void 0 == a) throw Error("CPlayer - bad arguments", a);
    this.x = a[START_GAME_PLAYER.x];
    this.y = a[START_GAME_PLAYER.y];
    this.look = PLAYER_LOOK_LEFT;
    this.minang = a[START_GAME_PLAYER.minang];
    this.maxang = a[START_GAME_PLAYER.maxang];
    this.ang = random(this.minang, this.maxang);
    this.team = 0 == a[START_GAME_PLAYER.n] % 2 ? "A" : "B";
    this.hp = this.maxhp = a[START_GAME_PLAYER.hp];
    this.shield = this.maxshield = a[START_GAME_PLAYER.shield];
    this.shield_regen = a[START_GAME_PLAYER.shield_regen];
    this.rank = a[START_GAME_PLAYER.rank];
    this.mobile = a[START_GAME_PLAYER.mobile];
    this.guild = a[START_GAME_PLAYER.guild];
    this.delay = this.delay_before = 0;
    this.lastturn = a[START_GAME_PLAYER.lastturn];
    this.mobile = a[START_GAME_PLAYER.mobile];
    this.aim = [new Vector(a[START_GAME_PLAYER.aim_s1_ang], a[START_GAME_PLAYER.aim_s1_len]), new Vector(a[START_GAME_PLAYER.aim_s2_ang], a[START_GAME_PLAYER.aim_s2_len]), new Vector(a[START_GAME_PLAYER.aim_ss_ang], a[START_GAME_PLAYER.aim_ss_len])];
    this.is_me = b;
    this.user_id = a[START_GAME_PLAYER.user_id];
    this.name = a[START_GAME_PLAYER.name];
    this.player_number_in_game = a[START_GAME_PLAYER.n];
    this.relationship_status = a[START_GAME_PLAYER.relationship_status];
    this.country = a[START_GAME_PLAYER.country] || "";
    this.is_alive = !0;
    this.last_sent_look = this.last_sent_y = this.last_sent_x = void 0;
    this.ground = c;
    this.avatars = a[START_GAME_PLAYER.avatars];
    this.dn = d;
    this.isInView = !1;
    this.Init()
  }
  CPlayer.prototype.Chat = function(a, b) {
    var c = this.divBalloon,
      d = this.divBalloonTip;
    4 == b ? c.addClass("bg1") : c.removeClass("bg1");
    5 == b ? c.addClass("bg2") : c.removeClass("bg2");
    c.removeClass("text_anim");
    d.removeClass("text_anim");
    setTimeout(function() {
      c.html(a);
      c.addClass("text_anim");
      d.addClass("text_anim")
    }, 20)
  };
  CPlayer.prototype.Shoot = function(a, b, c) {
    this.dn.SendPlayerShoot(this.x, this.y, this.body, this.look, this.ang, a, b, c);
    a = (this.look == PLAYER_LOOK_LEFT ? 180 - this.ang : this.ang) - this.body;
    b = $("#LastAngleDigit-");
    90 < a && (a = 180 - a);
    0 > a ? (b.show(), a *= -1) : b.hide();
    $("#LastAngleDigit1").removeClass().addClass("LastAngleDigit LastAngleDigit" + Math.floor(a / 10));
    $("#LastAngleDigit2").removeClass().addClass("LastAngleDigit LastAngleDigit" + a % 10)
  };
  CPlayer.prototype.PassTurn = function(a) {
    this.dn.SendPlayerPassTurn(this.x, this.y, this.body, this.look, this.ang, a)
  };
  CPlayer.prototype.SendPosUpdate = function() {
    if (this.x != this.last_sent_x || this.y != this.last_sent_y || this.look != this.last_sent_look) this.dn.SendPlayerMove(this.x, this.y, this.body, this.look, this.ang), this.last_sent_x = this.x, this.last_sent_y = this.y, this.last_sent_look = this.look
  };
  CPlayer.prototype.UseItem = function(a) {
    this.dn.SendPlayerUseItem(a)
  };
  CPlayer.prototype.UpdateHpShieldGraphic = function() {
    var a = this.maxhp + this.maxshield,
      b = 76 * this.hp / a,
      a = 76 * this.shield / a;
    this.divHp.css({
      backgroundColor: "#63b64a",
      width: b
    });
    this.divShield.css({
      width: a,
      left: b
    })
  };
  CPlayer.prototype.UpdateAnim = function() {
    this.ani_image.UpdateAnim()
  };
  var RANK_IMG = {
      0: {
        x: 0,
        y: 723,
        f: 1
      },
      1: {
        x: 26,
        y: 723,
        f: 1
      },
      2: {
        x: 52,
        y: 723,
        f: 1
      },
      3: {
        x: 78,
        y: 723,
        f: 1
      },
      4: {
        x: 104,
        y: 723,
        f: 1
      },
      5: {
        x: 130,
        y: 723,
        f: 1
      },
      6: {
        x: 156,
        y: 723,
        f: 1
      },
      7: {
        x: 182,
        y: 723,
        f: 1
      },
      8: {
        x: 208,
        y: 723,
        f: 1
      },
      9: {
        x: 234,
        y: 723,
        f: 1
      },
      10: {
        x: 260,
        y: 723,
        f: 1
      },
      11: {
        x: 286,
        y: 723,
        f: 1
      },
      12: {
        x: 312,
        y: 723,
        f: 1
      },
      13: {
        x: 0,
        y: 739,
        f: 1
      },
      14: {
        x: 26,
        y: 739,
        f: 1
      },
      15: {
        x: 52,
        y: 739,
        f: 1
      },
      16: {
        x: 78,
        y: 739,
        f: 1
      },
      17: {
        x: 104,
        y: 739,
        f: 1
      },
      18: {
        x: 130,
        y: 739,
        f: 1
      },
      19: {
        x: 156,
        y: 739,
        f: 1
      },
      20: {
        x: 182,
        y: 739,
        f: 1
      },
      21: {
        x: 0,
        y: 0,
        f: 2
      },
      22: {
        x: 208,
        y: 739,
        f: 1
      },
      23: {
        x: 234,
        y: 739,
        f: 1
      },
      24: {
        x: 260,
        y: 739,
        f: 1
      },
      25: {
        x: 312,
        y: 739,
        f: 1
      },
      26: {
        x: 286,
        y: 739,
        f: 1
      },
      27: {
        x: 26,
        y: 0,
        f: 2
      },
      28: {
        x: 52,
        y: 0,
        f: 2
      },
      29: {
        x: 78,
        y: 0,
        f: 2
      },
      30: {
        x: 104,
        y: 0,
        f: 2
      },
      31: {
        x: 130,
        y: 0,
        f: 2
      }
    },
    g_ranks_file2 = "/static/images/ranks2.png?2",
    g_ranksImage, g_ranksImageReady, g_ranksImage2, g_ranksImageReady2;

  function createName(a, b, c, d, e, f, h) {
    h || (h = 1);
    a = document.createElement("canvas");
    a.width = 200 * h;
    a.height = 15 * h;
    var k = a.getContext("2d");
    b = 28 * h;
    var m = 2 == h ? 22 : 12;
    k.font = (2 == h ? 22 : 12) + "px verdana, arial, sans-serif";
    k.strokeStyle = "black";
    k.lineWidth = 2 == h ? 5 : 3;
    k.lineJoin = "miter";
    k.miterLimit = 1;
    d && (k.fillStyle = "A" == f ? "#f09" : "B" == f ? "#09f" : "#f85", k.strokeText(d, b, m), k.fillText(d, b, m), b += k.measureText(d).width + 3 * h);
    k.fillStyle = "A" == f ? "#FF9f6B" : "B" == f ? "#BDCFCF" : "#fff";
    k.strokeText(e, b, m);
    k.fillText(e, b, m);
    k.drawImage(g_dirty, -1, -1, 1, 1);
    c = RANK_IMG[c] || RANK_IMG[25];
    var n = c.x,
      p = c.y;
    1 == c.f ? g_ranksImageReady ? k.drawImage(g_ranksImage, n, p, 25, 15, 0, 0, 25 * h, 15 * h) : (g_ranksImage = new Image, g_ranksImage.onload = function() {
      k.drawImage(g_ranksImage, n, p, 25, 15, 0, 0, 25 * h, 15 * h);
      g_ranksImageReady = !0
    }, g_ranksImage.src = GetBackgroundImageUrl(".rank")) : g_ranksImageReady2 ? k.drawImage(g_ranksImage2, n, p, 25, 15, 0, 0, 25 * h, 15 * h) : (g_ranksImage2 = new Image, g_ranksImage2.onload = function() {
      k.drawImage(g_ranksImage2, n, p, 25, 15, 0, 0, 25 * h, 15 * h);
      g_ranksImageReady2 = !0
    }, g_ranksImage2.src = g_ranks_file2);
    2 == h && $(a).css({
      scale: 0.5,
      "transform-origin": "0 0"
    });
    return a
  }
  CPlayer.prototype.CreateDivs = function() {
    this.divHp = $("<div/>", {
      style: "position: absolute;top: 0;left: 0;height: 3px;background-color: #63b64a;width: 76px;transition: all 1.25s ease-in-out;-webkit-transition: all 1.25s ease-in-out;-moz-transition: all 1.25s ease-in-out;"
    });
    this.divShield = $("<div/>", {
      style: "position: absolute;top: 0;left: 0;height: 3px;background-color: #0000ff;width: 0;transition: all 1.25s ease-in-out;-webkit-transition: all 1.25s ease-in-out;-moz-transition: all 1.25s ease-in-out;"
    });
    this.divMobile =
      $("<div/>", {
        style: "position: absolute;background-repeat: no-repeat;"
      });
    this.ani_image = new CPlayerGraphic(this.divMobile, this.mobile, this.avatars[0], this.avatars[1], this.avatars[2], this.avatars[3], !1);
    if (this.is_me) {
      var a = $("#MyAngle");
      this.aimCircleCanvas = $('<canvas style="position: absolute;margin-left: -43px;margin-top: -43px;" width="86" height="86"/>');
      this.aimCircleContext = this.aimCircleCanvas[0].getContext("2d");
      this.myAngleContext = a[0].getContext("2d");
      this.divMobile.append(this.aimCircleCanvas);
      this.angOX = random(0, 6);
      this.angOY = random(0, 2);
      var b = random(-20, 20);
      a.css("-webkit-filter", "hue-rotate(" + b + "deg)");
      var c = this,
        a = this.aimCircleImage = new Image;
      a.onload = function() {
        c.UpdateGuiAngle();
        c.DrawPlayerAngle()
      };
      a.src = GetBackgroundImageUrl("#gameui")
    } else a = $('<canvas style="position: absolute;margin-left: -43px;margin-top: -43px;" width="86" height="86"/>'), this.divMobile.append(a);
    this.divReducedDef = $("<div/>", {
      style: "position: absolute;top: -6px;left: 30px;font-size: 11px;color: #9cffde;text-shadow: #0066ff -1px 0 1px, #0066ff 0 1px 1px, #0066ff 1px 0 1px, #0066ff 0 -1px 1px;"
    });
    this.divIon = $("<div/>", {
      style: "position: absolute;"
    });
    a = MOBILES[this.mobile];
    a.ion_file && (this.ion = new CAnimatedObject2("mobiles/" + a.ion_file + ".png", a.ion_graphics, 0, 0, this.divIon, 1, ANIMATIONS_FPS, this.flip, LOOP_NORMAL, 0, 2, OPTIONS.anim), this.SetIon(90, 0, -200));
    this.divTurn = $("<div/>", {
      "class": "Turn" + (OPTIONS.anim ? " TurnAnim" : "")
    });
    this.divBalloon = $("<div/>", {
      "class": "GamePlayerBalloon"
    });
    this.divBalloonTip = $("<div/>", {
      style: "position:absolute;left:0;bottom:70px;width:9px;height:8px;opacity:0;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIAgMAAABWoz0mAAAACVBMVEUAAAAAAAD///+D3c/SAAAAAXRSTlMAQObYZgAAAB9JREFUCNdjYMhygGPGlQwMjEsYGNgmMDBIAoVCGBgAUTUEkQydUXEAAAAASUVORK5CYII=)"
    });
    this.divName = $(createName(this.relationship_status, this.country, this.rank, this.guild, this.name, this.team, 2)).css({
      position: "absolute",
      left: -40,
      top: 17
    });
    this.divCountry = $("<div/>", {
      style: "position:absolute;left:-40px;top:16px;font-size:7px;color:white",
      "class": "blackShadow"
    }).html(this.country);
    this.divRevive = $("<div/>", {
      style: "position:absolute;left:-39px;top:13px;width:190px;font-size:12px"
    }).hide();
    this.divHpBar = $("<div/>", {
      style: "position: absolute;top: 10px;left: -40px;width: 76px;height: 3px;border: 1px solid white;background-color: #292c29;z-index: 1;"
    }).append(this.divHp).append(this.divShield);
    this.divPlayer = $("<div/>", {
      style: "position:absolute;width:160px;-webkit-transform:translate3d(0px,0px,0px);"
    }).append(this.divMobile).append(this.divName).append(this.divCountry).append(this.divRevive).append(this.divReducedDef).append(this.divHpBar).append(this.divTurn).append(this.divIon).append(this.divBalloon).append(this.divBalloonTip)
  };
  CPlayer.prototype.AddToDom = function() {
    this.isInDom || !this.is_alive && void 0 == this.revive_turn || (this.divPlayer.css({
      left: this.x,
      top: this.y
    }).insertBefore("#game_objects"), this.isInDom = !0)
  };
  CPlayer.prototype.RemoveFromDom = function() {
    this.isInDom && (this.divBalloon.removeClass("text_anim"), this.divBalloonTip.removeClass("text_anim"), this.divPlayer.remove(), this.isInDom = void 0)
  };
  CPlayer.prototype.Init = function() {
    this.CreateDivs();
    this.UpdateHpShieldGraphic();
    this.SetReducedDefence(0);
    this.ChangedShot(GetSelectedShotType());
    this.Fall();
    this.divMobile.css({
      scaleX: 1,
      scaleY: 1
    });
    this.ChangeAngleTo(this.ang, !0)
  };
  CPlayer.prototype.Remove = function() {
    this.ani_image.remove();
    this.ion && this.ion.remove();
    this.RemoveFromDom()
  };
  CPlayer.prototype.Walk = function(a) {
    this.Look(a);
    var b = this.body,
      b = this.ground.GetPosForWalking(this.x, this.y, a);
    if (b.fall_and_die || b.stuck) return !1;
    this.x = b.x;
    this.y = b.y;
    this.divPlayer.css({
      left: b.x,
      top: b.y
    });
    b = this.ground.GetAngle(b.x, b.y);
    a = this.divMobile;
    this.body != b && (this.body = b, this.UpdateGuiAngle(), 0 == a.queue("fx") ? a.css({
      rotate: this.body + "deg",
      scaleX: this.look == PLAYER_LOOK_LEFT ? 1 : -1
    }) : a.css({
      rotate: this.body + "deg"
    }));
    return !0
  };
  CPlayer.prototype.SetIon = function(a, b, c, d) {
    var e = this.divIon;
    void 0 != a && e.css({
      rotate: -a + "deg"
    });
    void 0 != b && void 0 != c && void 0 != d && e.animate({
      left: b,
      top: c
    }, d)
  };
  CPlayer.prototype.EnterView = function() {
    this.isInView = !0;
    this.AddToDom()
  };
  CPlayer.prototype.ExitView = function() {
    this.isInView = !1;
    this.RemoveFromDom()
  };
  CPlayer.prototype.OnCameraUpdate = function(a, b) {
    var c = this.x > a - 80 && this.x < a + 880 && this.y > b - 80 && this.y < b + 680;
    this.isInView && !c ? this.ExitView() : !this.isInView && c && this.EnterView()
  };
  CPlayer.prototype.Look = function(a) {
    this.look != a && (a == PLAYER_LOOK_LEFT ? this.look = PLAYER_LOOK_LEFT : a == PLAYER_LOOK_RIGHT && (this.look = PLAYER_LOOK_RIGHT), a = this.divMobile, a.stop(), a.animate({
      scaleX: this.look == PLAYER_LOOK_LEFT ? 1 : -1
    }, 300), this.UpdateGuiAngle())
  };
  CPlayer.prototype.ChangeAngleTo = function(a, b) {
    a > this.maxang && (a = this.maxang);
    a < this.minang && (a = this.minang);
    if (this.ang != a || b) this.ang = a, this.UpdateGuiAngle(), this.DrawPlayerAngle()
  };
  CPlayer.prototype.UpdateGuiAngle = function() {
    if (this.is_me) {
      var a = (this.look == PLAYER_LOOK_LEFT ? 180 - this.ang : this.ang) - this.body;
      90 < a && (a = 180 - a);
      var b = this.myAngleContext,
        c = this.aimCircleImage;
      b.clearRect(0, 0, 43, 15);
      c && (0 > a && (b.drawImage(c, 801, 154, 13, 13, 0 + this.angOX, 0 + this.angOY, 13, 13), a *= -1), b.drawImage(c, 801, 14 * Math.floor(a / 10) + 14, 13, 13, 13 + this.angOX, 0 + this.angOY, 13, 13), b.drawImage(c, 801, a % 10 * 14 + 14, 13, 13, 26 + this.angOX, 0 + this.angOY, 13, 13), b.drawImage(g_dirty, -1, -1, 1, 1))
    }
  };
  CPlayer.prototype.DrawPlayerAngle = function() {
    if (this.is_me) {
      var a = this.aimCircleContext,
        b = this.aimCircleImage;
      a.clearRect(0, 0, 86, 86);
      a.save();
      b && a.drawImage(b, 483, 116, 86, 86, 0, 0, 86, 86);
      a.translate(43, 43);
      a.beginPath();
      a.arc(0, 0, 28, AngleToRad(180 + this.minang), AngleToRad(180 + this.maxang));
      a.lineWidth = 25;
      a.strokeStyle = "rgba(0,220,0,0.5)";
      a.stroke();
      a.rotate(AngleToRad(180 + this.ang));
      b && a.drawImage(b, 526, 213, 43, 5, 0, -2, 43, 5);
      a.restore();
      a.drawImage(g_dirty, -1, -1, 1, 1)
    }
  };
  CPlayer.prototype.Fall = function() {
    if (this.is_alive) {
      var a = this.ground.GetUnder(this.x, this.y);
      if (void 0 == a) {
        debug && console.log("Player fall and die");
        this.y = 2E3;
        var b = this;
        this.divPlayer.animate({
          top: this.y
        }, 4E3, "linear", function() {
          $(b).hide()
        });
        this.is_alive = !1
      } else a != this.y && (this.y = a, this.divPlayer.animate({
        top: this.y
      }, 500)), a = this.ground.GetAngle(this.x, this.y), a != this.body && (this.body = a, this.divMobile.css("rotate", this.body + "deg"), this.UpdateGuiAngle())
    }
  };
  CPlayer.prototype.MoveTo = function(a, b, c, d, e) {
    if (this.is_alive || void 0 != this.revive_turn)
      if (void 0 != c && this.look != c && (this.look = c, this.divMobile.css("scaleX", c == PLAYER_LOOK_LEFT ? 1 : -1)), this.x = a, this.y = b, d) this.divPlayer.stop(!0).css({
        left: a,
        top: b
      }), e || this.Fall();
      else {
        var f = this;
        this.divPlayer.stop(!0).animate({
          left: a,
          top: b
        }, 1E3, function() {
          e || f.Fall()
        })
      }
  };
  CPlayer.prototype.SetGhost = function(a, b, c, d) {
    this.revive_turn = c;
    this.AddToDom();
    this.divPlayer.stop(!0).css({
      opacity: 1
    });
    this.MoveTo(a, b, void 0, void 0, !0);
    this.divHpBar.hide();
    this.aimCircleCanvas && this.aimCircleCanvas.hide();
    this.UpdateGhostTurn(d);
    this.divMobile.addClass("ghost")
  };
  CPlayer.prototype.UpdateGhostTurn = function(a) {
    void 0 == this.revive_turn ? 1 != this.divPlayer.css("opacity") && this.divPlayer.css({
      opacity: 1
    }) : (a = this.revive_turn - a, this.divName.hide(), this.divCountry.hide(), this.divRevive.html("(Return in " + a + " Turns)").css({
      color: "A" == this.team ? "#FF9f6B" : "#BDCFCF"
    }).show())
  };
  CPlayer.prototype.Revived = function(a, b, c, d, e, f) {
    delete this.revive_turn;
    this.is_alive = !0;
    this.divName.show();
    this.divCountry.show();
    this.divRevive.hide();
    this.divMobile.removeClass("ghost");
    this.divHpBar.show();
    this.aimCircleCanvas && this.aimCircleCanvas.show();
    this.ChangeHPShield(c, d, f, !1);
    this.MoveTo(a, b)
  };
  CPlayer.prototype.ChangeHPShield = function(a, b, c, d) {
    if (this.hp != a || this.shield != b) {
      void 0 == b && (b = 0);
      var e = this.hp - a + (this.shield - b);
      if (!(d && 0 >= e || (d = this.hp == a, this.hp = a, this.shield = b, a = this.maxhp + this.maxshield, b = 76 * this.hp / a, 0 < this.maxshield && this.divShield.css({
          width: 76 * this.shield / a,
          left: b
        }), new CDamageEffect(this.x - 30, this.y - 30, -e, this.player_number_in_game, c, d), 0 > this.hp && (this.is_alive = !1), d))) {
        var f = this;
        this.divHp.css({
          backgroundColor: 0.3 >= this.hp / this.maxhp ? "#c61000" : "#63b64a",
          width: b
        });
        this.is_alive || this.divPlayer.animate({
          opacity: 0
        }, 1500, function() {
          f.RemoveFromDom()
        })
      }
    }
  };
  CPlayer.prototype.ReduceHPby = function(a, b) {
    if (this.is_alive) {
      var c = this.shield,
        d = this.hp,
        c = c - a;
      0 > c && (d += c, c = 0);
      this.ChangeHPShield(d, c, b, !0)
    }
  };
  CPlayer.prototype.SetReducedDefence = function(a) {
    this.divReducedDef.html(0 == a ? "" : 0 > a ? "+" + -a + " DEF" : "-" + a + " DEF")
  };
  CPlayer.prototype.ChangeAliveTo = function(a) {
    if (!0 == this.is_alive && !1 == a) {
      debug && console.log("[CPlayer.ChangeAliveTo] player", this.name, "died");
      this.is_alive = !1;
      var b = this.divPlayer;
      b.animate({
        opacity: 0
      }, 1500, "linear", function() {
        b.hide()
      })
    }
  };
  CPlayer.prototype.ChangeMyTurn = function(a) {
    var b = this.divTurn;
    a ? OPTIONS.anim ? b.css({
      bottom: 100,
      "background-position": "-144px -159px",
      height: 29
    }).slideDown("slow") : b.css({
      bottom: 100,
      "background-position": "-144px -159px",
      height: 29
    }).show() : OPTIONS.anim ? b.stop(!0).css("height", 29).slideUp("slow").hide() : b.stop(!0).css("height", 29).hide()
  };
  CPlayer.prototype.RegenShield = function(a) {
    if (this.is_alive && !(0 >= this.shield_regen) && this.shield < this.maxshield) {
      var b = Math.min(this.shield_regen, this.maxshield - this.shield);
      this.ChangeHPShield(this.hp, this.shield + b, a, !1)
    }
  };
  CPlayer.prototype.ChangeDelay = function(a, b) {
    a != this.delay && (this.delay_before = this.delay, this.delay = a);
    this.lastturn = b
  };
  CPlayer.prototype.ChangedShot = function(a) {
    var b = this.aim[a];
    this.aimCircleCanvas && this.aimCircleCanvas.css({
      left: -b.x,
      top: b.y
    });
    this.ion && this.SetIon(void 0, 0, 1 == a ? -600 : -200, 500)
  };
  CPlayer.prototype.TeleportTo = function(a, b) {
    this.MoveTo(a, b)
  };
  DragonFreeze(CPlayer);
  var g_options_map = MAP.RANDOM,
    g_custom_map, g_max_players = 8,
    g_game_mode = GAME_MODE_NORMAL,
    g_add_bot_to_slot, RANK_FOR_DISABLE_TELE = 11,
    RANK_FOR_DISABLE_S1 = 9,
    RANK_FOR_RANDOM_TEAMS = 7;

  function RoomGUI(a) {
    function b() {
      for (var a = 0; a < c.length; a++) c[a].remove();
      c = [];
      $(".mobileSelectBtn").remove();
      $("#roomMobileSelect").slideUp("fast")
    }
    $("#roomChat").tinyscrollbar({
      size: 58
    });
    $("#roomButtonBack").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.SendRoomLeave()
    });
    $("#roomButtonReady").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      CheckBrowserAbilities(!0) && (AutoReadyStop(), a.SendRoomChangeReady(!a.myPlayerInfo.is_ready))
    });
    $("#buttonShopFromRoom").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      AutoReadyStop();
      a.SendRoomChangeReady(!1);
      SwitchToShopScreen(a)
    });
    $("#roomButtonStart").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      CheckBrowserAbilities(!0) && a.SendRoomGameStart()
    });
    $("#roomButtonChangeTeam").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.SendRoomChangeTeam("A" == a.myPlayerInfo.team ? "B" : "A")
    });
    var c = [];
    $("#roomButtonMobile").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      b();
      for (var d = $("#roomMobileSelect").slideDown("fast"), e = SELECTABLE_MOBILES, f = 0; f < e.length; f++)(function() {
        var h =
          e[f],
          k = MOBILES[h],
          m = $('<div class="mobileSelectBtn glow_button"><div class="mobileName">' + k.name + '</div><div class="Alt">' + f.toString(16).toUpperCase() + "</div>").click(function() {
            a.SendRoomChangeMobile(h);
            b()
          }).appendTo(d),
          n = k.file && -1 == k.file.indexOf("/") ? "mobiles/" + k.file + ".png" : k.file,
          k = new CAnimatedObject2(n, k.graphics, 35, 55, m, 1, ANIMATIONS_FPS, !0, LOOP_NORMAL, 0, 1, !0);
        c.push(k)
      })(), $(".Alt").is(":visible") && $(".Alt").show()
    });
    $("#roomMobileSelectCancel").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      b()
    });
    $(".playerInRoom").click(function() {
      AddToChatInput($(this).children(".roomPlayerName").html().split("</span> ").pop().replace("&amp;", "&").replace("&gt;", ">").replace("&lt;", "<"))
    });
    $("#itemDual").click(function() {
      RoomSelectItem(ITEM_DUAL)
    });
    $("#itemTeleport").click(function() {
      $(this).hasClass("grayscale") || RoomSelectItem(ITEM_TELEPORT)
    });
    $("#itemSlot0").click(function() {
      RoomRemoveItemFromSlot(0)
    });
    $("#itemSlot1").click(function() {
      RoomRemoveItemFromSlot(1)
    });
    $("#itemSlot2").click(function() {
      RoomRemoveItemFromSlot(2)
    });
    $("#itemSlot3").click(function() {
      RoomRemoveItemFromSlot(3)
    });
    $("#itemSlot4").click(function() {
      RoomRemoveItemFromSlot(4)
    });
    $("#itemSlot5").click(function() {
      RoomRemoveItemFromSlot(5)
    });
    $("#roomInput").keydown(function(b) {
      if (13 == b.which) {
        if ("" != this.value) {
          var c = this.value;
          this.value = "";
          a.SendChat(c)
        }
        b.stopPropagation()
      }
    });
    g_is_mobile_device && $("#roomInput").focus(function() {
      g_after_resize_callback = function() {
        var a = window.innerWidth / 500 / g_aspect_ratio;
        $("#roomInput").css({
          scaleX: a,
          scaleY: a,
          "margin-top": -15 *
            (a - 1)
        })
      }
    }).blur(function() {
      g_after_resize_callback = void 0;
      $("#roomInput").removeAttr("style")
    });
    $("#room_change_title_button").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.is_master ? (FadeInDialog("dialog_change_title_div"), $("#room_change_title_input").focus()) : DragonDialogOpen(l.t("Not Room Master"), l.t("Sorry, only the room master can change the room title."), 1)
    });
    $("#room_change_title_input").keydown(function(a) {
      a.which == KEY.Enter ? ($("#dialog_change_title_ok").click(), a.stopPropagation()) :
        a.which == KEY.Esc && ($("#dialog_change_title_cancel").click(), a.stopPropagation())
    });
    $("#room_options_button").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.is_master ? (FixRoomOptionsDialog(a.myPlayerInfo.rank), FadeInDialog("dialog_room_options")) : DragonDialogOpen(l.t("Not Room Master"), l.t("Sorry, only the room master can change the room options."), 1)
    });
    $("#dialog_change_title_cancel").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ExplodeDialog("dialog_change_title_div")
    });
    $("#dialog_change_title_ok").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.SendRoomChangeTitle($("#room_change_title_input").val());
      ExplodeDialog("dialog_change_title_div")
    });
    $(".roomBotSelect").click(function(b) {
      b.stopPropagation();
      $("#select_bot_div").is(":visible") ? $("#select_bot_div").slideUp(g_graphics_high ? "slow" : 0) : (AudioPlay(AUDIO_BUTTON_SELECT2), b = Number($(this).parent().attr("id")[12]), OpenBotSelectDialog(b, a))
    });
    $(".roomBotRemove").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      b.stopPropagation();
      b = Number($(this).parent().attr("id")[12]);
      a.SendSelectBot(b, -1)
    });
    $("#add_bot_button").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      b.stopPropagation();
      OpenBotSelectDialog(g_add_bot_to_slot, a)
    });
    $("body").click(function(a) {
      $("#select_bot_div").is(":visible") && $("#select_bot_div").slideUp(g_graphics_high ? "slow" : 0)
    });
    $(".roomPlayerInfo").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      InfoDialogOpenFor($(this).attr("user_id"), a);
      b.stopPropagation()
    });
    $("#infoClose").click(function(a) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ExplodeDialog("playerInfoDialog");
      a.stopPropagation()
    });
    $("#infoAddBuddy").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.SendAddFriendRequest($(this).attr("user_id"));
      b.stopPropagation()
    });
    $("#infoGuildInvite").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.SendGuildInviteRequest($(this).attr("user_id"));
      b.stopPropagation()
    });
    $("#infoChat").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ChatDialogCreate($(this).attr("user_id"), $("#infoName").html(), a);
      b.stopPropagation()
    });
    $("#room_item_buddy_tab1").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      RoomTabChangeTo(TAB_ITEMS);
      a.SendTabWatch(TAB_ITEMS)
    });
    $("#room_item_buddy_tab2").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      RoomTabChangeTo(TAB_FRIENDS);
      a.SendTabWatch(TAB_FRIENDS);
      0 == $("#friendsListHtml").children().length && a.SendRefreshFriends()
    });
    $("#room_item_buddy_tab3").click(function(b) {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      RoomTabChangeTo(TAB_GUILD);
      a.SendTabWatch(TAB_GUILD);
      0 == $("#guildMembersListHtml").children().length && a.SendRefreshGuildies()
    });
    $("#roomButtonVideoChat").click(function() {
      var b =
        a.myPlayerInfo.game_id,
        c = SERVER_TYPE.toUpperCase() + (Number(a.server) + 1) + "-" + a.myPlayerInfo.room_number;
      DragonVideoButton(b, c)
    });
    $("#roomButtonInvite").click(function() {
      var b = a.myPlayerInfo.game_id,
        c = a.server + 1,
        f = a.myPlayerInfo.room_number,
        h = a.my_room_pw || "",
        c = l.t("DragonBound Invite") + ": " + l.t("Server") + " " + c + " - " + l.t("Room") + " " + f + (h ? " - " + l.t("Password") + ": " + h : ""),
        b = b + "] " + l.t("Click here to enter my room");
      FacebookShare(location.href, "https://dragonbound.net/static/images/icon_invite.png", "www.DragonBound.net",
        c, b,
        function(a) {
          a ? alertify.success(l.t("Invitation posted") + " :)") : alertify.error(l.t("Invitation canceled") + "...")
        })
    });
    RoomOptionsDialogGUI(a);
    $("#room_auto_match_btn,#room_auto_match_btn2").click(function() {
      $("#roomButtonBack").click();
      setTimeout(function() {
        $("#buttonStart1v1").click()
      }, 1E3)
    })
  }

  function RoomTabChangeTo(a) {
    var b = $("#itemSlot0,#itemSlot1,#itemSlot2,#itemSlot3,#itemSlot4,#itemSlot5,#itemDual,#itemTeleport,#roomInfo5,#roomInfo6");
    a == TAB_ITEMS ? ($("#room_item_buddy_tab1,#room_item_buddy_tab2,#room_item_buddy_tab3").removeClass("Guild").removeClass("BuddyList"), $("#friendsList").hide(), $("#guildMembersList").hide(), $("#friendsListExtra").hide(), $("#guildRoomTabExtra").hide(), b.show()) : a == TAB_FRIENDS ? ($("#room_item_buddy_tab1,#room_item_buddy_tab2,#room_item_buddy_tab3").removeClass("Guild").addClass("BuddyList"),
      $("#friendsList").show(), $("#guildMembersList").hide(), $("#friendsListExtra").show(), $("#guildRoomTabExtra").hide(), b.hide()) : a == TAB_GUILD && ($("#room_item_buddy_tab1,#room_item_buddy_tab2,#room_item_buddy_tab3").addClass("Guild").removeClass("BuddyList"), $("#friendsList").hide(), $("#guildMembersList").show(), $("#friendsListExtra").hide(), $("#guildRoomTabExtra").show(), b.hide())
  }

  function RoomOptionsPressedOK(a) {
    var b, c;
    b = $("#RoomOptionsPlayers");
    b = b.hasClass("players1v1") ? 2 : b.hasClass("players2v2") ? 4 : b.hasClass("players3v3") ? 6 : b.hasClass("players1vB") ? 1 : b.hasClass("players2vB") ? 2 : b.hasClass("players3vB") ? 3 : b.hasClass("players4vB") ? 4 : 8;
    c = g_create_room_game_mode;
    var d = $("#RoomOptionsAvatars").html() == l.t("ON") ? 1 : 0,
      e = Number($("#RoomOptionsWind").html()),
      f = $("#RoomOptionsS1").hasClass("grayscale"),
      h = $("#RoomOptionsTele").hasClass("grayscale"),
      k = !$("#RoomOptionsRandomTeams").hasClass("grayscale");
    a.SendRoomOptions(b, c, g_options_map, d, e, g_custom_map, f, h, k)
  }

  function FixRoomOptionsDialog(a) {
    $("#RoomOptionsRandomTeamsLock, #RoomOptionsRandomTeamsRank").toggle(a < RANK_FOR_RANDOM_TEAMS);
    $("#RoomOptionsS1Lock, #RoomOptionsS1Rank").toggle(a < RANK_FOR_DISABLE_S1);
    $("#RoomOptionsTeleLock, #RoomOptionsTeleRank").toggle(a < RANK_FOR_DISABLE_TELE);
    g_create_room_game_mode == GAME_MODE_BOSS ? ($("#RoomOptionsAvatarsPrev, #RoomOptionsAvatarsNext").hide(), $("#RoomOptionsAvatars").html(l.t("ON")).css("color", "#00ff00"), $("#RoomOptionsAvatarsGP").html(""), g_options_map == MAP.CUSTOM ?
      $("#RoomOptionsMapPrev, #RoomOptionsMapNext").show() : $("#RoomOptionsMapPrev, #RoomOptionsMapNext").hide(), g_options_map != MAP.RANDOM && g_options_map != MAP.CUSTOM && RoomOptionsDialogSetMap(MAP.RANDOM), $("#RoomOptionsS1, #RoomOptionsTele").removeClass("grayscale"), $("#RoomOptionsRandomTeams").addClass("grayscale").html("[ ] Random Teams"), $("#RoomOptionsS1Lock, #RoomOptionsTeleLock, #RoomOptionsRandomTeamsLock").show()) : ($("#RoomOptionsAvatarsPrev, #RoomOptionsAvatarsNext").show(), $("#RoomOptionsMapPrev, #RoomOptionsMapNext").show())
  }

  function RoomOptionsDialogSetMap(a, b) {
    g_options_map = a;
    $("#RoomOptionsMapImage").html("").css("background-position", "0 " + GetMapImageOffset(a) + "px");
    $("#RoomOptionsMapName").html(GetMapName(a));
    $("#RoomOptionsMapLock").toggle(-1 != MAPS_PACK.indexOf(g_options_map) && !b)
  }

  function RoomOptionsDialogGUI(a) {
    $("#RoomOptionsCancel").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      g_graphics_high ? $("#dialog_room_options").effect("explode") : $("#dialog_room_options").hide()
    });
    $("#RoomOptionsOK").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      $("#RoomOptionsMapLock").is(":visible") || (RoomOptionsPressedOK(a), g_graphics_high ? $("#dialog_room_options").effect("explode") : $("#dialog_room_options").hide())
    });
    $("#RoomOptionsNumPlayersPrev").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      var a = $("#RoomOptionsPlayers"),
        c;
      c = g_create_room_game_mode == GAME_MODE_BOSS ? a.hasClass("players1vB") ? "players4vB" : a.hasClass("players2vB") ? "players1vB" : a.hasClass("players3vB") ? "players2vB" : "players3vB" : a.hasClass("players1v1") ? "players4v4" : a.hasClass("players2v2") ? "players1v1" : a.hasClass("players3v3") ? "players2v2" : "players3v3";
      a.removeClass().addClass(c)
    });
    $("#RoomOptionsNumPlayersNext").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      var a = $("#RoomOptionsPlayers"),
        c;
      c = g_create_room_game_mode == GAME_MODE_BOSS ?
        a.hasClass("players1vB") ? "players2vB" : a.hasClass("players2vB") ? "players3vB" : a.hasClass("players3vB") ? "players4vB" : "players1vB" : a.hasClass("players1v1") ? "players2v2" : a.hasClass("players2v2") ? "players3v3" : a.hasClass("players3v3") ? "players4v4" : "players1v1";
      a.removeClass().addClass(c)
    });
    $("#RoomOptionsModeNext").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      g_create_room_game_mode = (g_create_room_game_mode + 1) % GAME_MODES;
      RoomOptionsChangeMode(g_create_room_game_mode, a.myPlayerInfo.unlock, a.myPlayerInfo.rank)
    });
    $("#RoomOptionsModePrev").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      g_create_room_game_mode = (g_create_room_game_mode + GAME_MODES - 1) % GAME_MODES;
      RoomOptionsChangeMode(g_create_room_game_mode, a.myPlayerInfo.unlock, a.myPlayerInfo.rank)
    });
    $("#RoomOptionsMapPrev").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      var b;
      g_create_room_game_mode == GAME_MODE_BOSS ? (b = MAP.RANDOM, $("#RoomOptionsMapPrev, #RoomOptionsMapNext").hide()) : b = GetMapBefore(g_options_map);
      RoomOptionsDialogSetMap(b, a.myPlayerInfo.maps_pack)
    });
    $("#RoomOptionsMapNext").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      var b;
      g_create_room_game_mode == GAME_MODE_BOSS ? (b = MAP.RANDOM, $("#RoomOptionsMapPrev, #RoomOptionsMapNext").hide()) : b = GetMapAfter(g_options_map);
      RoomOptionsDialogSetMap(b, a.myPlayerInfo.maps_pack)
    });
    $("#RoomOptionsMapLockBtn").click(function() {
      GoToBuyShopItem(a, 1223, 2)
    });
    $("#RoomOptionsAvatarsPrev, #RoomOptionsAvatarsNext").click(function() {
      if (g_create_room_game_mode != GAME_MODE_BOSS) {
        AudioPlay(AUDIO_BUTTON_SELECT2);
        var a = $("#RoomOptionsAvatars");
        a.html() == l.t("OFF") ? (a.html(l.t("ON")).css("color", "#00ff00"), $("#RoomOptionsAvatarsGP").html("+10% GP")) : (a.html(l.t("OFF")).css("color", "#ff0000"), $("#RoomOptionsAvatarsGP").html(""))
      }
    });
    $("#RoomOptionsWindNext").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      var a = $("#RoomOptionsWind"),
        c = Number(a.html()),
        d;
      0 == c ? (c = 12, d = 5) : 12 == c ? (c = 26, d = 10) : 26 == c ? (c = 50, d = 15) : d = c = 0;
      a.html(c).css("color", 0 == c ? "#ff0000" : "#00ff00");
      $("#RoomOptionsWindGP").html(0 == d ? "" : "+" + d + "% GP")
    });
    $("#RoomOptionsWindPrev").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      var a = $("#RoomOptionsWind"),
        c = Number(a.html()),
        d;
      0 == c ? (c = 50, d = 15) : 50 == c ? (c = 26, d = 10) : 26 == c ? (c = 12, d = 5) : d = c = 0;
      a.html(c).css("color", 0 == c ? "#ff0000" : "#00ff00");
      $("#RoomOptionsWindGP").html(0 == d ? "" : "+" + d + "% GP")
    });
    $("#RoomOptionsTele").click(function() {
      var b = $(this);
      b.hasClass("grayscale") ? b.removeClass("grayscale") : g_create_room_game_mode != GAME_MODE_BOSS && a.myPlayerInfo.rank >= RANK_FOR_DISABLE_TELE && b.addClass("grayscale")
    });
    $("#RoomOptionsS1").click(function() {
      var b = $(this);
      b.hasClass("grayscale") ? b.removeClass("grayscale") :
        g_create_room_game_mode != GAME_MODE_BOSS && a.myPlayerInfo.rank >= RANK_FOR_DISABLE_S1 && b.addClass("grayscale")
    });
    $("#RoomOptionsRandomTeams").click(function() {
      var b = $(this);
      b.hasClass("grayscale") && g_create_room_game_mode != GAME_MODE_BOSS && a.myPlayerInfo.rank >= RANK_FOR_RANDOM_TEAMS ? b.removeClass("grayscale").html("[X] Random Teams") : b.addClass("grayscale").html("[ ] Random Teams")
    });
    DragonMapCreator()
  }

  function RoomOptionsChangeMode(a, b, c) {
    var d = $("#RoomOptionsMode"),
      e = $("#RoomOptionsPlayers"),
      f;
    a == GAME_MODE_BOSS ? f = e.hasClass("players1v1") ? "players1vB" : e.hasClass("players2v2") ? "players2vB" : e.hasClass("players3v3") ? "players3vB" : "players4vB" : (f = e.hasClass("players1v1") ? "players1v1" : e.hasClass("players2v2") ? "players2v2" : e.hasClass("players3v3") ? "players3v3" : e.hasClass("players1vB") ? "players1v1" : e.hasClass("players2vB") ? "players2v2" : e.hasClass("players3vB") ? "players3v3" : "players4v4", $("#RoomOptionsAvatars").html() ==
      l.t("ON") && $("#RoomOptionsAvatarsGP").html("+10% GP"));
    d.html(GAME_MODE_NAMES[a]).removeClass("gameMode0 gameMode1 gameMode2 gameMode3").addClass("gameMode" + a);
    e.removeClass().addClass(f);
    $("#RoomOptionsModeIcon").removeClass().addClass("iconMode" + a);
    a == GAME_MODE_NORMAL && 1 > b ? ($("#RoomOptionsModeLocked").show(), $("#RoomOptionsMessage").html(l.t("This mode is locked until you win at BOSS mode as room master.")), $("#RoomOptionsOK").hide()) : a == GAME_MODE_SAME && 12 > b ? ($("#RoomOptionsModeLocked").show(),
      $("#RoomOptionsMessage").html(l.t("This mode is locked until you win *ALL* BOSS mode levels as room master.")), $("#RoomOptionsOK").hide()) : a == GAME_MODE_SCORE && 5 > b ? ($("#RoomOptionsModeLocked").show(), $("#RoomOptionsMessage").html(l.t("This mode is locked until you win the 5 first boss levels.")), $("#RoomOptionsOK").hide()) : ($("#RoomOptionsModeLocked").hide(), $("#RoomOptionsOK").show(), b = "", a == GAME_MODE_NORMAL ? b = "Kill the other team to win." : a == GAME_MODE_BOSS ? b = "Fight computer players at increasing difficulty." :
      a == GAME_MODE_SAME ? b = "Everyone use the same mobile as the room master." : a == GAME_MODE_SCORE && (b = "Revive after you die. First team to get to 0 points lose."), $("#RoomOptionsMessage").html(l.t(b)));
    FixRoomOptionsDialog(c)
  }

  function InfoDialogOpenFor(a, b) {
    $("#infoChat").attr("user_id", a);
    $("#infoAddBuddy").attr("user_id", a);
    $("#infoGuildInvite").attr("user_id", a).hide();
    $("#infoName").html("");
    $("#infoRanking").html("");
    $("#infoGP").html("");
    $("#infoDamage").html("");
    $("#infoWinRate").html("");
    $("#infoGender").html("");
    $("#infoRank").removeClass().addClass("rank rank25");
    $("#infoRelationBtn").html("").hide();
    $("#infoGFPhotoDiv").html("");
    $("#infoImageDiv2").html("");
    $("#infoAddBuddy,#infoChat").hide();
    $("#infoRelationBonus").html("");
    $("#infoLoading").show();
    FadeInDialog("playerInfoDialog");
    b.SendGetPlayerInfo(a)
  }
  var g_info_name;

  function InfoDialogReceiveInfo(a, b) {
    b = ArrayToObject(b, "user_id game_id flowers rank gp gender photo_url damage_average win_rate win lose guild guild_job relationship_status relationship_with_id relationship_with_rank relationship_with_photo relationship_with_name relationship_with_gender is_my_friend is_my_guild_mate".split(" "));
    debug && console.log("Player Info:", b);
    $("#infoLoading").hide();
    $("#infoName").html(BuildPlayerNameWithGuild(b.guild, b.game_id));
    g_info_name = b.game_id;
    b.rank == GM_RANK ? $("#infoRanking").html("GM") :
      b.rank == PRO_GM_RANK ? $("#infoRanking").html("Pro-GM") : ($("#infoRanking").html("?"), LoadRanking(1, b.game_id, a));
    $("#infoGP").html(b.gp);
    $("#infoDamage").html(b.damage_average);
    $("#infoWinRate").html(b.win_rate);
    $("#infoGender").html(b.gender == GENDER_MALE ? l.t("Male") : l.t("Female"));
    $("#infoRank").removeClass().addClass("rank rank" + b.rank);
    $("#infoWin").html(b.win);
    $("#infoLose").html(b.lose);
    $("#infoGuild").html(b.guild ? BuildPlayerNameWithGuild(b.guild, "") : "");
    var c = "";
    b.guild && (0 == b.guild_job ? c = l.t("Member") :
      1 == b.guild_job ? c = l.t("Leader") : 2 == b.guild_job && (c = l.t("Semi-Leader")));
    $("#infoGuildJob").html(c);
    $("#infoImageDiv2").html("").append(Img2div(b.photo_url, b.gender, "infoImage", b.user_id, 124, 106));
    $("#infoGFPhotoDiv").html(BuildGFPhoto(b.relationship_status, b.relationship_with_id, b.relationship_with_photo, b.relationship_with_rank, b.relationship_with_name, b.relationship_with_gender, a.myPlayerInfo.gender));
    c = $("#infoRelationBtn");
    a.myPlayerInfo.id == b.user_id ? ("s" != b.relationship_status ? c.html('<span class="heartBrokenIcon"></span> ' +
        l.t("Break Up")).show().unbind().click(function() {
        a.SendRelationshipChange("s", b.relationship_with_id)
      }) : c.html("").hide(), "f" == b.relationship_status ? $("#infoRelationBonus").html("+10% GP & Gold " + l.t("when playing at same team")) : "e" == b.relationship_status ? $("#infoRelationBonus").html("+20% GP & Gold " + l.t("when playing at same team")) : "m" == b.relationship_status && $("#infoRelationBonus").html("+30% GP & Gold " + l.t("when playing at same team"))) : b.is_my_friend && "s" == a.myPlayerInfo.relationship_status &&
      "s" == b.relationship_status ? c.html('<span class="relationshipIcon"></span> ' + l.t("Be My " + ("m" == b.gender ? "Boyfriend?" : "Girlfriend?"))).show().unbind().click(function() {
        a.SendRelationshipChange("f", b.user_id)
      }) : "f" == a.myPlayerInfo.relationship_status && "f" == b.relationship_status && a.myPlayerInfo.relationship_with_id == b.user_id && b.relationship_with_id == a.myPlayerInfo.id ? (c.html('<span class="relationshipIconE"></span> ' + l.t("Get Engaged")).show().unbind().click(function() {
        a.SendRelationshipChange("e",
          b.user_id)
      }), $("#infoRelationBonus").html("+10% GP & Gold " + l.t("when playing at same team"))) : "e" == a.myPlayerInfo.relationship_status && "e" == b.relationship_status && a.myPlayerInfo.relationship_with_id == b.user_id && b.relationship_with_id == a.myPlayerInfo.id ? (c.html('<span class="relationshipIconM"></span> ' + l.t("Get Married")).show().unbind().click(function() {
        a.SendRelationshipChange("m", b.user_id)
      }), $("#infoRelationBonus").html("+20% GP & Gold " + l.t("when playing at same team"))) : "m" == a.myPlayerInfo.relationship_status &&
      "m" == b.relationship_status && a.myPlayerInfo.relationship_with_id == b.user_id && b.relationship_with_id == a.myPlayerInfo.id ? (c.html("").hide(), $("#infoRelationBonus").html("+30% GP & Gold " + l.t("when playing at same team"))) : "x" == b.relationship_status ? (c.html("").hide(), $("#infoRelationBonus").html(l.t("Private relationship status"))) : (c.html("").hide(), $("#infoRelationBonus").html(""));
    c = a.myPlayerInfo.id == b.user_id;
    $("#infoChat").toggle(!c && (b.is_my_friend || a.myPlayerInfo.rank == GM_RANK || a.myPlayerInfo.rank ==
      PRO_GM_RANK));
    $("#infoAddBuddy").toggle(!c && !b.is_my_friend);
    $("#infoGuildInvite").toggle(!c && (1 == a.myPlayerInfo.guild_job || 2 == a.myPlayerInfo.guild_job) && !b.is_my_guild_mate)
  }

  function BuildGFPhoto(a, b, c, d, e, f, h) {
    if (!b || "s" == a || "" == a) return "";
    d = "";
    var k;
    "f" == a ? (d = l.t(f == GENDER_MALE ? "Boyfriend" : "Girlfriend"), k = "relationshipIcon") : "e" == a ? (d = l.t(h + "Engaged to").slice(1), k = "relationshipIconE") : "m" == a && (d = l.t(h + "Married to").slice(1), k = "relationshipIconM");
    a = $("<div></div>");
    a.append(Img2div(c, f, "myPhotoImage", b, 62, 53));
    a.append($('<div class="myInfoRelText blackShadow myInfoRelText1"><span class="' + k + '"></span> ' + d + "</div>"));
    a.append($('<div class="myInfoRelText blackShadow myInfoRelText2">' +
      e + "</div></div>"));
    return a
  }

  function OpenBotSelectDialog(a, b) {
    var c = b.myPlayerInfo.unlock;
    g_bot_select_for_slot = a;
    for (var d = $("#select_bot_div"), e = "", f, h, k, m, n, p, q, r = 0; r < COMPUTER_PLAYER.length; r++) q = COMPUTER_PLAYER[r], r <= c ? (f = q.rank, h = q.name, k = q.gp, m = q.atk, n = q.def, p = q.life, q = q.dig) : (f = 25, h = "???", k = q.gp, m = n = p = q = "??"), e += '<div class="bs_line" id=' + r + '> <div class="bs_rank rank rank' + f + '"></div> <div class="bs_name">' + h + '</div> <div class="bs_gp">GP:' + k + "</div>", e += '<div class="bs_atk_icon  stat_icon stat_icon_atk"></div> <div class="bs_atk">' + m +
      '</div><div class="bs_def_icon  stat_icon stat_icon_def"></div> <div class="bs_def">' + n + '</div><div class="bs_life_icon stat_icon stat_icon_life"></div><div class="bs_life">' + p + '</div><div class="bs_dig_icon  stat_icon stat_icon_dig"></div> <div class="bs_dig">' + q + "</div></div>";
    d.html(e);
    $(".bs_line").click(function() {
      var c = $(this).attr("id");
      b.SendSelectBot(a, c);
      $("#select_bot_div").slideUp(g_graphics_high ? "slow" : 0);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    d.slideDown(g_graphics_high ? "slow" : 0)
  }

  function AutoReadyStartTimer(a) {
    CheckBrowserAbilities(!1) && (AutoReadyStop(), g_auto_ready_timer = setTimeout(function() {
      $("#roomButtonStart").is(":visible") || !1 != a.myPlayerInfo.is_ready || a.game || a.SendRoomChangeReady(!0)
    }, 15E3))
  }

  function AutoReadyStop() {
    g_auto_ready_timer = clearTimeout(g_auto_ready_timer)
  }
  var g_room_timer_interval;

  function MasterTimerTick() {
    var a = Number($("#room_timer_text").html());
    0 == a ? g_room_timer_interval = clearInterval(g_room_timer_interval) : $("#room_timer_text").html(a - 1)
  }

  function MasterTimer(a) {
    0 == a ? ($("#room_timer").fadeOut("slow"), $("#room_timer_text").html("0")) : ($("#room_timer_text").html(a), $("#room_timer").fadeIn("slow"), g_room_timer_interval = setInterval(function() {
      MasterTimerTick()
    }, 1E3))
  }
  var E_ROOM_STATE_INDEX = Object.freeze({
    room_type: 0,
    number: 1,
    title: 2,
    password: 3,
    max_players: 4,
    game_mode: 5,
    room_map: 6,
    is_avatars_on: 7,
    max_wind: 8,
    gp_rate: 9,
    minimap: 10,
    is_s1_disabled: 11,
    is_tele_disabled: 12,
    is_random_teams: 13
  });

  function RoomUpdate(a, b) {
    $("#roomNumber").html(b[E_ROOM_STATE_INDEX.number]);
    var c = b[E_ROOM_STATE_INDEX.password],
      d = b[E_ROOM_STATE_INDEX.title],
      d = text_filter(d, filtered_words);
    $("#room_change_title_input").val(UnEscapeHTML(d));
    d = TextToEmo(d);
    c && (d += " (" + c + ")");
    $("#roomTitle").html(d);
    c = b[E_ROOM_STATE_INDEX.game_mode];
    $("#room_game_mode").removeClass("gameMode0 gameMode1 gameMode2 gameMode3").addClass("gameMode" + c).html(GAME_MODE_NAMES[c]);
    g_create_room_game_mode = c;
    RoomOptionsChangeMode(c, a.myPlayerInfo.unlock,
      a.myPlayerInfo.rank);
    var e, d = b[E_ROOM_STATE_INDEX.max_players];
    c != GAME_MODE_BOSS ? (2 == d ? e = "players1v1" : 4 == d ? e = "players2v2" : 6 == d ? e = "players3v3" : 8 == d && (e = "players4v4"), g_can_change_team ? $("#roomButtonChangeTeam").show() : $("#roomButtonChangeTeam").hide(), g_max_players = d) : (1 == d ? e = "players1vB" : 2 == d ? e = "players2vB" : 3 == d ? e = "players3vB" : 4 == d && (e = "players4vB"), $("#roomButtonChangeTeam").hide(), g_max_players = 2 * d);
    c != GAME_MODE_SAME && g_can_change_mobile && $("#roomButtonMobile").show();
    g_game_mode = c;
    $("#room_players").removeClass().addClass(e);
    $("#RoomOptionsPlayers").removeClass().addClass(e);
    e = b[E_ROOM_STATE_INDEX.room_map];
    $("#room_map").html("").css("background-position", "0 " + GetMapImageOffset(e) + "px");
    RoomOptionsDialogSetMap(e, a.myPlayerInfo.maps_pack);
    d = b[E_ROOM_STATE_INDEX.is_avatars_on];
    $("#room_avatars").css("color", d ? "#00ff00" : "#ff0000").html(d ? l.t("ON") : l.t("OFF"));
    $("#RoomOptionsAvatars").css("color", d ? "#00ff00" : "#ff0000").html(d ? l.t("ON") : l.t("OFF"));
    $("#RoomOptionsAvatarsGP").html(c != GAME_MODE_BOSS && d ? "+10% GP" : "");
    c = b[E_ROOM_STATE_INDEX.max_wind];
    $("#room_wind").css("color", 0 == c ? "#ff0000" : "#00ff00").html(c);
    $("#RoomOptionsWind").css("color", 0 == c ? "#ff0000" : "#00ff00").html(c);
    c = 12 == c ? 5 : 26 == c ? 10 : 50 == c ? 15 : 0;
    $("#RoomOptionsWindGP").html(c ? "+" + c + "% GP" : "");
    c = b[E_ROOM_STATE_INDEX.gp_rate];
    $("#gp_rate").html(c + 100 + "%");
    if (e == MAP.CUSTOM) {
      g_custom_map = void 0;
      if (47 <= g_server_version) {
        c = b[E_ROOM_STATE_INDEX.minimap][0];
        e = b[E_ROOM_STATE_INDEX.minimap][1];
        var f = DragonDecompress(c),
          c = document.createElement("canvas"),
          d = document.createElement("canvas");
        c.width =
          d.width = 213;
        c.height = d.height = 49;
        var h = c.getContext("2d"),
          k = d.getContext("2d"),
          m = new Image;
        m.onload = function() {
          h.drawImage(m, 0, 0, 213, 49);
          var a = h.getImageData(0, 0, 213, 49);
          BooleanArrayToImageData(f, a);
          h.putImageData(a, 0, 0);
          k.putImageData(a, 0, 0)
        };
        m.src = e
      } else c = b[E_ROOM_STATE_INDEX.minimap], f = DragonDecompress(c), c = BooleanArrayToCanvas(f, 213, 49, 213, 49), d = BooleanArrayToCanvas(f, 213, 49, 213, 49);
      $("#room_map").html("").css({
        "background-position": "999px 999px"
      }).append(c);
      $("#RoomOptionsMapImage").html("").css({
        "background-position": "999px 999px"
      }).append(d);
      $("#RoomOptionsMapName").html("Custom")
    }
    b[E_ROOM_STATE_INDEX.is_s1_disabled] ? ($("#RoomS1Disabled").show(), $("#RoomOptionsS1").addClass("grayscale")) : ($("#RoomS1Disabled").hide(), $("#RoomOptionsS1").removeClass("grayscale"));
    b[E_ROOM_STATE_INDEX.is_tele_disabled] ? ($("#itemTeleport, #RoomOptionsTele").addClass("grayscale"), RemoveItemsOfType(ITEM_TELEPORT) && a.SendRoomChangeReady(!1)) : $("#itemTeleport, #RoomOptionsTele").removeClass("grayscale");
    b[E_ROOM_STATE_INDEX.is_random_teams] ? ($("#RoomRandomTeams").show(),
      $("#RoomOptionsRandomTeams").removeClass("grayscale").html("[X] Random Teams")) : ($("#RoomRandomTeams").hide(), $("#RoomOptionsRandomTeams").addClass("grayscale").html("[ ] Random Teams"))
  }
  var g_room_slot_graphic2 = [];

  function RoomRemoveAnimations() {
    for (var a = 0; a < g_room_slot_graphic2.length; a++) g_room_slot_graphic2[a] && g_room_slot_graphic2[a].remove();
    g_room_slot_graphic2 = []
  }

  function RoomUpdateWorthGP(a, b, c, d) {
    $("#gp_team_a").html("<u>" + l.t("Team") + " A</u><br>" + a + " GP<br>" + c + "G");
    $("#gp_team_b").html("<u>" + l.t("Team") + " B</u><br>" + b + " GP<br>" + d + "G")
  }
  var MY_AVATARS_HEAD = 0,
    MY_AVATARS_BODY = 1,
    MY_AVATARS_EYES = 2,
    MY_AVATARS_FLAG = 3,
    MY_AVATARS_BACKGROUND = 4,
    MY_AVATARS_FOREGROUND = 5,
    GP_TO_GOLD_RATE = 100,
    g_room_players_slots = [],
    g_no_winning_bonus_for = [];

  function RoomPlayerSlotsFullUpdate(a, b) {
    var c = a[0],
      d = a[1];
    g_no_winning_bonus_for = a[2];
    RoomUpdateWorthGP(c, d, c * GP_TO_GOLD_RATE, d * GP_TO_GOLD_RATE);
    g_room_players_slots = [];
    for (c = 3; c < a.length - 14; c += 15) d = a[c], g_room_players_slots[d] = {
      user_id: a[c + 1],
      game_id: a[c + 2],
      rank: a[c + 3],
      guild: a[c + 4],
      is_master: 1 == a[c + 5],
      is_ready: 1 == a[c + 6],
      gender: a[c + 7],
      mobile: a[c + 8],
      avatars: a[c + 9],
      is_bot: a[c + 10],
      power_user: a[c + 11],
      relationship_status: a[c + 12],
      team: 0 == d % 2 ? "A" : "B",
      country: a[c + 13],
      photo_url: a[c + 14]
    };
    RoomPlayerUpdateGUI(b)
  }

  function SlotUpdate(a, b) {
    var c = a[0],
      d = a[1];
    g_no_winning_bonus_for = a[2];
    RoomUpdateWorthGP(c, d, c * GP_TO_GOLD_RATE, d * GP_TO_GOLD_RATE);
    c = a[3];
    g_room_players_slots[c] = {
      user_id: a[4],
      game_id: a[5],
      rank: a[6],
      guild: a[7],
      is_master: 1 == a[8],
      is_ready: 1 == a[9],
      gender: a[10],
      mobile: a[11],
      avatars: a[12],
      is_bot: a[13],
      power_user: a[14],
      relationship_status: a[15],
      team: 0 == c % 2 ? "A" : "B",
      country: a[16],
      photo_url: a[17]
    };
    dlog("SlotUpdate", c, "=", g_room_players_slots[c]);
    RoomPlayerUpdateGUI(b)
  }

  function GetSlotFromUserID(a) {
    var b, c, d = g_room_players_slots.length;
    for (b = 0; b < d; b++)
      if ((c = g_room_players_slots[b]) && c.user_id == a) return b
  }

  function DeleteSlot(a) {
    for (; g_room_players_slots[a];) g_room_players_slots[a] = g_room_players_slots[a + 2], a += 2
  }

  function ClearSlot(a, b, c) {
    g_no_winning_bonus_for = c;
    DeleteSlot(GetSlotFromUserID(a));
    RoomPlayerUpdateGUI(b)
  }

  function PassMasterTo(a, b) {
    var c, d, e = g_room_players_slots.length;
    for (c = 0; c < e; c++)
      if (d = g_room_players_slots[c]) d.is_master = d.user_id == a;
    RoomPlayerUpdateGUI(b)
  }
  var g_can_change_team = !0,
    g_can_change_mobile = !0;

  function RoomPlayerUpdateGUI(a) {
    $("#roomButtonReady").hide();
    $("#roomButtonStart").hide();
    var b, c = 0,
      d = 0,
      e = 0,
      f = g_room_players_slots.length,
      h = !0;
    g_can_change_team = g_can_change_mobile = !1;
    8 > f && (f = 8);
    for (var k = 0; k < f; k++) {
      b = g_room_players_slots[k];
      var m = "#playerInRoom" + k,
        n = $(m),
        p = g_room_slot_graphic2[k];
      if (b) {
        0 == k % 2 ? d++ : e++;
        var q = !b.avatars[MY_AVATARS_BACKGROUND] && b.power_user ? POWER_USER_BACKGROUND : b.avatars[MY_AVATARS_BACKGROUND];
        p ? (p.change_mobile(b.mobile), p.change(b.avatars[MY_AVATARS_HEAD], AVATAR_TYPE_HEAD),
          p.change(b.avatars[MY_AVATARS_BODY], AVATAR_TYPE_BODY), p.change(b.avatars[MY_AVATARS_EYES], AVATAR_TYPE_EYES), p.change(b.avatars[MY_AVATARS_FLAG], AVATAR_TYPE_FLAG), p.change(q, AVATAR_TYPE_BACKGROUND), p.change(b.avatars[MY_AVATARS_FOREGROUND], AVATAR_TYPE_FOREGROUND)) : g_room_slot_graphic2[k] = new CPlayerGraphic(m + " .roomPlayerMobile", b.mobile, b.avatars[MY_AVATARS_HEAD], b.avatars[MY_AVATARS_BODY], b.avatars[MY_AVATARS_EYES], b.avatars[MY_AVATARS_FLAG], "A" == b.team, q, b.avatars[MY_AVATARS_FOREGROUND]);
        n.children(".roomPlayerName").html(BuildRelationRankCountryGuildName(b.relationship_status,
          b.rank, b.country, b.guild, b.game_id));
        if (b.user_id == a.user_id) {
          n.children(".roomPlayerMyself").show();
          a.is_ready = b.is_ready;
          a.team = b.team;
          a.mobile = b.mobile;
          a.is_master = b.is_master;
          g_can_change_team = g_can_change_mobile = !0;
          $("#team_search").is(":visible") || (b.is_master ? ($("#roomButtonStart").show(), $("#roomButtonReady").hide()) : ($("#roomButtonReady").show(), $("#roomButtonStart").hide()));
          $("#mobile_info").removeClass().addClass("mobile_info" + b.mobile);
          p = g_no_winning_bonus_for;
          m = !0;
          if (p && p.length)
            for (q =
              0; q < p.length; q += 2)
              if (k == p[q]) {
                k % 2 ? $("#gp_team_a").html("<u>" + l.t("Team") + " A</u><br>XXX") : $("#gp_team_b").html("<u>" + l.t("Team") + " B</u><br>XXX"); - 1 == p[q + 1] ? $("#no_win_bonus").html(b.game_id + " -> Computer Players<br><br>" + l.t("If you win you will not get winning bonus because you already won this player many times today.<br>Play for fun, play with others, or continue tomorrow.")).show() : g_room_players_slots[p[q + 1]] && $("#no_win_bonus").html(b.game_id + " -> " + g_room_players_slots[p[q + 1]].game_id + "<br><br>" +
                  l.t("If you win you will not get winning bonus because you already won this player many times today.<br>Play for fun, play with others, or continue tomorrow.")).show();
                m = !1;
                break
              }
          m && $("#no_win_bonus").html("").hide()
        } else n.children(".roomPlayerMyself").hide();
        b.is_master ? (n.children(".roomPlayerNotReady").hide(), n.children(".roomPlayerReady").hide(), n.children(".roomPlayerMaster").show()) : (n.children(".roomPlayerMaster").hide(), b.is_ready ? (n.children(".roomPlayerNotReady").hide(), n.children(".roomPlayerReady").show()) :
          (n.children(".roomPlayerNotReady").show(), n.children(".roomPlayerReady").hide(), h = !1));
        b.is_bot ? (a.is_master && n.children(".roomBotSelect").show(), n.children(".roomPlayerInfo").hide(), c++) : (n.children(".roomBotSelect").hide(), n.children(".roomPlayerInfo").attr("user_id", b.user_id).show());
        n.show()
      } else n.children(".roomPlayerBalloon, .roomPlayerBalloonTip").removeClass("text_anim"), n.children(".roomPlayerName").html(""), n.hide(), p && (p.remove(), g_room_slot_graphic2[k] = void 0)
    }
    $("#add_bot_button").hide();
    g_game_mode == GAME_MODE_BOSS && a.is_master ? 2 <= c ? ($(".roomBotRemove").show(), $(".roomBotSelect").hide()) : ($(".roomBotRemove").hide(), $(".roomBotSelect").show()) : ($(".roomBotSelect").hide(), $(".roomBotRemove").hide());
    g_game_mode != GAME_MODE_SAME || a.is_master || (g_can_change_mobile = !1);
    g_game_mode == GAME_MODE_BOSS && (g_can_change_team = !1); - 1 != g_server_force_mobile && (g_can_change_mobile = !1);
    1 == g_server_type ? (g_can_change_team = !1, $("#room_options_button").hide()) : $("#room_options_button").show();
    g_can_change_mobile ?
      $("#roomButtonMobile").show() : $("#roomButtonMobile").hide();
    g_can_change_team ? $("#roomButtonChangeTeam").show() : $("#roomButtonChangeTeam").hide();
    c = Math.max(d, Math.floor(g_max_players / 2));
    g_game_mode == GAME_MODE_BOSS ? (p = e, 4 > p && p++) : p = Math.max(e, Math.floor(g_max_players / 2));
    b = DragonTheme_Get("room_bg");
    q = (!b || "." == b) && !g_server_subtype == SERVER_SUB_TYPE_COUPLES;
    for (k = 0; k < f; k++) {
      b = g_room_players_slots[k];
      var m = "#playerInRoom" + k,
        n = $(m),
        m = 0 == k % 2 ? c : p,
        r = (q ? 257 - 48 * (Math.floor(m) - 1) : 113) + 97 * Math.floor(k / 2);
      n.css("top", r);
      n = $("#vortex" + k);
      n.css("top", r - 50);
      b ? n.hide() : (Math.floor(k / 2) < m && (0 == k % 2 || 1 != g_server_type) && OPTIONS.vortex ? n.show() : n.hide(), g_game_mode == GAME_MODE_BOSS && k == 2 * p - 1 && 0 < a.unlock && ($("#add_bot_button").css("top", r + 40).show(), g_add_bot_to_slot = k))
    }
    auto_start && a.is_master && h && g_game_mode != GAME_MODE_BOSS && (d == e && d == c || 1 == g_server_type && 4 == d && 0 == e) && (debug && console.log("Auto Start!"), $("#roomButtonStart").click());
    $("#room_auto_match_btn").toggle(g_server_subtype == SERVER_SUB_TYPE_COUPLES &&
      1 == d && 0 == e);
    $(".roomPlayerPhoto").html("");
    g_server_subtype == SERVER_SUB_TYPE_COUPLES && (g_room_players_slots[0] && $("#playerInRoom0 .roomPlayerPhoto").append(Img2div(g_room_players_slots[0].photo_url, g_room_players_slots[0].gender, "infoImageS", g_room_players_slots[0].user_id, 62, 53)), g_room_players_slots[2] && $("#playerInRoom2 .roomPlayerPhoto").append(Img2div(g_room_players_slots[2].photo_url, g_room_players_slots[2].gender, "infoImageS", g_room_players_slots[2].user_id, 62, 53)))
  }
  var g_vortex_start, g_vortex_interval;

  function VortexStart() {
    g_vortex_start = get_time();
    clearInterval(g_vortex_interval);
    OPTIONS.vortex ? g_vortex_interval = setInterval(function() {
      var a = (get_time() - g_vortex_start) / 8E3 * Math.PI;
      $(".vortex").css({
        scaleY: 0.35,
        rotate: a
      })
    }, 30) : $(".vortex").hide()
  }

  function VortexStop() {
    g_vortex_interval = clearInterval(g_vortex_interval)
  }

  function TeamSearchMsg(a, b) {
    var c = $("#team_search"),
      d = $("#roomButtonStart,#roomButtonReady");
    if (b) {
      AudioPlay(AUDIO_WAIT);
      var e = l.t("Searching for other team") + '...<div id="hourglass"></div><div id="CancelWaiting2" class="cancelwait">Cancel</div>';
      c.html(e).show();
      d.hide();
      $("#CancelWaiting2").click(function() {
        a.SendTeamSearchCancel()
      })
    } else c.html("").hide(), a && a.myPlayerInfo.is_master ? $("#roomButtonStart").show() : $("#roomButtonReady").show()
  }

  function ChangedMobile(a, b, c) {
    for (var d, e = g_room_players_slots.length, f = 0; f < e; f++) !(d = g_room_players_slots[f]) || -1 != a && d.user_id != a || (d.mobile = b, g_room_slot_graphic2[f].change_mobile(b), d.user_id == c.user_id && (c.mobile = b, $("#mobile_info").removeClass().addClass("mobile_info" + b)))
  }

  function ChangedTeam(a, b, c, d) {
    g_no_winning_bonus_for = d;
    var e, f = g_room_players_slots.length;
    for (d = 0; d < f && (!(e = g_room_players_slots[d]) || e.user_id != a); d++);
    if (!(d >= f) && d % 2 == ("A" == b)) {
      for (a = g_room_players_slots[d]; g_room_players_slots[d];) g_room_players_slots[d] = g_room_players_slots[d + 2], d += 2;
      for (d = "A" == b ? 0 : 1; g_room_players_slots[d];) d += 2;
      g_room_players_slots[d] = a;
      a.team = b;
      RoomPlayerUpdateGUI(c)
    }
  }

  function ChangedReady(a, b, c) {
    var d, e, f = g_room_players_slots.length;
    for (d = 0; d < f && (!(e = g_room_players_slots[d]) || e.user_id != a); d++);
    d != f && (e.is_ready = b, RoomPlayerUpdateGUI(c))
  }

  function CheckBrowserAbilities(a) {
    return void 0 == document.getElementById("MyAngle").getContext ? (a && DragonDialogOpen(l.t("Old Browser"), l.t("Your browser is too old.<br>It does not have required features to run the game.") + "<br><br>" + l.t('Please change to <a href="https://www.google.com/chrome/">Chrome</a> or <a href="http://www.mozilla.org/en-US/firefox/new/">Firefox</a>'), 1), !1) : !0
  }

  function RoomSelectItem(a) {
    var b = ITEM_SIZE[a],
      c;
    for (c = 0; c <= 6 - b && (g_items[c] != ITEM_NONE || 1 != b && g_items[c + 1] != ITEM_NONE); c++) g_items[c] != ITEM_NONE && 1 < ITEM_SIZE[g_items[c]] && c++;
    c <= 6 - b && (g_items[c] = a, $("#itemSlot" + c).removeClass().addClass(ITEM_CLASS[a]))
  }

  function RoomRemoveItemFromSlot(a) {
    g_items[a] != ITEM_NONE && (g_items[a] = ITEM_NONE, $("#itemSlot" + a).removeClass().addClass("itemNone"))
  }

  function GameSetItems(a) {
    for (var b = 0; b < a.length; b++) {
      var c = $("#gameItemSlot" + b);
      c.removeClass();
      a[b] != ITEM_NONE && (c.addClass("item").addClass(ITEM_CLASS[a[b]]), 2 == ITEM_SIZE[a[b]] && c.addClass("big"))
    }
  }

  function RemoveItemsOfType(a) {
    for (var b = !1, c = 0; 6 > c; c++) g_items[c] == a && (RoomRemoveItemFromSlot(c), b = !0);
    return b
  }

  function DragonMapCreator() {
    "undefined" === typeof window.FileReader ? debug && console.log("FileReader Unsupported") : $("#RoomOptionsMapImage").bind("dragenter dragover", function() {
      $(this).css("box-shadow", "yellow 0px 0px 50px 50px");
      return !1
    }).bind("dragend dragleave", function() {
      $(this).css("box-shadow", "");
      return !1
    }).bind("drop", function(a) {
      a = a.originalEvent;
      a.preventDefault();
      $(this).css("box-shadow", "");
      if (27 > g_server_version) alertify.alert("This server does not supportaps yet. Try it on Server 13 on DB-Global.");
      else {
        a = a.dataTransfer.files[0];
        var b = new FileReader;
        b.onload = function(a) {
          DragonMapCreator_GotPNG(a.target.result)
        };
        b.readAsDataURL(a);
        return !1
      }
    })
  }

  function DragonMapCreator_GotPNG(a) {
    var b = new Image;
    b.onload = function() {
      var a = b.width,
        d = b.height;
      if (400 > a || 400 > d || 2E3 < a || 2E3 < d) alertify.alert("Image size need to be: 400x400-2000x2000 (We got " + a + "x" + d + ")");
      else {
        var e = document.createElement("canvas");
        e.width = a;
        e.height = d;
        var f = e.getContext("2d");
        f.drawImage(this, 0, 0);
        var f = f.getImageData(0, 0, a, d),
          h = ImageDataToBooleanArray2(f),
          f = Math.floor(0 / a);
        0 < f && (h = h.slice(f * a), d -= f);
        f = Math.floor(0 / a);
        0 < f && (h = h.slice(0, -f * a), d -= f);
        var k = DragonCompress(h);
        if (1E5 <
          k.length) alertify.alert("File size is too big. Please decrease the file size.");
        else {
          for (var m = 0, n = 0, p = 0; p < h.length; p++) h[p] ? n++ : m++;
          h = 100 * n / (b.width * b.height);
          10 > h ? alertify.alert("This map has " + Math.floor(h) + "% ground. Please add more ground pixels. (at least 10% ground is needed)") : (m = document.createElement("canvas"), m.width = 213, m.height = 49, m.getContext("2d").drawImage(this, 0, 0, a, d, 0, 0, m.width, m.height), h = m.toDataURL("image/jpeg", 0.8), $("#RoomOptionsMapImage").html("").css({
              "background-position": "999px 999px"
            }).append(m),
            $("#RoomOptionsMapName").html("Custom"), $("#RoomOptionsMapPrev, #RoomOptionsMapNext").show(), m = Math.max(a, d, 800), g_custom_map = [a, d, m, floor((m - a) / 2), m - d - f, k, 0], a = e.toDataURL("image/jpeg", 0.7), g_custom_map.push(a), g_custom_map.push(h), g_options_map = MAP.CUSTOM, debug && (window.g_custom_map = g_custom_map))
        }
      }
    };
    b.onerror = b.onabort = function() {
      alertify.alert("Error loading image, try a different file.")
    };
    g_custom_map = void 0;
    b.src = a
  }

  function BooleanArrayToCanvas(a, b, c, d, e) {
    var f = document.createElement("canvas");
    f.width = d;
    f.height = e;
    for (var h = f.getContext("2d"), k = h.getImageData(0, 0, d, e), m = k.data, n = "string" == typeof a ? "1" : !0, p = 0; p < e; p++)
      for (var q = 0; q < d; q++) {
        var r = 4 * (p * d + q);
        m[r] = m[r + 1] = m[r + 2] = 0;
        m[r + 3] = a[Math.floor(p * c / e) * b + Math.floor(q * b / d)] == n ? 255 : 0
      }
    h.putImageData(k, 0, 0);
    return f
  }

  function base62_encode(a, b, c) {
    a = a !== +a || a % 1 ? -1 : a;
    for (b = ""; 0 <= a; a = Math.floor(a / 62) || -1) b = String.fromCharCode((9 < (c = a % 62) ? 35 < c ? 29 : 87 : 48) + c) + b;
    return b
  }

  function DragonCompress2(a) {
    var b, c = "",
      d;
    for (b = 0; b < a.length; b++) {
      d = a[b];
      if (14776336 <= d) throw Error("Number too high: " + d);
      238328 <= d ? c += "-" : 3844 <= d ? c += "+" : 62 > d && (c += "0");
      c += base62_encode(d)
    }
    return c
  }

  function DragonCompress(a) {
    var b, c = a.length,
      d = 0,
      e = [],
      f = !1;
    for (b = 0; b < c; b++) !!Number(a[b]) == f ? d++ : (e.push(d), d = 1, f = !f);
    d && e.push(d);
    return DragonCompress2(e)
  }
  var WORKER_PATH = "/static/js/recorderWorker.js";

  function Recorder(a) {
    var b, c, d, e = !1,
      f;
    b = new AudioContext;
    c = b.createMediaStreamSource(a);
    DEBUG && console.log("input sample rate", b.sampleRate);
    d = (b.createScriptProcessor || b.createJavaScriptNode).call(b, 0, 1, 1);
    var h = new Worker(WORKER_PATH);
    h.postMessage({
      command: "init",
      sampleRate: b.sampleRate
    });
    d.onaudioprocess = function(a) {
      e && h.postMessage({
        command: "record",
        buffer: a.inputBuffer.getChannelData(0)
      })
    };
    this.record = function() {
      e = !0
    };
    this.stop = function() {
      setTimeout(function() {
        e = !1;
        a.stop()
      }, 1E3)
    };
    this.exportMP3 =
      function(a) {
        f = a;
        setTimeout(function() {
          h.postMessage({
            command: "exportMP3"
          })
        }, 500)
      };
    h.onmessage = function(a) {
      f(a.data)
    };
    c.connect(d);
    d.connect(b.destination)
  }
  var RECORDER_STATUS = {
      NO_INIT: 0,
      READY_TO_RECORD: 1,
      ASKING_PERMISSION: 2,
      RECORDING: 4,
      PROCESSING: 5,
      LISTEN: 6,
      READING_FILE: 7,
      SENDING: 8
    },
    recording_status = RECORDER_STATUS.NO_INIT,
    MAX_RECORD_TIME = 1E4;

  function DragonRecorder(a) {
    DEBUG || b.hide();
    var b = $("#Mic"),
      c = $("#DragonRecorderStatus");
    if (!navigator.getUserMedia) return b.hide(), console.warn("[DragonRecorder] getUserMedia unavailable");
    c.html("");
    recording_status = RECORDER_STATUS.READY_TO_RECORD;
    b.addClass("CanClick");
    var d, e;
    b.click(function() {
      recording_status == RECORDER_STATUS.READY_TO_RECORD ? (recording_status = RECORDER_STATUS.ASKING_PERMISSION, c.html(l.t('Asking for mic, click "Allow" at address bar')), b.removeClass("CanClick"), navigator.getUserMedia({
          audio: !0
        },
        function(a) {
          d = new Recorder(a);
          d.record();
          b.addClass("recording");
          c.html(l.t("Recording") + "!");
          recording_status = RECORDER_STATUS.RECORDING;
          clearInterval(e);
          var h = get_time();
          e = setInterval(function() {
            var a = get_time() - h;
            c.html(l.t("Recording") + "! " + Math.floor(a / 100) / 10);
            a > MAX_RECORD_TIME && (b.click(), clearInterval(e))
          }, 100)
        },
        function(a) {
          "PermissionDeniedError" == a.name ? alertify.alert(l.t("No permission, please allow mic. (In Chrome click the camera icon in the address bar)")) : alertify.alert("Error " + a.name);
          console.warn("[DragonRecorder] No live audio input: ", a);
          recording_status = RECORDER_STATUS.READY_TO_RECORD;
          c.html("");
          b.addClass("CanClick")
        })) : recording_status == RECORDER_STATUS.RECORDING && (e = clearInterval(e), b.removeClass("recording"), c.html(l.t("Processing") + "..."), recording_status = RECORDER_STATUS.PROCESSING, d.stop(), d.exportMP3(function(c) {
        var d = URL.createObjectURL(c),
          e = document.createElement("audio");
        e.controls = !0;
        e.src = d;
        DEBUG && log(c, d);
        var m = $("#DragonRecorderStatus"),
          d = $('<div class="btnYes glow_button_anim" />').click(function() {
            m.html("Preparing...");
            recording_status = RECORDER_STATUS.READING_FILE;
            var d = new FileReader;
            d.onload = function(c) {
              DEBUG && log(c.target.result.length, c.target.result);
              a.SendChat(c.target.result, !1, 1);
              m.html("");
              recording_status = RECORDER_STATUS.READY_TO_RECORD;
              b.addClass("CanClick")
            };
            d.readAsDataURL(c)
          }),
          n = $('<div class="btnRetry glow_button_anim" />').click(function() {
            m.html("");
            recording_status = RECORDER_STATUS.READY_TO_RECORD;
            b.addClass("CanClick");
            b.click()
          }),
          p = $('<div class="btnNo glow_button_anim" />').click(function() {
            m.html("");
            recording_status = RECORDER_STATUS.READY_TO_RECORD;
            b.addClass("CanClick")
          });
        m.html("").append(e).append("<br>").append(d).append(n).append(p);
        recording_status = RECORDER_STATUS.LISTEN
      }))
    })
  };
  var rankings_cache = [{}, {}, {}],
    RANKING_CACHE_TIME = 3E5,
    RANKING_PAGE_SIZE = 30,
    ranks_cache, ranks_cache_expire = 0,
    g_countries = "PE-Peru;BO-Bolivia;VE-Venezuela;AR-Argentina;PH-Philippines;US-United States;CL-Chile;ES-Spain;IT-Italy;BR-Brazil;MX-Mexico;VN-Vietnam;CO-Colombia;EC-Ecuador;JP-Japan;CA-Canada;FR-France;DE-Germany;ID-Indonesia;AU-Australia;NL-Netherlands;GB-United Kingdom;SE-Sweden;PA-Panama;SV-El Salvador;SG-Singapore;UY-Uruguay;MY-Malaysia;CR-Costa Rica;IL-Israel;DO-Dominican Republic;CH-Switzerland;TN-Tunisia;SA-Saudi Arabia".split(";");

  function RankingGUI(a) {
    g_is_installed_app ? $("#ranking_panel_open,#ranking_panel,#FullScreenButton").remove() : ($(".ranking_btn").bind("mousedown mouseup", function(a) {
        a.stopPropagation()
      }), $("#ranking_btn_type1").click(function(b) {
        LoadRanking(1, 1, a);
        b.stopPropagation()
      }), $("#ranking_btn_type2").click(function(b) {
        LoadRanking(2, 1, a);
        b.stopPropagation()
      }), $("#ranking_btn_type3").click(function(b) {
        ShowFriendsRanking(a, 1);
        b.stopPropagation()
      }), $("#ranking_btn_ranks").click(function(a) {
        LoadRanks();
        a.stopPropagation()
      }),
      $("#ranking_btn_howto").click(function(a) {
        HowToPlay();
        a.stopPropagation()
      }), $("#ranking_btn_contact").click(function(a) {
        ShowContact();
        a.stopPropagation()
      }), $("#ranking_btn_terms").click(function(a) {
        ShowTerms();
        a.stopPropagation()
      }), $("#ranking_btn_privacy").click(function(a) {
        ShowPrivacy();
        a.stopPropagation()
      }), $("#ranking_panel_open").click(function(a) {
        AudioPlay(AUDIO_BUTTON_SELECT2);
        ChangeRankingsViewState();
        g_rankings_button_clicked = !0;
        a.stopPropagation()
      }))
  }

  function ShowFriendsRanking(a, b) {
    $(".ranking_btn").removeClass("selected");
    $("#ranking_btn_type3").addClass("selected");
    if (a.friends)
      if (0 == a.friends.length) $("#ranking_data").html("You have no DragonBound friends yet. Add some.");
      else {
        b > a.friends.length - RANKING_PAGE_SIZE && (b = a.friends.length - RANKING_PAGE_SIZE);
        1 > b && (b = 1);
        for (var c = [1, b], d = Math.min(a.friends.length, b - 1 + 100), e = b - 1; e < d; e++) c.push(a.friends[e].gp, a.friends[e].rank, a.friends[e].name);
        DragonRankings_BuildPage(c, 3, a, 1)
      } else $("#ranking_data").html("Unknown friends. Enter server first."),
      a.ds && a.SendRefreshFriends()
  }

  function RankingReClick() {
    $("#ranking_btn_ranks").hasClass("selected") ? LoadRanks() : $("#ranking_btn_howto").hasClass("selected") ? HowToPlay() : $("#ranking_btn_contact").hasClass("selected") && ShowContact()
  }

  function LoadRanks() {
    $(".ranking_btn").removeClass("selected");
    $("#ranking_btn_ranks").addClass("selected");
    if (!g_is_ranking_loading) {
      var a = get_time();
      if (ranks_cache && a < ranks_cache_expire) return DEBUG && console.log("from cache"), DragonRankings_BuildRanks(ranks_cache);
      g_is_ranking_loading = !0;
      DEBUG && t0();
      $.get("/ri", function(b) {
        DEBUG && t1("[DragonRankings] Ranks Query Time");
        g_is_ranking_loading = !1;
        DEBUG && console.log("Got Ranks:", b);
        4 != b.length ? console.error("Bad ranks data", b) : (ranks_cache = b, ranks_cache_expire =
          a + RANKING_CACHE_TIME, DragonRankings_BuildRanks(b))
      }, "json").error(function() {
        g_is_ranking_loading = !1;
        alertify.log("Can't load ranks, try again later")
      })
    }
  }

  function DragonRankings_BuildRanks(a) {
    var b = (new Date(a[0])).toString(),
      c = a[1],
      d = a[2];
    a = a[3];
    var b = '<div style="text-align: center; font-weight: bold;">' + l.t("Last Update") + ':</div><div style="text-align: center;">' + b + '</div><br><table width=100%><tr style="font-weight: bold;"><td><strong>Rank</strong></td><td style="text-align: center;">GP</td><td style="text-align: center;">' + l.t("Rule") + '<td style="text-align: center;">' + l.t("Players") + "</td></tr>",
      e, f, h, k, m = [24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13,
        12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 26, 27
      ];
    for (e = 0; e < m.length; e++) f = m[e], h = 24 == f ? "1" : 23 == f ? "4" : 22 == f ? "16" : 21 >= f && 12 <= f ? (a[f - 12] || 0) + "%" : 11 == f ? "100%" : "-", k = 28 == f ? "Event #1" : 29 == f ? "Event #2" : 30 == f ? "Event #3" : 31 == f ? "VIP" : 26 == f ? "Pro GM" : 27 == f ? l.t("New") + " GM" : c[f - 1] ? c[f - 1] : "-", b += '<tr><td><div class="rank rank' + f + '"></div></td><td style="text-align: center;">' + k + '</td><td style="text-align: center;">' + h + '</td><td style="text-align: center;">' + (d[f] ? d[f] : "-") + "</td></tr>";
    b += "</table>";
    $("#ranking_data").html(b)
  }

  function HowToPlay() {
    $(".ranking_btn").removeClass("selected");
    $("#ranking_btn_howto").addClass("selected");
    var a = '<div class="howto1">' + l.t("Lobby Screen") + '</div>        <div class="howto4">' + l.t("Join a game, chat or shop") + '</div>        <div class="howto3"><span class="howto2">' + l.t("Quick Play") + "</span> - " + l.t("Join to an available game room") + '.</div>        <div class="howto3"><span class="howto2">' + l.t("Create") + "</span> - " + l.t("Create your own game room") + '.</div>        <div class="howto3"><span class="howto2">' +
      l.t("Shop") + "</span> - " + l.t("Buy and use avatars (items)") + '.</div>        <div class="howto3"><span class="howto2">' + l.t("My Info") + "</span> - " + l.t("Change Name & Photo") + '.</div>        <div class="howto3"><span class="howto2">' + l.t("Options") + "</span> - " + l.t("Music / Sound / Graphics") + '.</div>        <div class="howto3"><span class="howto2">' + l.t("Rooms List") + "</span> - " + l.t('Click on a "Waiting" room to join to a game') + '.</div>        <br>        <div class="howto1">' + l.t("Room Screen") +
      '</div>        <div class="howto4">' + l.t('When all players are "Ready" the room master can start a game') + '.</div>        <div class="howto3"><span class="howto2">' + l.t("Ready Button") + "</span> - " + l.t("To ready") + '.</div>        <div class="howto3"><span class="howto2">' + l.t("Start") + "</span> - " + l.t("For room master to start a game") + '.</div>        <br>        <div class="howto1">' + l.t("Game Screen") + '</div>        <div class="howto4">' + l.t("You have to kill the other team to win. Shoot in your turn") +
      '.</div><br>        <div class="howto3"><span class="howto2">' + l.t("Up/Down") + "</span> - " + l.t("Change angle") + '.</div>        <div class="howto3"><span class="howto2">' + l.t("Left/Right") + "</span> - " + l.t("Walk (on your turn)") + '.</div>        <div class="howto3"><span class="howto2">' + l.t("Space") + "</span> - " + l.t("Shoot. Hold down for more power") + ".</div>";
    $("#ranking_data").html(a)
  }

  function LoadRanking(a, b, c, d) {
    if (1 == a || 2 == a)
      if ($(".ranking_btn").removeClass("selected"), $("#ranking_btn_type" + a).addClass("selected"), !g_is_ranking_loading) {
        isNaN(b) || (b = b - b % RANKING_PAGE_SIZE + 1);
        var e = d ? d : a;
        DEBUG && console.log("[DragonRankings] Type", a, "Country", d, "cache_key", e);
        if (rankings_cache[e] && rankings_cache[e][b] && get_time() < rankings_cache[e][b].x) DEBUG && console.log("[DragonRankings] From Cache:", e, b), DragonRankings_BuildPage(rankings_cache[e][b].d, a, c, b);
        else {
          var f = "/r" + (1 == a ? 1 : 2),
            h = {
              s: b
            };
          d && (h.c = d);
          DEBUG && console.log('[DragonRankings] Asking For: "' + b + '", Country "' + d + '"');
          DEBUG && t0();
          g_is_ranking_loading = !0;
          $.get(f, h, function(d) {
            g_is_ranking_loading = !1;
            DEBUG && t1("[DragonRankings] Rankings Query Time");
            var f = d.length;
            1 > f ? alertify.log("No ranking data received") : 1 == f && 0 == d[0] ? (DEBUG && console.log("[DragonRankings] not found"), $("#playerInfoDialog").is(":visible") || alertify.log("Player not found on rankings.")) : (f = d[1], rankings_cache[e] || (rankings_cache[e] = {}), rankings_cache[e][f] = {
              x: get_time() +
                RANKING_CACHE_TIME,
              d: d
            }, isNaN(b) && (rankings_cache[e][b] = rankings_cache[e][f]), DragonRankings_BuildPage(d, a, c, b))
          }, "json").error(function() {
            g_is_ranking_loading = !1;
            alertify.log("Error when loading rankings, try again later")
          })
        }
      }
  }

  function DragonRankings_BuildPage(a, b, c, d) {
    DEBUG && console.log("[DragonRankings_BuildPage]", a);
    var e = a.length,
      f = a[0],
      h = a[1],
      k = h,
      m = "<table>",
      n = 2,
      p, q, r, s = 3 == f,
      t = c.myPlayerInfo ? c.myPlayerInfo.game_id : "",
      w = "";
    isNaN(Number(f)) && 2 == f.length && (w = f, f = 1);
    for (; n < e;) {
      f = a[n++];
      p = a[n++];
      q = a[n++];
      r = "string" == typeof a[n] ? a[n++] : "";
      m += "<tr";
      if (q == t || q == d) m += ' class="ranking_me"';
      s && (s = !0, r = q, q = "");
      m += "><td>" + k + '</td><td><div class="rank rank' + p + '"></div></td><td><div class="ranking_name">' + BuildPlayerNameWithGuild(r,
        q) + "</div></td><td>" + f + "</td></tr>";
      q == g_info_name && $("#infoRanking").html(k);
      k++
    }
    m += "</table>";
    if (3 == b) n = '<div class="Nav"><button id="btnRPrev">&lt;-</button> ' + l.t("Friends") + ' <button id="btnRNext">-&gt;</button></div>';
    else if (1 == b) {
      a = '<option value="">World Rankings</option>';
      d = "";
      for (n = 0; n < g_countries.length; n++) d = g_countries[n].split("-")[0], a += '<option value="' + d + '"' + (d == w ? " selected" : "") + ">" + g_countries[n] + "</option>";
      n = '<div class="Nav"><select id="rankingsCountrySelect">' + a + '</select><br><button id="btnRPrev">&lt;-</button><button id="btnMe">' +
        l.t("ME") + "</button>" + l.t("Search") + ': <input id="rankingOffset" value="' + h + '"><button id="btnRNext">-&gt;</button></div>'
    } else n = '<div class="Nav"><button id="btnRPrev">&lt;-</button><button id="btnMe">' + l.t("ME") + "</button>" + l.t("Search") + ': <input id="rankingOffset" value="' + h + '"><button id="btnRNext">-&gt;</button></div>';
    $("#ranking_data").html(n + m);
    $("#btnRPrev").click(function() {
      3 == b ? ShowFriendsRanking(c, Math.max(1, h - RANKING_PAGE_SIZE)) : LoadRanking(b, Math.max(1, h - RANKING_PAGE_SIZE), c, $("#rankingsCountrySelect").val())
    });
    $("#btnRNext").click(function() {
      3 == b ? ShowFriendsRanking(c, Math.max(1, h + RANKING_PAGE_SIZE)) : LoadRanking(b, Math.max(1, k), c, $("#rankingsCountrySelect").val())
    });
    $("#rankingsCountrySelect").change(function() {
      DEBUG && console.log("country select", $("#rankingsCountrySelect").val());
      LoadRanking(b, 1, c, $("#rankingsCountrySelect").val())
    });
    3 != b && ($("#btnMe").click(function() {
      c.myPlayerInfo ? s && !c.myPlayerInfo.guild ? alertify.log("You don't have a guild. Join one.") : LoadRanking(b, s ? c.myPlayerInfo.guild : c.myPlayerInfo.game_id,
        c, $("#rankingsCountrySelect").val()) : alertify.log("Don't know who you are, enter a server.")
    }), $("#rankingOffset").bind("keyup", function(a) {
      if (13 == a.which) return LoadRanking(b, $(this).val(), c, $("#rankingsCountrySelect").val()), a.stopPropagation(), !1
    }))
  }

  function ShowContact() {
    $(".ranking_btn").removeClass("selected");
    $("#ranking_btn_contact").addClass("selected");
    var a = '<br><div class="ContactTitle">- ' + l.t("COMPANY EMAILS") + ' -</div><div class="ContactName">' + l.t("Community") + ':</div><div class="ContactFB"><a href="mailto:business@dragonbound.net">community@dragonbound.net</a></div><div class="ContactLang">(' + l.t("English / Spanish") + ')</div><br><div class="ContactName">' + l.t("Business Relations") + ':</div><div class="ContactFB"><a href="mailto:business@dragonbound.net">business@dragonbound.net</a></div><div class="ContactLang">(' +
      l.t("COMPANIES ONLY, IN ENGLISH") + ')</div><br><div class="ContactName">' + l.t("Official FB Page (new)") + ':</div><div class="ContactFB"><a href="https://www.facebook.com/dragonbound.net.game" target="_blank">facebook.com/dragonbound.net.game</a></div><iframe src="https://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fdragonbound.net.game&height=59&colorscheme=dark&show_faces=false&header=false&stream=false&show_border=false" scrolling="no" frameborder="0" allowTransparency="true" class="fbfan"></iframe><div class="ContactName">' +
      l.t("Official Announcements & Forums") + ':</div><div class="ContactFB"><a href="http://dragonbound-forums.com/forumdisplay.php?fid=11" target="_blank">dragonbound-forums.com</a></div><div class="ContactTitle">- ' + l.t("GM LIST") + " -</div>",
      b;
    b = [
      ["DN", "gm.dragonight", "English"],
      ["Zamy", "GMZamy", "Spanish, English"],
      ["Pinuna", "GameMasterPinuna", "Filipino, English"],
      ["Ash", "GMAshOficial", "Spanish, English"],
      ["Larry", "DBLarry", "Spanish"],
      ["Jhan", "GameMasterJhan", "Spanish"],
      ["Jean", "DragonBoundJean", "Spanish"],
      ["Marthin", "GM.Marthin", "Spanish, English"],
      ["MasterCadeM", "MasterCadeM", "Spanish, English"],
      ["Alex", "DB.GM.Alex", "Spanish, English"],
      ["Santa", "GMSanta", ""],
      ["Cupid", "GMCupid", ""],
      ["EasterBunny", "GMEasterBunny", ""],
      ["EasterGirl", "GMEasterGirl", ""]
    ];
    for (var c = 0; c < b.length; c++) var d = b[c][1],
      e = b[c][2],
      a = a + ('<div class="ContactName">' + b[c][0] + (e ? '<span class="ContactLang"> (' + e + ")</span>" : "") + '</div><div class="ContactFB"><a href="https://www.facebook.com/' + d + '" target="_blank">fb.com/' + d + '</a></div><iframe src="https://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2F' +
        d + '&height=59&colorscheme=dark&show_faces=false&header=false&stream=false&show_border=false" scrolling="no" frameborder="0" allowTransparency="true" class="fbfan"></iframe>');
    a += "<br><br><br><br><br><br>";
    $("#ranking_data").html(a)
  }

  function ShowTerms() {
    $(".ranking_btn").removeClass("selected");
    $("#ranking_btn_terms").addClass("selected");
    $("#ranking_data").html(" = Dragonbound Terms of Service\n\nThank you for playing Dragonbound.\n\nBy using our services, you hereby agree to our terms and conditions.\n\nDragonBound is a free to play multiplayer online game, and is solely for entertainment purposes and to offer fun to players around the world.\n\nOur web site and services provided to you on and through our web site on an AS IS basis. You agree that the owners of DragonBound exclusively reserve the right and may, at any time and without notice and any liability to you, modify or discontinue DragonBound and its services or delete the data you provide, whether temporarily or permanently. We shall have no responsibility or liability for the timeliness, deletion, failure to store, inaccuracy, or improper delivery of any data or information.\n\n = Your Account\n\nYou are responsible for your account. Please keep your password safe and we recommend not to share your personal Facebook information.  Do not trust anyone with your password.  We are not responsible for any case of compromise, theft, loss, or any other occurrence that would prevent you from using our services, DragonBound representatives will never ask you for your password.\nIf you lose access to your Facebook account, you should use Facebook's support for getting back access to your account, we cannot help you with stolen Facebook accounts.\n\n = Your Avatars\n\nIt is entirely the player's decision to buy an avatar in the shop or not, there will not be change or devolution of the acquired avatars.\nYour avatars, whether bought with gold or cash, are only valid within DragonBound.  You cannot claim ownership of avatars outside of DragonBound, nor claim compensation in any form, in case of lost avatars.\nYou agree that you have no right or title in or to any such content, including virtual in-game assets, or any other attributes or features of the Account or stored on the Service. You further agree that there are no refunds or restorations available for any intentionally or accidentally lost, misplaced, or deleted virtual assets. You also acknowledge that DragonBound may, in its sole and absolute discretion, review any virtual asset issues and make a binding decision in accordance with these terms.\n\n = Code of Conduct\n\nAlways do what is right and fair.  You are not permitted to gain unfair advantage that other users have no control over. DragonBound reserves the right to determine what constitutes \"unfair advantage\" this may be illegal GP gaining, and the use of third party programs to unbalance the fair and clean game, and will discipline users with any penalty that they deem fit, in the event of violating this policy.  You are entitled to appeal in the event that you are penalized, but DragonBound will have the final decision in any circumstance.\nRespect other players. DragonBound will not tolerate any bad behavior by players. DragonBound will discipline users with any penalty that they deem fit, in the event of violating this policy.\n\n = About Game Masters\n\nBeing a GM doesn't mean to have access to the main data of the game, each GM is responsible for their acts.\nDragonBound have chosen Game Masters of the game, The GMs are the people in the game who keep the peace and same treatment to the users inside the game, GMs will discipline users with any penalty that they deem fit, in the event of illegal playing.\n\n = Penalty/Ban\n\nPenalties will be the same in condition and criteria of the GMs who are designated to do so.\nEach GM will be responsible for their own bans, arbitrary bans are not tolerated and may lead into a destitution of their charge.\nThey will have the following options:\n1 day warning ban, no GP lose - Usually for trouble makers, insulting GM, chat spam.\n7 days ban & -25% GP  Usually for using 3rd party software that gives unfair advantage (like aimbots and auto-clickers).\n3 days ban & -50% GP  Usually for getting GP in unfair ways (like boosting and free kill games)\nPermanent Ban - Usually for payment issues, accounts involved in repeated offenses, or accounts used mainly for breaking the rules.\nEvery GM in the game is able to mute players, from 1 to 60 minutes if needed in order to keep the proper environment of the game.\nThese were general guide lines. However, DragonBound saves the right to close temporarily or permanently or punish any account for any reason that DragonBound's GM finds necessary.\n\n = User Generated Content\n\nWe are not responsible for user generated content. Some of our content may be created by users, and it may violate copyrights or trademarks. In the event that this happens, please contact us by email to the business relations address advertised in \"Contact Us\" and we will remove the content from DragonBound.\nWhen a player sends us his graphic design to be added to the game, he also agrees that he will have no claims of intellectual property / copyrights / trademark in the future for this design. The reward that he will receive for sending us his design will be considered as DragonBound paying and buying his rights to use that graphical content for unlimited time.\n\n = About Virtual Currency / Donations / Cash Chargers\n\nIt is entirely the player's decision to buy an avatar in the shop or not, as well as it is to pay real money for them, users are not forced to buy cash.\nThe real money is properly collected from users who agree to donate, cash is taken as donation to DragonBound, to server's maintenance and to keep offering our services.\nPayments made using the services of PayPal will have to be made with a Verified account status, and any kind of reversed payment will lead to a permanent ban.\nRefund Policy: There are no refunds, unless decided by the seller in special cases to make an exception and make a refund.\n\n = Third Party Services\n\nGoods and services of third parties may be advertised and/or made available on or through DragonBound. Representations made regarding products and services provided by third parties are governed by the policies and representations made by these third parties. We shall not be liable for or responsible in any manner for any of your dealings or interaction with third parties. \n\n = Limitation of Liability\n\nYOU EXPRESSLY UNDERSTAND AND AGREE THAT WE SHALL NOT BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL, INDICENTAL, CONSEQUENTIAL OR EXEMPLARY DAMAGES, INCLUDING BUT NOT LIMITED TO, DAMAGES FOR LOSS OF PROFITS, GOODWILL, USE, DATA OR OTHER INTANGIBLE LOSS (EVEN IF WE HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES), RESULTING FROM OR ARISING OUT OF (I) THE USE OF OR THE INABILITY TO USE THE SERVICE, (II) THE COST TO OBTAIN SUBSTITUTE GOODS AND/OR SERVICES RESULTING FROM ANY TRANSACTION ENTERED INTO ON THROUGH THE SERVICE, (III) UNAUTHORIZED ACCESS TO OR ALTERATION OF YOUR DATA TRANSMISSIONS, (IV) STATEMENTS OR CONDUCT OF ANY THIRD PARTY ON THE SERVICE, OR (V) ANY OTHER MATTER RELATING TO THE SERVICE. Please remember that we are not responsible for any messages posted. We do not vouch for or warrant the accuracy, completeness or usefulness of any message, and are not responsible for the contents of any message. The messages express the views of the author of the message, not necessarily the views of DragonBound. Any user who feels that a posted message is objectionable is encouraged to contact us immediately. We have the ability to remove objectionable messages and we will make every effort to do so, within a reasonable time frame, if we determine that removal is necessary. You agree, through your use of this service, that you will not use DragonBound to post any material which is knowingly false and/or defamatory, inaccurate, abusive, vulgar, hateful, harassing, obscene, profane, sexually oriented, threatening, invasive of a person's privacy, or otherwise violate of any law. You agree not to post any copyrighted material unless the copyright is owned by you or by DragonBound. If you have read, understood and agree to these rules and conditions, you may use our services. If you disagree, leave immediately.".replace(/\n/g, "<br>"))
  }

  function ShowPrivacy() {
    $(".ranking_btn").removeClass("selected");
    $("#ranking_btn_privacy").addClass("selected");
    $("#ranking_data").html(' = Privacy Policy\n\nDragonBound may require the following information from you:\n\n = Facebook Login\n\nWe are using facebook login to provide users a convenient way to play DragonBound. We do not control the facebook login process, nor do we have any record of your passwords.\n\n = Facebook Information\n\nWe may view your PUBLIC facebook profile, email and birthday for the purpose of verifying your identity.\n\nYour PUBLIC facebook profile photo and name will be used as the default in-game photo and name - You can <a href="/settings" target="_blank">change name and photo</a> in game.DragonBound will automatically gather your gender information to determine your gender in-game.\n\nWe will never share or give to 3rd party any of your private information. We will never send you any emails (unless you contacted us first).\n\nWe will not use any of your facebook information for any purpose other than those stated above.\n\n = Visit Information\n\nYour visit data is collected by Google Analytics for anonymous information purposes only.\n\n = Ads Cookies\n\nThird party vendors, including Google, use cookies to serve ads based on a user\'s prior visits to your website.\nGoogle\'s use of the DoubleClick cookie enables it and its partners to serve ads to your users based on their visit to your sites and/or other sites on the Internet.\nUsers may opt out of the use of the DoubleClick cookie for interest-based advertising by visiting <a href="http://www.google.com/ads/preferences/" target="_blank">Ads Settings</a>.\n\n = Third Party Payment Information\n\nDragonBound employs third parties to make payments more convenient for users. These companies may require personal, payment, and billing information. The information you provide these companies do not pass through DragonBound.\n\n = In-Game Information\n\nAll information and statistics transmitted in-game may be monitored, and may be used by DragonBound for whatever purpose it may deem fit.\n\n = Sharing Information\n\nDragonBound will not share your information with anyone. DragonBound will treat your information with utmost confidentiality.\n\n = Changes to the Privacy Policy\n\nDragonBound may modify, in part or entirely, its privacy policy. The most updated version will be available on the website.\n\n\n\n\n\n\n\n\n\n'.replace(/\n/g,
      "<br>"))
  }
  var RANKING_SIZE = 234,
    g_previous_w, g_previous_h, g_previous_orientation, g_aspect_ratio = 1,
    g_no_aspect_left = 0,
    g_no_aspect_top = 0,
    g_after_resize_callback, g_space_on_right_side = 0;

  function Resize(a) {
    var b = window.innerWidth,
      c = window.innerHeight;
    if (a || b != g_previous_w || c != g_previous_h) {
      g_previous_w = b;
      g_previous_h = c;
      a = g_is_show_ranking;
      var d, e, f;
      b / 800 < c / 600 ? (d = b / 800, e = 0, f = Math.floor((c - 600 * d) / 2)) : (d = c / 600, e = Math.floor((b - 800 * d) / 2), f = 0);
      a && e < RANKING_SIZE && (b -= RANKING_SIZE, b / 800 < c / 600 ? (d = b / 800, e = RANKING_SIZE, f = Math.floor((c - 600 * d) / 2)) : (d = c / 600, e = Math.floor((b + RANKING_SIZE - 800 * d) / 2), e < RANKING_SIZE && (e = RANKING_SIZE), f = 0));
      $("#container").css({
        scaleX: d,
        scaleY: d,
        left: e,
        top: f
      });
      g_dragon2d &&
        g_dragon2d.ResizeTo(e, f, d);
      g_aspect_ratio = d;
      g_no_aspect_left = e;
      g_no_aspect_top = f;
      g_space_on_right_side = Math.floor(window.innerWidth - e - 800 * d);
      $("#touch_ui").css("left", 450 + g_space_on_right_side / g_aspect_ratio);
      a ? ($("#ranking_panel").show().animate({
        left: 0
      }), $("#ranking_panel_open").animate({
        left: RANKING_SIZE
      })) : ($("#ranking_panel").animate({
        left: -RANKING_SIZE
      }, {
        done: function() {
          $("#ranking_panel").hide()
        }
      }), $("#ranking_panel_open").animate({
        left: 0
      }));
      c = $("#LoginWindow");
      a = 1;
      b = window.innerWidth;
      710 >
        b && (a = b / 710);
      c.css({
        scaleX: a,
        scaleY: a
      });
      g_after_resize_callback && g_after_resize_callback()
    }
  }

  function ResizeInit() {
    $("#Loading").remove();
    window.addEventListener("resize", Resize, !1);
    Resize();
    setTimeout(Resize, 1E3);
    setTimeout(Resize, 3E3);
    setTimeout(Resize, 8E3);
    setTimeout(Resize, 15E3)
  };
  var g_ss, g_my_avatars, g_equips_on_shop_enter, g_send_gift_to;

  function ShopGUI(a) {
    $("#shop_my_items_container").tinyscrollbar({
      size: 237
    });
    var b, c = 0;
    for (b = 0; b < AVATARS.length; b++) AVATARS[b] && (AVATARS[b][AVATAR_INDEX_SHOP] || c++, Object.freeze(AVATARS[b]));
    $("#buttonShopExit").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopClose(a)
    });
    $("#shop_item0").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(0, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(0, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item1").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(1, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(1, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item2").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(2, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(2, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item3").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(3, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(3, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item4").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(4, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(4, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item5").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(5, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(5, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item6").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(6, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(6, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item7").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(7, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(7, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#shop_item8").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(8, a.myPlayerInfo.gender)
    }).dblclick(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSelectItem(8, a.myPlayerInfo.gender, !0);
      ShopBuy(a)
    });
    $("#buttonShopTry").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopTry()
    });
    $("#buttonShopBuy").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopBuy(a)
    });
    $("#buy_cancel_btn").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopBuyCloseDialog();
      delete a.after_purchase_action
    });
    $("#buy_period_next_btn").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSetPeriod((ShopGetPeriod() + 1) % 3)
    });
    $("#buy_period_prev_btn").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopSetPeriod((ShopGetPeriod() + 2) % 3)
    });
    $("#buy_gold_btn").click(function() {
      $(this).hasClass("active") && (AudioPlay(AUDIO_BUTTON_SELECT2), ShopDoPurchase(!1, a))
    });
    $("#buy_cash_btn").click(function() {
      $(this).hasClass("active") && (AudioPlay(AUDIO_BUTTON_SELECT2), ShopDoPurchase(!0, a))
    });
    $("#buy_cash_week").click(function() {
      $(this).hasClass("buy_btn") && (AudioPlay(AUDIO_BUTTON_SELECT2), ShopDoPurchase2(!0, PERIOD_WEEK, a))
    });
    $("#buy_cash_month").click(function() {
      $(this).hasClass("buy_btn") && (AudioPlay(AUDIO_BUTTON_SELECT2),
        ShopDoPurchase2(!0, PERIOD_MONTH, a))
    });
    $("#buy_cash_perm").click(function() {
      $(this).hasClass("buy_btn") && (AudioPlay(AUDIO_BUTTON_SELECT2), ShopDoPurchase2(!0, PERIOD_PERM, a))
    });
    $("#buy_gold_week").click(function() {
      $(this).hasClass("buy_btn") && (AudioPlay(AUDIO_BUTTON_SELECT2), ShopDoPurchase2(!1, PERIOD_WEEK, a))
    });
    $("#buy_gold_month").click(function() {
      $(this).hasClass("buy_btn") && (AudioPlay(AUDIO_BUTTON_SELECT2), ShopDoPurchase2(!1, PERIOD_MONTH, a))
    });
    $("#buy_gold_perm").click(function() {
      $(this).hasClass("buy_btn") &&
        (AudioPlay(AUDIO_BUTTON_SELECT2), ShopDoPurchase2(!1, PERIOD_PERM, a))
    });
    $("#buttonShopHead").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(AVATAR_TYPE_HEAD, 0, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopBody").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(AVATAR_TYPE_BODY, 0, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopEyes").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(AVATAR_TYPE_EYES, 0, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopFlag").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(AVATAR_TYPE_FLAG, 0, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopBackground").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(AVATAR_TYPE_BACKGROUND, 0, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopForeground").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(AVATAR_TYPE_FOREGROUND, 0, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopExItem").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(AVATAR_TYPE_EXITEM, 0, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopNext").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK &&
        (g_ss = 0);
      ShopSetPage(g_current_shop_type, g_current_shop_page + 1, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#buttonShopPrev").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.myPlayerInfo.rank != PRO_GM_RANK && (g_ss = 0);
      ShopSetPage(g_current_shop_type, g_current_shop_page - 1, a.myPlayerInfo.gender, c, a.myPlayerInfo.rank)
    });
    $("#shop_delete_avatar").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ShopDeleteAvatar(a)
    });
    $("#buy_ui_chk").change(function() {
      SetClass("#buy_gold_btn, #buy_cash_btn, #buy_period_next_btn, #buy_period_prev_btn, #buy_period",
        "hide", !this.checked);
      SetClass("#buy_panel1", "hide", this.checked);
      ShopBuy(a)
    });
    var d;
    $("#shop_sort_select").change(function() {
      var b = {
        Type: function(a, b) {
          var c = "hbgf12".split(""),
            e = c.indexOf(AVATARS[a[1]][AVATAR_INDEX_TYPE]),
            c = c.indexOf(AVATARS[b[1]][AVATAR_INDEX_TYPE]);
          return e == c && d ? d(a, b) : e - c
        },
        "Gift,Cash,Gold": function(a, b) {
          return 2 * b[5] + b[4] - (2 * a[5] + a[4])
        },
        "Stat: Attack": function(a, b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_ATK] - AVATARS[a[1]][AVATAR_INDEX_STAT_ATK]
        },
        "Stat: Defense": function(a, b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_DEF] -
            AVATARS[a[1]][AVATAR_INDEX_STAT_DEF]
        },
        "Stat: Life": function(a, b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_LIFE] - AVATARS[a[1]][AVATAR_INDEX_STAT_LIFE]
        },
        "Stat: Dig": function(a, b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_DIG] - AVATARS[a[1]][AVATAR_INDEX_STAT_DIG]
        },
        "Stat: Shield": function(a, b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_SHLD] - AVATARS[a[1]][AVATAR_INDEX_STAT_SHLD]
        },
        "Stat: Speed": function(a, b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_TIME] - AVATARS[a[1]][AVATAR_INDEX_STAT_TIME]
        },
        "Stat: Item": function(a,
          b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_ITEM] - AVATARS[a[1]][AVATAR_INDEX_STAT_ITEM]
        },
        "Stat: Gold": function(a, b) {
          return AVATARS[b[1]][AVATAR_INDEX_STAT_POP] - AVATARS[a[1]][AVATAR_INDEX_STAT_POP]
        },
        Name: function(a, b) {
          return AVATARS[a[1]][AVATAR_INDEX_NAME].localeCompare(AVATARS[b[1]][AVATAR_INDEX_NAME])
        },
        "Purchase Time": function(a, b) {
          return a[0] - b[0]
        }
      }[$("#shop_sort_select").val()];
      g_my_avatars && ShopSetMyItems2(g_my_avatars, a.myPlayerInfo.gender, b);
      d = b
    })
  }

  function ShopEntered(a) {
    g_equips_on_shop_enter = void 0;
    $("#buttonShopHead").click();
    $("#shop_sort_select").val("Purchase Time");
    ShopSetMyItems(a);
    g_shop_player || (g_shop_player = new CPlayerGraphic("#shop_player", -1, a.myPlayerInfo.head, a.myPlayerInfo.body, a.myPlayerInfo.eyes, a.myPlayerInfo.flag, !0));
    ShopUpdateMyStats()
  }

  function ShopDeleteAvatar(a) {
    var b = $(".shop_my_item.selected");
    if (0 == b.length) return DragonDialogOpen(l.t("Delete Avatar"), l.t("Select an avatar to delete"), DIALOG_BUTTONS_OK);
    var c = b.children(".shop_my_item_name").text(),
      d = Number(b.attr("avatar_id"));
    DragonDialogOpen(l.t("Delete Avatar"), l.t("Are you sure you want to delete avatar") + " <font color=yellow>" + c + "</font> ?", DIALOG_BUTTONS_OK_CANCEL, function(b) {
      b && a.SendDeleteAvatar(d)
    })
  }

  function ShopSetMyItems(a) {
    a.SendGetMyAvatars()
  }

  function ShopSetMyItems2(a, b, c) {
    for (var d = 0; d < a.length; d++) {
      var e = a[d],
        f = e[1],
        h = AVATARS[f];
      void 0 == h && (DEBUG && console.log("*** ERROR: Unknown avatar:", e), a.splice(d, 1), d--)
    }
    g_my_avatars = a;
    var k = "",
      m = "pop time atk def life item dig shld".split(" "),
      n = [AVATAR_INDEX_STAT_POP, AVATAR_INDEX_STAT_TIME, AVATAR_INDEX_STAT_ATK, AVATAR_INDEX_STAT_DEF, AVATAR_INDEX_STAT_LIFE, AVATAR_INDEX_STAT_ITEM, AVATAR_INDEX_STAT_DIG, AVATAR_INDEX_STAT_SHLD],
      p = !1;
    ShopWearEquippedItems(b);
    c && a.sort(c);
    c = {};
    for (d = 0; d < a.length; d++) {
      var e =
        a[d],
        q = e[0],
        f = e[1],
        r = e[2],
        s = e[3],
        t = e[4],
        w = e[5],
        v = e[6],
        h = AVATARS[f];
      if (void 0 == h) DEBUG && console.log("*** ERROR: Unknown avatar:", e);
      else {
        var e = h[AVATAR_INDEX_TYPE],
          u = h[AVATAR_INDEX_GENDER],
          x = h[AVATAR_INDEX_NAME],
          y = void 0;
        if (s)
          if (y = new Date(s) - new Date, y >= MS_IN_1_DAY) y = Math.floor(y / MS_IN_1_DAY) + 1 + " Days";
          else if (0 < y) y = Math.floor(y / MS_IN_1_HOUR) + 1 + " Hours";
        else continue;
        void 0 != v && (x = x + ' <span class="blackShadow" style="color:yellow">[' + v + "]</span>");
        k += '<div id="shop_my_item' + d + '" class="shop_my_item" i="' +
          d + '" gender="' + b + '" avatar_id="' + q + '" avatar_number="' + f + '" avatar_type="' + e + '">';
        s || (c[f] = 1);
        w ? k += '<div class="shop_my_item_gift"></div>' : t && (k += '<div class="shop_my_item_cash"></div>');
        k += '<div class="shop_my_item_icon shop_item_icon_' + e + u + '"></div><div class="shop_my_item_name">' + x + (y ? " (" + y + ")" : "") + '</div><div class="shop_my_item_equip' + (r ? " equipped" : "") + ' "></div>';
        for (s = q = 0; s < m.length; s++) t = n[s], w = m[s], h[t] && (k += '<div class="shop_my_item_stat shop_my_item_stat' + q + '"> <div class="stat_icon stat_icon_' +
          (0 < h[t] ? w : w + "-") + '"></div> <div class="stat_digit1 stat_font stat_font' + Math.floor(Math.abs(h[t] / 10)) + '"></div> <div class="stat_digit2 stat_font stat_font' + Math.abs(h[t] % 10) + '"></div> </div>', q++);
        k += "</div>";
        r && g_shop_player && g_shop_player.change(f);
        9E3 == h[AVATAR_INDEX_N] && (p = !0)
      }
    }
    p && !g_shop_player.background && g_shop_player.change(POWER_USER_BACKGROUND);
    $("#shop_my_items").html(k);
    $(".shop_my_item").on("mousedown", function(a) {
      a = $(this);
      ShopSelectMyItem(a.attr("i"), a.attr("gender"))
    });
    $("#shop_my_items_container").tinyscrollbar_update();
    d = a.length.toString().split("");
    for (a = 0; 4 > a; a++) $("#shop_my_items_number .digit" + a).removeClass().addClass("digit" + a + (a < d.length ? " stat_font stat_font" + d[a] : ""));
    ShopUpdateMyStats();
    h = f = a = 0;
    for (d = 5; d < AVATARS.length; d++) !AVATARS[d] || 4 == AVATARS[d][AVATAR_INDEX_NOTE] || 6 == AVATARS[d][AVATAR_INDEX_NOTE] || AVATARS[d][AVATAR_INDEX_TYPE] == AVATAR_TYPE_EXITEM || 3 != AVATARS[d][AVATAR_INDEX_NOTE] && 0 == AVATARS[d][AVATAR_INDEX_GOLD_PERM] && 0 == AVATARS[d][AVATAR_INDEX_CASH_PERM] || AVATARS[d][AVATAR_INDEX_GENDER] != GENDER_ALL &&
      AVATARS[d][AVATAR_INDEX_GENDER] != b && AVATARS[d][AVATAR_INDEX_TYPE] != AVATAR_TYPE_FLAG && AVATARS[d][AVATAR_INDEX_TYPE] != AVATAR_TYPE_BACKGROUND && AVATARS[d][AVATAR_INDEX_TYPE] != AVATAR_TYPE_FOREGROUND || (a++, AVATARS[d][AVATAR_INDEX_SHOP] && f++, c[d] && h++);
    b = a ? (h / a * 100).toFixed(2) : 100;
    $("#shop_my_items_stats").html(l.t("Avatars Collection") + ": " + b + "%");
    g_equips_on_shop_enter || (g_equips_on_shop_enter = GetEquipped())
  }

  function ShopSetMyGoldCash(a, b) {
    $("#shop_my_cash").html(Commatize(b) + " Cash");
    $("#shop_my_gold").html(Commatize(a) + " Gold")
  }

  function ShopSelectMyItem(a, b) {
    if ($("#shop_my_item" + a).hasClass("selected")) {
      $("#shop_my_item" + a).attr("avatar_id");
      $("#shop_my_item" + a).attr("avatar_number");
      var c = $("#shop_my_item" + a).attr("avatar_type");
      c != AVATAR_TYPE_EXITEM && ($("#shop_my_item" + a + " .shop_my_item_equip").hasClass("equipped") ? $("#shop_my_item" + a + " .shop_my_item_equip").removeClass("equipped") : ($(".shop_my_item_equip.equipped").each(function() {
        $(this).parent().attr("avatar_type") == c && $(this).removeClass("equipped")
      }), $("#shop_my_item" +
        a + " .shop_my_item_equip").addClass("equipped")), ShopWearEquippedItems(b))
    } else $(".shop_my_item").removeClass("selected"), $(".shop_my_item .shop_my_item_name").removeClass("blackShadow"), $(".shop_my_item .shop_my_item_cash").removeClass("selected"), $(".shop_my_item .shop_my_item_gift").removeClass("selected"), $("#shop_my_item" + a).addClass("selected"), $("#shop_my_item" + a + " .shop_my_item_name").addClass("blackShadow"), $("#shop_my_item" + a + " .shop_my_item_cash").addClass("selected"), $("#shop_my_item" +
      a + " .shop_my_item_gift").addClass("selected")
  }

  function ShopSetPage(a, b, c, d, e) {
    var f = [],
      h, k = 0;
    for (h = AVATARS.length - 1; 0 <= h; h--) AVATARS[h] && (AVATARS[h][AVATAR_INDEX_SHOP] || g_ss) && AVATARS[h][AVATAR_INDEX_TYPE] == a && f.push(h), AVATARS[h] && !AVATARS[h][AVATAR_INDEX_SHOP] && k++;
    k != d && (f = []);
    h = Math.floor((f.length + 9 - 1) / 9);
    0 == h ? b = 0 : (0 > b && (b += h), b %= h);
    f.sort(function(b, d) {
      if (a != AVATAR_TYPE_FLAG && a != AVATAR_TYPE_BACKGROUND && a != AVATAR_TYPE_FOREGROUND && a != AVATAR_TYPE_EXITEM) {
        var e = AVATARS[b][AVATAR_INDEX_GENDER],
          f = AVATARS[d][AVATAR_INDEX_GENDER];
        if (e != f) {
          if (e !=
            c && e != GENDER_ALL) return 1;
          if (f != c && f != GENDER_ALL) return -1
        }
      }
      e = AVATARS[b][AVATAR_INDEX_NOTE] || 0;
      f = AVATARS[d][AVATAR_INDEX_NOTE] || 0;
      if (e == f) return 5 == e || 1 == e ? b - d : d - b;
      if (1 == e || 2 == e) e += 10;
      if (1 == f || 2 == f) f += 10;
      return f - e
    });
    f = f.slice(9 * b, 9 * (b + 1));
    g_current_shop_type = a;
    g_current_shop_page = b;
    b = "pop time atk def life item dig shld".split(" ");
    d = [AVATAR_INDEX_STAT_POP, AVATAR_INDEX_STAT_TIME, AVATAR_INDEX_STAT_ATK, AVATAR_INDEX_STAT_DEF, AVATAR_INDEX_STAT_LIFE, AVATAR_INDEX_STAT_ITEM, AVATAR_INDEX_STAT_DIG, AVATAR_INDEX_STAT_SHLD];
    var m;
    for (h = 0; h < f.length; h++) {
      var n = f[h],
        k = AVATARS[n],
        p = k[AVATAR_INDEX_N],
        q = k[AVATAR_INDEX_TYPE],
        r = k[AVATAR_INDEX_GENDER];
      m = k[AVATAR_INDEX_URL] ? k[AVATAR_INDEX_URL] : q == AVATAR_TYPE_BACKGROUND ? STATIC_DIR + "images/ava/b20" + p + ".png" : q == AVATAR_TYPE_FOREGROUND ? STATIC_DIR + "images/ava/f20" + p + ".png" : STATIC_DIR + "images/ava/" + r + q + (p + 1E5).toString().substring(1) + ".png";
      $("#shop_item" + h + " .shop_item_icon").removeClass().addClass("shop_item_icon shop_item_icon_" + q + r);
      $("#shop_item" + h + " .shop_item_name").html(k[AVATAR_INDEX_NAME]);
      k[AVATAR_INDEX_GRAPHICS] && k[AVATAR_INDEX_GRAPHICS][0] && (void 0 != k[AVATAR_INDEX_GRAPHICS][1] ? $("#shop_item" + h + " .shop_item_image").css({
        background: "url(" + m + ") no-repeat -" + (k[AVATAR_INDEX_GRAPHICS][0][0] + 1) + "px 0",
        width: k[AVATAR_INDEX_GRAPHICS][1][0],
        height: k[AVATAR_INDEX_GRAPHICS][1][1],
        left: (158 - k[AVATAR_INDEX_GRAPHICS][1][0]) / 2
      }) : $("#shop_item" + h + " .shop_item_image").css({
        background: "url(" + m + ") no-repeat 0 0",
        width: k[AVATAR_INDEX_GRAPHICS][0][0],
        height: k[AVATAR_INDEX_GRAPHICS][0][1],
        left: (158 - k[AVATAR_INDEX_GRAPHICS][0][0]) /
          2
      }));
      m = k[AVATAR_INDEX_GOLD_WEEK] ? k[AVATAR_INDEX_GOLD_WEEK] : k[AVATAR_INDEX_GOLD_MONTH] ? k[AVATAR_INDEX_GOLD_MONTH] : k[AVATAR_INDEX_GOLD_PERM] ? k[AVATAR_INDEX_GOLD_PERM] : 0;
      q = k[AVATAR_INDEX_CASH_WEEK] ? k[AVATAR_INDEX_CASH_WEEK] : k[AVATAR_INDEX_CASH_MONTH] ? k[AVATAR_INDEX_CASH_MONTH] : k[AVATAR_INDEX_CASH_PERM] ? k[AVATAR_INDEX_CASH_PERM] : 0;
      $("#shop_item" + h + " .shop_item_cash").html(q ? Commatize(q) + " Cash" : "");
      $("#shop_item" + h + " .shop_item_gold").html(m ? Commatize(m) + " Gold" : "");
      $("#shop_item" + h).show();
      $("#shop_item" +
        h).attr("avatar_index", n);
      void 0 != ITEMS_RANK_LIMIT[p] && e < ITEMS_RANK_LIMIT[p] && (log("rank limit", ITEMS_RANK_LIMIT[p]), $("#shop_item" + h + " .shop_item_cash").html(l.t("Required Level") + ' <span class="span_rank rank rank' + ITEMS_RANK_LIMIT[p] + '"></span>+'), $("#shop_item" + h + " .shop_item_gold").html(""));
      for (p = n = 0; p < b.length; p++) m = d[p], q = b[p], k[m] && ($("#shop_item" + h + " .shop_item_stat" + n + " .stat_icon").removeClass().addClass("stat_icon stat_icon_" + (0 < k[m] ? q : q + "-")).show(), $("#shop_item" + h + " .shop_item_stat" +
        n + " .stat_digit1").removeClass().addClass("stat_digit1 stat_font stat_font" + Math.floor(Math.abs(k[m] / 10))).show(), $("#shop_item" + h + " .shop_item_stat" + n + " .stat_digit2").removeClass().addClass("stat_digit2 stat_font stat_font" + Math.abs(k[m] % 10)).show(), n++);
      for (; 8 > n; n++) $("#shop_item" + h + " .shop_item_stat" + n + " .stat_icon").hide(), $("#shop_item" + h + " .shop_item_stat" + n + " .stat_digit1").hide(), $("#shop_item" + h + " .shop_item_stat" + n + " .stat_digit2").hide();
      (k = ["", "NEW", "ON<br>SALE", "Special<br>Gift", "GM<br>Only",
        l.t("Until") + "<br>Jun.20", "Custom", "GM<br>Gift"
      ][k[AVATAR_INDEX_NOTE]] || "") && (k = l.t(k));
      n = $("#shop_item" + h + " .shop_item_note .shot_item_note_text");
      p = $("#shop_item" + h + " .shop_item_note");
      n.html(k);
      k ? p.show() : p.hide(); - 1 != k.indexOf("<br>") ? n.addClass("shot_item_note_text2") : n.removeClass("shot_item_note_text2")
    }
    for (; 9 > h; h++) $("#shop_item" + h).hide();
    e = ShopGetSelected();
    $("#shop_item" + e).removeClass("selected")
  }

  function ShopWearEquippedItems(a) {
    var b = !0,
      c = !0,
      d = !0,
      e = !0,
      f = !0,
      h = !0;
    $(".shop_my_item_equip.equipped").parent().each(function(a) {
      g_shop_player && g_shop_player.change($(this).attr("avatar_number"));
      $(this).attr("avatar_type") == AVATAR_TYPE_HEAD ? b = !1 : $(this).attr("avatar_type") == AVATAR_TYPE_BODY ? c = !1 : $(this).attr("avatar_type") == AVATAR_TYPE_EYES ? d = !1 : $(this).attr("avatar_type") == AVATAR_TYPE_FLAG ? e = !1 : $(this).attr("avatar_type") == AVATAR_TYPE_BACKGROUND ? f = !1 : $(this).attr("avatar_type") == AVATAR_TYPE_FOREGROUND &&
        (h = !1)
    });
    $(".shop_my_item").each(function(a) {
      $(this).attr("avatar_number") == POWER_USER_EXITEM && f && (f = !1, g_shop_player && g_shop_player.change(POWER_USER_BACKGROUND))
    });
    g_shop_player && (b && g_shop_player.change(a == GENDER_MALE ? AVATAR_NAKED_HEAD_MALE : AVATAR_NAKED_HEAD_FEMALE), c && g_shop_player.change(a == GENDER_MALE ? AVATAR_NAKED_BODY_MALE : AVATAR_NAKED_BODY_FEMALE), d && g_shop_player.change(void 0, AVATAR_TYPE_EYES), e && g_shop_player.change(void 0, AVATAR_TYPE_FLAG), f && g_shop_player.change(void 0, AVATAR_TYPE_BACKGROUND),
      h && g_shop_player.change(void 0, AVATAR_TYPE_FOREGROUND));
    ShopUpdateMyStats()
  }

  function ShopSelectItem(a, b, c) {
    var d = ShopGetSelected();
    d != a || c ? ($("#shop_item" + d).removeClass("selected"), $("#shop_item" + a).addClass("selected"), ShopTry()) : ($("#shop_item" + d).removeClass("selected"), ShopWearEquippedItems(b))
  }

  function ShopGetSelected() {
    for (var a = 0; 9 > a; a++)
      if ($("#shop_item" + a).hasClass("selected")) return a
  }

  function ShopTry() {
    var a = ShopGetSelected();
    void 0 != a && (a = $("#shop_item" + a).attr("avatar_index"), 9E3 != AVATARS[a][0] || g_shop_player.background || (a = POWER_USER_BACKGROUND), g_shop_player.change(a), ShopUpdateMyStats())
  }

  function ShopBuy(a, b) {
    if (!b) {
      delete a.after_purchase_action;
      var c = ShopGetSelected();
      if (void 0 == c) return;
      2 > a.user_rank ? $("#buttonChargeShop, #buttonChargeShop1, #buy_panel2").hide() : $("#buttonChargeShop, #buttonChargeShop1, #buy_panel2").show();
      b = Number($("#shop_item" + c).attr("avatar_index"))
    }
    var c = AVATARS[b],
      d = c[AVATAR_INDEX_N],
      e = c[AVATAR_INDEX_TYPE],
      f = c[AVATAR_INDEX_GENDER],
      h = c[AVATAR_INDEX_NAME],
      k;
    k = c[AVATAR_INDEX_URL] ? c[AVATAR_INDEX_URL] : e == AVATAR_TYPE_BACKGROUND ? STATIC_DIR + "images/ava/b20" + d +
      ".png" : e == AVATAR_TYPE_FOREGROUND ? STATIC_DIR + "images/ava/f20" + d + ".png" : STATIC_DIR + "images/ava/" + f + e + (d + 1E5).toString().substring(1) + ".png";
    if (void 0 != ITEMS_RANK_LIMIT[d] && a.myPlayerInfo.rank < ITEMS_RANK_LIMIT[d]) return DragonDialogOpen(l.t("Sorry"), l.t("You have to be at least rank") + ' <span class="span_rank rank rank' + ITEMS_RANK_LIMIT[d] + '"></span> ' + l.t("to buy this item."), DIALOG_BUTTONS_OK);
    $("#shop_buy_dialog .shop_item_icon").removeClass().addClass("shop_item_icon shop_item_icon_" + e + f);
    $("#shop_buy_dialog .shop_item_name").html(h);
    c[AVATAR_INDEX_GRAPHICS] && c[AVATAR_INDEX_GRAPHICS][0] && (void 0 != c[AVATAR_INDEX_GRAPHICS][1] ? $("#shop_buy_dialog .shop_item_image").css({
      background: "url(" + k + ") no-repeat -" + (c[AVATAR_INDEX_GRAPHICS][0][0] + 1) + "px 0",
      width: c[AVATAR_INDEX_GRAPHICS][1][0],
      height: c[AVATAR_INDEX_GRAPHICS][1][1],
      left: 156 + (158 - c[AVATAR_INDEX_GRAPHICS][1][0]) / 2
    }) : $("#shop_buy_dialog .shop_item_image").css({
      background: "url(" + k + ") no-repeat 0 0",
      width: c[AVATAR_INDEX_GRAPHICS][0][0],
      height: c[AVATAR_INDEX_GRAPHICS][0][1],
      left: 156 +
        (158 - c[AVATAR_INDEX_GRAPHICS][0][0]) / 2
    }));
    e = l.t("Can't Buy");
    $("#buy_cash_week .Text").html(0 < c[AVATAR_INDEX_CASH_WEEK] ? Commatize(c[AVATAR_INDEX_CASH_WEEK]) : e);
    $("#buy_cash_month .Text").html(0 < c[AVATAR_INDEX_CASH_MONTH] ? Commatize(c[AVATAR_INDEX_CASH_MONTH]) : e);
    $("#buy_cash_perm .Text").html(0 < c[AVATAR_INDEX_CASH_PERM] ? Commatize(c[AVATAR_INDEX_CASH_PERM]) : e);
    $("#buy_gold_week .Text").html(0 < c[AVATAR_INDEX_GOLD_WEEK] ? Commatize(c[AVATAR_INDEX_GOLD_WEEK]) : e);
    $("#buy_gold_month .Text").html(0 < c[AVATAR_INDEX_GOLD_MONTH] ?
      Commatize(c[AVATAR_INDEX_GOLD_MONTH]) : e);
    $("#buy_gold_perm .Text").html(0 < c[AVATAR_INDEX_GOLD_PERM] ? Commatize(c[AVATAR_INDEX_GOLD_PERM]) : e);
    $("#buy_ui_chk").is(":checked") ? SetClass(".buy_btn", "buy_btn glow_button", !1) : (SetClass("#buy_cash_week", "buy_btn glow_button", 0 < c[AVATAR_INDEX_CASH_WEEK]), SetClass("#buy_cash_month", "buy_btn glow_button", 0 < c[AVATAR_INDEX_CASH_MONTH]), SetClass("#buy_cash_perm", "buy_btn glow_button", 0 < c[AVATAR_INDEX_CASH_PERM]), SetClass("#buy_gold_week", "buy_btn glow_button", 0 <
      c[AVATAR_INDEX_GOLD_WEEK]), SetClass("#buy_gold_month", "buy_btn glow_button", 0 < c[AVATAR_INDEX_GOLD_MONTH]), SetClass("#buy_gold_perm", "buy_btn glow_button", 0 < c[AVATAR_INDEX_GOLD_PERM]));
    $("#buy_option1").html(ShopGetPeriodText(d, PERIOD_WEEK));
    $("#buy_option2").html(ShopGetPeriodText(d, PERIOD_MONTH));
    $("#buy_option3").html(ShopGetPeriodText(d, PERIOD_PERM));
    g_current_buy_avatar_index = b;
    ShopSetPeriod(0);
    $("#buy_panel1").html(l.t("^ Click to buy ^"));
    $("#buy_gift_btn").html($('<button class="glow_button" style="margin-top:10px;">' +
      l.t("Send Gift") + ' (<span class="span_rank2 rank rank17"></span>+)</button>').click(function() {
      if (17 > a.myPlayerInfo.rank) return alertify.alert(l.t("Only high ranks can send gifts currently."));
      var b = prompt(l.t("Who will receive the gift? Please enter a name of a friend:"));
      if (b) {
        for (var c, d = 0; d < a.friends.length; d++)
          if (b == a.friends[d].name && a.friends[d].id != a.myPlayerInfo.id) {
            c = a.friends[d];
            break
          }
        if (!c) return alertify.alert(l.t("He is not your friend, please try again and enter a friend name."));
        if (f !=
          GENDER_ALL && f != c.gender) return alertify.alert(l.t("Wrong gender. Your friend can not wear this avatar. Please select another one."));
        $("#buy_panel1").html(l.t("^ Click to <font color=yellow>GIFT</font> ^"));
        $("#buy_gift_btn").html(l.t("Gifting to") + ' <font color="#0f0">' + c.name + '</font><br><input id="gift_msg" placeholder="' + l.t("Write message for") + " " + c.name + '" maxlength=100>');
        g_send_gift_to = c;
        alertify.alert(l.t("OK<br>Now select a price.<br>You can also add a personal message."), function() {
          $("#gift_msg").focus()
        })
      }
    }));
    g_send_gift_to = void 0;
    g_graphics_high ? $("#shop_buy_dialog").fadeIn() : $("#shop_buy_dialog").show()
  }

  function ShopBuyCloseDialog(a) {
    g_graphics_high && !a ? $("#shop_buy_dialog").effect("explode") : $("#shop_buy_dialog").hide()
  }
  var BUY_PERIOD = ["1 Week", "1 Month", "Limitless"],
    BUY_PERIOD_1USE = ["", "", "1 Use"],
    BUY_PERIOD_MULTIUSE = ["30 Uses", "50 Uses", "100 Uses"],
    PERIOD_WEEK = 0,
    PERIOD_MONTH = 1,
    PERIOD_PERM = 2;

  function ShopGetPeriodText(a, b) {
    var c = {
      9004: 1,
      9005: 1,
      9006: 1,
      9007: 1,
      9008: 1,
      9009: 1,
      9002: 2
    };
    return 1 == c[a] ? l.t(BUY_PERIOD_1USE[b]) : 2 == c[a] ? l.t(BUY_PERIOD_MULTIUSE[b]) : l.t(BUY_PERIOD[b])
  }

  function ShopGetPeriod() {
    var a = BUY_PERIOD.indexOf($("#buy_period").html()); - 1 == a && ShopSetPeriod(0);
    return a
  }

  function ShopSetPeriod(a) {
    $("#buy_period").html(BUY_PERIOD[a]);
    var b = AVATARS[g_current_buy_avatar_index],
      c = $("#buy_cash_btn"),
      d = $("#buy_gold_btn");
    a == PERIOD_WEEK ? (0 < b[AVATAR_INDEX_CASH_WEEK] ? c.addClass("active") : c.removeClass("active"), 0 < b[AVATAR_INDEX_GOLD_WEEK] ? d.addClass("active") : d.removeClass("active")) : a == PERIOD_MONTH ? (0 < b[AVATAR_INDEX_CASH_MONTH] ? c.addClass("active") : c.removeClass("active"), 0 < b[AVATAR_INDEX_GOLD_MONTH] ? d.addClass("active") : d.removeClass("active")) : a == PERIOD_PERM && (0 < b[AVATAR_INDEX_CASH_PERM] ?
      c.addClass("active") : c.removeClass("active"), 0 < b[AVATAR_INDEX_GOLD_PERM] ? d.addClass("active") : d.removeClass("active"))
  }

  function ShopDoPurchase(a, b) {
    ShopDoPurchase2(a, ShopGetPeriod(), b)
  }

  function ShopDoPurchase2(a, b, c) {
    var d = AVATARS[g_current_buy_avatar_index],
      e;
    b == PERIOD_WEEK ? e = a ? d[AVATAR_INDEX_CASH_WEEK] : d[AVATAR_INDEX_GOLD_WEEK] : b == PERIOD_MONTH ? e = a ? d[AVATAR_INDEX_CASH_MONTH] : d[AVATAR_INDEX_GOLD_MONTH] : b == PERIOD_PERM && (e = a ? d[AVATAR_INDEX_CASH_PERM] : d[AVATAR_INDEX_GOLD_PERM]);
    var f, h = "";
    g_send_gift_to ? (h = $("#gift_msg").val(), f = l.t("Gift to") + " " + g_send_gift_to.name + " ?", d = l.t("Send gift") + ' <span class="AlertBold">' + d[AVATAR_INDEX_NAME] + "</span> " + l.t("for") + ' <span class="AlertBold">' +
      ShopGetPeriodText(d[AVATAR_INDEX_N], b) + "</span> " + l.t("at") + ' <span class="AlertBold">' + Commatize(e) + " " + (a ? "Cash" : "Gold") + "</span><br><br>" + l.t("to") + ' <span class="AlertBold">' + FixHTML(g_send_gift_to.name) + "</span><br><br>" + l.t("with message") + ' "<span class="AlertBold">' + FixHTML(h) + '</span>"') : (f = l.t("Are you sure?"), d = l.t("Are you sure you want to purchase") + ' <span class="AlertBold">' + d[AVATAR_INDEX_NAME] + "</span> " + l.t("for") + ' <span class="AlertBold">' + ShopGetPeriodText(d[AVATAR_INDEX_N], b) +
      "</span> " + l.t("at") + ' <span class="AlertBold">' + Commatize(e) + " " + (a ? "Cash" : "Gold") + "</span> ?");
    DragonDialogOpen(f, d, 2, function(d) {
      d && c.SendPurchase(g_current_buy_avatar_index, a, b, e, g_send_gift_to ? g_send_gift_to.id : 0, h)
    })
  }

  function ShopUpdateMyStats() {
    if (g_shop_player)
      for (var a = "pop shld item def life atk dig time".split(" "), b = [AVATAR_INDEX_STAT_POP, AVATAR_INDEX_STAT_SHLD, AVATAR_INDEX_STAT_ITEM, AVATAR_INDEX_STAT_DEF, AVATAR_INDEX_STAT_LIFE, AVATAR_INDEX_STAT_ATK, AVATAR_INDEX_STAT_DIG, AVATAR_INDEX_STAT_TIME], c = g_shop_player.GetAvatars(), d = 0; d < a.length; d++) {
        for (var e = 0, f = 0; f < c.length; f++) {
          var h = AVATARS[c[f]];
          void 0 != h && (h = h[b[d]], void 0 != h && (e += h))
        }
        50 < e && (e = 50);
        f = a[d];
        $("#shop_my_stats .shop_item_stat" + d + " .stat_icon").removeClass().addClass("stat_icon stat_icon_" +
          (0 <= e ? f : f + "-")).show();
        $("#shop_my_stats .shop_item_stat" + d + " .stat_digit1").removeClass().addClass("stat_digit1 stat_font stat_font" + Math.floor(Math.abs(e / 10))).show();
        $("#shop_my_stats .shop_item_stat" + d + " .stat_digit2").removeClass().addClass("stat_digit2 stat_font stat_font" + Math.abs(e % 10)).show()
      }
  }

  function GetEquipped() {
    var a = [];
    $(".shop_my_item_equip.equipped").parent().each(function(b) {
      a.push(Number($(this).attr("avatar_id")))
    });
    return a
  }

  function ShopClose(a) {
    var b = GetEquipped();
    b.toString() != g_equips_on_shop_enter.toString() && a.SendEquip(b);
    a.myPlayerInfo.location_type == LOCATION_TYPE_ROOM ? (SwitchToRoomScreen(a), RoomPlayerUpdateGUI(a.myPlayerInfo)) : SwitchToChannelScreen(a);
    delete a.after_purchase_action;
    ShopBuyCloseDialog(!0)
  }

  function DragonDesigner_ChangeAvatar(a, b, c) {
    var d = random(1E4, 19999);
    AVATARS[d] = [d, a, "a", "TEST " + d, 1, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, JSON.parse(c), void 0, b];
    g_shop_player.change(d, a, !0);
    g_shop_player.AddBackgroundFrame()
  }

  function DragonDesigner_FillGraphicsByType() {
    var a = Number($("#DragonDesignerType").val()),
      a = g_shop_player.GetAvatars()[a],
      a = void 0 == a ? "" : JSON.stringify(AVATARS[a][AVATAR_INDEX_GRAPHICS]);
    $("#DragonDesignerTypeAnimation").val(a)
  }

  function DragonDesigner_Init() {
    "undefined" === typeof window.FileReader ? DEBUG && console.log("FileReader Unsupported") : $("#shop_player").bind("dragenter dragover", function() {
      $(this).css("box-shadow", "yellow 0px 0px 70px 70px");
      return !1
    }).bind("dragend dragleave", function() {
      $(this).css("box-shadow", "");
      return !1
    }).bind("drop", function(a) {
      a = a.originalEvent;
      a.preventDefault();
      $("#shop_player").css("box-shadow", "");
      a = a.dataTransfer.files[0];
      var b = new FileReader;
      b.onload = function(a) {
        var b = a.target.result;
        a =
          $('<div id="DragonDesigner" class="AlertBox"><div class="AlertBoxTitle">Create Your Avatar</div><div class="AlertBoxContent blackShadow">Type: <select id="DragonDesignerType"><option value="0">Head</option><option value="1">Body</option><option value="2">Eyes</option><option value="3">Flag</option><option value="4">Background</option><option value="5">Foreground</option></select><p>Frames: [W,H,CenterX,CenterY]<br><textarea rows="4" cols="28" id="DragonDesignerTypeAnimation"></textarea><div id="DragonDesignerOK" class="buttonOK"></div></div></div>');
        $("#container").append(a);
        DragonDesigner_FillGraphicsByType();
        $("#DragonDesignerType").change(DragonDesigner_FillGraphicsByType);
        $("#DragonDesignerOK").click(function() {
          var a = [AVATAR_TYPE_HEAD, AVATAR_TYPE_BODY, AVATAR_TYPE_EYES, AVATAR_TYPE_FLAG, AVATAR_TYPE_BACKGROUND, AVATAR_TYPE_FOREGROUND],
            c = Number($("#DragonDesignerType").val()),
            a = a[c],
            c = $("#DragonDesignerTypeAnimation").val();
          DragonDesigner_ChangeAvatar(a, b, c);
          $("#DragonDesigner").remove()
        })
      };
      b.readAsDataURL(a);
      return !1
    })
  }

  function GoToBuyShopItem(a, b, c, d) {
    a.after_purchase_of_item = b;
    a.after_purchase_action = c;
    a.after_purchase_params = d;
    SwitchToShopScreen(a);
    setTimeout(function() {
      $("#buttonShopExItem").click();
      setTimeout(function() {
        ShopBuy(a, b)
      }, 500)
    }, 1E3)
  }
  SecretShop = function() {
    g_ss = 1;
    return "OK"
  };
  var TAB_ALL = 0,
    TAB_ITEMS = 0,
    TAB_FRIENDS = 1,
    TAB_GUILD = 2,
    GUILD_JOB_MEMBER = 0,
    GUILD_JOB_LEADER = 1,
    GUILD_JOB_SEMI_LEADER = 2,
    g_rankings_button_clicked, ROOM_NAMES = ["Hello World", "The Love Room", "DragonBound", "Welcome", "Let's Rock!"];

  function ChannelGUI(a) {
    $("#channel").tinyscrollbar({
      size: 101
    });
    $("#playersList").tinyscrollbar({
      size: 207
    });
    $("#friendsList").tinyscrollbar({
      size: 208
    });
    $("#guildMembersList").tinyscrollbar({
      size: 208
    });
    $("#buttonCreateRoom").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT), 6 > a.myPlayerInfo.unlock ? CreateRoomChangeMode(GAME_MODE_BOSS, a.myPlayerInfo.unlock) : CreateRoomChangeMode(GAME_MODE_NORMAL, a.myPlayerInfo.unlock), $("#createRoomTitle").val(ROOM_NAMES[random(0, ROOM_NAMES.length - 1)]),
        FadeInDialog("dialogCreateRoom"), $("#createRoomTitle").focus())
    });
    $("#buttonOptions").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ToggleOptionsDialog()
    });
    $("#OptionsDialog").on("mousedown click", function(a) {
      a.stopPropagation()
    });
    $("#buttonRoomsListDown").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), CloseRoomExtraInfo(), window.contadorGeneral || window.contadoBajada || window.refreshId ? (clearInterval(window.refreshId), $("#buttonRoomsListDown,#buttonRoomsListUp").unbind()) : a.SendChannelRooms("next"))
    });
    $("#buttonRoomsListUp").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), CloseRoomExtraInfo(), a.SendChannelRooms("prev"))
    });
    $(".room").click(function() {
      if (0 == g_server_type) {
        AudioPlay(AUDIO_BUTTON_SELECT2);
        var b = $(this).children(".roomNumber").html();
        b && ($(this).children(".roomLock").hasClass("roomLocked") ? ($("#join_room_input").val(b), FadeInDialog("dialog_join_room_div"), $("#join_password_input").val("").focus()) : a.SendRoomJoin(b))
      }
    }).bind("contextmenu", function() {
      if (0 == g_server_type) {
        var b =
          $(this).children(".roomNumber").html();
        g_extra_info_room == b ? CloseRoomExtraInfo() : a.SendChannelGetRoomInfo(b)
      }
    });
    $("#join_room_input").keydown(function(a) {
      a.which == KEY.Enter && ($("#join_password_input").is(":visible") ? $("#join_password_input").focus().select() : $("#dialog_join_room_ok").click(), a.stopPropagation())
    });
    $("#join_password_input").keydown(function(a) {
      a.which == KEY.Enter && ($("#dialog_join_room_ok").click(), a.stopPropagation())
    });
    $("#createRoomTitle").keydown(function(a) {
      a.which == KEY.Enter &&
        ($("#dialogCreateRoomButtonOK").click(), a.stopPropagation())
    });
    $("#buttonJoin").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), $("#join_password_input").val(""), FadeInDialog("dialog_join_room_div"), $("#join_room_input").focus())
    });
    $("#buttonMyInfo").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      $("#display_name").val(a.myPlayerInfo.game_id);
      $("#can_show_photo").prop("checked", 1 < String(a.myPlayerInfo.photo_url).length);
      FadeInDialog("dialog_change_name_div")
    });
    $("#buttonShop").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      SwitchToShopScreen(a)
    });
    $("#buttonQuickJoin").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendQuickJoin())
    });
    $("#dialog_change_name_cancel").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ExplodeDialog("dialog_change_name_div")
    });
    $("#dialog_change_name_ok").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ExplodeDialog("dialog_change_name_div", !0);
      var b = $("#display_name").val(),
        c = $("#can_show_photo").is(":checked");
      b != a.myPlayerInfo.game_id && (-1 != b.indexOf("  ") ? DragonDialogOpen("Sorry",
        "Double space is not allowed, try single space.", DIALOG_BUTTONS_OK) : /GM\W/.exec(b) ? DragonDialogOpen("Sorry", "GM in name is not allowed, try a different name.", DIALOG_BUTTONS_OK) : DragonDialogOpen("Are you sure to change name?", 0 == a.myPlayerInfo.name_changes ? 'This is your first name change so it will be <font color="cyan">FREE</font> this time, future changes will be 4,000 Cash.<br><br>Change name to <font color="yellow">' + b + "</font> ?" : 'Name change costs <font color="cyan">4,000 Cash</font>.<br><br>Are you sure you want to change name to <font color="yellow">' +
        b + "</font> ?", DIALOG_BUTTONS_OK_CANCEL,
        function(c) {
          c && a.SendChangeName(b)
        }));
      1 < String(a.myPlayerInfo.photo_url).length != c && a.SendChangeInfo(c)
    });
    $("#changePassword").click(function() {
      ExplodeDialog("dialog_change_name_div", !0);
      a.dragonLogin.ChangePassword()
    });
    $("#dialog_join_room_cancel").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ExplodeDialog("dialog_join_room_div")
    });
    $("#dialog_join_room_ok").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      var b = Number($("#join_room_input").val());
      if (isNaN(b) ||
        0 >= b) DragonDialogOpen("Sorry", "Room Number should be a positive number.", DIALOG_BUTTONS_OK_CANCEL);
      else {
        var c = $("#join_password_input").val();
        a.SendRoomJoin(b, c);
        ExplodeDialog("dialog_join_room_div")
      }
    });
    $("#channelInput").keydown(function(b) {
      13 == b.which && "" != this.value && (b = this.value, this.value = "", a.SendChat(b))
    });
    g_is_mobile_device && $("#channelInput").focus(function() {
      g_after_resize_callback = function() {
        var a = window.innerWidth / 500 / g_aspect_ratio;
        $("#channelInput").css({
          scaleX: a,
          scaleY: a,
          "margin-top": -15 *
            (a - 1)
        })
      }
    }).blur(function() {
      g_after_resize_callback = void 0;
      $("#channelInput").removeAttr("style")
    });
    $("#buttonRanking").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ChangeRankingsViewState();
      g_rankings_button_clicked = !0
    });
    $("#event_button").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      a.SendEvent(0)
    });
    $("#facebook_post").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      Facebook_PostToFeed(a)
    });
    $("#buttonAllBuddyList1").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      TabChangeTo(TAB_ALL);
      a.SendTabWatch(0)
    });
    $("#buttonAllBuddyList2").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      TabChangeTo(TAB_FRIENDS);
      a.SendTabWatch(1);
      0 == $("#friendsListHtml").children().length && a.SendRefreshFriends()
    });
    $("#buttonAllBuddyList3").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      TabChangeTo(TAB_GUILD);
      a.SendTabWatch(2);
      0 == $("#guildMembersListHtml").children().length && a.SendRefreshGuildies()
    });
    $("#filter_all").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendChannelRooms("all"))
    });
    $("#filter_waiting").click(function() {
      0 ==
        g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendChannelRooms("waiting"))
    });
    $("#filter_normal").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendChannelRooms("normal"))
    });
    $("#filter_boss").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendChannelRooms("boss"))
    });
    $("#filter_same").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendChannelRooms("same"))
    });
    $("#filter_score").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2),
        a.SendChannelRooms("score"))
    });
    $("#filter_friends").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendChannelRooms("friends"))
    });
    $("#filter_guild").click(function() {
      0 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendChannelRooms("guild"))
    });
    $("#buttonStart1v1").click(function() {
      1 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendStartTournamentGame(1, a.lobbyMobile, []))
    });
    $("#buttonCreateTeam").click(function() {
      1 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.SendCreateTeam())
    });
    $("#buttonJoinTeam").click(function() {
      1 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), $("#join_password_input").val(""), FadeInDialog("dialog_join_room_div"), $("#join_room_input").focus())
    });
    $("#lobbyButtonMobile").click(function() {
      1 == g_server_type && (AudioPlay(AUDIO_BUTTON_SELECT2), a.lobbyMobile = GetMobileAfter(a.lobbyMobile), g_channel_player.change_mobile(a.lobbyMobile))
    });
    $("#buttonChannels").click(function() {
      a.OpenBrokerWindow()
    });
    $("#BrokerRefresh").click(function() {
      a.BrokerConnect()
    });
    $("#lobby_channel").change(function() {
      var b =
        Number($(this).val());
      a.SendChangeLobbyChannel(b);
      localStorage.lobby_channel = b
    });
    $(".BtnBcm").click(function() {
      var b = "#";
      a.location == GUI_LOCATION_CHANNEL ? b = "#channelInput" : a.location == GUI_LOCATION_ROOM ? b = "#roomInput" : a.location == GUI_LOCATION_GAME && (b = "#gameInput");
      alertify.prompt(l.t("Use 1 Megaphone item to broadcast?"), function(c, d) {
        if (c && d) {
          if (d.length > CHAT_LENGTH_LIMIT) return setTimeout(function() {
            alertify.alert(l.t("Can't send broadcast longer than the limit of 150 letters. Yours is") + " " + d.length +
              ".")
          }, 700);
          a.SendBcm(d);
          $(b).val("")
        }
      }, $(b).val())
    });
    CreateRoomDialogGUI(a);
    OptionsDialogGUI(a)
  }

  function Hotkeys(a) {
    var b = !1;
    $("body").keydown(function(c) {
      !c.altKey || c.which != KEY.Left && c.which != KEY.Right || c.preventDefault();
      if (!$(document.activeElement).is("input") && !$(document.activeElement).is("textarea") && (!c.altKey && c.which != KEY.Alt || b || (b = !0, $(".Alt").show()), c.altKey)) {
        var d;
        c.which != KEY.N && c.which != KEY.Z || $("#ranking_panel_open").click();
        c.which == KEY.F11 && $("#FullScreenButton").click();
        if (a.location == GUI_LOCATION_CHANNEL)
          if ($("#BrokerScreen").is(":visible")) switch (c.which) {
            case KEY.N1:
              $("#BrokerChannel0").click();
              break;
            case KEY.N2:
              $("#BrokerChannel1").click();
              break;
            case KEY.N3:
              $("#BrokerChannel2").click();
              break;
            case KEY.N4:
              $("#BrokerChannel3").click();
              break;
            case KEY.N5:
              $("#BrokerChannel4").click();
              break;
            case KEY.N6:
              $("#BrokerChannel5").click();
              break;
            case KEY.N7:
              $("#BrokerChannel6").click();
              break;
            case KEY.N8:
              $("#BrokerChannel7").click();
              break;
            case KEY.N9:
              $("#BrokerChannel8").click();
              break;
            case KEY.A:
              $("#BrokerChannel9").click();
              break;
            case KEY.B:
              $("#BrokerChannel10").click();
              break;
            case KEY.C:
              $("#BrokerChannel11").click();
              break;
            case KEY.D:
              $("#BrokerChannel12").click();
              break;
            case KEY.E:
              $("#BrokerChannel13").click();
              break;
            case KEY.F:
              $("#BrokerChannel14").click();
              break;
            case KEY.Q:
              $("#BrokerLogout").click();
              break;
            case KEY.R:
              $("#BrokerRefresh").click();
              break;
            default:
              d = 1
          } else switch (c.which) {
            case KEY.C:
              $(g_server_type ? "#buttonCreateTeam" : "#buttonCreateRoom").click();
              break;
            case KEY.J:
              $(g_server_type ? "#buttonJoinTeam" : "#buttonJoin").click();
              break;
            case KEY.S:
              $(g_server_type ? "#buttonStart1v1" : "#buttonQuickJoin").click();
              break;
            case KEY.I:
              $("#buttonMyInfo").click();
              break;
            case KEY.H:
              $("#buttonShop").click();
              break;
            case KEY.R:
              $("#buttonCharge2").click();
              break;
            case KEY.B:
              $("#facebook_post").click();
              break;
            case KEY.E:
              $("#event_button").click();
              break;
            case KEY.O:
              $("#buttonOptions").click();
              break;
            case KEY.Q:
              $("#buttonChannels").click();
              break;
            case KEY.A:
              $("#buttonAllBuddyList1").click();
              break;
            case KEY.F:
              $("#buttonAllBuddyList2").click();
              break;
            case KEY.G:
              $("#buttonAllBuddyList3").click();
              break;
            case KEY.UP:
              $("#buttonRoomsListUp").click();
              break;
            case KEY.DOWN:
              $("#buttonRoomsListDown").click();
              break;
            case KEY.N1:
              $("#room0").click();
              break;
            case KEY.N2:
              $("#room1").click();
              break;
            case KEY.N3:
              $("#room2").click();
              break;
            case KEY.N4:
              $("#room3").click();
              break;
            case KEY.N5:
              $("#room4").click();
              break;
            case KEY.N6:
              $("#room5").click();
              break;
            case KEY.L:
              $("#filter_all").click();
              break;
            case KEY.T:
              $("#filter_waiting").click();
              break;
            case KEY.M:
              1 == g_server_type && $("#lobbyButtonMobile").click();
              break;
            default:
              d = 1
          } else if (a.location == GUI_LOCATION_ROOM)
            if ($("#roomMobileSelect").is(":visible")) {
              var e = [KEY.N0, KEY.N1, KEY.N2, KEY.N3, KEY.N4, KEY.N5, KEY.N6, KEY.N7, KEY.N8, KEY.N9, KEY.A, KEY.B, KEY.C, KEY.D, KEY.E, KEY.F].indexOf(c.which);
              if (0 <= e) $(".mobileSelectBtn").eq(e).click();
              else switch (c.which) {
                case KEY.M:
                  $("#roomMobileSelectCancel").click();
                  break;
                default:
                  d = 1
              }
            } else switch (c.which) {
              case KEY.L:
                $("#room_change_title_button").click();
                break;
              case KEY.S:
                $("#roomButtonStart").click();
                break;
              case KEY.R:
                $("#roomButtonReady").click();
                break;
              case KEY.A:
                $("#room_item_buddy_tab1").click();
                break;
              case KEY.F:
                $("#room_item_buddy_tab2").click();
                break;
              case KEY.G:
                $("#room_item_buddy_tab3").click();
                break;
              case KEY.I:
                $("#roomButtonInvite").click();
                break;
              case KEY.M:
                $("#roomButtonMobile").click();
                break;
              case KEY.T:
                $("#roomButtonChangeTeam").click();
                break;
              case KEY.H:
                $("#buttonShopFromRoom").click();
                break;
              case KEY.V:
                $("#roomButtonVideoChat").click();
                break;
              case KEY.Q:
                $("#roomButtonBack").click();
                break;
              case KEY.O:
                $("#room_options_button").click();
                break;
              default:
                d = 1
            } else if (a.location == GUI_LOCATION_SHOP)
              if ($("#shop_buy_dialog").is(":visible")) switch (c.which) {
                case KEY.N1:
                  $("#buy_cash_week").click();
                  break;
                case KEY.N2:
                  $("#buy_cash_month").click();
                  break;
                case KEY.N3:
                  $("#buy_cash_perm").click();
                  break;
                case KEY.N4:
                  $("#buy_gold_week").click();
                  break;
                case KEY.N5:
                  $("#buy_gold_month").click();
                  break;
                case KEY.N6:
                  $("#buy_gold_perm").click();
                  break;
                case KEY.R:
                  $("#buttonChargeShop").click();
                  break;
                default:
                  d = 1
              } else switch (c.which) {
                case KEY.Q:
                  $("#buttonShopExit").click();
                  break;
                case KEY.Up:
                case KEY.Left:
                  $("#buttonShopPrev").click();
                  break;
                case KEY.Down:
                case KEY.Right:
                  $("#buttonShopNext").click();
                  break;
                case KEY.N1:
                  $("#shop_item0").dblclick();
                  break;
                case KEY.N2:
                  $("#shop_item1").dblclick();
                  break;
                case KEY.N3:
                  $("#shop_item2").dblclick();
                  break;
                case KEY.N4:
                  $("#shop_item3").dblclick();
                  break;
                case KEY.N5:
                  $("#shop_item4").dblclick();
                  break;
                case KEY.N6:
                  $("#shop_item5").dblclick();
                  break;
                case KEY.N7:
                  $("#shop_item6").dblclick();
                  break;
                case KEY.N8:
                  $("#shop_item7").dblclick();
                  break;
                case KEY.N9:
                  $("#shop_item8").dblclick();
                  break;
                case KEY.H:
                  $("#buttonShopHead").click();
                  break;
                case KEY.B:
                  $("#buttonShopBody").click();
                  break;
                case KEY.G:
                  $("#buttonShopEyes").click();
                  break;
                case KEY.F:
                  $("#buttonShopFlag").click();
                  break;
                case KEY.C:
                  $("#buttonShopBackground").click();
                  break;
                case KEY.E:
                  $("#buttonShopForeground").click();
                  break;
                case KEY.X:
                  $("#buttonShopExItem").click();
                  break;
                case KEY.R:
                  $("#buttonChargeShop1").click();
                  break;
                default:
                  d = 1
              } else if (a.location == GUI_LOCATION_GAME)
                if ($("#OptionsDialog").is(":visible")) switch (c.which) {
                  case KEY.Q:
                    $("#OptionsLeave").click();
                    break;
                  default:
                    d = 1
                } else switch (c.which) {
                  case KEY.N1:
                    $("#btnShot1").click();
                    break;
                  case KEY.N2:
                    $("#btnShot2").click();
                    break;
                  case KEY.N3:
                    $("#btnShotSS").click();
                    break;
                  case KEY.M:
                    $("#slice_drag_button").click();
                    break;
                  default:
                    d = 1
                }
                d || (c.stopPropagation(), c.preventDefault())
      }
    }).keyup(function(a) {
      if (b) {
        if (a.which == KEY.Alt) return $(".Alt").hide(), b = !1, a.stopPropagation(), a.preventDefault(), !1;
        a.altKey || ($(".Alt").hide(), b = !1)
      }
    });
    $(window).blur(function(a) {
      b && ($(".Alt").hide(), b = !1)
    })
  }

  function ChangeRankingsViewState(a) {
    g_is_show_ranking = void 0 == a ? !g_is_show_ranking : a;
    Resize(!0);
    g_is_show_ranking ? $("#buttonRanking").addClass("open") : $("#buttonRanking").removeClass("open")
  }

  function Facebook_PostToFeed(a) {
    var b = "icon180x180.png icon2_180x180.png icon3_180x180.jpg icon4_180x180.jpg icon5_180x180.jpg icon6_180x180.jpg".split(" "),
      b = b[random(0, b.length - 1)],
      c = "DragonBound - " + l.t("HTML5 online multiplayer game"),
      d = location.protocol + "//" + location.host,
      e = l.t("Play with or against your friends from your browser anywhere for free. Shop for avatars to make you stronger. Unlock hidden characters, game modes, and challenges. Meet new friends. Single player option too.");
    FB.ui({
      method: "feed",
      link: d,
      picture: d + "/static/images/" + b,
      name: c,
      caption: "www.DragonBound.net",
      description: e
    }, function(b) {
      null != b && a.SendEvent(1, b.post_id)
    })
  }

  function FacebookShare(a, b, c, d, e, f) {
    FB.ui({
      method: "feed",
      link: a,
      picture: b,
      name: d,
      caption: c,
      description: e
    }, f)
  }

  function PrepareOptionsDialog(a) {
    a ? ($("#OptionsLeave").show(), $("#OptionsOK").css("left", "175px"), a = $("#btnEsc").offset(), $("#OptionsDialog").css({
      left: a.left - 10,
      top: a.top - 340
    })) : a || ($("#OptionsLeave").hide(), $("#OptionsOK").css("left", "106px"), $("#OptionsDialog").css({
      left: "35%",
      top: "35%"
    }));
    g_is_game_slice ? ($("#OptionsShootingModeSlice").removeClass("RadioOff").addClass("RadioOn"), $("#OptionsShootingModeDrag").removeClass("RadioOn").addClass("RadioOff")) : ($("#OptionsShootingModeSlice").removeClass("RadioOn").addClass("RadioOff"),
      $("#OptionsShootingModeDrag").removeClass("RadioOff").addClass("RadioOn"));
    $("#lang_select").val(l.GetCurrentLang());
    $("#OptionExplodes").prop("checked", !!OPTIONS.explodes);
    $("#OptionKillMsg").prop("checked", !!OPTIONS.killmsg);
    $("#OptionBackground").prop("checked", !!OPTIONS.background);
    $("#OptionAnimations").prop("checked", !!OPTIONS.anim);
    $("#OptionVortex").prop("checked", !!OPTIONS.vortex);
    $("#OptionCountries").prop("checked", !!OPTIONS.countries);
    $("#OptionGameEndCounter").prop("checked", !!OPTIONS.gameendcounter);
    $("#OptionCamFollowBullets").prop("checked", !!OPTIONS.camfollowbullets);
    $("#OptionLowRes").prop("checked", 1 == localStorage.low_res);
    $("#OptionFPS").prop("checked", 1 == localStorage.fps)
  }

  function OptionsDialogOnChange(a) {
    SetValue("explodes", OPTIONS.explodes = $("#OptionExplodes").is(":checked") ? 1 : 0);
    SetValue("killmsg", OPTIONS.killmsg = $("#OptionKillMsg").is(":checked") ? 1 : 0);
    SetValue("background", OPTIONS.background = $("#OptionBackground").is(":checked") ? 1 : 0);
    SetValue("anim", OPTIONS.anim = $("#OptionAnimations").is(":checked") ? 1 : 0);
    SetValue("vortex", OPTIONS.vortex = $("#OptionVortex").is(":checked") ? 1 : 0);
    SetValue("countries", OPTIONS.countries = $("#OptionCountries").is(":checked") ? 1 : 0);
    SetValue("gameendcounter",
      OPTIONS.gameendcounter = $("#OptionGameEndCounter").is(":checked") ? 1 : 0);
    g_is_game_background = OPTIONS.background;
    a.game && (a.game.UpdateAnim && a.game.UpdateAnim(), a.game.dragon2d ? a.game.dragon2d.ReSetBackground() : a.game.ground && a.game.ground.SetMapBackground())
  }

  function OptionsDialogGUI(a) {
    $("#OptionsOK").on("click touchstart", function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      ExplodeDialog("OptionsDialog")
    });
    $("#OptionExplodes,#OptionKillMsg,#OptionBackground,#OptionAnimations,#OptionVortex,#OptionCountries,#OptionGameEndCounter,#OptionCamFollowBullets,#OptionLowRes,#OptionFPS").change(function() {
      OptionsDialogOnChange(a)
    });
    $("#OptionsShootingModeSlice").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      g_is_game_slice = !0;
      PrepareOptionsDialog(!!a.game);
      UpdateSliceDragGUI();
      SetValue("slice", 1)
    });
    $("#OptionsShootingModeDrag").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      g_is_game_slice = !1;
      PrepareOptionsDialog(!!a.game);
      UpdateSliceDragGUI();
      SetValue("slice", 0)
    });
    $("#lang_select").change(function() {
      var b = $(this).val(),
        d = LANGUAGE[b];
      DEBUG && console.log("Lang:", b, d);
      void 0 != d && (l.lang = d, l.SetAll(), RankingReClick(), PrepareOptionsDialog(!!a.game), SetValue("lang", l.lang))
    });
    $("#OptionsTheme").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      DragonThemeDialog()
    });
    $("#OptionsLeave").on("click touchstart",
      function() {
        AudioPlay(AUDIO_BUTTON_SELECT2);
        ExplodeDialog("OptionsDialog");
        a.should_stay_in_game_screen = !1;
        a.game && (0 > a.game.my_player_index ? a.SendRoomLeave() : DragonDialogOpen("Quit Game?", "Alive: -5 GP, -1500 Gold, +1 Lose<p><br>Dead: +1 Lose", DIALOG_BUTTONS_OK_CANCEL, function(b) {
          b && a.SendRoomLeave()
        }, [35, 52]))
      });
    $("#DragonThemeDialog").dialog({
      autoOpen: !1,
      show: {
        effect: "blind",
        duration: 500
      },
      hide: {
        effect: "explode",
        duration: 500
      },
      width: 510,
      height: 450,
      modal: !0
    });
    for (var b in DragonThemeDefault) $("#theme_" +
      b).focusout(function() {
      0 != DragonTheme_ChangeOneProperty(this.id.substr(6), this.value, function(a, b) {
        $("#theme_" + a).css("background-color", b ? "#9f9" : "#f99")
      }) && DragonTheme_UpdateFullThemeField()
    });
    $("#themeFull").focusout(function() {
      var a = DragonTheme_SetThemeFromJSON(this.value);
      1 == a ? (DragonTheme_UpdateFields(), $(this).css("background-color", this.value ? "#9f9" : "")) : -1 == a && $(this).css("background-color", "#f99")
    })
  }

  function DragonThemeDialog() {
    for (var a in DragonThemeInUse) $("#theme_" + a).val(DragonTheme_GetValue(a));
    $("#themeFull").val(DragonTheme_ToJSON());
    $("#DragonThemeDialog").dialog("open")
  }

  function CreateRoomDialogPressedOK(a) {
    var b, c = "",
      d;
    b = $("#createRoomTitle").blur().val();
    $("#CreateRoomPrivateCheckbox").hasClass("checkboxOn") && (c = $("#createRoomPasswordInput").val());
    d = $("#CreateRoomPlayers");
    d = d.hasClass("players1v1") ? 2 : d.hasClass("players2v2") ? 4 : d.hasClass("players3v3") ? 6 : d.hasClass("players1vB") ? 1 : d.hasClass("players2vB") ? 2 : d.hasClass("players3vB") ? 3 : d.hasClass("players4vB") ? 4 : 8;
    a.SendRoomCreate(b, c, d, g_create_room_game_mode);
    $("#dialogCreateRoom").hide()
  }
  var g_create_room_game_mode = GAME_MODE_NORMAL;

  function CreateRoomDialogGUI(a) {
    $("#dialogCreateRoomButtonCancel").click(function() {
      g_graphics_high ? $("#dialogCreateRoom").effect("explode") : $("#dialogCreateRoom").hide();
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#dialogCreateRoomButtonOK").click(function() {
      CreateRoomDialogPressedOK(a);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#CreateRoomPrivateCheckbox").click(function() {
      var a = $("#CreateRoomPrivateCheckbox");
      a.hasClass("checkboxOff") ? (a.removeClass("checkboxOff").addClass("checkboxOn"), $("#CreateRoomPassword").show(),
        $("#createRoomPasswordInput").focus()) : (a.removeClass("checkboxOn").addClass("checkboxOff"), $("#CreateRoomPassword").hide());
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#CreateRoomNumPlayersPrev").click(function() {
      var a = $("#CreateRoomPlayers"),
        c;
      c = g_create_room_game_mode == GAME_MODE_BOSS ? a.hasClass("players1vB") ? "players4vB" : a.hasClass("players2vB") ? "players1vB" : a.hasClass("players3vB") ? "players2vB" : "players3vB" : a.hasClass("players1v1") ? "players4v4" : a.hasClass("players2v2") ? "players1v1" : a.hasClass("players3v3") ?
        "players2v2" : "players3v3";
      a.removeClass().addClass(c);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#CreateRoomNumPlayersNext").click(function() {
      var a = $("#CreateRoomPlayers"),
        c;
      c = g_create_room_game_mode == GAME_MODE_BOSS ? a.hasClass("players1vB") ? "players2vB" : a.hasClass("players2vB") ? "players3vB" : a.hasClass("players3vB") ? "players4vB" : "players1vB" : a.hasClass("players1v1") ? "players2v2" : a.hasClass("players2v2") ? "players3v3" : a.hasClass("players3v3") ? "players4v4" : "players1v1";
      a.removeClass().addClass(c);
      AudioPlay(AUDIO_BUTTON_SELECT2)
    });
    $("#CreateRoomModeNext").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      CreateRoomChangeMode((g_create_room_game_mode + 1) % GAME_MODES, a.myPlayerInfo.unlock)
    });
    $("#CreateRoomModePrev").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      CreateRoomChangeMode((g_create_room_game_mode + GAME_MODES - 1) % GAME_MODES, a.myPlayerInfo.unlock)
    })
  }

  function CreateRoomChangeMode(a, b) {
    g_create_room_game_mode = a;
    var c = $("#CreateRoomMode"),
      d = $("#CreateRoomPlayers"),
      e;
    e = a == GAME_MODE_BOSS ? d.hasClass("players1v1") ? "players1vB" : d.hasClass("players2v2") ? "players2vB" : d.hasClass("players3v3") ? "players3vB" : "players4vB" : d.hasClass("players1v1") ? "players1v1" : d.hasClass("players2v2") ? "players2v2" : d.hasClass("players3v3") ? "players3v3" : d.hasClass("players1vB") ? "players1v1" : d.hasClass("players2vB") ? "players2v2" : d.hasClass("players3vB") ? "players3v3" : "players4v4";
    c.html(GAME_MODE_NAMES[a]).removeClass("gameMode0 gameMode1 gameMode2 gameMode3").addClass("gameMode" + a);
    d.removeClass().addClass(e);
    $("#CreateRoomModeIcon").removeClass().addClass("iconMode" + a);
    a == GAME_MODE_NORMAL && 1 > b ? ($("#dialogCreateLocked").show(), $("#dialogCreateMessage").html(l.t("This mode is locked until you win at BOSS mode as room master.")), $("#dialogCreateRoomButtonOK").hide()) : a == GAME_MODE_SAME && 12 > b ? ($("#dialogCreateLocked").show(), $("#dialogCreateMessage").html(l.t("This mode is locked until you win *ALL* BOSS mode levels as room master.")),
      $("#dialogCreateRoomButtonOK").hide()) : a == GAME_MODE_SCORE && 5 > b ? ($("#dialogCreateLocked").show(), $("#dialogCreateMessage").html(l.t("This mode is locked until you win the 5 first boss levels.")), $("#dialogCreateRoomButtonOK").hide()) : ($("#dialogCreateLocked").hide(), $("#dialogCreateRoomButtonOK").show(), c = "", a == GAME_MODE_NORMAL ? c = "Kill the other team to win." : a == GAME_MODE_BOSS ? c = "Fight computer players at increasing difficulty." : a == GAME_MODE_SAME ? c = "Everyone use the same mobile as the room master." :
      a == GAME_MODE_SCORE && (c = "Revive after you die. First team to get to 0 points lose."), $("#dialogCreateMessage").html(l.t(c)))
  }

  function ChannelChatClear() {
    $("#channelTextHtml").html("");
    $("#channel").tinyscrollbar_update("bottom")
  }

  function FixGuildName(a) {
    return ReplaceNonPrintableUnicodeChars(a, "")
  }

  function BuildPlayerNameWithGuild(a, b, c) {
    a && (b = c ? '<span class="GuildNameTeam' + c + '">' + FixGuildName(a) + "</span> " + b : '<span class="GuildName"><a href="/guild/' + encodeURIComponent(a) + '" target="_blank">' + FixGuildName(a) + "</a></span> " + b);
    return b
  }

  function BuildRelationRankGuildName(a, b, c, d, e) {
    var f = "";
    "f" == a ? f += '<span class="relationshipIcon"></span> ' : "e" == a ? f += '<span class="relationshipIconE"></span> ' : "m" == a && (f += '<span class="relationshipIconM"></span> ');
    return f += '<span class="span_rank2 rank rank' + b + '"></span> ' + BuildPlayerNameWithGuild(c, d, e)
  }

  function BuildRelationRankCountryGuildName(a, b, c, d, e, f) {
    var h = "";
    "f" == a ? h += '<span class="relationshipIcon"></span> ' : "e" == a ? h += '<span class="relationshipIconE"></span> ' : "m" == a && (h += '<span class="relationshipIconM"></span> ');
    h += '<span class="span_rank2 rank rank' + b + '">';
    OPTIONS.countries && c && (h += '<div class="country">' + c + "</div>");
    h += "</span> ";
    void 0 != e && (h += BuildPlayerNameWithGuild(d, e, f));
    return h
  }
  var PLAYER_INDEX_USER_ID = 0,
    PLAYER_INDEX_GAME_ID = 1,
    PLAYER_INDEX_RANK = 2,
    PLAYER_INDEX_GUILD = 3,
    PLAYER_INDEX_TEAM = 4,
    PLAYER_INDEX_IS_MASTER = 5,
    PLAYER_INDEX_IS_READY = 6,
    PLAYER_INDEX_GENDER = 7,
    PLAYER_INDEX_MOBILE = 8,
    PLAYER_INDEX_AVATARS = 9,
    PLAYER_INDEX_IS_BOT = 10;

  function ChannelUpdatePlayersList(a) {
    TabChangeTo(TAB_ALL);
    for (var b = "", c = 0; c < a.length - 3; c += 4) var d = a[c],
      b = b + ('<div class="playerListItem" id="player_user_id_' + d + '" user_id=' + d + '><div class="playerListRank rank rank' + a[c + 2] + '"></div><div class="playerListName blackShadow">' + BuildPlayerNameWithGuild(a[c + 3], a[c + 1]) + "</div></div>");
    $("#channelPlayersListHtml").html(b);
    $("#playersList").tinyscrollbar_update("top")
  }

  function ChannelPlayerJoined(a, b, c) {
    ChannelPlayerLeft(a);
    a = '<div class="playerListItem" id="player_user_id_' + a + '" user_id=' + a + '><div class="playerListRank rank rank' + c + '"></div><div class="playerListName blackShadow">' + b + "</div></div>";
    $("#channelPlayersListHtml").append(a);
    $("#playersList").tinyscrollbar_update("relative")
  }

  function ChannelPlayerLeft(a) {
    $("#player_user_id_" + a).remove();
    $("#playersList").tinyscrollbar_update("relative")
  }

  function TabChangeTo(a) {
    a == TAB_ALL ? ($("#buttonAllBuddyList1,#buttonAllBuddyList2,#buttonAllBuddyList3").removeClass("Guild").removeClass("BuddyList"), $("#friendsList").hide(), $("#guildMembersList").hide()) : a == TAB_FRIENDS ? ($("#buttonAllBuddyList1,#buttonAllBuddyList2,#buttonAllBuddyList3").removeClass("Guild").addClass("BuddyList"), $("#friendsList").show(), $("#guildMembersList").hide(), $("#channelPlayersListHtml").html(""), $("#playersList .scrollbar").hide()) : a == TAB_GUILD && ($("#buttonAllBuddyList1,#buttonAllBuddyList2,#buttonAllBuddyList3").addClass("Guild").removeClass("BuddyList"),
      $("#friendsList").hide(), $("#guildMembersList").show(), $("#channelPlayersListHtml").html(""), $("#playersList .scrollbar").hide())
  }

  function GotFullGuildMembersList(a, b) {
    RoomTabChangeTo(TAB_GUILD);
    TabChangeTo(TAB_GUILD);
    if (a) {
      var c = a[0],
        d = a[1],
        e = "??";
      0 == d ? e = l.t("Member") : 1 == d ? e = l.t("Leader") : 2 == d && (e = l.t("Semi-Leader"));
      c = $("#guildMembersListHtml").html('<div class="refresh_button_guildies">Refresh Guild List</div><div id="guild_leave" class="opacity_button"></div><div><span class="GuildName blackShadow">' + e + '</span> of Guild:<br><span class="GuildName blackShadow">' + c + '</span><div style="clear: both"></div></div>');
      for (d = 2; d <
        a.length; d++) {
        e = a[d];
        Img2url(e[FRIEND_INDEX_IMAGE], e[FRIEND_INDEX_GENDER]);
        var f;
        0 == e[FRIEND_INDEX_SERVER] ? f = "Offline" : 0 < e[FRIEND_INDEX_SERVER] ? f = "Server " + e[FRIEND_INDEX_SERVER] : 0 > e[FRIEND_INDEX_SERVER] && (f = 0 == e[FRIEND_INDEX_ROOM] ? "Lobby" : "Room: " + e[FRIEND_INDEX_ROOM]);
        var h = 1 == d % 2 ? " odd" : "",
          k = $('<div class="friendListPhoto"></div>');
        k.append(Img2div(e[FRIEND_INDEX_IMAGE], e[FRIEND_INDEX_GENDER], "friendListPhotoImg", 0, 40, 30));
        h = $('<div id="guild_member_' + e[FRIEND_INDEX_ID] + '" friend="' + e[FRIEND_INDEX_ID] +
          '" class="guildMemberListItem' + h + '"></div>');
        h.append(k);
        h.append('<div class="friendListRank rank rank' + e[FRIEND_INDEX_RANK] + '"></div>');
        h.append('<div class="friendListName blackShadow">' + e[FRIEND_INDEX_NAME] + "</div>");
        h.append('<div class="friendListGP blackShadow">GP ' + e[FRIEND_INDEX_GP] + "</div>");
        h.append('<div class="friendListLocation blackShadow">' + f + "</div>");
        c.append(h)
      }
      $("#guildMembersList").tinyscrollbar_update("top");
      $(".guildMemberListItem").bind("click", function() {
        $(".guildMemberListItem").removeClass("selected");
        $(this).addClass("selected");
        ChatDialogCreate($(this).attr("friend"), $(this).children(".friendListName").html(), b)
      });
      $("#guild_leave").click(function() {
        DragonDialogOpen(l.t("Are You Sure?"), l.t("Are you sure you want to leave your guild?"), DIALOG_BUTTONS_OK_CANCEL, function(a) {
          a && b.SendGuildLeave()
        })
      });
      InitRefreshButtonGuildies(b);
      UpdateFriendsInRooms()
    } else f = "<br><br>" + l.t('You do not have a guild yet.<br><br>To create a Guild select a name, pay <font color="yellow">500,000 Gold</font>, and press the button.<br><br>Guild Name') +
      ': <input id="create_guild_name"><div id="guild_create" class="opacity_button"></div>', $("#guildMembersListHtml").html(f), $("#guild_create").click(function() {
        var a = $("#create_guild_name").val();
        a == ReplaceNonPrintableUnicodeChars(a) ? DragonDialogOpen(l.t("Are You Sure?"), l.t("Are you sure you want to create the guild") + ': <font color="cyan">' + a + "</font> ?<br><br>" + l.t('By clicking OK you will pay <font color="yellow">500,000 Gold</font> and create the guild.'), DIALOG_BUTTONS_OK_CANCEL, function(c) {
          c &&
            b.SendGuildCreate(a)
        }) : DragonDialogOpen(l.t("Bad Name"), l.t("Can not use invisible letters in guild name.<br><br>Try a different name."), DIALOG_BUTTONS_OK)
      })
  }
  var FRIEND_INDEX_ID = 0,
    FRIEND_INDEX_NAME = 1,
    FRIEND_INDEX_GENDER = 2,
    FRIEND_INDEX_RANK = 3,
    FRIEND_INDEX_GP = 4,
    FRIEND_INDEX_IMAGE = 5,
    FRIEND_INDEX_SERVER = 6,
    FRIEND_INDEX_ROOM = 7,
    g_last_refresh_friends_click = 0,
    g_last_refresh_guildies_click = 0;

  function UpdateFriendsList(a, b, c, d) {
    RoomTabChangeTo(TAB_FRIENDS);
    TabChangeTo(TAB_FRIENDS);
    c || (c = 50);
    var e = [],
      f = $("#friendsListHtml").html('<div class="refresh_button_friends" id="refresh_friends_button">&#8635; ' + l.t("Refresh List") + '</div><div id="friends_list_dnd_btn" class="dnd_btn' + (b.pm_dnd ? " on" : "") + '">' + (b.pm_dnd ? "DND" : "PM") + "</div>");
    a.sort(function(a, b) {
      var c = b[FRIEND_INDEX_GP];
      0 < b[FRIEND_INDEX_SERVER] ? c += 1E12 * (20 - b[FRIEND_INDEX_SERVER]) : 0 > b[FRIEND_INDEX_SERVER] && (c = 0 == b[FRIEND_INDEX_ROOM] ?
        c + 2E13 : c + (2E13 + 1E8 * (1E4 - b[FRIEND_INDEX_ROOM])));
      var d = a[FRIEND_INDEX_GP];
      0 < a[FRIEND_INDEX_SERVER] ? d += 1E12 * (20 - a[FRIEND_INDEX_SERVER]) : 0 > a[FRIEND_INDEX_SERVER] && (d = 0 == a[FRIEND_INDEX_ROOM] ? d + 2E13 : d + (2E13 + 1E8 * (1E4 - a[FRIEND_INDEX_ROOM])));
      return c - d
    });
    for (var h = a.length, k = !1, m = 0; m < h; m++) {
      var n = a[m];
      if (m < c) {
        var p;
        0 == n[FRIEND_INDEX_SERVER] ? p = "Offline" : 0 < n[FRIEND_INDEX_SERVER] ? p = "Server " + n[FRIEND_INDEX_SERVER] : 0 > n[FRIEND_INDEX_SERVER] && (p = 0 == n[FRIEND_INDEX_ROOM] ? "Lobby" : "Room: " + n[FRIEND_INDEX_ROOM]);
        var q =
          1 == m % 2 ? " odd" : "",
          r = $('<div class="friendListPhoto"></div>');
        r.append(Img2div(n[FRIEND_INDEX_IMAGE], n[FRIEND_INDEX_GENDER], "friendListPhotoImg", 0, 40, 30));
        q = $('<div id="friend_' + n[FRIEND_INDEX_ID] + '" friend="' + n[FRIEND_INDEX_ID] + '" class="friendListItem' + q + '"></div>');
        q.append(r);
        q.append('<div class="friendListRank rank rank' + n[FRIEND_INDEX_RANK] + '"></div>');
        q.append('<div class="friendListName blackShadow">' + n[FRIEND_INDEX_NAME] + "</div>");
        q.append('<div class="friendListGP blackShadow">GP ' + n[FRIEND_INDEX_GP] +
          "</div>");
        q.append('<div class="friendListLocation blackShadow">' + p + "</div>");
        f.append(q)
      } else k || (k = !0, f.append($('<div class="blackShadow" style="font-size: 11px;background:rgba(255,0,0,0.5)">' + l.t("Showing Friends") + ": " + c + " / " + h + '</div><div class="refresh_button_friends" id="show_more_friends_button">' + l.t("Show More Friends") + "</div>")));
      e.push({
        id: n[FRIEND_INDEX_ID],
        gp: n[FRIEND_INDEX_GP],
        rank: n[FRIEND_INDEX_RANK],
        name: n[FRIEND_INDEX_NAME],
        gender: n[FRIEND_INDEX_GENDER]
      })
    }
    $(".friendListItem").bind("click",
      function(a) {
        a.stopPropagation();
        $(".friendListItem").removeClass("selected");
        $(this).addClass("selected");
        ChatDialogCreate($(this).attr("friend"), $(this).children(".friendListName").html(), b)
      }).bind("mousedown", function(a) {
      a.stopPropagation()
    });
    InitRefreshButtonFriends(b);
    k && $("#show_more_friends_button").bind("click", function() {
      UpdateFriendsList(a, b, 2 * c, !0)
    });
    $("#friendsList").tinyscrollbar_update(d ? "bottom" : "top");
    $("#friends_list_dnd_btn").click(function() {
      DNDClicked(b)
    });
    UpdateFriendsInRooms();
    e.push({
      id: b.myPlayerInfo.id,
      gp: b.myPlayerInfo.gp,
      rank: b.myPlayerInfo.rank,
      name: b.myPlayerInfo.game_id,
      gender: b.myPlayerInfo.gender
    });
    e.sort(function(a, b) {
      return b.gp - a.gp
    });
    b.friends = e
  }

  function InitRefreshButtonFriends(a) {
    $("#refresh_friends_button").bind("click", function() {
      var b = get_time();
      b > g_last_refresh_friends_click + 3E3 && (g_last_refresh_friends_click = b, a.SendRefreshFriends())
    })
  }

  function InitRefreshButtonGuildies(a) {
    $(".refresh_button_guildies").bind("click", function() {
      var b = get_time();
      b > g_last_refresh_guildies_click + 3E3 && (g_last_refresh_guildies_click = b, a.SendRefreshGuildies())
    })
  }

  function UpdateFriendsInRooms() {
    var a = [],
      b = [];
    $(".friendListLocation").each(function() {
      var c = $(this),
        d = c.html(); - 1 != d.indexOf("Room: ") && (d = Number(d.substr(6)), -1 != c.parent().attr("id").indexOf("guild") ? b.push(d) : a.push(d))
    });
    $("#roomsList > .room").each(function() {
      var c = $(this),
        d = Number(c.children(".roomNumber").html());
      0 < d && (-1 != a.indexOf(d) ? c.children(".roomBuddy").show() : c.children(".roomBuddy").hide(), -1 != b.indexOf(d) ? c.children(".roomGuildMember").show() : c.children(".roomGuildMember").hide())
    })
  }

  function FriendUpdate(a, b, c, d, e) {
    var f = "Offline";
    d && (f = 0 == e ? "Lobby" : "Room: " + e);
    d = $("#friend_" + a);
    d.children(".friendListRank").removeClass().addClass("friendListRank rank rank" + b);
    d.children(".friendListGP").html("GP " + c);
    d.children(".friendListLocation").html(f);
    a = $("#guild_member_" + a);
    a.children(".friendListRank").removeClass().addClass("friendListRank rank rank" + b);
    a.children(".friendListGP").html("GP " + c);
    a.children(".friendListLocation").html(f);
    UpdateFriendsInRooms()
  }

  function GetHighestChatZIndex() {
    var a = 1;
    $(".ChatDialog").each(function(b) {
      b = parseFloat($(this).css("zIndex"));
      a = b > a ? b : a
    });
    return a
  }

  function BringChatToTop(a) {
    var b = parseFloat(a.css("zIndex")),
      c = GetHighestChatZIndex();
    b < c && a.css("z-index", c + 1)
  }

  function ChatDialogCreate(a, b, c) {
    var d = $("#chat_" + a);
    if (0 != d.length) BringChatToTop(d);
    else {
      var d = c.myPlayerInfo.guild_job == GUILD_JOB_LEADER || c.myPlayerInfo.guild_job == GUILD_JOB_SEMI_LEADER,
        e = max(0, min(400, window.innerWidth - 376)),
        f = max(0, min(300, window.innerHeight - 324)),
        e = random(0, e),
        f = random(0, f),
        h = GetHighestChatZIndex() + 1;
      b = '<div class="ChatDialog" id="chat_' + a + '" friend=' + a + ' style="left:' + e + "px;top:" + f + "px;z-index:" + h + '"><div class="chatDialogName blackShadow">' + b + '</div><div class="chatDialogDelete opacity_button"></div>' +
        (d ? '<div class="chatDialogGuildKick opacity_button"></div>' : "") + ('<a class="chatDialogProfile opacity_button" href="/u/' + a + '" target="_blank"></a>') + '<div class="chatDialogClose opacity_button"></div><input type="text" class="chatDialogInput" value="" maxlength="150"><div class="chatDialogText"><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div><div class="viewport"><div class="CanSelect overview chatDialogTextHtml"></div></div></div><div class="chatDialogEsc blackShadow">[ESC]</div></div>';
      $("#chat_divs").append(b);
      a = $("#chat_" + a);
      if (376 > window.innerWidth || 324 > window.innerHeight) a.css({
        scale: min(window.innerWidth / 376, window.innerHeight / 324),
        "transform-origin": "0 0"
      });
      else a.draggable({
        containment: "window"
      }).on("mousedown touchstart", function(a) {
        BringChatToTop($(this));
        a.stopPropagation();
        $(".ChatDialog input,#channelInput,#roomInput,#gameInput").blur()
      });
      $(".chatDialogTextHtml").unbind("mousedown mouseup").bind("mousedown mouseup", function(a) {
        a.stopPropagation()
      });
      a.children(".chatDialogText").tinyscrollbar({
        size: 183
      });
      a.children(".chatDialogInput").keydown(function(a) {
        a.which == KEY.Enter && (a.stopPropagation(), a = $(this).val(), "" != a && (c.SendPrivateChat($(this).parent().attr("friend"), a), $(this).val("")))
      });
      g_is_mobile_device || a.children(".chatDialogInput").focus();
      a.children(".chatDialogClose").on("click touchstart", function(a) {
        $(this).parent().remove();
        a.stopPropagation();
        a.preventDefault()
      });
      a.children(".chatDialogDelete").on("click touchstart", function(a) {
        a.stopPropagation();
        a.preventDefault();
        var b = $(this).parent().attr("friend");
        DragonDialogOpen("Delete Friend?", "Are you sure to delete this friend?", DIALOG_BUTTONS_OK_CANCEL, function(a) {
          a && c.SendDeleteFriend(b)
        })
      });
      a.children(".chatDialogGuildKick").on("click touchstart", function(a) {
        a.stopPropagation();
        a.preventDefault();
        var b = $(this).parent().attr("friend");
        DragonDialogOpen("Kick from Guild?", "Are you sure to kick this player from your guild?", DIALOG_BUTTONS_OK_CANCEL, function(a) {
          a && c.SendGuildKick(b)
        })
      })
    }
  }

  function FriendPrivateChat(a, b, c, d) {
    var e = $("#chat_" + a);
    c = text_filter(c, filtered_words);
    c = TextToEmo(c);
    if (0 == e.length) {
      if (d.pm_dnd) {
        0 != c.indexOf("(Auto-Reply)") && (d.pms_on_hold.push({
          user_id: a,
          name: b,
          text: c
        }), ChatReceived(l.t("You got a PM from") + " " + b, "[DND", CHAT_TYPE_DEAD, void 0, void 0, d), AudioPlay(AUDIO_DING), d.dnd_msg && d.SendPrivateChat(a, "(Auto-Reply) " + d.dnd_msg));
        return
      }
      ChatDialogCreate(a, b, d);
      e = $("#chat_" + a);
      AudioPlay(AUDIO_DING)
    }
    a = "[" + b + "] " + c + "<br>";
    e.find(".chatDialogTextHtml").append(a);
    e.children(".chatDialogText").tinyscrollbar_update("bottom")
  }

  function pad(a, b) {
    for (var c = "" + a; c.length < b;) c = "0" + c;
    return c
  }

  function Img2url(a, b) {
    return "m" == a ? STATIC_DIR + "images/fb_boy.gif" : "f" == a ? STATIC_DIR + "images/fb_girl.gif" : "" == a ? b == GENDER_FEMALE ? STATIC_DIR + "images/fb_girl.gif" : STATIC_DIR + "images/fb_boy.gif" : a == Number(a) ? "//graph.facebook.com/" + FB_API_VERSION + "/" + a + "/picture?type=large" : FixHTTPS(a)
  }

  function Img2div(a, b, c, d, e, f) {
    a = Img2url(a, b);
    if (0 == a.indexOf("//graph.facebook.com/")) {
      e *= 2;
      f *= 2;
      var h = document.createElement("canvas");
      c && (h.className = c);
      h.width = e;
      h.height = f;
      var k = new Image;
      k.onload = function() {
        var a = k.width,
          b = k.height,
          c = min(a / e, b / f),
          a = a / c,
          b = b / c;
        h.getContext("2d").drawImage(k, ceil((e - a) / 2), ceil((f - b) / 2), a, b)
      };
      k.src = a;
      c = h;
      $(c).css({
        scaleX: 0.5,
        scaleY: 0.5,
        "transform-origin": "0 0"
      })
    } else a = a.slice(a.indexOf("://") + 1), c = $('<div class="' + c + '"></div>').css({
      width: e,
      height: f,
      "background-image": "url(" +
        a + ")",
      "background-size": "cover",
      "background-position": "center center",
      "background-repeat": "no-repeat"
    });
    return d ? (a = $('<div class="glow_button_anim"></div>'), d = $('<a href="/u/' + d + '" target="_blank"></a>'), d.append(c), a.append(d), a) : c
  }

  function ChannelPlayerInfoUpdate(a, b) {
    $("#myName2").html("").append(createName(0, "", a.rank, a.guild, a.game_id, "", 2));
    $("#myGP2").html(Commatize(a.gp) + " GP");
    $("#myCash2").html(Commatize(a.cash) + " Cash");
    $("#myGold2").html(Commatize(a.gold) + " Gold");
    a.power_user ? $("#myPUGP,#myPUG").show() : $("#myPUGP,#myPUG").hide();
    a.plus10gp ? $("#myPlusGP").show() : $("#myPlusGP").hide();
    $("#NameChangeLittle").html("(" + (0 == a.name_changes ? "You have 1 Free name change" : "Name Change costs 4,000 Cash") + ")");
    $("#myPhotoDiv").html("").append(Img2div(a.photo_url,
      a.gender, "myPhotoImage", a.id, 62, 53));
    "x" == a.relationship_status ? $("#myGFPhotoDiv").html('<div class="opacity_button"><a href="/settings" target="_blank"><div class="myInfoRelText blackShadow"><span class="relationshipIcon"></span> Private</div></a></div>') : $("#myGFPhotoDiv").html("").append(BuildGFPhoto(a.relationship_status, a.relationship_with_id, a.relationship_with_photo, a.relationship_with_rank, a.relationship_with_name, a.relationship_with_gender, a.gender));
    var c = !a.background && a.power_user ? POWER_USER_BACKGROUND :
      a.background;
    g_channel_player ? (g_channel_player.change(a.head, AVATAR_TYPE_HEAD), g_channel_player.change(a.body, AVATAR_TYPE_BODY), g_channel_player.change(a.eyes, AVATAR_TYPE_EYES), g_channel_player.change(a.flag, AVATAR_TYPE_FLAG), g_channel_player.change(c, AVATAR_TYPE_BACKGROUND), g_channel_player.change(a.foreground, AVATAR_TYPE_FOREGROUND), void 0 != b && g_channel_player.change_mobile(b)) : g_channel_player = new CPlayerGraphic("#channel_player", void 0 != b ? b : -1, a.head, a.body, a.eyes, a.flag, !1, c, a.foreground);
    0 <
      a.event1 ? $("#event_button .event_button_text").html(pad(Math.floor(a.event1 / 60), 2) + ":" + pad(a.event1 % 60, 2) + "<br>&nbsp;") : $("#event_button .event_button_text").html("+?? Gold");
    0 < a.event2 ? $("#facebook_post .event_button_text").html(pad(Math.floor(a.event2 / 60), 2) + ":" + pad(a.event2 % 60, 2) + "<br>&nbsp;") : $("#facebook_post .event_button_text").html("+?? Cash");
    if (0 == $("#myName").length) {
      var c = RandomString(random(2, 6)),
        d = RandomString(random(2, 12));
      $("#channelScreen").append($('<div id="myName" class="hide"><span>' +
        c + "</span> " + d + "</div>")).append($('<div id="myRank" class="hide rank' + random(0, 20) + '"></div>')).append($('<div id="myGP" class="hide">' + random(1E3, 3E4) + '"></div>')).append($('<div id="myGold" class="hide">' + random(0, 3E4) + '"></div>')).append($('<div id="myCash" class="hide">' + random(0, 1E3) + '"></div>'));
      $("#myName3").html('<span class="GuildName">' + c + "</span> " + d).hide()
    } - 1 != g_server_force_mobile && g_channel_player.change_mobile(g_server_force_mobile)
  }

  function RoomChangeDetails(a, b) {
    var c = $("#room" + b);
    if (a) {
      var d = a[0],
        e = a[1],
        f = a[2],
        h = a[3],
        k = a[4],
        m = a[5],
        n = a[6],
        p = a[7],
        q = a[8],
        e = TextToEmo(text_filter(e, filtered_words));
      1 == q ? c.addClass("powerUserRoom") : c.removeClass("powerUserRoom");
      c.children(".roomNumber").html(d);
      c.children(".roomTitle").html(e);
      c.children(".numPlayers").html(f);
      c.children(".maxPlayers").html(h);
      d = "";
      k == ROOM_STATUS_WAITING ? d = "status-waiting" : k == ROOM_STATUS_FULL ? d = "status-full" : k == ROOM_STATUS_PLAYING && (d = "status-playing");
      c.children(".status").removeClass().addClass("status " +
        d);
      c.children(".gameMode").removeClass().addClass("gameMode iconMode" + m);
      n ? c.children(".roomLock").addClass("roomLocked") : c.children(".roomLock").removeClass("roomLocked");
      p == MAP.CUSTOM ? (k = Array.isArray(a[9]) ? GenerateMinimapCanvas(a[9][0], a[9][1]) : BooleanArrayToCanvas(DragonDecompress(a[9]), 213, 49, 213, 49), c.children(".roomMap").html("").css("background-position", "999px 999px").append(k)) : c.children(".roomMap").html("").css("background-position", "0 " + GetMapImageOffset(p) + "px");
      c.show();
      UpdateFriendsInRooms()
    } else c.hide()
  }

  function GenerateMinimapCanvas(a, b) {
    var c = DragonDecompress(a),
      d = document.createElement("canvas");
    d.width = 213;
    d.height = 49;
    var e = d.getContext("2d"),
      f = new Image;
    f.onload = function() {
      e.drawImage(f, 0, 0, 213, 49);
      var a = e.getImageData(0, 0, 213, 49);
      BooleanArrayToImageData(c, a);
      e.putImageData(a, 0, 0)
    };
    f.src = b;
    return d
  }

  function GetRoomDivFromRoomNumber(a) {
    for (var b = 0; 6 > b; b++)
      if ($("#room" + b + " .roomNumber").html() == a) return $("#room" + b)
  }
  var g_extra_info_timeout, g_extra_info_room;

  function CloseRoomExtraInfo() {
    g_extra_info_room = void 0;
    g_extra_info_timeout = clearTimeout(g_extra_info_timeout);
    $(".roomExtraInfo").removeClass("roomExtraInfo");
    $(".roomExtraInfoSlot").remove()
  }

  function ShowExtraRoomInfo(a) {
    var b = a[0],
      c = GetRoomDivFromRoomNumber(b);
    if (c) {
      CloseRoomExtraInfo();
      c.addClass("roomExtraInfo");
      for (var d = 1; d < a.length - 2; d += 3) c.append($('<div class="roomExtraInfoSlot roomExtraInfoSlot' + a[d] + '"><div class="playerListRank rank rank' + a[d + 1] + '"></div><div class="playerListName blackShadow">' + a[d + 2] + "</div></div>"));
      g_extra_info_room = b;
      g_extra_info_timeout = setTimeout(function() {
        CloseRoomExtraInfo()
      }, 3E3)
    }
  }
  var SERVER_SUB_TYPE_COUPLES = 4;

  function SetLobby(a, b, c) {
    1 == b ? (DragonTheme_ReTheme(), $("#buttonQuickJoin,#buttonCreateRoom,#buttonJoin,#buttonRoomsListUp,#buttonRoomsListDown,#filter_all,#filter_waiting,#filter_normal,#filter_boss,#filter_same,#filter_score,#filter_friends,#filter_guild,.room,#join_room2,#join_password_input").hide(), $("#buttonStart1v1,#buttonCreateTeam,#buttonJoinTeam,#lobbyButtonMobile,#tournament_info").show(), $("#channelScreen").css({
        "background-image": "none"
      }), $("body").css({
        "background-image": c == SERVER_SUB_TYPE_COUPLES ?
          "url(/static/images/themes/love_bg.jpg)" : "url(/static/images/themes/full_bg2.jpg)"
      }), void 0 == a.lobbyMobile && (a.lobbyMobile = MOBILE.ARMOR), $("#dialog_join_room_div .AlertBoxTitle").html(l.t("Join Team")), c == SERVER_SUB_TYPE_COUPLES ? ($("#buttonCreateTeam .Text").html('<img src="/static/images/hearts.png"> ' + l.t("Create Couple")), $("#buttonJoinTeam .Text").html('<img src="/static/images/hearts.png"> ' + l.t("Join Couple")), $("#room_auto_match_btn2").show(), $("#buttonCreateTeam,#buttonJoinTeam,#buttonStart1v1").addClass("LoveServer")) :
      ($("#buttonStart1v1 .Text").html(l.t("Start 1v1 Game")), $("#buttonCreateTeam .Text").html(l.t("Create Team")), $("#buttonJoinTeam .Text").html(l.t("Join Team")), $("#room_auto_match_btn2").hide(), $("#buttonCreateTeam,#buttonJoinTeam,#buttonStart1v1").removeClass("LoveServer"))) : (DragonTheme_ReTheme(), $("#buttonQuickJoin,#buttonCreateRoom,#buttonJoin,#buttonRoomsListUp,#buttonRoomsListDown,#filter_all,#filter_waiting,#filter_normal,#filter_boss,#filter_same,#filter_score,#filter_friends,#filter_guild,.room,#join_room2,#join_password_input").show(),
      $("#buttonStart1v1,#buttonCreateTeam,#buttonJoinTeam,#lobbyButtonMobile,#tournament_info").hide(), $("#channelScreen").css({
        "background-image": ""
      }), $("body").css({
        "background-image": ""
      }), g_channel_player && g_channel_player.change_mobile(), $("#dialog_join_room_div .AlertBoxTitle").html(l.t("Join Room")), $("#fastLobbyMsg").html("").hide(), $("#buttonStart1v1").hide(), $("#room_auto_match_btn2").hide());
    g_server_force_mobile = -1;
    $("#roomButtonMobile").show();
    g_tournament_timer = clearInterval(g_tournament_timer)
  }

  function LobbyChangeMobile(a) {
    g_channel_player.change_mobile(a)
  }
  var g_is_showing_tournament_waiting_msg;

  function TournamentWaitingMsgShow(a, b) {
    if (g_is_showing_tournament_waiting_msg) b && $("#queuePos").html(b);
    else {
      g_is_showing_tournament_waiting_msg = !0;
      AudioPlay(AUDIO_WAIT);
      var c = l.t("Searching") + '... <span id="queuePos">' + b + '</span><div id="hourglass"></div><div id="CancelWaiting" class="cancelwait">Cancel</div>';
      $("#tournament_waiting").html(c).css({
        top: -400
      }).show();
      setTimeout(function() {
        $("#tournament_waiting").css({
          top: 40
        })
      }, 50);
      $("#lobbyButtonMobile").hide();
      $("#CancelWaiting").click(function() {
        a.SendCancelTournamentWait();
        TournamentWaitingMsgHide()
      })
    }
  }

  function TournamentWaitingMsgHide() {
    g_is_showing_tournament_waiting_msg = !1;
    $("#tournament_waiting").html("").hide().css({
      top: -400
    });
    1 == g_server_type && -1 == g_server_force_mobile && $("#lobbyButtonMobile").show()
  }

  function SecondsToString(a) {
    var b = "";
    0 > a && (b = " Ago", a *= -1);
    var c = Math.floor(a / 86400),
      d = Math.floor(a % 86400 / 3600),
      e = Math.floor(a % 3600 / 60);
    a %= 60;
    return c ? c + " " + l.t("Days") + " " + (d ? d + " " + l.t("Hours") : "") + b : d ? d + " " + l.t("Hours") + " " + (e ? e + " " + l.t("Minutes") : "") + b : e ? e + " " + l.t("Minutes") + " " + (a ? a + " " + l.t("Seconds") : "") + b : a ? a + " " + l.t("Seconds") + " " + b : l.t("Now")
  }
  var g_tournament_timer, g_tournament_timer_start, g_t0, g_t1;

  function SetTournamentInfo(a) {
    DEBUG && console.log("[SetTournamentInfo]", a);
    a && (SetTournamentInfo2(a), g_t0 = a[0], g_t1 = a[1], g_tournament_timer = clearInterval(g_tournament_timer), 0 < g_t0 && 5E3 > g_t0 || 0 < g_t1 && 5E3 > g_t1) && (g_tournament_timer_start = get_time(), g_tournament_timer = setInterval(function() {
      var b = get_time();
      g_t0 && (a[0] = g_t0 - Math.floor((b - g_tournament_timer_start) / 1E3));
      g_t1 && (a[1] = g_t1 - Math.floor((b - g_tournament_timer_start) / 1E3));
      SetTournamentInfo2(a)
    }, 1E3))
  }
  var g_server_force_mobile = -1;

  function SetTournamentInfo2(a) {
    var b = ArrayToObject(a, "start_time end_time players avatar_on max_wind force_mobile name total_games last_5_minutes_games rooms map game_mode s1 tp save_personal save_guild min_points map2".split(" "));
    DEBUG && console.log("Tournament Info:", b);
    var c = $("#lobbyButtonMobile");
    a = "" + ("Avatar: " + (b.avatar_on ? "On" : "Off") + "<br>");
    a += "Wind: " + b.max_wind + "<br>";
    b.map != MAP.RANDOM && void 0 != b.map ? (a += "Map: (" + b.map + ") " + MAPS[b.map].name, b.map2 && (a += " / (" + b.map2 + ") " + MAPS[b.map2].name),
      a += "<br>") : a += "Map: Random<br>"; - 1 != b.force_mobile ? (a += "Mobile: (" + b.force_mobile + ") " + MOBILES[b.force_mobile].name + "<br>", c.hide()) : (a += "Mobile: Any<br>", c.show());
    g_server_force_mobile = b.force_mobile;
    a += "Game Mode: " + GAME_MODE_NAMES_LOWER[b.game_mode] + "<br>";
    b.s1 || (a += "S1 Disabled<br>");
    b.tp || (a += "Teleport Disabled<br>");
    b.save_personal && (a += "Saving Personal Tournament Points!<br>");
    b.save_guild && (a += "Saving Guild Tournament Points!<br>"); - 1E5 < b.min_points && (a += "Disqualify Points: " + b.min_points +
      "<br>");
    var c = $("#buttonStart1v1"),
      d = $("#buttonCreateTeam, #buttonJoinTeam"),
      e = $("#fastLobbyMsg");
    7 == b.players ? (c.hide(), d.show(), e.html(l.t("4v4 Guilds")).show()) : 8 == b.players ? (c.hide(), d.show(), e.html(l.t("4v4 Teams")).show()) : 4 == b.players ? (c.show(), d.show(), e.html(l.t("2v2 Couples (Boy+Girl Teams)")).show()) : (2 == b.players ? (c.show(), d.hide()) : (c.show(), d.show()), e.html("").hide());
    a = a + "<br>" + (l.t("Games started at the last 5 minutes") + ": " + b.last_5_minutes_games + "<br>");
    15 < b.last_5_minutes_games &&
      (a += l.t("Average Waiting Time") + ": " + (150 / b.last_5_minutes_games).toFixed(2) + " " + l.t("Seconds") + "<br>");
    DEBUG && (console.log("Teams + 1v1 Games Now:", b.rooms), console.log("Games Since Server Reset:", b.total_games));
    c = b.start_time;
    b = b.end_time;
    0 < c ? (a += "<br>Start Time: " + SecondsToString(c) + "<br>", b && b > c && (a += "Tournament Time: " + SecondsToString(b - c) + "<br>")) : b && (a += "<br>End Time: " + SecondsToString(b) + "<br>");
    $("#tournament_info").html(a)
  };

  function SelectThisResellerButton(a) {
    $(".seller_button").removeClass("buttonGlow");
    $(a).addClass("buttonGlow")
  }

  function ResellersGUI(a) {
    $("#buttonCharge2, #buttonChargeShop, #buttonChargeShop1").click(function() {
      AudioPlay(AUDIO_BUTTON_SELECT2);
      2 > a.user_rank ? DragonDialogOpen('New Player <div class="rank rank' + a.user_rank + '" style="display:inline-block"></div>', 'You have to be at least rank <div class="rank rank2" style="display:inline-block"></div> (1200+ GP) for buying cash online or getting free cash for offers.<br>Play some games first.', DIALOG_BUTTONS_OK) : ($("#chargeWindow").show("fast"), "br" == SERVER_TYPE &&
        ($("#resellers_btn").hide(), $("#charge_pin_btn").hide()), $(".seller_button").removeClass("buttonGlow"), $("#chargeWindowPayment").html('<iframe style="width:100%;height:762px;border:0;padding:0;margin:0;" frameborder="0" src="/static/charge_news.html"></iframe>'))
    });
    $("#chargeWindowClose").click(function() {
      $("#chargeWindowPayment").html("");
      $("#chargeWindow").hide("fast")
    });
    $("#paymentwall_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html(l.t("Loading") + "...");
      var b =
        $("#chargeWindowPayment");
      $.get("/paymentwall_get", {
        u: a.myPlayerInfo.username
      }, function(a) {
        1 >= a.length ? (a = a[0], 1 == a ? b.html("I don't know who you are, please relog to the game.") : 3 == a ? b.html("Different user, please re-login (F5).") : b.html("Error " + a)) : b.html('<iframe src="' + a[1] + '" width="780" height="800" frameborder="0"></iframe>')
      }, "json").error(function(a, d, e) {
        b.html("Internet error happened, try again.");
        console.log("paymentwall_get ERROR:", a, d, e)
      })
    });
    $("#ultimatepay_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe src="/static/ultimatepay.html" class="ChargeFrame"></iframe>')
    });
    $("#charge_pin_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe src="/pin" class="ChargeFrame"></iframe>')
    });
    $("#resellers_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe src="/static/resellers.html" class="ChargeFrame"></iframe>')
    });
    $("#charge_myinfo_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe src="/my_payments" class="ChargeFrame"></iframe>')
    });
    $("#charge_bitcoin_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe src="/static/bitcoin.html" class="ChargeFrame"></iframe>')
    });
    $("#matomy_btn").click(function() {
      SelectThisResellerButton(this);
      var b = a.myPlayerInfo.id;
      $("#chargeWindowPayment").html('<iframe src="https://service.matomy.com/offer/?id=ab88ceff-0075-4a74-846f-1840270d7796&user_id=' + b + '" frameborder="0" width="780" height="800" marginheight="0" marginwidth="0" allowtransparency="true"></iframe>')
    });
    $("#superrewards_btn").click(function() {
      SelectThisResellerButton(this);
      var b = a.myPlayerInfo.id;
      $("#chargeWindowPayment").html('<iframe src="https://www.superrewards-offers.com/super/offers?h=ljfotykngeh.024155292008&uid=' + b + '" frameborder="0" width="780" height="800" scrolling="no"></iframe>')
    });
    $("#supersonic_btn").click(function() {
      SelectThisResellerButton(this);
      var b = a.myPlayerInfo.id;
      $("#chargeWindowPayment").html("Loading...");
      $.get("/get_supersonicads_signature", {
        u: b
      }, function(a) {
        "Bad" != a && "Relog" !=
          a ? $("#chargeWindowPayment").html('<iframe style="width:780px;height:762px;border:0;padding:0;margin:0;" frameborder="0" src="' + a + '"></iframe>') : $("#chargeWindowPayment").html("Error - Please re-log (F5) and try again")
      })
    });
    $("#dragonoffers_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe style="width:100%;height:762px;border:0;padding:0;margin:0;" frameborder="0" src="/dragonoffers"></iframe>')
    });
    $("#astropay_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe style="width:100%;height:762px;border:0;padding:0;margin:0;" frameborder="0" src="/astropay"></iframe>')
    });
    $("#reseller1_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe style="width:100%;height:762px;border:0;padding:0;margin:0;" frameborder="0" src="/static/ash.html"></iframe>')
    });
    $("#reseller2_btn").click(function() {
      SelectThisResellerButton(this);
      $("#chargeWindowPayment").html('<iframe style="width:100%;height:762px;border:0;padding:0;margin:0;" frameborder="0" src="/static/mastercadem.html"></iframe>')
    })
  };
  var WebSocket = window.WebSocket,
    JSON = window.JSON;

  function DragonSocket() {
    this.ws = void 0;
    this.receive_handlers = [];
    this.error_handler = this.disconnected_handler = this.connected_handler = void 0
  }
  DragonSocket.prototype.IsSupported = function() {
    return "undefined" !== typeof WebSocket
  };
  DragonSocket.prototype.SetHandler = function(a, b) {
    "connected" == a ? this.connected_handler = b : "disconnected" == a ? this.disconnected_handler = b : "error" == a ? this.error_handler = b : "receive" == a && (this.receive_handlers = Object.freeze(b))
  };
  DragonSocket.prototype.Connect = function(a) {
    this.ws = new WebSocket(a);
    var b = this;
    this.ws.onopen = function() {
      b.connected_handler && b.connected_handler()
    };
    this.ws.onclose = function() {
      b.disconnected_handler && b.disconnected_handler()
    };
    this.ws.onerror = function(a) {
      b.error_handler && b.error_handler(a)
    };
    this.ws.onmessage = function(a) {
      try {
        var d = JSON.parse(a.data)
      } catch (e) {
        b.error_handler && b.error_handler("Received not JSON: " + a.data);
        return
      }
      void 0 == d.length || 1 > d.length ? b.error_handler && b.error_handler("JSON is not Array: " +
        d) : (a = d[0], d.shift(), b.receive_handlers[a] ? b.receive_handlers[a].apply(window, d) : b.error_handler && b.error_handler("No handler for opcode:", a, "at packet:", d))
    }
  };
  DragonSocket.prototype.Send = function() {
    if (0 != arguments.length) {
      for (var a = [], b = 0; b < arguments.length; b++) a.push(arguments[b]);
      this.ws.send(JSON.stringify(a))
    }
  };
  DragonSocket.prototype.Disconnect = function() {
    this.ws && this.ws.close()
  };
  DragonFreeze(DragonSocket);
  DragonFreeze(WebSocket);

  function DragonParticle(a, b, c, d, e, f, h, k) {
    var m = function(a, b, c, d, e, f) {
      this.x0 = a;
      this.y0 = b;
      this.v = new Vector(c, d);
      this.ax = e;
      this.ay = f
    };
    m.prototype.GetPosAtTime = function(a) {
      a /= 1E3;
      return {
        x: this.x0 + this.v.x * a + this.ax * a * a / 2,
        y: this.y0 + this.v.y * a + this.ay * a * a / 2
      }
    };
    this.time = h;
    this.div_id = "P" + random(0, 999999);
    this.start_time = get_time();
    this.zp = new m(a, b, c, d, e, f);
    k.x = a;
    k.y = b;
    this.div = $("<div/>", {
      "class": "Particle"
    }).css(k).appendTo(DIV_TO_CREATE_GAME_OBJECTS);
    var n = this;
    this.interval = setInterval(function() {
        n.update()
      },
      30)
  }
  DragonParticle.prototype.update = function() {
    var a = get_time() - this.start_time;
    if (a >= this.time) this.Remove();
    else {
      var b = this.zp.GetPosAtTime(a);
      this.div.css({
        left: b.x,
        top: b.y,
        opacity: 1 - a / this.time
      })
    }
  };
  DragonParticle.prototype.Remove = function() {
    this.interval = clearInterval(this.interval);
    this.div.remove()
  };
  Object.freeze(DragonParticle.prototype);
  (function() {
    function a() {
      this.callbacks = {}
    }

    function b(a) {
      var b = this;
      a = a || {};
      this.config = {
        url: "http://signaling.simplewebrtc.com:8888",
        log: !1,
        localVideoEl: "",
        remoteVideosEl: "",
        autoRequestMedia: !1,
        peerConnectionConfig: {
          iceServers: "firefox" == k ? [{
            url: "stun:124.124.124.2"
          }] : [{
            url: "stun:stun.l.google.com:19302"
          }]
        },
        peerConnectionContraints: {
          optional: [{
            DtlsSrtpKeyAgreement: !0
          }]
        },
        media: {
          audio: !0,
          video: {
            mandatory: {},
            optional: []
          }
        }
      };
      var e, f;
      for (e in a) this.config[e] = a[e];
      webRTCSupport || console.error("Your browser doesn't seem to support WebRTC");
      this.config.log && (d = console);
      this.pcs = {};
      var r = this;
      f = this.connection = io.connect(this.config.url);
      f.on("connect", function() {
        b.emit("ready", f.socket.sessionid);
        b.sessionReady = !0;
        b.testReadiness()
      });
      f.on("message", function(a) {
        var d = b.pcs[a.from];
        d ? d.handleMessage(a) : (b.pcs[a.from] = new c({
          id: a.from,
          parent: b,
          initiator: !1,
          name: a.from_name
        }), b.pcs[a.from].handleMessage(a))
      });
      f.on("joined", function(a, c, d, e) {
        b.pcs[c] || b.startVideoCall(c, d);
        r.emit("joined", d, e)
      });
      f.on("left", function(a) {
        if (a = b.pcs[a]) a.handleStreamRemoved(),
          r.emit("left", a.name)
      });
      this.callbacks = {};
      this.on("*", function(a, b, c) {
        d.log("event:", a, b, c)
      });
      window.user_media_stream ? (h(this.getLocalVideoContainer(), window.user_media_stream), this.localStream = window.user_media_stream, this.testReadiness()) : this.config.autoRequestMedia && this.startLocalVideo()
    }

    function c(a) {
      var b = this;
      this.id = a.id;
      this.name = a.name;
      this.parent = a.parent;
      this.initiator = a.initiator;
      this.pc = new e(this.parent.config.peerConnectionConfig, this.parent.config.peerConnectionContraints);
      this.pc.onicecandidate =
        this.onIceCandidate.bind(this);
      this.pc.addStream(this.parent.localStream);
      this.pc.onaddstream = this.handleRemoteStreamAdded.bind(this);
      this.pc.onremovestream = this.handleStreamRemoved.bind(this);
      this.mediaConstraints = {
        mandatory: {
          OfferToReceiveAudio: !0,
          OfferToReceiveVideo: !0
        }
      };
      this.callbacks = {};
      this.on("*", function(a, c) {
        b.parent.emit(a, c, b)
      })
    }
    var d = {
        log: function() {},
        warn: function() {},
        error: function() {}
      },
      e = null,
      f = null,
      h = null,
      k = null;
    webRTCSupport = !0;
    navigator.mozGetUserMedia ? (d.log("This appears to be Firefox"),
      k = "firefox", e = mozRTCPeerConnection, RTCSessionDescription = mozRTCSessionDescription, RTCIceCandidate = mozRTCIceCandidate, f = navigator.mozGetUserMedia.bind(navigator), h = function(a, b) {
        a.mozSrcObject = b;
        a.play()
      }, MediaStream.prototype.getVideoTracks = function() {
        return []
      }, MediaStream.prototype.getAudioTracks = function() {
        return []
      }) : navigator.webkitGetUserMedia ? (k = "chrome", e = webkitRTCPeerConnection, f = navigator.webkitGetUserMedia.bind(navigator), h = function(a, b) {
        a.autoplay = !0;
        a.src = webkitURL.createObjectURL(b)
      },
      webkitMediaStream.prototype.getVideoTracks || (webkitMediaStream.prototype.getVideoTracks = function() {
        return this.videoTracks
      }, webkitMediaStream.prototype.getAudioTracks = function() {
        return this.audioTracks
      }), webkitRTCPeerConnection.prototype.getLocalStreams || (webkitRTCPeerConnection.prototype.getLocalStreams = function() {
        return this.localStreams
      }, webkitRTCPeerConnection.prototype.getRemoteStreams = function() {
        return this.remoteStreams
      })) : webRTCSupport = !1;
    window.webRTCSupport = webRTCSupport;
    a.prototype.on =
      function(a, b, c) {
        var d = 3 === arguments.length,
          e = d ? arguments[2] : arguments[1];
        e._groupName = d ? arguments[1] : void 0;
        (this.callbacks[a] = this.callbacks[a] || []).push(e);
        return this
      };
    a.prototype.once = function(a, b) {
      function c() {
        d.off(a, c);
        b.apply(this, arguments)
      }
      var d = this;
      this.on(a, c);
      return this
    };
    a.prototype.releaseGroup = function(a) {
      var b, c, d, e;
      for (b in this.callbacks)
        for (e = this.callbacks[b], c = 0, d = e.length; c < d; c++) e[c]._groupName === a && (e.splice(c, 1), c--, d--);
      return this
    };
    a.prototype.off = function(a, b) {
      var c =
        this.callbacks[a],
        d;
      if (!c) return this;
      if (1 === arguments.length) return delete this.callbacks[a], this;
      d = c.indexOf(b);
      c.splice(d, 1);
      return this
    };
    a.prototype.emit = function(a) {
      var b = [].slice.call(arguments, 1),
        c = this.callbacks[a],
        d = this.getWildcardCallbacks(a),
        e, f;
      if (c)
        for (e = 0, f = c.length; e < f; ++e) c[e].apply(this, b);
      if (d)
        for (e = 0, f = d.length; e < f; ++e) d[e].apply(this, [a].concat(b));
      return this
    };
    a.prototype.getWildcardCallbacks = function(a) {
      var b, c, d = [];
      for (b in this.callbacks)
        if (c = b.split("*"), "*" === b || 2 === c.length &&
          a.slice(0, c[1].length) === c[1]) d = d.concat(this.callbacks[b]);
      return d
    };
    b.prototype = Object.create(a.prototype, {
      constructor: {
        value: b
      }
    });
    b.prototype.getEl = function(a) {
      return "string" == typeof a ? document.getElementById(a) : a
    };
    b.prototype.getLocalVideoContainer = function() {
      var a = this.getEl(this.config.localVideoEl);
      if (a && "VIDEO" === a.tagName) return a;
      var b = document.createElement("video");
      a.appendChild(b);
      return b
    };
    b.prototype.getRemoteVideoContainer = function() {
      return this.getEl(this.config.remoteVideosEl)
    };
    b.prototype.startVideoCall = function(a, b) {
      this.pcs[a] = new c({
        id: a,
        parent: this,
        initiator: !0,
        name: b
      });
      this.pcs[a].start()
    };
    b.prototype.createRoom = function(a, b) {
      2 === arguments.length ? this.connection.emit("create", a, b) : this.connection.emit("create", a)
    };
    b.prototype.joinRoom = function(a, b) {
      this.connection.emit("join", a, b);
      this.roomName = a
    };
    b.prototype.leaveRoom = function() {
      if (this.roomName) {
        this.connection.emit("leave", this.roomName);
        for (var a in this.pcs) this.pcs[a].end()
      }
    };
    b.prototype.testReadiness = function() {
      var a =
        this;
      this.localStream && this.sessionReady && setTimeout(function() {
        a.emit("readyToCall", a.connection.socket.sessionid)
      }, 500)
    };
    b.prototype.startLocalVideo = function(a) {
      var b = this;
      f(this.config.media, function(c) {
        window.user_media_stream = c;
        h(a || b.getLocalVideoContainer(), c);
        b.localStream = c;
        b.testReadiness()
      }, function(a) {
        b.emit("reject", a);
        throw Error("Failed to get access to local media.", a);
      })
    };
    b.prototype.send = function(a, b, c) {
      this.connection.emit("message", {
        to: a,
        type: b,
        payload: c
      })
    };
    b.prototype.changeName =
      function(a) {
        this.connection.emit("changeName", a)
      };
    c.prototype = Object.create(a.prototype, {
      constructor: {
        value: c
      }
    });
    c.prototype.handleMessage = function(a) {
      "offer" === a.type ? (d.log("setting remote description"), this.pc.setRemoteDescription(new RTCSessionDescription(a.payload)), this.answer()) : "answer" === a.type ? this.pc.setRemoteDescription(new RTCSessionDescription(a.payload)) : "candidate" === a.type && (a = new RTCIceCandidate({
        sdpMLineIndex: a.payload.label,
        candidate: a.payload.candidate
      }), this.pc.addIceCandidate(a))
    };
    c.prototype.send = function(a, b) {
      this.parent.send(this.id, a, b)
    };
    c.prototype.onIceCandidate = function(a) {
      this.closed || (a.candidate ? this.send("candidate", {
        label: a.candidate.sdpMLineIndex,
        id: a.candidate.sdpMid,
        candidate: a.candidate.candidate
      }) : d.log("End of candidates."))
    };
    c.prototype.start = function() {
      var a = this;
      this.pc.createOffer(function(b) {
        d.log("setting local description");
        a.pc.setLocalDescription(b);
        d.log("sending offer", b);
        a.send("offer", b)
      }, null, this.mediaConstraints)
    };
    c.prototype.end = function() {
      this.pc.close();
      this.handleStreamRemoved()
    };
    c.prototype.answer = function() {
      var a = this;
      d.log("answer called");
      this.pc.createAnswer(function(b) {
        d.log("setting local description");
        a.pc.setLocalDescription(b);
        d.log("sending answer", b);
        a.send("answer", b)
      }, null, this.mediaConstraints)
    };
    c.prototype.handleRemoteStreamAdded = function(a) {
      var b = this.name;
      a = this.stream = a.stream;
      var b = $('<div class="vframe"><div class="vname NoSelect">' + b + "</div></div>"),
        c = document.createElement("video"),
        d = $("#remotesVideos");
      c.id = this.id;
      h(c, a);
      b.append(c);
      d && d.append(b);
      this.emit("videoAdded", c, this.name)
    };
    c.prototype.handleStreamRemoved = function() {
      var a = $("#" + this.id);
      a.parent().remove();
      this.emit("videoRemoved", a);
      delete this.parent.pcs[this.id];
      this.closed = !0
    };
    window.DragonVideo = b
  })();
  var g_dragonVideo, g_dragonVideo_on;

  function DragonVideoButton(a, b) {
    if (g_dragonVideo_on) console.log("[DragonVideo] END"), g_dragonVideo_on = !1, g_dragonVideo.leaveRoom(), $("#DragonVideo").hide(), alertify.log("DragonBound VideoChat Exit - Bye! :)");
    else if (webRTCSupport) {
      console.log("[DragonVideo] START");
      var c = $("#VideoChannelInput").val();
      c || (c = b ? b : "" + random(1, 999999), $("#VideoChannelInput").val(c));
      console.log("[DragonVideo] room:", c, "user:", a);
      if (g_dragonVideo) $("#DragonVideo").show(), alertify.log("Joining VideoChat..."), g_dragonVideo.joinRoom(c,
        a);
      else {
        alertify.log("Welcome to DragonVideo - Please Allow Camera / Microphone (if doesn't work, reconnect your cam/mic and restart browser)");
        $("#localVideo").draggable({
          containment: "body",
          scroll: !1
        }).click(function() {
          $(this).toggleClass("bigVideo")
        });
        $("#localVideo")[0].volume = 0;
        var d = new DragonVideo({
          localVideoEl: "localVideo",
          remoteVideosEl: "remotesVideos",
          autoRequestMedia: !0,
          url: "t.zotata.com" == location.hostname ? "https://t.zotata.com:9988" : "https://videoserver.dragonbound.net:9988",
          iceServers: [{
            url: "stun:stun.l.google.com:19302"
          }, {
            url: "stun:23.21.150.121"
          }, {
            url: "stun:124.124.124.2"
          }, {
            url: "turn:numb.viagenie.ca",
            credential: "webrtcdemo",
            username: "louis@mozilla.com"
          }, {
            url: "turn:homeo@turn.bistri.com:80",
            credential: "homeo"
          }]
        });
        d.on("videoAdded", function(a, b) {
          console.log("[DragonVideo] Video added:", a, b);
          $(a).parent().draggable({
            containment: "body",
            scroll: !1
          }).click(function() {
            $(this).children().toggleClass("bigVideo")
          }).css({
            left: window.innerWidth / 2 + random(-200, 50),
            top: window.innerHeight / 2 + random(-200, 50)
          })
        });
        d.on("readyToCall",
          function(b) {
            console.log("[DragonVideo] readyToCall - my_id:", b);
            $("#DragonVideo").show();
            alertify.log("Cam/Mic Ready :)<br>Drag Video = Move, Click = Size");
            d.joinRoom(c, a)
          });
        d.on("joined", function(a) {
          console.log("[DragonVideo] joined:", a);
          alertify.log("Video User Joined: " + EscapeHTML(a))
        });
        d.on("left", function(a) {
          console.log("[DragonVideo] left:", a);
          alertify.log("Video User Left: " + EscapeHTML(a))
        });
        d.on("reject", function(a) {
          console.log("[DragonVideo] reject:", a);
          alertify.log("Can't get your cam/mic, please Allow")
        });
        g_dragonVideo = d
      }
      g_dragonVideo_on = !0
    } else alertify.alert("Your browser is not supported - Use latest Chrome/FireFox")
  };
  PIXI.Text.prototype.setText = function(a) {
    a = a.toString() || " ";
    this.text != a && (this.text = a, this.dirty = !0)
  };
  PIXI.Text.prototype.wordWrap = function(a) {
    var b = "";
    a = a.split("\n");
    for (var c = 0; c < a.length; c++) {
      for (var d = this.style.wordWrapWidth, e = a[c].split(" "), f = 0; f < e.length; f++) {
        var h = this.context.measureText(e[f]).width,
          k = h + this.context.measureText(" ").width;
        if (0 === f || k > d) {
          0 < f && (b += "\n");
          if (35 < e[f].length) {
            for (var d = [], k = 0, m = e[f].length; k < m; k += 35) d.push(e[f].substring(k, k + 35));
            e[f] = d.join("\n")
          }
          b += e[f];
          d = this.style.wordWrapWidth - h
        } else d -= k, b += " " + e[f]
      }
      c < a.length - 1 && (b += "\n")
    }
    return b
  };
  PIXI.DisplayObjectContainer.prototype.removeChild = function(a) {
    try {
      return this.removeChildAt(this.children.indexOf(a))
    } catch (b) {
      warn(b.message, a)
    }
  };
  PIXI.DisplayObjectContainer.prototype.removeAll || (PIXI.DisplayObjectContainer.prototype.removeAll = function() {
    for (; this.children[0];) this.removeChild(this.children[0])
  });
  var g_TexturesCache = {};

  function GetTextureWithCache(a, b, c, d, e) {
    g_TexturesCache[a] || (g_TexturesCache[a] = new PIXI.Texture.fromImage(FixCORS(a)));
    if (void 0 != e) {
      var f = a + "_" + b + "_" + c + "_" + d + "_" + e;
      g_TexturesCache[f] || (g_TexturesCache[f] = new PIXI.Texture(g_TexturesCache[a], new PIXI.Rectangle(b, c, d, e)));
      return g_TexturesCache[f]
    }
    return g_TexturesCache[a]
  }
  ANIMATIONS_FPS = 10;

  function depthCompare(a, b) {
    return void 0 == a.z ? -1 : void 0 == b.z ? 1 : a.z == b.z ? a.y - b.y : a.z - b.z
  }
  PIXI.DisplayObjectContainer.prototype.ApplyZIndex = function() {
    this.children.sort(depthCompare)
  };
  var ZINDEX = {
      ground: 1,
      player: 1E3,
      player_info: 2E3,
      explode: 3E3,
      thor_shot: 3001,
      thor: 3002,
      lightning: 3003,
      shot: 3004,
      ground_parts: 3005,
      damage: 3006,
      textBubble: 3007
    },
    LOW_FPS = 20;

  function Dragon2D() {
    this.world = {
      players: {}
    };
    this.original_w = 800;
    this.original_h = 600;
    this.is_keep_aspect_ratio = !0;
    this.groundPartsTexture = [];
    this.fps = 60
  }
  Dragon2D.prototype.Init = function() {
    var a = this.stage = new PIXI.Stage(0, !0),
      b = this.stage_scaled = new PIXI.DisplayObjectContainer;
    a.addChild(b);
    PIXI.dontSayHello = !0;
    a = this.renderer = new(g_renderer == RENDERER_CANVAS || 0 == localStorage.allowWebGL ? PIXI.CanvasRenderer : PIXI.autoDetectRenderer)(this.original_w, this.original_h);
    Resize(!0);
    a.view.style.display = "block";
    $("#Dragon2D").append(a.view);
    this.is_3d = this.renderer instanceof PIXI.WebGLRenderer;
    this.fps_sprite = new PIXI.Text("", {
      font: "26px Arial",
      stroke: "black",
      fill: "white",
      strokeThickness: 5
    });
    this.fps_sprite.scale.x = this.fps_sprite.scale.y = 0.5;
    this.camera_container = new DisplayObjectContainerWithZ;
    this.stage_scaled.addChild(this.camera_container);
    this.thor = new Thor;
    this.camera_container.addChild(this.thor, ZINDEX.thor);
    b.addChild(this.fps_sprite);
    DragonClock.Add(this);
    DragonClock.Add(this, "Render", !0);
    this.ReInit()
  };
  Dragon2D.prototype.Shake = function() {
    var a = $(this.renderer.view);
    a.removeClass("shake_anim");
    setTimeout(function() {
      a.addClass("shake_anim")
    }, 1);
    clearTimeout(this.shake_remove_timeout);
    this.shake_remove_timeout = setTimeout(function() {
      a.removeClass("shake_anim")
    }, 200)
  };
  Dragon2D.prototype.ReInit = function() {
    this.total_elapsed_time = this.frames = 0;
    this.RemoveAll();
    Resize(!0);
    g_dragonClock.StartLoop()
  };
  Dragon2D.prototype.Stop = function() {
    g_dragonClock.StopLoop()
  };
  Dragon2D.prototype.CreateShot = function(a, b, c, d, e) {
    a = new Shot2(a, b, c, this, d, e);
    this.camera_container.addChild(a, ZINDEX.shot);
    return a
  };
  Dragon2D.prototype.CreateExplode = function(a, b, c) {
    if ((a = EXPLODES[a]) && a.file) {
      AudioPlay(a.sound);
      var d = -1 == a.file.indexOf("/") ? "explodes/" + (a.fileS || a.file) + ".png" : a.file;
      this.camera_container.addChild(new AnimatedSprite(d, a.graphics, b, c, 20, !1, LOOP_ONCE, 0, !0, !!a.fileS), ZINDEX.explode)
    }
  };
  Dragon2D.prototype.CreateFlyingGroundPart = function(a, b) {
    var c = random(0, 43);
    this.groundPartsTexture[c] || (this.groundPartsBaseTexture || (this.groundPartsBaseTexture = PIXI.Texture.fromImage("/static/images/particles1.png")), this.groundPartsTexture[c] = new PIXI.Texture(this.groundPartsBaseTexture, new PIXI.Rectangle(37 * c, 0, 36, 36)));
    this.camera_container.addChild(new FlyingSprite(this.groundPartsTexture[c], a, b, random(0, 359), random(100, 600), 0, 800, 1500), ZINDEX.ground_parts)
  };
  Dragon2D.prototype.CreateDamageEffect = function(a, b, c, d, e, f) {
    this.camera_container.addChild(new DamageSprite(this.camera_container, a, b, c, d, e, f), ZINDEX.damage)
  };
  Dragon2D.prototype.SetPlayerTurn = function(a) {
    if (a) {
      var b = this.world.players[a];
      if (!b) return warn("[SetPlayerTurn] unknown player:", a, this.world.players);
      b.player_info.SetTurn(!0)
    } else this.last_turn_of_player_id && this.last_turn_of_player_id != a && this.world.players[this.last_turn_of_player_id] && this.world.players[this.last_turn_of_player_id].player_info.SetTurn(!1);
    this.last_turn_of_player_id = a
  };
  var THOR_SHOOT_TEXTURE = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAeCAYAAADtlXTHAAAAB3RJTUUH3gQLDzQv3cZ/rQAAAAlwSFlzAAAnEAAAJxABlGlRGQAAAARnQU1BAACxjwv8YQUAAABKSURBVHjaY2Bg+M/LxMXFwAkiuJg4OSEsKAHkciFxsYmBdDBcuvT/ChMDAwMTs6hogyLT9+8M35m+fYMRQO4PJC42MTgXaMh/KQBXYCrEWIxApwAAAABJRU5ErkJggg==";
  Dragon2D.prototype.ThorShoot = function(a, b, c, d) {
    this.thor.MoveTo(a, b, -c);
    this.thorShootTexture || (this.thorShootTexture = PIXI.Texture.fromImage(THOR_SHOOT_TEXTURE));
    var e = new PIXI.Sprite(this.thorShootTexture);
    e.x = a;
    e.y = b;
    e.scale.x = d;
    e.anchor.y = 0.5;
    e.rotation = AngleToRad(-c);
    this.camera_container.addChild(e, ZINDEX.thor_shot);
    var f = this;
    setTimeout(function() {
      f.camera_container.removeChild(e)
    }, LIGHTNING_SHOW_TIME)
  };
  var LIGHTNING_SHOW_TIME = 100,
    LIGHTNINGS_IMAGE_FILE = "/static/images/lightnings.png";
  Dragon2D.prototype.CreateLightning = function(a, b, c) {
    this.lightningsTexture || (this.lightningsTexture = PIXI.Texture.fromImage(LIGHTNINGS_IMAGE_FILE));
    var d = new PIXI.TilingSprite(this.lightningsTexture);
    d.tilePosition.x = 64 * random(0, 3);
    d.x = a;
    d.y = b;
    d.width = 64;
    d.height = 1024;
    d.anchor.x = 0.5;
    this.is_3d || (d.anchor.x = 0, d.x += 32);
    d.rotation = AngleToRad(90 - c);
    this.camera_container.addChild(d, ZINDEX.lightning);
    var e = this;
    setTimeout(function() {
      e.camera_container.removeChild(d)
    }, LIGHTNING_SHOW_TIME)
  };
  Dragon2D.prototype.SSBackgroundFadeIn = function() {
    this.background && (this.background.tint = 5263440);
    this.ground && (this.ground.tint = 8421504);
    this.stage.setBackgroundColor(1052688)
  };
  Dragon2D.prototype.SSBackgroundFadeOut = function() {
    this.background && (this.background.tint = this.is_in_sd ? 40960 : 16777215);
    this.ground && (this.ground.tint = 16777215);
    this.bgcolor && this.stage.setBackgroundColor(this.is_in_sd ? 24576 : parseInt(this.bgcolor.slice(1), 16))
  };
  Dragon2D.prototype.SDBackgroundFadeIn = function() {
    this.is_in_sd = !0;
    this.background && (this.background.tint = 40960);
    this.stage.setBackgroundColor(24576)
  };
  Dragon2D.prototype.ResetBackgroundTint = function() {
    this.background && (this.background.tint = 16777215);
    this.ground && (this.ground.tint = 16777215);
    this.bgcolor && this.stage.setBackgroundColor(parseInt(this.bgcolor.slice(1), 16));
    this.is_in_sd = !1
  };
  Dragon2D.prototype.SetMap = function(a) {
    var b = DragonTheme_Get2("map_bg");
    b && "." != b || (b = a.bg);
    this.SetBackground(a.bgcolor, b);
    this.map = a;
    this.SetGround(a);
    this.CameraInit(a)
  };
  Dragon2D.prototype.ReSetBackground = function() {
    this.SetBackground(this.map.bgcolor, this.map.bg)
  };
  Dragon2D.prototype.AddPlayer = function(a) {
    var b = new PlayerInfo(a.rank, a.name, a.guild, a.team, a.country, a.hp, a.maxhp, a.shield, a.maxshield),
      c = new PlayerContainer(a.x, a.y, a.look, a.body, a.mobile, a.avatars.head, a.avatars.body, a.avatars.eyes, a.avatars.flag, a.avatars.bg, a.avatars.fg, b, a.aim_circle_x, a.aim_circle_y, a.ang, a.minang, a.maxang),
      d = a.n;
    a.is_me && (d += 50);
    this.world.players[a.id] = c;
    this.camera_container.addChild(c, ZINDEX.player + d);
    this.camera_container.addChild(b, ZINDEX.player_info + d);
    return c
  };
  Dragon2D.prototype.RemovePlayer = function(a) {
    this.world.players[a].player_info.Remove();
    this.world.players[a].Remove();
    delete this.world.players[a]
  };
  Dragon2D.prototype.RemoveAll = function(a) {
    for (a in this.world.players) this.RemovePlayer(a);
    this.isInMapDraggin = !1;
    this.ResetBackgroundTint();
    for (a = this.camera_container.children.length - 1; 0 <= a; a--) {
      var b = this.camera_container.children[a];
      b != this.thor && b != this.ground && (b.Remove ? b.Remove() : this.camera_container.removeChild(b))
    }
  };
  Dragon2D.prototype.ResizeTo = function(a, b, c) {
    var d = 1;
    1 == localStorage.low_res && (d = 2, c /= d);
    $("#Dragon2D").css({
      position: "fixed",
      left: a,
      top: b,
      scaleX: d,
      scaleY: d,
      "transform-origin": "0 0"
    });
    this.renderer.resize(floor(this.original_w * c), floor(this.original_h * c));
    this.stage_scaled.scale.x = this.stage_scaled.scale.y = c
  };
  Dragon2D.prototype.Update = function(a) {
    this.total_elapsed_time += a;
    var b = 0 >= a ? 60 : 1E3 / a;
    void 0 == this.last_fps && (this.last_fps = b);
    this.fps = this.last_fps = 0.1 * b + 0.9 * this.last_fps;
    this.fps_sprite.visible = !1;
    this.CameraUpdate(a);
    this.frames++
  };
  Dragon2D.prototype.Render = function() {
    this.renderer.render(this.stage)
  };
  Dragon2D.prototype.SetGround = function(a) {
    this.ground && this.camera_container.removeChild(this.ground);
    this.ground = new Ground2(a);
    this.camera_container.addChild(this.ground, ZINDEX.ground)
  };
  Dragon2D.prototype.SetBackground = function(a, b) {
    this.bgcolor != a && (this.bgcolor = a, this.stage.setBackgroundColor(parseInt(a.slice(1), 16)));
    var c;
    OPTIONS.background ? (c = b, -1 == c.indexOf("/") && (c = -1 == c.indexOf(".") ? "/static/images/maps/" + c + ".jpg" : "/static/images/maps/" + c)) : c = void 0;
    this.bg_image_url != c && (this.bg_image_url = c, this.background && (this.stage_scaled.removeChild(this.background), this.background = void 0), void 0 != this.bg_image_url && (this.background = new PIXI.Sprite(PIXI.Texture.fromImage(FixCORS(this.bg_image_url))),
      this.stage_scaled.addChildAt(this.background, 0), this.CameraPosChanged()))
  };
  Dragon2D.prototype.CameraInit = function(a, b) {
    this.min_x = -a.offset_x + 400;
    this.max_x = a.ground_size - 400;
    this.min_y = -a.offset_y + 300;
    this.max_y = a.ground_size - a.offset_y - 300 + 84;
    this.max_y = (a.is_cave ? a.h + a.offset_y : a.ground_size - a.offset_y) - 300 + 84;
    this.bg_aspect_ratio_x = (MAP_BACKGROUND_W - 800) / (a.ground_size - 500);
    this.bg_aspect_ratio_y = (MAP_BACKGROUND_H - 600) / (a.ground_size - 500);
    this.bg_offset_x = a.offset_x;
    this.bg_offset_y = a.offset_y;
    this.onChange = b;
    this.CameraFocusAt(a.w / 2, 0)
  };
  Dragon2D.prototype.CameraMoveBy = function(a, b, c) {
    this.CameraFocusAt(this.camera_x + a, this.camera_y + b, c)
  };
  Dragon2D.prototype.CameraFocusAt = function(a, b, c) {
    c && this.isInMapDraggin || (a < this.min_x ? a = this.min_x : a > this.max_x && (a = this.max_x), b < this.min_y ? b = this.min_y : b > this.max_y && (b = this.max_y), a = round(a), b = round(b), c ? (this.camera_target_x = a, this.camera_target_y = b) : (this.camera_x = this.camera_target_x = a, this.camera_y = this.camera_target_y = b, this.CameraPosChanged()))
  };
  Dragon2D.prototype.CameraUpdate = function(a) {
    if (this.camera_x != this.camera_target_x || this.camera_y != this.camera_target_y) this.camera_x = GetCloserToTargetValue(this.camera_x, a, this.camera_target_x), this.camera_y = GetCloserToTargetValue(this.camera_y, a, this.camera_target_y), this.CameraPosChanged()
  };
  Dragon2D.prototype.ScreenToCameraXY = function(a, b) {
    return {
      x: a + this.camera_x - 400,
      y: b + this.camera_y - 300
    }
  };
  Dragon2D.prototype.CameraPosChanged = function() {
    var a = -(this.camera_x - 400),
      b = -(this.camera_y - 300);
    this.camera_container.position.x = a;
    this.camera_container.position.y = b;
    this.background && (b = (b - this.bg_offset_y) * this.bg_aspect_ratio_y, this.background.position.x = (a - this.bg_offset_x) * this.bg_aspect_ratio_x, this.background.position.y = b)
  };
  Dragon2D.prototype.CameraStopAnim = function() {
    this.camera_target_x = this.camera_x;
    this.camera_target_y = this.camera_y
  };

  function DynamicCanvasTextureSprite() {
    PIXI.Sprite.apply(this, arguments);
    this._dirtyTexture = !1
  }
  DynamicCanvasTextureSprite.prototype = Object.create(PIXI.Sprite.prototype);
  DynamicCanvasTextureSprite.prototype.constructor = DynamicCanvasTextureSprite;
  DynamicCanvasTextureSprite.prototype._renderWebGL = function(a) {
    this._dirtyTexture && (this._dirtyTexture = !1, PIXI.updateWebGLTexture(this.texture.baseTexture, a.gl));
    PIXI.Sprite.prototype._renderWebGL.call(this, a)
  };

  function CreateRectangle(a, b, c, d, e, f, h) {
    var k = new PIXI.Graphics;
    k.beginFill(e);
    k.lineStyle(h, f);
    k.drawRect(0, 0, c - h, d - h);
    k.endFill();
    k.position.x = a + h / 2;
    k.position.y = b + h / 2;
    return k
  }

  function DisplayObjectContainerWithZ() {
    PIXI.DisplayObjectContainer.call(this)
  }
  DisplayObjectContainerWithZ.prototype = Object.create(PIXI.DisplayObjectContainer.prototype);
  DisplayObjectContainerWithZ.prototype.constructor = DisplayObjectContainerWithZ;
  DisplayObjectContainerWithZ.prototype.addChild = function(a, b) {
    b && (a.z = b);
    b = a.z || 0;
    for (var c = this.children, d = c.length, e = 0; e < d && (c[e].z || 0) <= b;) e++;
    this.addChildAt(a, e)
  };

  function base62_decode(a, b, c, d) {
    for (b = c = (a === (a += "") && /^[a-z\d]+$/i.test(a)) - 1; d = a.charCodeAt(c++);) b = 62 * b + d - [, 48, 29, 87][d >> 5];
    return b
  }

  function DragonDecompress2(a) {
    var b, c, d = [];
    for (b = 0; b < a.length; b += 2) "-" == a[b] ? (c = a[b + 1] + a[b + 2] + a[b + 3] + a[b + 4], b += 3) : "+" == a[b] ? (c = a[b + 1] + a[b + 2] + a[b + 3], b += 2) : c = a[b] + a[b + 1], d.push(base62_decode(c));
    return d
  }

  function DragonDecompress(a) {
    a = DragonDecompress2(a);
    var b, c = "",
      d = !1,
      e = a.length;
    for (b = 0; b < e; b++) c += fillString(d ? 1 : 0, a[b]), d = !d;
    return c
  }

  function ImageDataToBooleanArray(a) {
    var b, c = [],
      d = a.data,
      e = a.width,
      f = a.height;
    for (b = 0; b < f; b++)
      for (a = 0; a < e; a++) c.push(0 != d[4 * (b * e + a) + 3]);
    return c
  }

  function ImageDataToBooleanArray2(a) {
    var b, c = [],
      d = a.data,
      e = a.width,
      f = a.height,
      h, k = 0 == d[3] || 0 == d[4 * (e - 1) + 3] || 0 == d[(f - 1) * e * 4 + 3] || 0 == d[4 * (f * e - 1) + 3];
    for (b = 0; b < f; b++)
      for (a = 0; a < e; a++) h = 4 * (b * e + a), k ? c.push(0 != d[h + 3]) : c.push(!(0 == d[h + 3] || 255 == d[h] && 255 == d[h + 1] && 255 == d[h + 2]));
    return c
  }

  function BooleanArrayToImageData(a, b, c) {
    var d, e, f = 0,
      h = b.width,
      k = b.height,
      m = b.data,
      n = "string" == typeof a ? "1" : !0,
      p = [],
      q;
    for (e = 0; e < k; e++)
      for (c && (p[e] = []), d = 0; d < h; d++) q = a[f] == n, m[4 * (e * h + d) + 3] = q ? 255 : 0, c && (p[e][d] = !q), f++;
    if (c) {
      for (e = -10; 0 > e; e++)
        for (p[e] = [], d = -10; d < h + 10; d++) p[e][d] = !0;
      for (e = k; e < k + 10; e++)
        for (p[e] = [], d = -10; d < h + 10; d++) p[e][d] = !0;
      for (e = 0; e < k; e++) {
        for (d = -10; 0 > d; d++) p[e][d] = !0;
        for (d = h; d < h + 10; d++) p[e][d] = !0
      }
      for (e = 0; e < k; e++)
        for (d = 0; d < h; d++)
          if (!p[e][d] && (p[e][d - 10] || p[e][d + 10] || p[e - 10][d] || p[e + 10][d] ||
              p[e + 10][d + 10] || p[e - 10][d - 10] || p[e + 10][d - 10] || p[e - 10][d + 10]))
            for (f = 1; 10 >= f; f++)
              if (p[e][d - f] || p[e][d + f] || p[e - f][d] || p[e + f][d] || p[e + f][d + f] || p[e - f][d - f] || p[e + f][d - f] || p[e - f][d + f]) {
                m[4 * (e * h + d)] = 0.1 * m[4 * (e * h + d)] * (f - 1);
                m[4 * (e * h + d) + 1] = 0.1 * m[4 * (e * h + d) + 1] * (f - 1);
                m[4 * (e * h + d) + 2] = 0.1 * m[4 * (e * h + d) + 2] * (f - 1);
                break
              }
    }
    return b
  }
  var TEST_ELEMENTS = 500,
    StressTest = function(a, b) {
      this.callback = b;
      this.stage = new PIXI.Stage(16777215);
      this.renderer = new(a ? PIXI.autoDetectRenderer : PIXI.CanvasRenderer)(500, 500);
      this.is_3d = this.renderer instanceof PIXI.WebGLRenderer;
      if (a && !this.is_3d) return b(0);
      $(this.renderer.view).appendTo("body").css({
        position: "absolute",
        left: -2E3,
        "z-index": 5555
      });
      this.duration = 3E3;
      this.frames = this.total_elapsed_time = 0;
      var c = document.createElement("canvas");
      c.width = 52;
      c.height = 74;
      c.context = c.getContext("2d");
      c.context.fillRect(0,
        0, 52, 74);
      this.texture = PIXI.Texture.fromCanvas(c);
      if (this.is_3d && (c = this.renderer.gl, c = c.getParameter(c.MAX_TEXTURE_SIZE), localStorage.max_tx_size = c, 4096 > c)) return b(0);
      var d = this;
      setTimeout(function() {
        d.begin()
      }, 30)
    };
  StressTest.prototype.begin = function() {
    this.testSprites = [];
    for (var a = 0; a < TEST_ELEMENTS; a++) {
      var b = new PIXI.Sprite(this.texture);
      b.anchor.x = 0.5;
      b.anchor.y = 0.5;
      this.stage.addChild(b);
      b.position.x = 50 + 400 * Math.random();
      b.position.y = 50 + 400 * Math.random();
      this.testSprites.push(b)
    }
    this.renderer.render(this.stage);
    this.lastTime = Date.now();
    var c = this;
    requestAnimFrame(function() {
      c.update()
    })
  };
  StressTest.prototype.update = function() {
    for (var a = 0; a < this.testSprites.length; a++) this.testSprites[a].rotation += 0.2;
    this.renderer.render(this.stage);
    this.frames++;
    var a = Date.now(),
      b = a - this.lastTime;
    this.lastTime = a;
    300 < b && (b = 0);
    this.total_elapsed_time += b;
    this.total_elapsed_time < this.duration ? requestAnimFrame(this.update.bind(this)) : (document.body.removeChild(this.renderer.view), this.renderer = null, this.result = Math.round(1E3 * this.frames / this.total_elapsed_time), this.callback && this.callback(this.result))
  };
  PIXI.dontSayHello = !0;

  function SpeedTest(a) {
    new StressTest(!0, function(b) {
      if (b >= MIN_GOOD_FPS) return a(RENDERER_WEBGL, b);
      new StressTest(!1, function(c) {
        return c >= MIN_GOOD_FPS ? a(RENDERER_CANVAS, c) : a(RENDERER_DOM, Math.max(b, c))
      })
    })
  };
  CalcOrbitPoint = function(a, b, c, d) {
    return {
      x: a + c * Math.cos(AngleToRad(d)),
      y: b - c * Math.sin(AngleToRad(d))
    }
  };
  ZotataPhysics = function(a, b, c, d, e, f) {
    this.x0 = a;
    this.y0 = b;
    this.v = new Vector(c, d);
    this.ax = e;
    this.ay = f
  };
  ZotataPhysics.prototype.GetPosAtTime = function(a) {
    a /= 1E3;
    return {
      x: this.x0 + this.v.x * a + this.ax * a * a / 2,
      y: this.y0 + this.v.y * a + this.ay * a * a / 2
    }
  };
  ZotataPhysics.prototype.GetPosAtTimeOrbit = function(a, b, c, d, e) {
    a /= 1E3;
    return CalcOrbitPoint(this.x0 + this.v.x * a + this.ax * a * a / 2, this.y0 + this.v.y * a + this.ay * a * a / 2, a >= d ? e : e * a / d, b + c * a)
  };
  ZotataPhysics.prototype.GetPosAtTimeWave = function(a, b) {
    var c = a / 1E3,
      d = this.x0 + this.v.x * c + this.ax * c * c / 2,
      c = this.y0 + this.v.y * c + this.ay * c * c / 2,
      e = this.GetAngleAtTime(a),
      f;
    1 == b || 2 == b ? (f = 15 * Math.sin(a / 60), e = -e + (1 == b ? 90 : -90)) : 3 == b || 4 == b ? (e = -e + (3 == b ? 90 : -90), f = 400 > a ? a / 400 * 25 : 2200 > a ? 25 * Math.cos((a - 400) / 95) : 2600 > a ? 25 - (a - 1800 - 400) / 400 * 22 : 3) : e = f = 0;
    return CalcOrbitPoint(d, c, f, e)
  };
  ZotataPhysics.prototype.GetAngleAtTime = function(a) {
    var b = this.GetPosAtTime(a - 5);
    a = this.GetPosAtTime(a + 5);
    return RadToAngle(Math.atan2(a.y - b.y, a.x - b.x))
  };
  ZotataPhysics.prototype.GetAngleAtTimeWave = function(a, b) {
    var c = this.GetPosAtTimeWave(a - 5, b),
      d = this.GetPosAtTimeWave(a + 5, b);
    return RadToAngle(Math.atan2(d.y - c.y, d.x - c.x))
  };
  var FAST_FORWARD_SPEED = 4;

  function Shot2(a, b, c, d, e, f) {
    PIXI.DisplayObjectContainer.call(this);
    this.shot = a;
    this.total_elapsed_time = 0;
    this.zp = new ZotataPhysics(a.start.x, a.start.y, a.start.ang, a.start.power, a.start.ax, a.start.ay);
    this.callback_finish = c;
    this.created_div = !1;
    this.is_camera_focus = b;
    this.thor = a.thor;
    this.shooting_player = e;
    this.dragon2d = d;
    this.trace_divs = [];
    this.is_fast_forward = f;
    a.ss && d.SSBackgroundFadeIn();
    DragonClock.Add(this);
    this.shot.start.t || this.CreateDiv()
  }
  Shot2.prototype = Object.create(PIXI.DisplayObjectContainer.prototype);
  Shot2.prototype.constructor = Shot2;
  var BULLET_ANIM_FPS = 20;
  Shot2.prototype.CreateDiv = function() {
    if (this.shot.is_lightning) this.shot.hole && this.dragon2d.CreateLightning(this.shot.hole[0], this.shot.hole[1], this.shot.start.ang), this.Remove(), this.callback_finish && this.callback_finish(this);
    else if (this.thor) {
      var a = 3E3;
      this.shot.hole && (a = Math.round(Dist2Points(this.shot.start.x, this.shot.start.y, this.shot.hole[0], this.shot.hole[1])));
      this.dragon2d.ThorShoot(this.shot.start.x, this.shot.start.y, this.shot.start.ang, a);
      this.Remove();
      this.callback_finish && this.callback_finish(this)
    } else {
      var a =
        BULLET[this.shot.img],
        b;
      if (a && a.file)
        if (a.trace) {
          b = 256 / a.trace;
          for (var c = 0; c < a.trace; c++) this.trace_divs.push(new PIXI.Point(c * b, 0));
          b = -1 == a.file.indexOf("/") ? "/static/images/bullets/" + a.file + ".png" : a.file;
          b = PIXI.Texture.fromImage(b);
          this.anim_obj = new PIXI.Rope(b, this.trace_divs);
          this.addChild(this.anim_obj)
        } else b = -1 == a.file.indexOf("/") ? "bullets/" + a.file + ".png" : a.file, this.anim_container = new PIXI.DisplayObjectContainer, this.anim_obj = new AnimatedSprite(b, a.graphics, 0, 0, BULLET_ANIM_FPS, !1, LOOP_NORMAL,
          1, !0), this.anim_container.addChild(this.anim_obj), this.addChild(this.anim_container);
      this.created_div = !0;
      if (a) {
        b = get_time();
        if (void 0 == g_last_shot_sound_time || b >= g_last_shot_sound_time + 10) g_last_shot_sound_time = b, !this.shot.is_lightning && a.sound && AudioPlay(a.sound);
        a.ion ? this.shooting_player.SetIon(this.shot.start.ang, this.shot.start.x - this.shooting_player.player_sprite.x, this.shot.start.y - this.shooting_player.player_sprite.y, 1E3) : a.ion_height && this.shooting_player.SetIon(void 0, 0, 1 == a.ion_height ?
          -200 : -600, 500)
      }
      this.Update(0)
    }
  };
  Shot2.prototype.Update = function(a) {
    this.is_fast_forward && (a *= FAST_FORWARD_SPEED);
    a = this.total_elapsed_time += a;
    if (void 0 != this.shot.start.t)
      if (a >= this.shot.start.t) {
        if (a -= this.shot.start.t, !this.created_div) {
          this.CreateDiv();
          return
        }
      } else return;
    if (!this.thor && !this.shot.is_lightning)
      if (a >= this.shot.time) this.Remove(), this.callback_finish && this.callback_finish(this.unique_id);
      else {
        var b;
        b = this.shot.orbit ? this.zp.GetPosAtTimeOrbit(a, this.shot.orbit[0], this.shot.orbit[1], this.shot.orbit[2], this.shot.orbit[3]) :
          this.zp.GetPosAtTime(a);
        this.marker && (this.marker.x = b.x - 5, this.marker.y = b.y - 5);
        if (this.trace_divs.length) {
          var c = BULLET[this.shot.img],
            d, e = c.traceTime / this.trace_divs.length;
          c.traceAlter && floor(a / 50);
          for (c = 0; c < this.trace_divs.length; c++) d = a - c * e, d = d >= e ? this.shot.wave ? this.zp.GetPosAtTimeWave(d, this.shot.wave) : this.zp.GetPosAtTime(d) : this.shot.wave ? this.zp.GetPosAtTimeWave(-3 * c, this.shot.wave) : this.zp.GetPosAtTime(-3 * c), this.trace_divs[c].x = d.x, this.trace_divs[c].y = d.y
        } else e = this.zp.GetAngleAtTime(a),
          this.anim_container.rotation = AngleToRad(e), this.anim_container.x = b.x, this.anim_container.y = b.y;
        this.shot.change && a >= this.shot.change.at && !this.is_shot_changed && (this.is_shot_changed = !0, c = BULLET[this.shot.change.img], e = -1 == c.file.indexOf("/") ? "bullets/" + c.file + ".png" : c.file, this.anim_obj.Remove(), this.anim_obj = new AnimatedSprite(e, c.graphics, 0, 0, BULLET_ANIM_FPS, !1, LOOP_NORMAL, 1, !0), this.anim_container.addChild(this.anim_obj));
        this.is_camera_focus && 400 < a && !this.dragon2d.isInMapDraggin && this.dragon2d.CameraFocusAt(b.x,
          b.y, !0)
      }
  };
  Shot2.prototype.Remove = function() {
    DragonClock.Remove(this);
    if (this.is_removed) debug && warn("[Shot2.Remove] already removed!", this.is_removed, this.shot);
    else if (this.is_removed = !0, this.anim_obj && (this.anim_obj.Remove ? this.anim_obj.Remove() : this.anim_container ? this.anim_container.removeChild(this.anim_obj) : this.removeChild(this.anim_obj)), this.anim_container && this.removeChild(this.anim_container), this.marker && this.removeChild(this.marker), this.parent && this.parent.removeChild(this), this.shot.ss) {
      var a = this,
        b = BULLET[this.shot.img],
        c = this.shooting_player;
      setTimeout(function() {
        b.ion_ss && c.SetIon(void 0, 0, -200, 400);
        a.dragon2d.SSBackgroundFadeOut()
      }, 1E3)
    }
  };
  Shot2.prototype.SetCameraFocus = function() {
    this.is_camera_focus = !0
  };
  Shot2.prototype.GetTimeLeft = function() {
    var a = this.shot.time || 0;
    void 0 != this.shot.start.t && (a += this.shot.start.t);
    a -= this.total_elapsed_time;
    if (0 > a) return 0;
    this.is_fast_forward && (a /= FAST_FORWARD_SPEED);
    return a
  };
  DragonFreeze(Shot2);
  var g_dragon2d;

  function DragonBound2(a, b, c) {
    this.Init2(a, b, c)
  }
  PIXI.Texture.prototype.setFrame = function(a) {
    (this.noFrame = !1, this.frame = a, this.width = a.width, this.height = a.height, this.crop.x = a.x, this.crop.y = a.y, this.crop.width = a.width, this.crop.height = a.height, !this.trim && (a.x + a.width > this.baseTexture.width || a.y + a.height > this.baseTexture.height)) ? warn("Location is outside of image file (Frames Info Error):", this.baseTexture.imageUrl, a.x, a.width, a.x + a.width, this.baseTexture.width, a.y, a.height, a.y + a.height, this.baseTexture.height): (this.valid = a && a.width && a.height &&
      this.baseTexture.source && this.baseTexture.hasLoaded, this.trim && (this.width = this.trim.width, this.height = this.trim.height, this.frame.width = this.trim.width, this.frame.height = this.trim.height), this.valid && PIXI.Texture.frameUpdates.push(this))
  };
  DragonBound2.prototype.Init2 = function(a, b, c) {
    $("#game_back").html("");
    $("#gameScreen").css({
      "background-color": "transparent"
    });
    g_dragon2d ? g_dragon2d.ReInit() : (g_dragon2d = new Dragon2D, g_dragon2d.Init());
    this.dragon2d = g_dragon2d;
    var d = ArrayToObject(b, "players first_turn thor_x thor_y thor_a thor_d weather wind_power wind_angle map is_s1_disabled event_game game_mode score".split(" ")),
      e = b[1],
      f = b[2],
      h = b[3],
      k = b[4],
      m = b[5],
      n = b[6],
      p = b[7],
      q = b[8],
      r = b[9],
      s = b[10],
      t = b[11],
      w = b[12];
    b = b[13];
    var v = this;
    this.my_user_id =
      a;
    this.my_player_index = this.my_player_number = -1;
    this.queue = [];
    this.is_queue_executing = !1;
    this.players = [];
    this.shots = [];
    this.isInMapDraggin = !1;
    this.turn = -1;
    this.after_shot_chat = [];
    this.after_shot_gold = void 0;
    this.steps = this.no_ss_turns = 0;
    this.sudden_death_at_turn = 40;
    this.t = random(10, 20);
    this.s = random(60, 70);
    this.is_s1_disabled = s;
    this.game_mode = w;
    this.dn = c;
    this.WOX = random(0, 12);
    this.WOY = random(0, 6);
    this.my_start_gp = this.dn.myPlayerInfo.gp;
    this.my_start_gold = this.dn.myPlayerInfo.gold;
    this.number_of_shots =
      0;
    this.gui_gold = void 0;
    a = MapNumberToObject(r);
    this.dragon2d.SetMap(a);
    for (a = 0; a < d.players.length; a++) w = new Player2(d.players[a], this), w.id == this.my_user_id && (this.my_player_number = w.n, this.my_player_index = a), this.players.push(w);
    this.HideClickToRevive();
    this.UnselectAllItems();
    this.UpdateGuiGold(0);
    $("#last_power_mark").css("left", 240);
    $("#game_over").hide();
    $("#game_replay").hide();
    this.UpdateScore(b, b);
    SetClass("#score_panel", "hide", this.game_mode != GAME_MODE_SCORE);
    $("#powerBar").css("width", 1);
    $("#walkBar").css("width", 400);
    $("#gameInput").val("");
    $("#gameChatHtml").html("");
    $("#gameChat .scrollbar").hide();
    $("#ss_shot_background").removeClass("sudden_death").hide();
    $("#message_over_items").removeClass().hide();
    0 != c.myPlayerInfo.rank || g_saw_auto_help || GetValue("SawHowToPlay") || ($("#howtoplay").show(), g_saw_auto_help = !0, SetValue("SawHowToPlay", 1));
    if (Object.isFrozen(DragonBound2)) {
      TeamChatOff();
      this.SetWeather(n);
      this.UpdateWind([p, q]);
      this.UpdateThor([f, h, k, m], !0);
      this.next_turn = e;
      "number" ==
      typeof r ? $("#btnDownloadMap").hide() : $("#btnDownloadMap").show().click(function() {
        this.href = v.dragon2d.ground.dataUrl.replace(/^data:image\/[^;]/, "data:application/octet-stream");
        this.download = "map.png"
      });
      this.UpdateTurnList();
      s ? ($("#btnShot1").hide(), SelectShotType(1, void 0), this.ChangedShot(SHOT2)) : ($("#btnShot1").show(), SelectShotType(0, void 0), this.ChangedShot(SHOT1));
      $("#btnShotSS").show();
      $(".EventGameMsg1").remove();
      if (1 == t) $("#game_front").append($('<div class="EventGameMsg1 blackShadow">- ' +
        l.t("Event Game") + " -<br>" + l.t("Losing Team Wins!<br>Double GP & Gold!") + "</div>")), setTimeout(function() {
        $(".EventGameMsg1").remove()
      }, 15E3);
      else {
        var u = $('<div class="EventGameMsg2 blackShadow">Ready</div>');
        $("#game_front").append(u);
        setTimeout(function() {
          u.html("GO!")
        }, 2E3);
        setTimeout(function() {
          u.remove()
        }, 5E3)
      }
      PreloadBullet(BULLET.TELEPORT);
      PreloadBullet(BULLETS.ADUKA1_THOR);
      PreloadImage(LIGHTNINGS_IMAGE_FILE);
      PreloadExplode(EXPLODE.TELEPORT);
      PreloadExplode(EXPLODE.ADUKA1_THOR);
      setTimeout(function() {
        v.SetBinds();
        v.StartNextTurn();
        v.QueueUnblock()
      }, 2E3)
    }
  };
  DragonBound2.prototype.OnKeyDown = function(a) {
    if (!$(document.activeElement).is("input") || a.which == KEY.F8 || a.which == KEY.F9 || a.which == KEY.F10 || a.which == KEY.Esc) {
      var b;
      switch (a.which) {
        case KEY.A:
        case KEY.Left:
          this.UIWalkLeftStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.D:
        case KEY.Right:
          this.UIWalkRightStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.W:
        case KEY.Up:
          this.UIAngleUpStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.S:
        case KEY.Down:
          this.UIAngleDownStart();
          a.preventDefault();
          a.stopPropagation();
          b = 1;
          break;
        case KEY.Space:
          g_is_game_slice && (this.UIShootStart(), a.preventDefault(), a.stopPropagation());
          b = 1;
          break;
        case KEY.F8:
          this.PassTurnClicked();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Tab:
          this.UINextShot();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F1:
          this.UseItem(0);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F2:
          this.UseItem(1);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F3:
          this.UseItem(2);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F4:
          this.UseItem(3);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F5:
          this.UseItem(4);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F6:
          this.UseItem(5);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F9:
          TeamChatToggle();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Esc:
          ToggleOptionsDialog(!0);
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F10:
          this.F10Friends(), a.preventDefault(), a.stopPropagation()
      }
      b && $("#howtoplay").is(":visible") &&
        $("#howtoplay").fadeOut("slow")
    }
  };
  DragonBound2.prototype.SetBinds = function() {
    function a(a) {
      a = a || window.event;
      a.preventDefault && a.preventDefault();
      a.stopPropagation && a.stopPropagation();
      a.cancelBubble = !0;
      return a.returnValue = !1
    }
    var b = this;
    $("#btnShoot,#btnLeft,#btnRight,#btnUp,#btnDown").unbind();
    $("#btnShoot").bind("mousedown touchstart", function(a) {
      b.UIShootStart()
    }).bind("mouseup touchend", function(a) {
      b.UIShootEnd()
    });
    $("#btnLeft").bind("mousedown touchstart", function(a) {
      b.UIWalkLeftStart()
    }).bind("mouseup touchend", function(a) {
      b.UIWalkLeftEnd()
    });
    $("#btnRight").bind("mousedown touchstart", function(a) {
      b.UIWalkRightStart()
    }).bind("mouseup touchend", function(a) {
      b.UIWalkRightEnd()
    });
    $("#btnUp").bind("mousedown touchstart", function(a) {
      b.UIAngleUpStart()
    }).bind("mouseup touchend", function(a) {
      b.UIAngleUpEnd()
    });
    $("#btnDown").bind("mousedown touchstart", function(a) {
      b.UIAngleDownStart()
    }).bind("mouseup touchend", function(a) {
      b.UIAngleDownEnd()
    });
    var c = $(document);
    c.unbind("keydown keyup click dblclick mousedown mousemove touchstart touchend touchmove");
    c.bind("keyup", function(a) {
      switch (a.which) {
        case KEY.A:
        case KEY.Left:
          b.UIWalkLeftEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.D:
        case KEY.Right:
          b.UIWalkRightEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.W:
        case KEY.Up:
          b.UIAngleUpEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.S:
        case KEY.Down:
          b.UIAngleDownEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Space:
          b.UIShootEnd();
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Ctrl:
          $(document.activeElement).is("input") ||
            a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F1:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F2:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F3:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F4:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F5:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F6:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.F9:
          a.preventDefault();
          a.stopPropagation();
          break;
        case KEY.Tab:
          a.preventDefault(), a.stopPropagation()
      }
    });
    $("#gameui").unbind().bind("mousedown",
      function(a) {
        a.stopPropagation();
        return !1
      });
    c.bind("mousedown", function(a) {
      if (2 == a.button) b.lastDragX = a.pageX, b.lastDragY = a.pageY, b.dragon2d.isInMapDraggin = !0, $("#container").addClass("HandCursor"), b.dragon2d.CameraStopAnim();
      else if (0 == a.button) {
        if ($("#howtoplay").is(":visible")) return log("closing how to play"), $("#howtoplay").hide("slow");
        g_is_game_slice || b.turn != b.my_player_number || (b.isInDrag = !0, b.UIDragStart(a.pageX))
      }
    });
    this.func_mouseup = function(a) {
      2 == a.button ? (b.dragon2d.isInMapDraggin = !1,
        $("#container").removeClass("HandCursor")) : 0 == a.button && b.isInDrag && (b.isInDrag = !1, b.UIDragMove(a.pageX), b.UIDragEnd())
    };
    c.unbind("mouseup", this.func_mouseup).bind("mouseup", this.func_mouseup);
    c.bind("mousemove", function(a) {
      b.isInDrag && b.UIDragMove(a.pageX);
      if (b.dragon2d.isInMapDraggin) {
        var c = b.lastDragX - a.pageX,
          f = b.lastDragY - a.pageY;
        (c || f) && b.dragon2d.CameraMoveBy(c / b.dragon2d.stage_scaled.scale.x, f / b.dragon2d.stage_scaled.scale.y);
        b.lastDragX = a.pageX;
        b.lastDragY = a.pageY
      }
      a.stopPropagation()
    });
    (function(b) {
      b &&
        (b.ontouchstart = a, b.ontouchmove = a, b.ontouchend = a, b.ontouchcancel = a)
    })(document.getElementById("touch_ui"));
    c.bind("touchstart", function(a) {
      $("#touch_ui").show();
      $("#howtoplay").is(":visible") && $("#howtoplay").hide();
      if (!(b.intervalDoSpace || b.intervalDoLeft || b.intervalDoRight || b.intervalDoUp || b.intervalDoDown)) {
        if (a.originalEvent.touches && a.originalEvent.touches.length) a = a.originalEvent.touches[0];
        else if (a.originalEvent.changedTouches && a.originalEvent.changedTouches.length) a = a.originalEvent.changedTouches[0];
        else return;
        b.lastDragX = a.pageX;
        b.lastDragY = a.pageY;
        b.dragon2d.isInMapDraggin = !0;
        a.preventDefault && a.preventDefault()
      }
    });
    c.bind("touchend", function(a) {
      b.dragon2d.isInMapDraggin = !1
    });
    c.bind("touchmove", function(a) {
      a.preventDefault && a.preventDefault();
      if (b.intervalDoSpace || b.intervalDoLeft || b.intervalDoRight || b.intervalDoUp || b.intervalDoDown) b.isInMapDraggin = !1;
      else {
        if (a.originalEvent.touches && a.originalEvent.touches.length) a = a.originalEvent.touches[0];
        else if (a.originalEvent.changedTouches && a.originalEvent.changedTouches.length) a =
          a.originalEvent.changedTouches[0];
        else return;
        if (b.dragon2d.isInMapDraggin) {
          var c = b.lastDragX - a.pageX,
            f = b.lastDragY - a.pageY;
          (c || f) && b.dragon2d.CameraMoveBy(c / b.dragon2d.stage_scaled.scale.x, f / b.dragon2d.stage_scaled.scale.y);
          b.lastDragX = a.pageX;
          b.lastDragY = a.pageY
        }
      }
    })
  };
  DragonBound2.prototype.UIWalkLeftStart = function() {
    $("#btnLeft").addClass("active");
    if (!(0 > this.my_player_index))
      if (this.turn == this.my_player_number) {
        if (!this.intervalDoLeft) {
          var a = this,
            b = get_time(),
            c = 0;
          this.intervalDoLeft = setInterval(function() {
            var d = Math.floor((get_time() - b) / 20),
              e = d - c;
            200 < a.steps + e && (e = 200 - a.steps);
            if (200 <= a.steps) a.players[a.my_player_index].Look(PLAYER_LOOK_LEFT);
            else {
              for (var f = 0; f < e && !1 != a.players[a.my_player_index].Walk(PLAYER_LOOK_LEFT); f++);
              e = f
            }
            a.steps += e;
            c = d;
            $("#walkBar").css("width",
              400 - 2 * a.steps)
          }, 20)
        }
      } else this.players[this.my_player_index].Look(PLAYER_LOOK_LEFT)
  };
  DragonBound2.prototype.UIWalkLeftEnd = function() {
    $("#btnLeft").removeClass("active");
    0 > this.my_player_index || (this.intervalDoLeft = clearInterval(this.intervalDoLeft))
  };
  DragonBound2.prototype.UIWalkRightStart = function() {
    $("#btnRight").addClass("active");
    if (!(0 > this.my_player_index))
      if (this.turn == this.my_player_number) {
        if (!this.intervalDoRight) {
          var a = this,
            b = get_time(),
            c = 0;
          this.intervalDoRight = setInterval(function() {
            var d = Math.floor((get_time() - b) / 20),
              e = d - c;
            200 < a.steps + e && (e = 200 - a.steps);
            if (200 <= a.steps) a.players[a.my_player_index].Look(PLAYER_LOOK_RIGHT);
            else {
              for (var f = 0; f < e && !1 != a.players[a.my_player_index].Walk(PLAYER_LOOK_RIGHT); f++);
              e = f
            }
            a.steps += e;
            c = d;
            $("#walkBar").css("width",
              400 - 2 * a.steps)
          }, 20)
        }
      } else this.players[this.my_player_index].Look(PLAYER_LOOK_RIGHT)
  };
  DragonBound2.prototype.UIWalkRightEnd = function() {
    $("#btnRight").removeClass("active");
    0 > this.my_player_index || (this.intervalDoRight = clearInterval(this.intervalDoRight))
  };
  DragonBound2.prototype.UIAngleUpStart = function() {
    $("#btnUp").addClass("active");
    if (!(0 > this.my_player_index || this.intervalDoUp || this.intervalDoDown)) {
      var a = this,
        b = get_time(),
        c = this.players[this.my_player_index].ang;
      this.intervalDoUp = setInterval(function() {
        var d = c + Math.floor((get_time() - b) / a.s) * (90 < a.players[a.my_player_index].minang ? -1 : 1);
        a.players[a.my_player_index].ChangeAngleTo(d)
      }, this.t)
    }
  };
  DragonBound2.prototype.UIAngleUpEnd = function() {
    $("#btnUp").removeClass("active");
    0 > this.my_player_index || (this.intervalDoUp = clearInterval(this.intervalDoUp))
  };
  DragonBound2.prototype.UIAngleDownStart = function() {
    $("#btnDown").addClass("active");
    if (!(0 > this.my_player_index || this.intervalDoDown || this.intervalDoUp)) {
      var a = this,
        b = get_time(),
        c = this.players[this.my_player_index].ang;
      this.intervalDoDown = setInterval(function() {
        var d = c - Math.floor((get_time() - b) / a.s) * (90 < a.players[a.my_player_index].minang ? -1 : 1);
        a.players[a.my_player_index].ChangeAngleTo(d)
      }, this.t)
    }
  };
  DragonBound2.prototype.UIAngleDownEnd = function() {
    $("#btnDown").removeClass("active");
    0 > this.my_player_index || (this.intervalDoDown = clearInterval(this.intervalDoDown))
  };
  DragonBound2.prototype.UIDragStart = function(a) {
    0 > this.my_player_index || (this.drag_start_x = a)
  };
  DragonBound2.prototype.UIDragMove = function(a) {
    0 > this.my_player_index || (a = (a - this.drag_start_x) / 1.5, 1 > a && (a = 1), 400 < a && (a = 400), $("#powerBar").css("width", a), 400 <= a && this.UIDragEnd())
  };
  DragonBound2.prototype.UIDragEnd = function() {
    0 > this.my_player_index || this.Shoot(Number($("#powerBar").css("width").slice(0, -2)))
  };
  DragonBound2.prototype.UIShootStart = function() {
    if (!(0 > this.my_player_index || this.turn != this.my_player_number || this.intervalDoSpace)) {
      this.UIWalkLeftEnd();
      this.UIWalkRightEnd();
      $("#powerBar").css("width", 0);
      var a = this,
        b = get_time();
      this.intervalDoSpace = setInterval(function() {
        var c = (get_time() - b) / 10;
        $("#powerBar").css("width", c);
        400 <= c && a.Shoot(400)
      }, 10)
    }
  };
  DragonBound2.prototype.UIShootEnd = function() {
    0 > this.my_player_index || !this.intervalDoSpace || (this.intervalDoSpace = clearInterval(this.intervalDoSpace), this.Shoot(Number($("#powerBar").css("width").slice(0, -2))))
  };
  DragonBound2.prototype.Shoot = function(a) {
    if (!(0 > this.my_player_index) && this.turn == this.my_player_number) {
      this.EndTurn();
      var b = Math.floor((get_time() - this.start_turn_time) / 1E3);
      if (20 < b || 0 > b) b = 20;
      this.players[this.my_player_index].Shoot(a, b, this.GetSelectedShotType());
      $("#last_power_mark").animate({
        left: 240 + a
      });
      $("#powerBar").css("width", a)
    }
  };
  DragonBound2.prototype.PassTurn = function() {
    if (!(0 > this.my_player_index)) {
      this.EndTurn();
      var a = Math.floor((get_time() - this.start_turn_time) / 1E3);
      if (20 < a || 0 > a) a = 20;
      this.players[this.my_player_index].PassTurn(a)
    }
  };
  DragonBound2.prototype.EndTurn = function() {
    var a = this.GetPlayerByPlayerNumber(this.turn);
    a && a.ChangeMyTurn(!1);
    this.turn = -1;
    this.intervalDoLeft = clearInterval(this.intervalDoLeft);
    this.intervalDoRight = clearInterval(this.intervalDoRight);
    this.intervalDoSpace = clearInterval(this.intervalDoSpace);
    this.turnTimeout = clearTimeout(this.turnTimeout);
    this.isInDrag = !1;
    $("#turn_timer").hide()
  };
  DragonBound2.prototype.GetPlayerByPlayerNumber = function(a) {
    if (-1 != a)
      for (var b = 0; b < this.players.length; b++)
        if (this.players[b].n == a) return this.players[b]
  };
  DragonBound2.prototype.SelectShotType = function(a, b) {
    2 != a || $("#btnShotSS").is(":visible") || (a = 0);
    switch (a) {
      case 0:
        $("#btnShot2, #btnShotSS").removeClass("Pressed");
        $("#btnShot1").addClass("Pressed");
        break;
      case 1:
        $("#btnShot1, #btnShotSS").removeClass("Pressed");
        $("#btnShot2").addClass("Pressed");
        break;
      case 2:
        $("#btnShot1, #btnShot2").removeClass("Pressed"), $("#btnShotSS").addClass("Pressed")
    }
    b && b.ChangedShot(a)
  };
  DragonBound2.prototype.GetSelectedShotType = function() {
    var a = 0;
    $("#btnShot2").hasClass("Pressed") ? a = 1 : $("#btnShotSS").hasClass("Pressed") && (a = 2);
    return a
  };
  DragonBound2.prototype.UpdateThor = function(a, b) {
    if (a) {
      for (var c = a[0], d = a[1], e = a[2], f = a[3], h = 0; h + 1 < THOR_LEVEL.length && f >= THOR_LEVEL[h + 1];) h++;
      h++;
      this.dragon2d.thor.MoveTo(c, d, -e, b);
      this.dragon2d.thor.SetLevelAndDamage(h, f)
    }
  };
  DragonBound2.prototype.QueueAddCommand = function(a, b) {
    this.queue.push({
      opcode: a,
      params: b
    });
    this.QueueExecuteNext()
  };
  DragonBound2.prototype.QueueUnblock = function() {
    this.is_queue_executing = !0;
    this.QueueExecuteNext()
  };
  E_PLAY = Object.freeze({
    next_turn_number: 0,
    player_number: 1,
    x: 2,
    y: 3,
    look: 4,
    add_delay: 5,
    next_turn_of_player: 6,
    chat: 7,
    thor_x: 8,
    thor_y: 9,
    thor_angle: 10,
    thor_damage: 11,
    new_weather: 12,
    wind_power: 13,
    wind_angle: 14,
    shots: 15,
    gold: 16
  });
  E_PASS = Object.freeze({
    next_turn_number: 0,
    player_number: 1,
    x: 2,
    y: 3,
    look: 4,
    add_delay: 5,
    next_turn_of_player: 6,
    chat: 7,
    thor_x: 8,
    thor_y: 9,
    thor_angle: 10,
    thor_damage: 11,
    new_weather: 12,
    wind_power: 13,
    wind_angle: 14
  });
  DragonBound2.prototype.QueueExecuteNext = function() {
    for (; this.is_queue_executing && 0 < this.queue.length;) {
      var a = this.queue.shift(),
        b = a.params;
      switch (a.opcode) {
        case "play":
          var c = b[E_PLAY.player_number],
            d = this.GetPlayerByPlayerNumber(c),
            a = a.params[E_PLAY.next_turn_number];
          d.MoveTo(b[E_PLAY.x], b[E_PLAY.y], b[E_PLAY.look]);
          d.ChangeDelay(d.delay + b[E_PLAY.add_delay], a - 1);
          this.UpdateTurnList();
          this.turn_number = a;
          this.UpdateGhostsTurn();
          this.after_shot_chat = b[E_PLAY.chat];
          this.after_shot_gold = c == this.my_player_number &&
            b[E_PLAY.gold] != this.gui_gold ? b[E_PLAY.gold] : void 0;
          this.EndTurn();
          this.after_shot_thor = [b[E_PLAY.thor_x], b[E_PLAY.thor_y], b[E_PLAY.thor_angle], b[E_PLAY.thor_damage]];
          this.after_shot_weather = b[E_PLAY.new_weather];
          this.next_turn = b[E_PLAY.next_turn_of_player];
          this.next_wind = [b[E_PLAY.wind_power], b[E_PLAY.wind_angle]];
          if (b[E_PLAY.shots] && 0 < b[E_PLAY.shots].length) {
            for (var a = !1, e = 0; e < b[E_PLAY.shots].length; e++) {
              var f = !a && !b[E_PLAY.shots][e].orbit;
              f && (a = !0);
              this.CreateShot(b[E_PLAY.shots][e], f, this.turn_number,
                d);
              b[E_PLAY.shots][e].ss && c == this.my_player_number && (this.no_ss_turns = 4, $("#btnShotSS").fadeOut(), 2 == GetSelectedShotType() && SelectShotType(this.is_s1_disabled ? 1 : 0, this))
            }
            this.is_queue_executing = !1;
            return
          }
          this.ReceivedChatArray(b[E_PLAY.chat], d.name);
          this.UpdateThor(this.after_shot_thor);
          this.PushWeather(this.after_shot_weather);
          this.UpdateWind(this.next_wind);
          this.StartNextTurn();
          break;
        case "pass":
          c = b[E_PASS.player_number];
          d = this.GetPlayerByPlayerNumber(c);
          a = a.params[E_PASS.next_turn_number];
          d.MoveTo(b[E_PASS.x],
            b[E_PASS.y], b[E_PASS.look]);
          d.ChangeDelay(d.delay + b[E_PASS.add_delay], a - 1);
          this.UpdateTurnList();
          this.turn_number = a;
          this.UpdateGhostsTurn();
          this.EndTurn();
          this.next_turn = b[E_PASS.next_turn_of_player];
          this.ReceivedChatArray(b[E_PASS.chat], d.name);
          this.UpdateThor([b[E_PASS.thor_x], b[E_PASS.thor_y], b[E_PASS.thor_angle], b[E_PASS.thor_damage]]);
          this.PushWeather(b[E_PASS.new_weather]);
          this.UpdateWind([b[E_PASS.wind_power], b[E_PASS.wind_angle]]);
          this.StartNextTurn();
          break;
        case "update":
          this.UpdatePlayer(b);
          break;
        case "game-over":
          this.ReceivedChatArray(b.chat);
          this.GameOver(b);
          break;
        case "dead":
          DEBUG && console.log("op dead", b);
          c = void 0 == b[0] ? b : b[0];
          if (d = this.GetPlayerByPlayerNumber(c)) d.ChangeAliveTo(!1), this.UpdateTurnList();
          void 0 != b[1] && void 0 != b[2] && this.ScoreLifeExpired(c % 2, b[1], b[2]);
          break;
        case "ghost":
          b = ArrayToObject(b, ["player_number", "x", "y", "revive_turn"]);
          (d = this.GetPlayerByPlayerNumber(b.player_number)) && d.SetGhost(b.x, b.y, b.revive_turn, this.turn_number);
          b.player_number == this.my_player_number &&
            this.HideClickToRevive();
          break;
        case "revived":
          if (b = ArrayToObject(b, "player_number x y hp shield delay".split(" ")), d = this.GetPlayerByPlayerNumber(b.player_number)) d.Revived(b.x, b.y, b.hp, b.shield, b.delay, this.turn_number), d.ChangeDelay(b.delay, this.turn_number), this.UpdateTurnList()
      }
    }
  };
  DragonBound2.prototype.StartNextTurn = function() {
    if (this.turn_number == this.sudden_death_at_turn - 20) ChatReceived(l.t("Sudden Death in %% turns").replace("%%", 20), "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
    else if (this.turn_number == this.sudden_death_at_turn - 10) ChatReceived(l.t("Sudden Death in %% turns").replace("%%", 10), "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
    else if (this.turn_number == this.sudden_death_at_turn - 5) ChatReceived(l.t("Sudden Death in %% turns").replace("%%", 5), "", CHAT_TYPE_SYSTEM,
      void 0, GUI_LOCATION_GAME);
    else if (this.turn_number == this.sudden_death_at_turn) ChatReceived(l.t("Sudden Death Started!"), "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME), this.dragon2d.SDBackgroundFadeIn(), $("#btnShotSS").hide(), this.no_ss_turns = 999999, 2 == GetSelectedShotType() && SelectShotType(1, this), $("#message_over_items").removeClass("items_locked").addClass("sudden_death").show(), AudioPlayInLoop(AUDIO_MUSIC_SUDDEN, !0);
    else if (this.turn_number > this.sudden_death_at_turn)
      for (var a = 0; a < this.players.length; a++) {
        var b =
          this.players[a];
        b.ReduceHPby(5 * (this.turn_number - this.sudden_death_at_turn), this.turn_number)
      }
    this.turn = this.next_turn;
    if (-1 != this.turn)
      if (b = this.GetPlayerByPlayerNumber(this.turn))
        if (b.ChangeMyTurn(!0), b.RegenShield(this.turn_number), 2 < this.queue.length ? $("#game_replay").show() : $("#game_replay").hide(), 0 == this.no_ss_turns && this.turn_number <= this.sudden_death_at_turn && $("#btnShotSS").show(), this.dragon2d.CameraFocusAt(b.x, b.y, !0), this.start_turn_time = get_time(), this.turn == this.my_player_number) {
          0 <
            this.no_ss_turns && this.no_ss_turns--;
          this.steps = 0;
          $("#walkBar").css("width", 400);
          this.UsePressedItem();
          $("#turn_timer").stop(!0, !0).hide().css("background-position", "0 -1900px").show("slow");
          var c = this;
          clearInterval(this.turnTimeout);
          this.turnTimeout = setInterval(function() {
            AudioPlay(AUDIO_TURN_TICK);
            if (c.turn != c.my_player_number) c.turnTimeout = clearInterval(c.turnTimeout);
            else {
              var a = 20 - Math.floor((get_time() - c.start_turn_time) / 1E3);
              0 < a ? (OPTIONS.anim ? $("#turn_timer").animate({
                backgroundPositionY: "-" +
                  (a - 1) + "00px"
              }, 200, "linear") : $("#turn_timer").css({
                backgroundPositionY: "-" + (a - 1) + "00px"
              }), 0 == c.queue.length && b.SendPosUpdate()) : (c.turnTimeout = clearInterval(c.turnTimeout), c.PassTurn())
            }
          }, 1E3);
          AudioPlay(AUDIO_MY_TURN)
        } else $("#turn_timer").hide();
    else DEBUG && console.log("[DragonBound.StartNextTurn] ERROR: turn of unknown player number", this.turn)
  };
  DragonBound2.prototype.UseItem = function(a) {
    if (!(0 > this.my_player_index)) {
      var b = $("#gameItemSlot" + a);
      b.hasClass("item") ? b.hasClass("Pressed") ? b.removeClass("Pressed") : ($(".item").removeClass("Pressed"), b.addClass("Pressed"), this.turn == this.my_player_number && this.UsePressedItem(a)) : 0 < a && (a--, $("#gameItemSlot" + a).hasClass("big") && this.UseItem(a))
    }
  };
  DragonBound2.prototype.UsePressedItem = function(a) {
    if (!(0 > this.my_player_index))
      for (a = void 0 != a ? a : 0; 6 > a; a++)
        if ($("#gameItemSlot" + a).hasClass("Pressed")) {
          this.players[this.my_player_index].UseItem(a);
          break
        }
  };
  DragonBound2.prototype.UpdateTurnList = function() {
    var a = [],
      b, c;
    0 > this.my_player_index ? c = b = 0 : (b = this.players[this.my_player_index].delay, c = this.players[this.my_player_index].delay_before);
    for (var d = 0; d < this.players.length; d++) {
      var e = this.players[d];
      e.is_alive && a.push({
        rank: e.rank,
        name: e.name,
        user_id: e.id,
        team: e.team,
        delay: e.delay,
        lastturn: e.lastturn,
        country: e.country
      })
    }
    a.sort(function(a, b) {
      return a.delay == b.delay ? a.lastturn - b.lastturn : a.delay - b.delay
    });
    d = JSON.stringify(a);
    if (this.last_turns_list_json !=
      d) {
      this.last_turns_list_json = d;
      for (d = 0; d < a.length; d++) {
        var e = a[d].delay - b,
          e = 0 < e ? "+" + e : e,
          f = OPTIONS.countries && a[d].country ? '<div class="country blackShadow">' + a[d].country + "</div>" : "";
        $("#turn_line" + d + " .turn_line_name").html(a[d].name);
        $("#turn_line" + d + " .turn_line_rank").removeClass().addClass("turn_line_rank rank rank" + a[d].rank).html(f);
        a[d].team == TEAM_A ? ($("#turn_line" + d + " .turn_line_number").removeClass("turn_line_number_b").addClass("turn_line_number_a turn_line_number" + d), $("#turn_line" + d +
          " .turn_line_name").removeClass("turn_line_name_b").addClass("turn_line_name_a turn_line_number" + d)) : ($("#turn_line" + d + " .turn_line_number").removeClass("turn_line_number_a").addClass("turn_line_number_b turn_line_number" + d), $("#turn_line" + d + " .turn_line_name").removeClass("turn_line_name_a").addClass("turn_line_name_b turn_line_number" + d));
        f = $("#turn_line" + d);
        a[d].user_id == this.my_user_id ? (f.addClass("turn_line_me"), e = b - c) : f.removeClass("turn_line_me");
        $("#turn_line" + d + " .turn_line_delay").html(e);
        f.show()
      }
      for (; 8 > d; d++) $("#turn_line" + d).hide()
    }
  };
  DragonBound2.prototype.UpdateGhostsTurn = function() {
    for (var a = this.players.length, b = 0; b < a; b++) this.players[b].UpdateGhostTurn(this.turn_number)
  };
  DragonBound2.prototype.CreateShot = function(a, b, c, d) {
    var e = this;
    a.hole && PreloadExplode(a.exp, !0);
    this.number_of_shots++;
    b = this.dragon2d.CreateShot(a, b, void 0, d, 1 < this.queue.length);
    setTimeout(function() {
      e.number_of_shots--;
      if (!e.destructed) {
        if (a.hole) {
          var b = a.hole[0],
            h = a.hole[1],
            k = a.hole[2],
            m = a.hole[3];
          0 < k && 0 < m && e.dragon2d.ground.AddGroundHole(b, h, k, m);
          e.dragon2d.CreateExplode(a.exp, b, h);
          if (OPTIONS.explodes)
            for (e.dragon2d.Shake(), m = Math.round(k * m / 150), k = 0; k < m; k++) e.dragon2d.CreateFlyingGroundPart(b,
              h);
          if (a.damages)
            for (k = 0; k < a.damages.length; k++) b = e.GetPlayerByPlayerNumber(a.damages[k].n), a.damages[k].hp && b.ChangeHPShield(a.damages[k].hp, a.damages[k].shield ? a.damages[k].shield : 0, c, !a.damages[k].heal), void 0 != a.damages[k].movex && b.MoveTo(a.damages[k].movex, void 0 != a.damages[k].movey ? a.damages[k].movey : b.y, void 0, !1), a.damages[k].rd && b.SetReducedDefence(a.damages[k].rd);
          for (k = 0; k < e.players.length; k++) e.players[k].Fall();
          e.UpdateTurnList()
        }
        if (a.tele)
          for (k = 0; k < a.tele.length; k += 5) {
            var b = a.tele[k +
                1],
              h = a.tele[k + 2],
              m = a.tele[k + 3],
              n = a.tele[k + 4],
              p = e.GetPlayerByPlayerNumber(a.tele[k]);
            p && (p.MoveTo(b, h, void 0, !0), p.MoveTo(m, n, void 0, !1), e.dragon2d.CreateExplode(a.exp, b, h))
          }
        0 >= e.number_of_shots && (e.ReceivedChatArray(e.after_shot_chat, d.name), e.after_shot_gold && (AudioPlay(AUDIO_GOLD), e.UpdateGuiGold(e.after_shot_gold)), e.UpdateThor(e.after_shot_thor), e.PushWeather(e.after_shot_weather), e.UpdateWind(e.next_wind), setTimeout(function() {
          e.StartNextTurn();
          e.QueueUnblock()
        }, 2 < e.queue.length ? 20 : 1E3))
      }
    }, b.GetTimeLeft())
  };
  GAMEMSG = Object.freeze({
    winning_award: 0,
    losing_consolation: 1,
    x_killed_y: 2,
    x_bunge_y: 3,
    ultra_high_ang: 4,
    high_ang: 5,
    excellent_shot: 6,
    good_shot: 7,
    shot_bonus: 8,
    team_damage_penalty: 9,
    killed_by_sd: 10,
    died_by_tele: 11,
    damage_1000: 12,
    damage_2000: 13,
    damage_3000: 14,
    triple_kill: 15,
    double_kill: 16,
    ending_bonus: 17,
    bunge_bonus: 18,
    suicide_penalty: 19,
    unlocked_challenge: 20,
    free_kill_detected: 21,
    suicide_penalty_bunge: 22,
    team_kill_penalty: 23,
    winning_change: 24,
    early_suicide: 25,
    blocked_winning: 26,
    score_change: 27
  });
  DragonBound2.prototype.ReceivedChatArray = function(a, b) {
    for (var c, d; 0 < a.length;) switch (a.shift()) {
      case GAMEMSG.winning_award:
        ChatReceived(this.GetPlayerByPlayerNumber(a.shift()).name + " [" + l.t("Winning Award") + "] +" + a.shift() + " Gold +" + a.shift() + " GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.losing_consolation:
        ChatReceived(this.GetPlayerByPlayerNumber(a.shift()).name + " [" + l.t("Losing Consolation") + "] +" + a.shift() + " Gold +" + a.shift() + " GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.x_killed_y:
        d = a.shift();
        c = this.GetPlayerByPlayerNumber(d).name;
        ChatReceived(c + " " + l.t("was killed by") + " " + b, "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#f33", d != this.my_player_number ? c + " " + l.t("Killed") : l.t("You are dead :("));
        break;
      case GAMEMSG.x_bunge_y:
        d = a.shift();
        c = this.GetPlayerByPlayerNumber(d).name;
        ChatReceived(c + " " + l.t("was killed by") + " " + b + " (" + l.t("bunge") + ")", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#f66", d != this.my_player_number ?
          c + " " + l.t("Bunged") : l.t("You fall down :("));
        break;
      case GAMEMSG.ultra_high_ang:
        ChatReceived(b + " [" + l.t("Ultra High Angle Bonus") + "] +100Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.high_ang:
        ChatReceived(b + " [" + l.t("High Angle Bonus") + "] +50Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.excellent_shot:
        ChatReceived(b + " [" + l.t("Excellent Shot Bonus") + "] +100Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.good_shot:
        ChatReceived(b + " [" +
          l.t("Good Shot Bonus") + "] +50Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.shot_bonus:
        ChatReceived(b + " [" + l.t("Shot Bonus") + "] +25Gold", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.team_damage_penalty:
        ChatReceived(b + " [" + l.t("Team Damage Penalty") + "] -25Gold", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.killed_by_sd:
        ChatReceived(this.GetPlayerByPlayerNumber(a.shift()).name + " " + l.t("was killed by") + " Sudden Death", "", CHAT_TYPE_DEAD, void 0,
          GUI_LOCATION_GAME);
        break;
      case GAMEMSG.died_by_tele:
        ChatReceived(b + " [" + l.t("died by teleport") + "]", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.damage_1000:
        ChatReceived(b + " [1000 " + l.t("damage achieved") + "] +100Gold +1GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.damage_2000:
        ChatReceived(b + " [2000 " + l.t("damage achieved") + "] +200Gold +2GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.damage_3000:
        ChatReceived(b + " [3000 " + l.t("damage achieved") +
          "] +300Gold +4GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.triple_kill:
        ChatReceived(b + " [" + l.t("Triple Kill Bonus") + "] +999Gold +7GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#d9f", "Triple Kill");
        break;
      case GAMEMSG.double_kill:
        ChatReceived(b + " [" + l.t("Double Kill Bonus") + "] +500Gold +5GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        this.ShowBigMsg("#b7f", "Double Kill");
        break;
      case GAMEMSG.ending_bonus:
        ChatReceived(b + " [" + l.t("Ending Bonus") + "] +400Gold +2GP",
          "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.bunge_bonus:
        ChatReceived(b + " [" + l.t("Bunge Shot Bonus") + "] +200Gold +1GP", "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.suicide_penalty:
        ChatReceived(b + " [" + l.t("Suicide Penalty") + "] -1000Gold -5GP", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.unlocked_challenge:
        ChatReceived(l.t("Room Master unlocked a new challenge opponent ! :)"), "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.free_kill_detected:
        ChatReceived(l.t("Free kill game detected - No winning bonus"),
          "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.suicide_penalty_bunge:
        ChatReceived(b + " [" + l.t("Suicide Penalty") + "] -1000Gold -5GP (" + l.t("bunge") + ")", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.team_kill_penalty:
        ChatReceived(b + " [Team Kill Penalty] -50Gold -1GP", "", CHAT_TYPE_DEAD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.winning_change:
        ChatReceived(l.t("Winning Bonus") + ": " + l.t("Team") + " A = " + a.shift() + " GP, " + l.t("Team") + " B = " + a.shift() + " GP.", "", CHAT_TYPE_SYSTEM,
          void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.early_suicide:
        ChatReceived(l.t("Early Suicide") + "! " + l.t("Team") + " A = " + a.shift() + " GP, " + l.t("Team") + " B = " + a.shift() + " GP.", "", CHAT_TYPE_SYSTEM, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.blocked_winning:
        c = a.shift();
        d = a.shift();
        ChatReceived(this.GetPlayerByPlayerNumber(c).name + " - " + l.t("No winning bonus (because you already won %% many times today. Play for fun, play with others, or continue tomorrow).").replace("%%", -1 == d ? "Computer Players" : this.GetPlayerByPlayerNumber(d).name),
          "", CHAT_TYPE_GOLD, void 0, GUI_LOCATION_GAME);
        break;
      case GAMEMSG.score_change:
        this.ScoreLifeExpired(a.shift(), a.shift(), a.shift())
    }
  };
  DragonBound2.prototype.UpdateScore = function(a, b) {
    $("#score_panel_a").html(a);
    $("#score_panel_b").html(b)
  };
  DragonBound2.prototype.ChatReceived = function(a, b, c) {
    DEBUG && console.log("ChatReceived:", a, b, c);
    var d, e = this.players.length,
      f;
    for (d = 0; d < e; d++)(f = this.players[d]) && f.name.replace(/<font.*font> /, "") == b && 1E8 > f.id && f.Chat(a, c)
  };
  DragonBound2.prototype.ScoreLifeExpired = function(a, b, c) {
    DEBUG && console.log("[ScoreLifeExpired]", a, b, c);
    ChatReceived("Team " + (a == TEAM_A ? "A" : "B") + " life expired. (Score " + b + "-" + c + ")", "", CHAT_TYPE_LOSE_LIFE, void 0, GUI_LOCATION_GAME);
    this.UpdateScore(b, c)
  };
  DragonBound2.prototype.ShowClickToRevive = function() {
    if (!this.click_to_revive) {
      $("#game_click_to_revive").html(l.t("Select Location to Return")).fadeIn();
      this.click_to_revive = !0;
      var a = $('<div id="revive_panel"></div>').css({
        width: "100%",
        height: "100%",
        top: -0
      });
      $("#game_back").append(a);
      var b = $('<div id="revive_hand" class="blinkingGlow"></div>');
      a.append(b);
      var c = this;
      a.on("mousedown touchstart", function(a) {
        if ("mousedown" != a.type || 0 == a.button) {
          var e = void 0 === a.offsetY ? a.originalEvent.layerY : a.offsetY;
          a = Math.round(void 0 === a.offsetX ? a.originalEvent.layerX : a.offsetX);
          var e = Math.round(e) - 0,
            f = c.dragon2d.ScreenToCameraXY(a, e);
          b.css({
            left: a,
            top: e + 0
          });
          c.dragon2d.ground.IsPixel(f.x, f.y) || void 0 == c.dragon2d.ground.GetUnder(f.x, f.y) || (c.dn.SendRevive(f.x, f.y), b.removeClass("squeeze_anim"), setTimeout(function() {
            b.addClass("squeeze_anim")
          }, 1))
        }
      }).on("mousemove touchmove", function(d) {
        if (d.target == a[0]) {
          var e = void 0 === d.offsetY ? d.originalEvent.layerY : d.offsetY;
          d = Math.round(void 0 === d.offsetX ? d.originalEvent.layerX :
            d.offsetX);
          var e = Math.round(e) - 0,
            f = c.dragon2d.ScreenToCameraXY(d, e);
          b.css({
            left: d,
            top: e + 0
          });
          d = !c.dragon2d.ground.IsPixel(f.x, f.y) && void 0 != c.dragon2d.ground.GetUnder(f.x, f.y);
          SetClass(b, "CanRevive", d)
        }
      });
      $("#gameChat").addClass("noPointerEvents")
    }
  };
  DragonBound2.prototype.HideClickToRevive = function() {
    this.click_to_revive = !1;
    $("#game_click_to_revive").hide();
    $("#revive_panel").remove();
    $("#gameChat").removeClass("noPointerEvents")
  };
  DragonBound2.prototype.ShowBigMsg = function(a, b) {
    OPTIONS.killmsg && ($(".BonusMsg").remove(), clearTimeout(this.msgTimeout), this.msgTimeout = setTimeout(function() {
      $("#game_front").append($('<div class="BonusMsg blackShadow" style="color:' + a + '">' + b + "</div>"))
    }, 1))
  };
  DragonBound2.prototype.UpdateGuiGold = function(a) {
    this.gui_gold = a;
    var b = a.toString().split("").reverse();
    for (a = 0; a < b.length && 5 > a; a++) "-" == b[a] ? $("#UIGoldDigit" + a).animate({
      backgroundPositionY: "-154px"
    }, 1E3) : $("#UIGoldDigit" + a).animate({
      backgroundPositionY: -14 - 14 * Number(b[a]) + "px"
    }, 1E3);
    for (; 5 > a; a++) $("#UIGoldDigit" + a).animate({
      backgroundPositionY: "0"
    }, 1E3)
  };
  DragonBound2.prototype.SetWeather = function(a) {
    this.weather = a;
    this.UpdateWeatherGUI()
  };
  DragonBound2.prototype.PushWeather = function(a) {
    this.weather.shift();
    this.weather.push(a);
    this.UpdateWeatherGUI();
    1 == this.weather[1] && AudioPlay(AUDIO_WIND)
  };
  DragonBound2.prototype.UpdateWeatherGUI = function() {
    $("#weatherSlot0").removeClass().addClass("weather-" + this.weather[0]);
    $("#weatherSlot1").removeClass().addClass("weather-" + this.weather[1]);
    $("#weatherSlot2").removeClass().addClass("weather-" + this.weather[2]);
    $("#weatherSlot3").removeClass().addClass("weather-" + this.weather[3]);
    $("#weatherSlot4").removeClass().addClass("weather-" + this.weather[4])
  };
  DragonBound2.prototype.UpdateWind = function(a) {
    var b = a[0],
      c = a[1];
    if (!this.gameStuffImage) {
      var d = this;
      a = this.gameStuffImage = new Image;
      a.onload = function() {
        d.DrawWind(b, c)
      };
      a.src = GetBackgroundImageUrl("#gameui")
    }
    this.DrawWind(b, c)
  };
  DragonBound2.prototype.DrawWind = function(a, b) {
    var c = $("#wind_meter2")[0].getContext("2d"),
      d = this.gameStuffImage;
    c.clearRect(0, 0, 66, 60);
    var e = this.WOX,
      f = this.WOY;
    d && c.drawImage(d, 177, 159, 54, 54, e, f, 54, 54);
    c.save();
    c.translate(27 + e, 27 + f);
    c.rotate(AngleToRad(-b));
    d && c.drawImage(d, 483, 221, 86, 5, -35, -2, 70, 5);
    c.restore();
    c.save();
    d = 10 > a ? "#ffffff" : 20 > a ? "#ffff00" : "#ff0000";
    10 > a && (a = "0" + a);
    c.fillStyle = d;
    c.font = "20px verdana";
    c.shadowColor = "black";
    c.shadowOffsetX = 0;
    c.shadowOffsetY = 0;
    c.shadowBlur = 4;
    c.strokeStyle =
      "black";
    c.lineWidth = 1;
    c.strokeText(a, 14 + e, 34 + f);
    c.fillText(a, 14 + e, 34 + f);
    c.restore();
    g_dirty && c.drawImage(g_dirty, -1, -1, 1, 1)
  };
  DragonBound2.prototype.UpdatePlayer = function(a) {
    var b = a[0];
    if (b != this.my_player_number) {
      var c = a[1],
        d = a[2];
      a = a[3];
      this.GetPlayerByPlayerNumber(b).MoveTo(c, d, a)
    }
  };
  DragonBound2.prototype.GameOver = function(a) {
    $("#scores_lose_a,#scores_lose_b").removeClass();
    if (a.won == TEAM_A || "A" == a.won) $("#scores_lose_a").addClass("win"), $("#scores_lose_b").removeClass();
    else if (a.won == TEAM_B || "B" == a.won) $("#scores_lose_a").removeClass(), $("#scores_lose_b").addClass("win");
    var b = ["", "Computer", "Left", "Rank Up!"],
      c = ["", "score_state_computer", "score_state_left", "score_state_rankup"],
      d = this.my_start_gp,
      e = 0,
      f = this.my_start_gold,
      h = 0;
    $(".score").hide().removeClass("toShow");
    for (var k =
        0; k < a.scores.length; k++) {
      var m = a.scores[k],
        n = m[0],
        p = m[1],
        q = m[2],
        r = m[3],
        s = m[4],
        t = m[5],
        w = m[6],
        v = m[7] || 0,
        m = m[8] || 0;
      $("#score" + n + " .score_name").html(q);
      $("#score" + n + " .score_rank").removeClass().addClass("score_rank rank rank" + r);
      $("#score" + n + " .score_gp").html(s + " GP");
      $("#score" + n + " .score_gold").html(t + " GOLD");
      $("#score" + n + " .score_bonus_gp").html(v ? "+" + v + " GP" : "");
      $("#score" + n + " .score_bonus_gold").html(m ? "+" + m + " GOLD" : "");
      $("#score" + n + " .score_state").html(b[w]).removeClass().addClass("score_state blackShadow " +
        c[w]);
      p == this.my_user_id ? ($("#score" + n + " .score_me").show(), e = s + v, h = t + m) : $("#score" + n + " .score_me").hide();
      $("#score" + n).addClass("toShow")
    }
    this.dn.myPlayerInfo.gp == d && (this.dn.myPlayerInfo.gp += e);
    this.dn.myPlayerInfo.gold == f && (this.dn.myPlayerInfo.gold += h);
    if (OPTIONS.gameendcounter) {
      var u, x, y = GpForNextRank(d);
      $("#GameOverMyGPGot").html((0 < e ? "+" : "") + Commatize(e) + " GP").show();
      $("#GameOverMyGP").html(Commatize(d) + " GP").removeClass("shake_anim").show();
      0 < y && $("#GameOverMyGPNext").html("Next Rank in " +
        Commatize(y) + " GP").show();
      $("#GameOverMyGoldGot").html((0 < h ? "+" : "") + Commatize(h) + " Gold").show();
      $("#GameOverMyGold").html(Commatize(f) + " Gold").removeClass("shake_anim").show();
      var A = function() {
        var a = (get_time() - u) / 2E3;
        1 < a && (a = 1);
        var b = 0.5 < a ? 2 * (a - 0.5) : 0,
          c = d + Math.round(e * (0.5 < a ? 1 : 2 * a)),
          b = f + Math.round(h * b);
        $("#GameOverMyGP").html(Commatize(c) + " GP");
        $("#GameOverMyGold").html(Commatize(b) + " Gold");
        y = GpForNextRank(c);
        0 < y ? $("#GameOverMyGPNext").html("Next Rank in " + Commatize(y) + " GP").show() : $("#GameOverMyGPNext").hide();
        0.5 < a && $("#GameOverMyGP").addClass("shake_anim");
        1 <= a && ($("#GameOverMyGold").addClass("shake_anim"), clearInterval(x), setTimeout(function() {
          $(".toShow").show("fast");
          $("#GameOverMyGP,#GameOverMyGold,#GameOverMyGPGot,#GameOverMyGoldGot,#GameOverMyGPNext").hide("fast")
        }, 800))
      };
      setTimeout(function() {
        u = get_time();
        x = setInterval(A, 25)
      }, 800)
    } else $(".toShow").show(), $("#GameOverMyGP,#GameOverMyGold,#GameOverMyGPGot,#GameOverMyGoldGot,#GameOverMyGPNext").hide();
    var z = this;
    $(".Player").promise().done(function() {
      function a() {
        $("#game_over").unbind();
        g_score_screen_timeout = clearTimeout(g_score_screen_timeout);
        var c = '<span id="ShareLastGame" class="opacity_button">[' + l.t("View Last Game Results") + "]</span><br>";
        b.location == GUI_LOCATION_GAME && (b.should_stay_in_game_screen = !1, b.myPlayerInfo.location_type == LOCATION_TYPE_CHANNEL ? (SwitchToChannelScreen(b), $("#channelTextHtml").append(c)) : ($("#roomChatHtml").append(c), SwitchToRoomScreen(b)), $("#ShareLastGame").click(function(a) {
          b.SendGameShare()
        }))
      }
      var b = z.dn;
      z.Destructor();
      z.dn.game = void 0;
      g_score_screen_timeout =
        setTimeout(a, 12E3);
      $("#game_over").unbind().click(a).fadeIn(1E3)
    })
  };
  DragonBound2.prototype.ChangedShot = function(a) {
    0 > this.my_player_index || this.players[this.my_player_index].ChangedShot(a)
  };
  DragonBound2.prototype.Destructor = function() {
    var a = $(document);
    a.unbind("keyup");
    a.unbind("mousedown");
    a.unbind("mouseup", this.func_mouseup);
    a.unbind("mousemove");
    a.unbind("touchstart");
    a.unbind("touchend");
    a.unbind("touchmove");
    $("#btnShoot").unbind("mousedown touchstart mouseup touchend");
    $("#btnLeft").unbind("mousedown touchstart mouseup touchend");
    $("#btnRight").unbind("mousedown touchstart mouseup touchend");
    $("#btnUp").unbind("mousedown touchstart mouseup touchend");
    $("#btnDown").unbind("mousedown touchstart mouseup touchend");
    this.turnTimeout = clearInterval(this.turnTimeout);
    this.intervalDoUp = clearInterval(this.intervalDoUp);
    this.intervalDoDown = clearInterval(this.intervalDoDown);
    this.EndTurn();
    $("#powerBar").css("width", 0);
    $("#turn_timer").hide();
    $("#game_over").hide();
    $("#container").removeClass("HandCursor");
    this.HideClickToRevive();
    this.dragon2d.RemoveAll();
    this.dragon2d.Stop();
    this.destructed = !0
  };
  DragonBound2.prototype.UINextShot = function() {
    this.is_s1_disabled ? SelectShotType(1 == GetSelectedShotType() && $("#btnShotSS").is(":visible") ? 2 : 1, this) : SelectShotType((GetSelectedShotType() + 1) % 3, this)
  };
  DragonBound2.prototype.UnselectAllItems = function() {
    for (var a = 0; 6 > a; a++) $("#gameItemSlot" + a).removeClass("Pressed")
  };
  DragonBound2.prototype.PassTurnClicked = function() {
    this.turn == this.my_player_number && this.PassTurn()
  };
  DragonBound2.prototype.F10Friends = function() {
    $("#friendsList").is(":visible") ? $("#friendsList").hide() : ($("#friendsList").show(), TabChangeTo(TAB_FRIENDS), this.dn.SendTabWatch(1), 0 == $("#friendsListHtml").children().length && this.dn.SendRefreshFriends())
  };
  DragonFreeze(DragonBound2);

  function Ground2(a) {
    var b = this.w = a.w,
      c = this.h = a.h,
      d = a.fg,
      e = this.canvas = document.createElement("canvas");
    e.width = b;
    e.height = c;
    var f = DragonDecompress(a.data),
      h = this.context = e.getContext("2d"),
      k = this.imageData = h.createImageData(b, c);
    BooleanArrayToImageData(f, k);
    h.putImageData(k, 0, 0);
    DynamicCanvasTextureSprite.call(this, PIXI.Texture.fromCanvas(e));
    var m = new Image,
      n = this;
    m.onload = function() {
      var d = ImageDataToBooleanArray(k);
      h.drawImage(m, 0, 0, max(b, m.width), Math.max(c, m.height));
      n.imageData = h.getImageData(0,
        0, b, c);
      a.is_custom_map && (BooleanArrayToImageData(d, n.imageData, !1), h.putImageData(n.imageData, 0, 0), n.dataUrl = e.toDataURL("image/png"));
      BooleanArrayToImageData(d, n.imageData, a.is_shadow);
      h.putImageData(n.imageData, 0, 0);
      n._dirtyTexture = !0
    }; - 1 == d.indexOf("/") ? -1 == d.indexOf(".") ? m.src = "/static/images/maps/" + d + ".jpg" : m.src = "/static/images/maps/" + d : m.src = d
  }
  Ground2.prototype = Object.create(DynamicCanvasTextureSprite.prototype);
  Ground2.prototype.constructor = Ground2;
  Ground2.prototype.IsPixel = function(a, b) {
    return 0 > a || a >= this.w || 0 > b || b >= this.h ? !1 : 0 < this.imageData.data[4 * (b * this.w + a) + 3]
  };
  Ground2.prototype.GetPosForWalking = function(a, b, c) {
    var d = c == DIR_LEFT ? a - 1 : a + 1;
    if (0 > d || d >= this.w) return {
      x: a,
      y: b,
      stuck: !0
    };
    if (this.IsPixel(d, b)) {
      for (c = b; c > b - 10; c--)
        if (!this.IsPixel(d, c)) return {
          x: d,
          y: c
        };
      return {
        x: a,
        y: b,
        stuck: !0
      }
    }
    for (c = b + 1; c < this.h; c++)
      if (this.IsPixel(d, c)) return {
        x: d,
        y: c - 1
      };
    return {
      x: d,
      y: this.h + 100,
      fall_and_die: !0
    }
  };
  Ground2.prototype.GetUnder = function(a, b, c) {
    if (void 0 == this.imageData) throw Error("GetUnder - imageData = undefined");
    for (c = c ? b + c : this.h; b < c; b++)
      if (this.IsPixel(a, b)) return b - 1
  };
  Ground2.prototype.GetAngle = function(a, b) {
    if (this.IsPixel(a, b)) return DEBUG && console.log("[CGround.GetAngle] IN-GROUND"), 0;
    var c = this.GetUnder(a, b, 10);
    if (void 0 == c) return DEBUG && console.log("[CGround.GetAngle] FALLING"), 0;
    if (c != b) return DEBUG && console.log("[CGround.GetAngle] FLYING"), 0;
    for (var d = c, e = 1, f = c, h = 1, k = 1; 9 >= k; k++) c = this.GetUnder(a - k, b - 10, 20), void 0 != c && (d += c, e++), c = this.GetUnder(a + k, b - 10, 20), void 0 != c && (f += c, h++);
    return Math.round(RadToAngle(Math.atan2((0 < h ? f / h : b) - (0 < e ? d / e : b), 19)))
  };
  Ground2.prototype.AddGroundHole = function(a, b, c, d) {
    var e, f, h, k, m = c * c,
      n = d * d,
      p, q, r;
    for (e = a - c - 10; e <= a; e++)
      for (r = !1, c = b - d - 10; c < b; c++)
        if (f = e - a, h = c - b, k = f * f / m + h * h / n, !r && 1.2 > k) {
          if (r = !0, p = e, q = c, h = b - h, this.AddGroundShadowColumn(p, q, h), 0 != f && (p = a - f, this.AddGroundShadowColumn(p, q, h)), 1.2 <= k && r) break
        } else if (1 > k) {
      p = e;
      q = c;
      h = b - h;
      this.AddGroundHoleColumn(p, q, h);
      0 != f && (p = a - f, this.AddGroundHoleColumn(p, q, h));
      break
    }
    this.context.putImageData(this.imageData, 0, 0);
    this._dirtyTexture = !0
  };
  Ground2.prototype.AddGroundHoleColumn = function(a, b, c) {
    if (!(0 > a || a >= this.w || (0 > b && (b = 0), c >= this.h && (c = this.h - 1), c < b)))
      for (var d = this.w, e = b; e <= c; e++) b = 4 * (e * d + a), this.imageData.data[b + 3] = 0
  };
  Ground2.prototype.AddGroundShadowColumn = function(a, b, c) {
    if (!(0 > a || a >= this.w || (0 > b && (b = 0), c >= this.h && (c = this.h - 1), c < b)))
      for (var d = this.w, e = b; e <= c; e++) b = 4 * (e * d + a), this.imageData.data[b] /= 2, this.imageData.data[b + 1] /= 2, this.imageData.data[b + 2] /= 2
  };

  function FlyingSprite(a, b, c, d, e, f, h, k) {
    PIXI.Sprite.call(this, a);
    this.time = k;
    this.total_elapsed_time = 0;
    this.zp = new ZotataPhysics(b, c, d, e, f, h);
    this.x = b;
    this.y = c;
    this.anchor.x = this.anchor.y = 0.5;
    DragonClock.Add(this)
  }
  FlyingSprite.prototype = Object.create(PIXI.Sprite.prototype);
  FlyingSprite.prototype.constructor = FlyingSprite;
  FlyingSprite.prototype.Update = function(a) {
    a = this.total_elapsed_time += a;
    if (a >= this.time) this.Remove();
    else {
      var b = this.zp.GetPosAtTime(a);
      this.alpha = 1 - a / this.time;
      this.x = b.x;
      this.y = b.y
    }
  };
  FlyingSprite.prototype.Remove = function() {
    DragonClock.Remove(this);
    this.parent && this.parent.removeChild(this)
  };
  Object.freeze(FlyingSprite.prototype);
  Object.freeze(FlyingSprite);
  window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.oRequestAnimationFrame;

  function DragonClock() {
    this.registered = {};
    this.registered_last = void 0;
    this.length = this.next_id = 0
  }
  DragonClock.prototype.Add = function(a, b) {
    b ? this.registered_last = a : this.registered[this.next_id] = a;
    return this.next_id++
  };
  DragonClock.prototype.Remove = function(a) {
    delete this.registered[a]
  };
  DragonClock.prototype.StartLoop = function() {
    function a() {
      if (b.stop) b.looping = !1;
      else {
        requestAnimationFrame(a);
        var d = get_time(),
          e = d - c;
        c = d;
        var d = 0,
          f;
        for (f in b.registered) d++, b.registered[f](e);
        b.registered_last && b.registered_last();
        b.length = d
      }
    }
    this.stop = !1;
    if (!this.looping) {
      var b = this,
        c = get_time();
      this.looping = !0;
      a()
    }
  };
  DragonClock.prototype.StopLoop = function() {
    this.stop = !0
  };
  DragonClock.Add = function(a, b, c) {
    if (a.Update) a._dragonclock_id = g_dragonClock.Add(a[b || "Update"].bind(a), c);
    else throw Error("DragonClock - registered class does not have Update function");
  };
  DragonClock.Remove = function(a) {
    void 0 != a._dragonclock_id ? g_dragonClock.Remove(a._dragonclock_id) : warn("[DragonClock] Trying to remove an object that was not added:", a)
  };
  Object.freeze(DragonClock.prototype);
  Object.freeze(DragonClock);
  var g_dragonClock = new DragonClock;
  var g_digitsTextures = {
      Red0: [572, 199],
      Red1: [593, 199],
      Red2: [614, 199],
      Red3: [635, 199],
      Red4: [656, 199],
      Red5: [677, 199],
      Red6: [698, 199],
      Red7: [719, 199],
      Red8: [740, 199],
      Red9: [761, 199],
      "Red-": [782, 199],
      Blue0: [572, 221],
      Blue1: [593, 221],
      Blue2: [614, 221],
      Blue3: [635, 221],
      Blue4: [656, 221],
      Blue5: [677, 221],
      Blue6: [698, 221],
      Blue7: [719, 221],
      Blue8: [740, 221],
      Blue9: [761, 221],
      "Blue-": [782, 221],
      "Blue+": [782, 176],
      Green0: [572, 243],
      Green1: [593, 243],
      Green2: [614, 243],
      Green3: [635, 243],
      Green4: [656, 243],
      Green5: [677, 243],
      Green6: [698, 243],
      Green7: [719, 243],
      Green8: [740, 243],
      Green9: [761, 243],
      "Green+": [782, 243]
    },
    g_damageSprites = {};

  function DamageSprite(a, b, c, d, e, f, h) {
    PIXI.DisplayObjectContainer.call(this);
    d = round(d);
    var k = h ? "Blue" : "Red";
    !h && 0 < d && (k = "Green");
    this.unique_id = "" + e + "_" + f + "_" + k + (h ? 0 <= d ? "+" : "-" : "");
    g_damageSprites[this.unique_id] && (d += g_damageSprites[this.unique_id].damage, g_damageSprites[this.unique_id].Remove());
    this.damage = d;
    g_damageSprites[this.unique_id] = this;
    e = String(d);
    "Red" != k && 0 < d && (e = "+" + e);
    d = PIXI.Texture.fromImage("/static/images/game_stuff6.png");
    for (f = 0; f < e.length; f++) {
      h = e.charCodeAt(f);
      var m = k;
      45 == h ?
        m += "-" : 43 == h ? m += "+" : 48 <= h && 57 >= h && (m += h - 48);
      void 0 != g_digitsTextures[m].length && (g_digitsTextures[m] = new PIXI.Texture(d, new PIXI.Rectangle(g_digitsTextures[m][0], g_digitsTextures[m][1], 20, 21)));
      h = new PIXI.Sprite(g_digitsTextures[m]);
      h.x = 14 * f;
      h.y = 0;
      this.addChild(h)
    }
    this.total_elapsed_time = 0;
    this.parent_container = a;
    this.time = 5E3;
    this.start_y = c;
    this.x = b - 7 * (f + 1);
    this.y = c - 10;
    this.parent_container.addChild(this);
    DragonClock.Add(this)
  }
  DamageSprite.prototype = Object.create(PIXI.DisplayObjectContainer.prototype);
  DamageSprite.prototype.constructor = DamageSprite;
  DamageSprite.prototype.Update = function(a) {
    a = this.total_elapsed_time += a;
    a >= this.time ? this.Remove() : (this.y = 600 < a ? this.start_y - 60 : this.start_y - 60 * a / 600, 2E3 < a && (this.alpha = 1 - (a - 2E3) / (this.time - 2E3)))
  };
  DamageSprite.prototype.Remove = function() {
    delete g_damageSprites[this.unique_id];
    DragonClock.Remove(this);
    this.parent_container.removeChild(this)
  };
  Object.freeze(DamageSprite.prototype);
  Object.freeze(DamageSprite);

  function Player2(a, b) {
    this.db = b;
    this.dn = b.dn;
    this.ground = this.db.dragon2d.ground;
    a = ArrayToObject(a, "n id name guild rank x y hp shield shield_regen minang maxang lastturn mobile avatars aim_s1_ang aim_s1_len aim_s2_ang aim_s2_len aim_ss_ang aim_ss_len relationship_status country".split(" "));
    a.avatars = ArrayToObject(a.avatars, "head body eyes flag bg fg".split(" "));
    delete a.avatars.bg;
    delete a.avatars.fg;
    for (var c in a) this[c] = a[c];
    void 0 == this.look && (this.look = this.x < b.dragon2d.ground.w / 2 ? DIR_RIGHT :
      DIR_LEFT);
    this.aim = [new Vector(this.aim_s1_ang, this.aim_s1_len), new Vector(this.aim_s2_ang, this.aim_s2_len), new Vector(this.aim_ss_ang, this.aim_ss_len)];
    this.team = this.n % 2 ? TEAM_B : TEAM_A;
    this.selected_shot = SHOT1;
    this.delay = this.delay_before = 0;
    this.is_alive = !0;
    this.ang = random(this.minang, this.maxang);
    this.body = this.ground.GetAngle(this.x, this.y);
    this.maxhp = this.hp;
    this.maxshield = this.shield;
    if (this.id == b.my_user_id) {
      this.is_me = !0;
      this.selected_shot = GetSelectedShotType();
      this.ChangedShot(this.selected_shot);
      var d = this;
      this.gameStuffImage = new Image;
      this.gameStuffImage.onload = function() {
        d.UpdateGuiAngle()
      };
      this.gameStuffImage.src = GetBackgroundImageUrl("#gameui")
    }
    this.last_sent_x = this.x;
    this.last_sent_y = this.y;
    this.last_sent_look = this.look;
    this.player_sprite = b.dragon2d.AddPlayer(this);
    this.is_me && this.ChangedShot(this.selected_shot);
    if (c = MOBILES[this.mobile]) {
      if (c.bullets)
        for (var e = 0; e < c.bullets.length; e++) PreloadBullet(c.bullets[e]);
      if (c.explodes)
        for (e = 0; e < c.explodes.length; e++) PreloadExplode(c.explodes[e], !0)
    }
  }
  Player2.prototype.ChangedShot = function(a) {
    this.selected_shot = a;
    this.aim_circle_x = this.aim[a].x;
    this.aim_circle_y = this.aim[a].y;
    this.player_sprite && this.player_sprite.SetAimCircleOffset(this.aim_circle_x, this.aim_circle_y);
    this.player_sprite && this.player_sprite.ion && this.player_sprite.SetIon(void 0, 0, a == SHOT2 ? -600 : -200)
  };
  Player2.prototype.Fall = function() {
    if (this.is_alive && !this.is_dont_fall) {
      var a = this.ground.GetUnder(this.x, this.y);
      void 0 == a ? (debug && log("Player fall and die:", this.name), this.y = 1500, this.player_sprite.ChangePos(this.x, this.y, !0, 250), this.is_alive = !1) : (a != this.y && (this.y = a, this.player_sprite.ChangePos(this.x, this.y, !0, 250)), a = this.ground.GetAngle(this.x, this.y), a != this.body && (this.body = a, this.UpdateGuiAngle(), this.player_sprite.ChangeBodyAngle(a, !0)))
    }
  };
  Player2.prototype.Walk = function(a) {
    this.Look(a);
    var b = this.body;
    a = this.ground.GetPosForWalking(this.x, this.y, a);
    if (a.fall_and_die || a.stuck) return !1;
    this.x = a.x;
    this.y = a.y;
    this.player_sprite.ChangePos(a.x, a.y);
    b = this.ground.GetAngle(a.x, a.y);
    this.body != b && (this.body = b, this.UpdateGuiAngle(), this.player_sprite.ChangeBodyAngle(b, !0));
    return !0
  };
  Player2.prototype.Look = function(a) {
    this.look != a && (this.look = a, this.player_sprite.ChangeLook(a, !0), this.UpdateGuiAngle())
  };
  Player2.prototype.ChangeAngleTo = function(a, b) {
    a > this.maxang && (a = this.maxang);
    a < this.minang && (a = this.minang);
    if (this.ang != a || b) this.ang = a, this.UpdateGuiAngle(), this.DrawPlayerAngle()
  };
  Player2.prototype.UpdateGuiAngle = function() {
    if (this.is_me) {
      var a = (this.look == DIR_LEFT ? 180 - this.ang : this.ang) - this.body;
      90 < a && (a = 180 - a);
      if (!this.myAngleContext) {
        var b = $("#MyAngle");
        this.myAngleContext = b[0].getContext("2d");
        this.angOX = random(0, 6);
        this.angOY = random(0, 2);
        var c = random(-20, 20);
        b.css("-webkit-filter", "hue-rotate(" + c + "deg)")
      }
      this.gameStuffImage && (this.myAngleContext.clearRect(0, 0, 43, 15), 0 > a && (this.myAngleContext.drawImage(this.gameStuffImage, 801, 154, 13, 13, 0 + this.angOX, 0 + this.angOY, 13, 13),
        a *= -1), this.myAngleContext.drawImage(this.gameStuffImage, 801, 14 * Math.floor(a / 10) + 14, 13, 13, 13 + this.angOX, 0 + this.angOY, 13, 13), this.myAngleContext.drawImage(this.gameStuffImage, 801, a % 10 * 14 + 14, 13, 13, 26 + this.angOX, 0 + this.angOY, 13, 13), g_dirty && this.myAngleContext.drawImage(g_dirty, -1, -1, 1, 1))
    }
  };
  Player2.prototype.DrawPlayerAngle = function() {
    this.player_sprite.ChangeAngle(this.ang)
  };
  Player2.prototype.Shoot = function(a, b, c) {
    this.dn.SendPlayerShoot(this.x, this.y, this.body, this.look, this.ang, a, b, c);
    a = (this.look == PLAYER_LOOK_LEFT ? 180 - this.ang : this.ang) - this.body;
    b = $("#LastAngleDigit-");
    90 < a && (a = 180 - a);
    0 > a ? (b.show(), a *= -1) : b.hide();
    $("#LastAngleDigit1").removeClass().addClass("LastAngleDigit LastAngleDigit" + Math.floor(a / 10));
    $("#LastAngleDigit2").removeClass().addClass("LastAngleDigit LastAngleDigit" + a % 10)
  };
  Player2.prototype.PassTurn = function(a) {
    this.dn.SendPlayerPassTurn(this.x, this.y, this.body, this.look, this.ang, a)
  };
  Player2.prototype.ChangeMyTurn = function(a) {
    this.db.dragon2d.SetPlayerTurn(a ? this.id : void 0)
  };
  Player2.prototype.RegenShield = function(a) {
    if (this.is_alive && !(0 >= this.shield_regen) && this.shield < this.maxshield) {
      var b = Math.min(this.shield_regen, this.maxshield - this.shield);
      this.ChangeHPShield(this.hp, this.shield + b, a, !1)
    }
  };
  Player2.prototype.ChangeDelay = function(a, b) {
    a != this.delay && (this.delay_before = this.delay, this.delay = a);
    this.lastturn = b
  };
  Player2.prototype.UseItem = function(a) {
    this.dn.SendPlayerUseItem(a)
  };
  Player2.prototype.SendPosUpdate = function() {
    if (this.x != this.last_sent_x || this.y != this.last_sent_y || this.look != this.last_sent_look) this.dn.SendPlayerMove(this.x, this.y, this.body, this.look, this.ang), this.last_sent_x = this.x, this.last_sent_y = this.y, this.last_sent_look = this.look
  };
  Player2.prototype.MoveTo = function(a, b, c, d, e) {
    if (this.is_alive || void 0 != this.revive_turn)
      if (void 0 != c && this.look != c && this.Look(c), this.x = a, this.y = b, d) this.player_sprite.ChangePos(a, b, !1), e || this.Fall();
      else if (this.player_sprite.ChangePos(a, b, !0, 100), !e) {
      this.is_dont_fall = !0;
      var f = this;
      setTimeout(function() {
        f.is_dont_fall = !1;
        f.Fall()
      }, 1E3)
    }
  };
  Player2.prototype.SetGhost = function(a, b, c, d) {
    debug && log("[SetGhost]", this.name, a, b, c);
    this.revive_turn = c;
    this.MoveTo(a, b, void 0, void 0, !0);
    this.UpdateGhostTurn(d);
    this.player_sprite.EffectGhost()
  };
  Player2.prototype.UpdateGhostTurn = function(a) {
    void 0 != this.revive_turn && this.player_sprite.player_info.SetReviveIn(this.revive_turn - a)
  };
  Player2.prototype.Revived = function(a, b, c, d, e, f) {
    delete this.revive_turn;
    this.is_alive = !0;
    this.player_sprite.EffectNone();
    this.player_sprite.player_info.RestoreName();
    this.ChangeHPShield(c, d, f, !1);
    this.MoveTo(a, b)
  };
  Player2.prototype.ChangeHPShield = function(a, b, c, d) {
    if (this.hp != a || this.shield != b) {
      void 0 == b && (b = 0);
      var e = this.hp - a + (this.shield - b);
      d && 0 >= e || (d = this.hp == a, 0 > a && (a = 0), 0 > b && (b = 0), this.hp = a, this.shield = b, this.player_sprite.player_info.ChangeHP(this.hp, this.maxhp, this.shield, this.maxshield), this.db.dragon2d.CreateDamageEffect(this.x, this.y - 15, -e, this.n, c, d), 0 >= this.hp && (this.is_alive = !1, this.player_sprite.EffectDead()))
    }
  };
  Player2.prototype.Chat = function(a, b) {
    if (this.is_alive) {
      var c = 0;
      4 == b ? c = 1 : 5 == b && (c = 2);
      this.player_sprite.player_info.CreateTextBubble(a, c)
    }
  };
  Player2.prototype.ReduceHPby = function(a, b) {
    if (this.is_alive) {
      var c = this.shield,
        d = this.hp,
        c = c - a;
      0 > c && (d += c, c = 0);
      this.ChangeHPShield(d, c, b, !0)
    }
  };
  Player2.prototype.SetReducedDefence = function(a) {
    this.player_sprite.player_info.SetReducedDefenceText(0 == a ? "" : 0 > a ? "+" + -a + " DEF" : "-" + a + " DEF")
  };
  Player2.prototype.SetIon = function(a, b, c, d) {
    this.player_sprite.SetIon(a, b, c, d)
  };
  Player2.prototype.ChangeAliveTo = function(a) {
    !0 == this.is_alive && !1 == a && (this.is_alive = !1, this.player_sprite.EffectDead())
  };

  function PlayerInfo(a, b, c, d, e, f, h, k, m) {
    PIXI.DisplayObjectContainer.call(this);
    this.rank = a;
    this.name = b;
    this.guild = c;
    this.team = d;
    this.country = e;
    b = this.start_left = -40;
    void 0 != h && (this.ChangeHP(f, h, k, m), this.addChild(this.bar_sprite));
    h = RANK_IMG[a] || RANK_IMG[25];
    a = h.x;
    f = h.y;
    h = 1 == h.f ? DragonTheme_Get("ranks") || DragonTheme_Get("lobby_stuff") : g_ranks_file2;
    this.rank_sprite = new PIXI.Sprite(GetTextureWithCache(h, a, f, 25, 15));
    this.rank_sprite.x = b;
    this.rank_sprite.y = 17;
    this.addChild(this.rank_sprite);
    this.country &&
      (this.country_sprite = new PIXI.Text(this.country, {
        font: "18px verdana, arial, sans-serif",
        stroke: "black",
        fill: "white",
        strokeThickness: 5
      }), this.country_sprite.x = this.rank_sprite.x - 2, this.country_sprite.y = this.rank_sprite.y - 3, this.country_sprite.scale.x = this.country_sprite.scale.y = 0.5, this.addChild(this.country_sprite));
    b += 27;
    void 0 != this.guild && "" != this.guild && (this.guild_sprite = new PIXI.Text(this.guild, {
      font: "24px verdana, arial, sans-serif",
      stroke: "black",
      fill: d == TEAM_A ? "#f09" : d == TEAM_B ? "#09f" : "#f7a539",
      strokeThickness: 6
    }), this.guild_sprite.x = b, this.guild_sprite.y = 16, this.guild_sprite.scale.x = this.guild_sprite.scale.y = 0.5, this.addChild(this.guild_sprite), b += this.guild_sprite.width);
    this.name_sprite = new PIXI.Text(this.name, {
      font: "24px verdana, arial, sans-serif",
      stroke: "black",
      fill: d == TEAM_A ? "#FF9f6B" : d == TEAM_B ? "#BDCFCF" : "#fff",
      strokeThickness: 6
    });
    this.name_sprite.x = b;
    this.name_sprite.y = 16;
    this.name_sprite.scale.x = this.name_sprite.scale.y = 0.5;
    this.addChild(this.name_sprite);
    this.name_x = b;
    this.turn_sprite =
      new PIXI.Sprite(GetTextureWithCache(DragonTheme_Get("game_stuff"), 144, 159, 32, 29));
    this.turn_sprite.y = -116;
    this.turn_sprite.anchor.x = this.turn_sprite.anchor.y = 0.5
  }
  PlayerInfo.constructor = PlayerInfo;
  PlayerInfo.prototype = Object.create(PIXI.DisplayObjectContainer.prototype);
  PlayerInfo.prototype.SetTurn = function(a) {
    a && !this.is_turn ? (this.is_turn = !0, this.addChild(this.turn_sprite), this.total_elapsed_time = 0, DragonClock.Add(this), this.Update(0)) : !a && this.is_turn && (DragonClock.Remove(this), this.is_turn = !1, this.removeChild(this.turn_sprite))
  };
  PlayerInfo.prototype.Update = function(a) {
    this.is_turn && OPTIONS.anim && (this.total_elapsed_time += a, a = this.total_elapsed_time % 2E3 / 1E3, 1 < a && (a = 2 - a), this.turn_sprite.scale.x = this.turn_sprite.scale.y = 1 + 0.2 * a, this.turn_sprite.y = -116 + 30 * a)
  };
  PlayerInfo.prototype.CreateHpBar = function(a, b, c, d, e, f, h, k, m, n, p) {
    var q;
    this.bar_sprite ? (this.bar_sprite.cacheAsBitmap = !1, this.bar_sprite.clear(), q = this.bar_sprite) : q = new PIXI.Graphics;
    c *= 2;
    d *= 2;
    q.beginFill(e);
    q.lineStyle(2 * h, f);
    q.drawRect(0, 0, c - h, d - h);
    q.lineStyle(1, 8421504);
    q.drawRect(h, h, c - 2 * h - 1, d - 2 * h - 1);
    q.endFill();
    e = m + p;
    f = k / e;
    k = f * (c - 2 * h);
    q.beginFill(0.3 >= f ? 16711680 : 6534730);
    q.lineStyle(0);
    q.drawRect(h, h, k, d - 2 * h - 1);
    q.endFill();
    p && (c = n / e * (c - 2 * h), q.beginFill(24831), q.drawRect(h + k, h, c, d - 2 * h - 1), q.endFill());
    q.position.x = a;
    q.position.y = b;
    q.scale.x = q.scale.y = 0.5;
    q.cacheAsBitmap = !0;
    return this.bar_sprite = q
  };
  PlayerInfo.prototype.ChangeHP = function(a, b, c, d) {
    this.hp = a;
    this.max_hp = b;
    this.shield = c;
    this.max_shield = d;
    this.CreateHpBar(this.start_left, 10, 78, 5, 0, 16777215, 1, a, b, c, d)
  };
  PlayerInfo.prototype.Remove = function() {
    this.is_turn && this.SetTurn(!1);
    this.name_sprite.destroy(!0);
    this.guild_sprite && this.guild_sprite.destroy(!0);
    this.country_sprite && this.country_sprite.destroy(!0);
    this.bar_sprite && (this.bar_sprite.cacheAsBitmap = !1);
    this.parent.removeChild(this)
  };
  PlayerInfo.prototype.SetReviveIn = function(a) {
    this.name_sprite.setText("(" + a + " " + l.t("Turns") + ")");
    this.name_sprite.x = -this.name_sprite.width / 2;
    this.rank_sprite.alpha = this.bar_sprite.alpha = 0;
    this.guild_sprite && (this.guild_sprite.alpha = 0);
    this.country_sprite && (this.country_sprite.alpha = 0)
  };
  PlayerInfo.prototype.RestoreName = function() {
    this.name_sprite.setText(this.name);
    this.name_sprite.x = this.name_x;
    this.rank_sprite.alpha = this.bar_sprite.alpha = 1;
    this.guild_sprite && (this.guild_sprite.alpha = 1);
    this.country_sprite && (this.country_sprite.alpha = 1)
  };
  PlayerInfo.prototype.SetReducedDefenceText = function(a) {
    this.reduced_def ? this.reduced_def.setText(a) : (this.reduced_def = new PIXI.Text(a, {
      font: "22px verdana, arial, sans-serif",
      stroke: "#0066ff",
      fill: "#9cffde",
      strokeThickness: 3
    }), this.reduced_def.x = 30, this.reduced_def.y = -6, this.reduced_def.scale.x = this.reduced_def.scale.y = 0.5, this.addChild(this.reduced_def))
  };
  PlayerInfo.prototype.CreateTextBubble = function(a, b) {
    this.textBubble && this.textBubble.Remove();
    this.textBubble = new TextBubble(0, 0, a, b);
    this.addChild(this.textBubble)
  };

  function PlayerContainer(a, b, c, d, e, f, h, k, m, n, p, q, r, s, t, w, v) {
    PIXI.DisplayObjectContainer.call(this);
    this.flip = !1;
    this.avatar_x = this.avatar_y = 0;
    this.player_info = q;
    this.speed = 500;
    this.x = this.target_x = this.player_info.x = a;
    this.y = this.target_y = this.player_info.y = b;
    this.rotate_container = new PIXI.DisplayObjectContainer;
    this.rotate_container.rotation = AngleToRad(d);
    this.addChild(this.rotate_container);
    this.ChangeLook(c);
    this.ChangeBodyAngle(d);
    void 0 != r && (this.aimCircle = new PIXI.Sprite(GetTextureWithCache(DragonTheme_Get("game_stuff"),
      483, 116, 86, 86)), this.aimCircle.anchor.x = this.aimCircle.anchor.y = 0.5, this.aimCircle.z = -3, this.rotate_container.addChild(this.aimCircle), this.greenArea = new PIXI.Graphics, this.greenArea.lineStyle(25, 56320, 0.5), this.greenArea.arc(0, 0, 28, AngleToRad(180 + w), AngleToRad(180 + v + 3)), this.greenArea.z = -2, this.rotate_container.addChild(this.greenArea), this.angle = new PIXI.Sprite(GetTextureWithCache(DragonTheme_Get("game_stuff"), 526, 213, 43, 5)), this.angle.anchor.y = 0.5, this.angle.rotation = AngleToRad(180 + t), this.angle.z = -1, this.rotate_container.addChild(this.angle), this.SetAimCircleOffset(r, s));
    this.change_mobile(e);
    n && this.change(n);
    m && this.change(m);
    f && this.change(f);
    h && this.change(h);
    k && this.change(k);
    p && this.change(p);
    this.total_elapsed_time = 0;
    this.frame_time = 1E3 / ANIMATIONS_FPS;
    this.ion_speed = 1E3;
    DragonClock.Add(this)
  }
  PlayerContainer.constructor = PlayerContainer;
  PlayerContainer.prototype = Object.create(PIXI.DisplayObjectContainer.prototype);
  PlayerContainer.prototype.SetAimCircleOffset = function(a, b) {
    this.aimCircle.x = -a;
    this.aimCircle.y = b;
    this.greenArea.x = -a;
    this.greenArea.y = b;
    this.angle.x = -a;
    this.angle.y = b
  };
  PlayerContainer.prototype.Update = function(a) {
    this.x != this.target_x && (this.x = GetCloserToTargetValue(this.x, a * this.speed / 1E3, this.target_x), this.player_info.x = this.x);
    this.y != this.target_y && (this.y = GetCloserToTargetValue(this.y, a * this.speed / 1E3, this.target_y), this.player_info.y = this.y);
    this.rotate_container.scale.x != this.target_scale_x && (this.rotate_container.scale.x = GetCloserToTargetValue(this.rotate_container.scale.x, a / 200, this.target_scale_x));
    !this.ion_container || this.ion_container.target_x == this.ion_container.x &&
      this.ion_container.target_y == this.ion_container.y || (this.ion_container.x = GetCloserToTargetValue(this.ion_container.x, a * this.ion_speed / 1E3, this.ion_container.target_x), this.ion_container.y = GetCloserToTargetValue(this.ion_container.y, a * this.ion_speed / 1E3, this.ion_container.target_y));
    this.total_elapsed_time += a;
    var b = floor(this.total_elapsed_time / this.frame_time);
    this.current_frame != b && OPTIONS.anim && (this.current_frame = b, this.mobile && this.mobile.set_frame(b), this.ion && this.ion.set_frame(b), 0 == b % 2 && (this.background &&
      this.background.set_frame(b / 2), this.background2 && this.background2.set_frame(b / 2)), this.flag && this.flag.set_frame(b), this.head && this.head.set_frame(b), this.body && this.body.set_frame(b), this.eyes && this.eyes.set_frame(b, this.head ? this.head.is_special : !1), 0 == b % 2 && this.foreground && this.foreground.set_frame(b / 2));
    this.effect && ("ghost" == this.effect && (this.rotate_container.rotation = AngleToRad(-this.total_elapsed_time / 5)), "dead" == this.effect && 0 < this.alpha && (this.player_info.alpha = this.alpha = GetCloserToTargetValue(this.alpha,
      a / 2E3, 0)))
  };
  PlayerContainer.prototype.change = function(a, b, c, d) {
    if (a) {
      var e = AVATARS[a];
      if (void 0 == e) return warn(" *** ERROR: [CPlayerGraphic.change] unknown avatar ", a, e);
      b = e[AVATAR_INDEX_URL] ? e[AVATAR_INDEX_URL] : "ava/" + e[AVATAR_INDEX_GENDER] + e[AVATAR_INDEX_TYPE] + (e[AVATAR_INDEX_N] + 1E5).toString().substring(1) + ".png";
      var f = e[AVATAR_INDEX_TYPE];
      d = e[AVATAR_INDEX_GRAPHICS];
      if (f == AVATAR_TYPE_FLAG) {
        if (this.flag_n != a || c) this.flag && this.removeChild(this.flag), this.flag = new AnimatedSprite(b, d, this.flip ? -this.avatar_x : this.avatar_x,
          this.avatar_y, ANIMATIONS_FPS, this.flip, LOOP_NORMAL_AND_REVERSE, 3), this.rotate_container.addChild(this.flag), this.rotate_container.ApplyZIndex(), this.flag_n = a
      } else if (f == AVATAR_TYPE_HEAD) {
        if (this.head_n != a || c) this.head && this.removeChild(this.head), this.head = new AnimatedSprite(b, d, this.flip ? -this.avatar_x : this.avatar_x, this.avatar_y, ANIMATIONS_FPS, this.flip, LOOP_AVATAR, 5), this.rotate_container.addChild(this.head), this.rotate_container.ApplyZIndex(), this.head_n = a
      } else if (f == AVATAR_TYPE_BODY) {
        if (this.body_n !=
          a || c) this.body && this.removeChild(this.body), this.body = new AnimatedSprite(b, d, this.flip ? -this.avatar_x : this.avatar_x, this.avatar_y, ANIMATIONS_FPS, this.flip, LOOP_NORMAL_AND_REVERSE, 4), this.rotate_container.addChild(this.body), this.rotate_container.ApplyZIndex(), this.body_n = a
      } else if (f == AVATAR_TYPE_EYES) {
        if (this.eyes_n != a || c) this.eyes && this.removeChild(this.eyes), c = e[AVATAR_INDEX_GRAPHICS].length, e = LOOP_NORMAL_AND_REVERSE, 22 == c ? e = LOOP_AVATAR : 44 == c && (e = LOOP_AVATAR_NO_REVERSE), this.eyes = new AnimatedSprite(b,
          d, this.flip ? -this.avatar_x : this.avatar_x, this.avatar_y, ANIMATIONS_FPS, this.flip, e, 6), this.rotate_container.addChild(this.eyes), this.rotate_container.ApplyZIndex(), this.eyes_n = a
      } else if (f == AVATAR_TYPE_BACKGROUND) {
        if (this.background_n != a || c) this.background && this.removeChild(this.background), b = e[AVATAR_INDEX_URL] ? e[AVATAR_INDEX_URL] : "ava/b20" + e[AVATAR_INDEX_N] + ".png", this.background = new AnimatedSprite(b, d, this.flip ? -100 : 100, -69, ANIMATIONS_FPS / 2, !this.flip, LOOP_NORMAL, 1), this.rotate_container.addChild(this.background),
          this.rotate_container.ApplyZIndex(), this.background_n = a
      } else f != AVATAR_TYPE_FOREGROUND || this.foreground_n == a && !c || (this.foreground && this.removeChild(this.foreground), b = e[AVATAR_INDEX_URL] ? e[AVATAR_INDEX_URL] : "ava/f20" + e[AVATAR_INDEX_N] + ".png", this.foreground = new AnimatedSprite(b, d, this.flip ? -100 : 100, -69, ANIMATIONS_FPS / 2, !this.flip, LOOP_NORMAL, 7), this.rotate_container.addChild(this.foreground), this.rotate_container.ApplyZIndex(), this.foreground_n = a)
    } else {
      if (void 0 == b) return warn(" *** ERROR: [CPlayerGraphic.change] undefined avatar");
      b == AVATAR_TYPE_FLAG && this.flag ? (this.removeChild(this.flag), this.flag = this.flag_n = void 0) : b == AVATAR_TYPE_BODY && this.body ? (this.removeChild(this.body), this.body = this.body_n = void 0) : b == AVATAR_TYPE_EYES && this.eyes ? (this.removeChild(this.eyes), this.eyes = this.eyes_n = void 0) : b == AVATAR_TYPE_HEAD && this.head ? (this.removeChild(this.head), this.head = this.head_n = void 0) : b == AVATAR_TYPE_BACKGROUND && this.background ? (this.removeChild(this.background), this.background = this.background_n = void 0) : b == AVATAR_TYPE_FOREGROUND &&
        this.foreground && (this.removeChild(this.foreground), this.foreground = this.foreground_n = void 0);
      debug && console.log("[CPlayerGraphic.change] avatar type removed:", b)
    }
  };
  PlayerContainer.prototype.GetAvatars = function() {
    return [this.head_n, this.body_n, this.eyes_n, this.flag_n, this.background_n, this.foreground_n]
  };
  PlayerContainer.prototype.change_mobile = function(a) {
    this.avatar_x = (a = MOBILES[a]) ? a.player_x : 0;
    this.avatar_y = a ? a.player_y : -19;
    var b = this.flip ? -this.avatar_x : this.avatar_x,
      c = this.avatar_y;
    this.head && this.head.change_pos(b, c);
    this.body && this.body.change_pos(b, c);
    this.eyes && this.eyes.change_pos(b, c);
    this.flag && this.flag.change_pos(b, c);
    this.mobile && this.rotate_container.removeChild(this.mobile);
    this.ion && this.removeChild(this.ion);
    b = a.file && -1 == a.file.indexOf("/") ? "mobiles/" + a.file + ".png" : a.file;
    this.mobile =
      new AnimatedSprite(b, a.graphics, 0, 0, ANIMATIONS_FPS, this.flip, LOOP_NORMAL, 2);
    this.rotate_container.addChild(this.mobile);
    a.ion_file && (b = a.ion_file && -1 == a.ion_file.indexOf("/") ? "mobiles/" + a.ion_file + ".png" : a.ion_file, this.ion_container = new PIXI.DisplayObjectContainer, this.ion = new AnimatedSprite(b, a.ion_graphics, 0, 0, ANIMATIONS_FPS, this.flip, LOOP_NORMAL, 2), this.SetIon(90, 0, -200), this.ion_container.addChild(this.ion), this.addChild(this.ion_container));
    this.rotate_container.ApplyZIndex()
  };
  PlayerContainer.prototype.ChangePos = function(a, b, c, d) {
    this.target_x = a;
    this.target_y = b;
    this.speed = d || 500;
    c || (this.x = this.player_info.x = this.target_x, this.y = this.player_info.y = this.target_y)
  };
  PlayerContainer.prototype.ChangeLook = function(a, b) {
    this.target_scale_x = a == DIR_LEFT ? 1 : -1;
    this.look = a;
    b || (this.rotate_container.scale.x = this.target_scale_x)
  };
  PlayerContainer.prototype.ChangeBodyAngle = function(a) {
    this.body_angle = a;
    this.rotate_container.rotation = AngleToRad(a)
  };
  PlayerContainer.prototype.ChangeAngle = function(a) {
    this.angle && (this.angle.rotation = AngleToRad(180 + a))
  };
  PlayerContainer.prototype.SetIon = function(a, b, c, d) {
    void 0 != a && (this.ion_container.rotation = AngleToRad(-a));
    void 0 != b && (this.ion_container.target_x = b);
    void 0 != c && (this.ion_container.target_y = c);
    this.ion_speed = d || 1E3
  };
  PlayerContainer.prototype.Remove = function() {
    DragonClock.Remove(this);
    this.parent && this.parent.removeChild(this)
  };
  PlayerContainer.prototype.EffectGhost = function() {
    this.effect = "ghost";
    this.alpha = 0.5;
    this.player_info.alpha = 1
  };
  PlayerContainer.prototype.EffectDead = function() {
    this.effect = "dead"
  };
  PlayerContainer.prototype.EffectNone = function() {
    this.effect = void 0;
    this.alpha = 1;
    this.player_info.alpha = 1;
    this.rotate_container.rotation = 0
  };
  GRAPHICS_INDEX_WIDTH = 0;
  GRAPHICS_INDEX_HEIGHT = 1;
  GRAPHICS_INDEX_CENTER_X = 2;
  GRAPHICS_INDEX_CENTER_Y = 3;
  LOOP_ONCE = 0;
  LOOP_NORMAL = 1;
  LOOP_NORMAL_AND_REVERSE = 2;
  LOOP_SINGLE_FRAME = 3;
  LOOP_AVATAR = 4;
  LOOP_AVATAR_NO_REVERSE = 5;
  RANDOM_FACE_TURN_CHANCE = 6;

  function AnimatedSprite(a, b, c, d, e, f, h, k, m, n) {
    this.graphics = b;
    this.frames = b.length;
    this.loop_type = h;
    this.is_flip = f;
    this.frame_time = 1E3 / e;
    this.is_special = !1;
    this.pos_x = c;
    this.pos_y = d;
    this.z = k;
    this.anchor_x = this.anchor_y = this.max_h = this.max_w = this.total_elapsed_time = this.current_frame = 0;
    this.is_self_clock = m;
    this.is_half_size = n; - 1 == a.indexOf(":") && (a = STATIC_DIR2 + "images/" + a);
    a = PIXI.Texture.fromImage(a);
    c = this.textures = [];
    for (d = e = 0; d < b.length; d++) f = b[d][GRAPHICS_INDEX_HEIGHT], h = b[d][GRAPHICS_INDEX_WIDTH],
      n && (f /= 2, h /= 2), c.push(new PIXI.Texture(a, new PIXI.Rectangle(e, 0, h, f))), e += h + (n ? 0.5 : 1), h > this.max_w && (this.max_w = h), f > this.max_h && (this.max_h = f);
    PIXI.Sprite.call(this, c[0]);
    this.set_frame(0);
    m && DragonClock.Add(this)
  }
  AnimatedSprite.constructor = AnimatedSprite;
  AnimatedSprite.prototype = Object.create(PIXI.Sprite.prototype);
  AnimatedSprite.prototype.Update = function(a, b) {
    if (void 0 != this.move_speed) {
      var c = a * this.move_speed / 1E3,
        d;
      void 0 != this.target_pos_x && this.pos_x != this.target_pos_x && (this.pos_x = GetCloserToTargetValue(this.pos_x, c, this.target_pos_x), d = !0);
      void 0 != this.target_pos_y && this.pos_y != this.target_pos_y && (this.pos_y = GetCloserToTargetValue(this.pos_y, c, this.target_pos_y), d = !0);
      d && this._UpdatePos()
    }
    void 0 != this.rotate_speed && (c = a * this.rotate_speed / 1E3, void 0 != this.target_rotate && this.rotation != this.target_rotate &&
      (this.rotation = GetCloserToTargetValue(this.rotation, c, this.target_rotate)));
    if (!(1 >= this.frames) && (this.total_elapsed_time += a, c = floor(this.total_elapsed_time / this.frame_time), c != this.current_frame)) return this.current_frame = c, this.set_frame(c, b)
  };
  AnimatedSprite.prototype.set_frame = function(a, b) {
    if (1 >= this.frames) a = 0;
    else {
      var c;
      if (this.loop_type == LOOP_ONCE) {
        if (a >= this.frames) return this.Remove(), 9
      } else if (this.loop_type == LOOP_NORMAL) a %= this.frames;
      else if (this.loop_type == LOOP_NORMAL_AND_REVERSE) c = 2 * this.frames - 2, a %= c, a >= this.frames && (a = c - a);
      else if (this.loop_type == LOOP_AVATAR) {
        if (void 0 == b) {
          c = Math.floor(a / (this.frames - 2));
          if (void 0 == this.turn_cycle || c > this.turn_cycle) this.turn_cycle = random(c, c + RANDOM_FACE_TURN_CHANCE);
          this.is_special = c == this.turn_cycle
        } else this.is_special =
          b;
        var d = this.frames / 2;
        c = 2 * d - 2;
        this.is_special ? (a %= c, a >= d && (a = c - a)) : (a %= c, a >= d && (a = c - a), a += d)
      } else if (this.loop_type == LOOP_AVATAR_NO_REVERSE) {
        if (void 0 == b) {
          c = Math.floor(a / (this.frames - 2));
          if (void 0 == this.turn_cycle || c > this.turn_cycle) this.turn_cycle = random(c, c + RANDOM_FACE_TURN_CHANCE);
          this.is_special = c == this.turn_cycle
        } else this.is_special = b;
        d = this.frames / 2;
        a = this.is_special ? a % d : a % d + d
      }
    }
    void 0 == this.graphics[a] && warn("MISSING FRAME Frame " + a, ":", "frames:", this.frames, "loop_type:", this.loop_type, "graphics:",
      this.graphics, "this:", this);
    c = this.graphics[a][GRAPHICS_INDEX_CENTER_X];
    d = this.graphics[a][GRAPHICS_INDEX_CENTER_Y];
    this.center_x = this.is_flip ? c : -c;
    this.center_y = -d;
    this.setTexture(this.textures[a]);
    this.position.x = this.pos_x + this.center_x;
    this.position.y = this.pos_y + this.center_y;
    this._UpdatePos();
    this.scale.x = this.is_flip ? -1 : 1;
    this.is_half_size && (this.scale.x *= 2, this.scale.y = 2)
  };
  AnimatedSprite.prototype._UpdatePos = function() {
    var a = this.pos_x + this.center_x,
      b = this.pos_y + this.center_y;
    if (a != this.position.x || b != this.position.y)
      if (this.position.x = a, this.position.y = b, this.onChangePositionCallback) this.onChangePositionCallback(a, b)
  };
  AnimatedSprite.prototype.change_pos = AnimatedSprite.prototype.SetPosition = function(a, b) {
    this.pos_x = a + this.anchor_x;
    this.pos_y = b + this.anchor_y;
    this.set_frame(this.current_frame)
  };
  AnimatedSprite.prototype.Remove = function() {
    this.is_self_clock && DragonClock.Remove(this);
    this.parent && this.parent.removeChild(this)
  };
  AnimatedSprite.prototype.SetSpeed = function(a, b) {
    this.move_speed = a;
    this.rotate_speed = AngleToRad(b)
  };
  AnimatedSprite.prototype.MoveTo = function(a, b, c) {
    this.target_pos_x = a + this.anchor_x;
    this.target_pos_y = b + this.anchor_y;
    this.target_rotate = AngleToRad(c);
    a = RadToAngle(this.rotation);
    a < c - 180 ? this.rotation += 2 * Math.PI : a > c + 180 && (this.rotation -= 2 * Math.PI)
  };
  AnimatedSprite.prototype.SetAnchor = function(a, b) {
    this.anchor_x = a;
    this.anchor_y = b;
    this.anchor.x = a / this.max_w;
    this.anchor.y = b / this.max_h
  };
  AnimatedSprite.prototype.OnChangePosition = function(a) {
    this.onChangePositionCallback = a
  };

  function TextBubble(a, b, c, d) {
    PIXI.DisplayObjectContainer.call(this);
    c = c.replace(/<.*?>/g, "").replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&");
    this.text_sprite = new PIXI.Text(c, {
      font: "11px verdana, arial, sans-serif",
      stroke: 0,
      wordWrap: !0,
      wordWrapWidth: 300
    });
    c = this.text_sprite.width;
    var e = this.text_sprite.height,
      f = min(80, c / 2 + 0.01),
      h = 8;
    this.text_sprite.x = -f;
    this.text_sprite.y = -e - 2 * h;
    var k, m;
    1 == d ? (d = 15663086, k = 16711680, m = 4) : 2 == d ? (d = 16777181, k = 65280, m = 4) : (d = 16777215, k = 0, m = 1);
    var n = this.bubble_sprite =
      new PIXI.Graphics;
    1 < m && (n.beginFill(d), n.lineStyle(m, k), n.moveTo(-h, 0), n.lineTo(0.66 * -h, 0.66 * -h), n.lineTo(0, -h), n.lineTo(c, -h), n.lineTo(c + 0.66 * h, 0.66 * -h), n.lineTo(c + h, 0), n.lineTo(c + h, e), n.lineTo(c + 0.66 * h, e + 0.66 * h), n.lineTo(c, e + h), n.lineTo(f + 5, e + h), n.lineTo(f + 1, e + h + 5), n.lineTo(f - 5, e + h + 8), n.lineTo(f - 2, e + h + 3), n.lineTo(f - 1, e + h), n.lineTo(0, e + h), n.lineTo(0.66 * -h, e + 0.66 * h), n.lineTo(-h, e), n.lineTo(-h, 0), n.endFill());
    h -= 2;
    n.beginFill(d);
    n.lineStyle(1, 0);
    n.moveTo(-h, 0);
    n.lineTo(0.66 * -h, 0.66 * -h);
    n.lineTo(0, -h);
    n.lineTo(c, -h);
    n.lineTo(c + 0.66 * h, 0.66 * -h);
    n.lineTo(c + h, 0);
    n.lineTo(c + h, e);
    n.lineTo(c + 0.66 * h, e + 0.66 * h);
    n.lineTo(c, e + h);
    n.lineTo(f + 5, e + h);
    n.lineTo(f + 1, e + h + 5);
    n.lineTo(f - 5, e + h + 8);
    n.lineTo(f - 2, e + h + 3);
    n.lineTo(f - 1, e + h);
    n.lineTo(0, e + h);
    n.lineTo(0.66 * -h, e + 0.66 * h);
    n.lineTo(-h, e);
    n.lineTo(-h, 0);
    n.endFill();
    n.alpha = 0.9;
    n.x = -f;
    n.y = -e - 2 * (h + 2);
    this.addChild(n);
    this.addChild(this.text_sprite);
    this.time = 7E3;
    this.total_elapsed_time = 0;
    this.scale.x = this.scale.y = 0;
    this.x = a;
    this.y = b - 65;
    this.w = c;
    this.h = e;
    DragonClock.Add(this)
  }
  TextBubble.prototype = Object.create(PIXI.DisplayObjectContainer.prototype);
  TextBubble.prototype.constructor = TextBubble;
  TextBubble.prototype.Update = function(a) {
    a = this.total_elapsed_time += a;
    if (a >= this.time) this.Remove();
    else {
      var b = this.time - 2E3,
        c = 350 <= a ? 1 : a / 350;
      this.scale.y = c;
      this.scale.x = c;
      this.rotation = AngleToRad(15 * (1 - c));
      this.alpha = a <= b ? 1 : 1 - (a - b) / 2E3
    }
  };
  TextBubble.prototype.Remove = function() {
    this.was_removed || (DragonClock.Remove(this), this.text_sprite.destroy(!0), this.removeChild(this.bubble_sprite), this.removeChild(this.text_sprite), this.parent && this.parent.removeChild(this), this.was_removed = !0, delete this.bubble_sprite, delete this.text_sprite)
  };
  Object.freeze(TextBubble.prototype);
  Object.freeze(TextBubble);

  function Thor() {
    PIXI.DisplayObjectContainer.call(this);
    this.thor = new AnimatedSprite("thor.png", THOR_GRAPHICS, 680, 0, ANIMATIONS_FPS, !1, LOOP_NORMAL, 1, !0);
    this.thor.SetAnchor(THOR_GRAPHICS[0][2], THOR_GRAPHICS[0][3]);
    this.thor.SetSpeed(50, 90);
    this.thor.OnChangePosition(this.ChangedPosition.bind(this));
    this.addChild(this.thor);
    this.lvl_sprite = new PIXI.Text("", {
      font: "14px verdana, arial, sans-serif",
      stroke: 0,
      fill: "#f73918",
      strokeThickness: 2
    });
    this.dmg_sprite = new PIXI.Text("", {
      font: "12px verdana, arial, sans-serif",
      stroke: 0,
      fill: "#ff5a42",
      strokeThickness: 2
    });
    this.SetLevelAndDamage(1, 0);
    this.addChild(this.lvl_sprite);
    this.addChild(this.dmg_sprite);
    this.ChangedPosition(680, 0)
  }
  Thor.prototype = Object.create(PIXI.DisplayObjectContainer.prototype);
  Thor.prototype.constructor = Thor;
  Thor.prototype.MoveTo = function(a, b, c, d) {
    d && (this.thor.pos_x = this.thor.x = a, this.thor.pos_y = this.thor.y = b + 250);
    this.thor.MoveTo(a, b, c)
  };
  Thor.prototype.SetLevelAndDamage = function(a, b) {
    this.lvl_sprite.setText("Lv. " + a);
    this.dmg_sprite.setText("" + b)
  };
  Thor.prototype.ChangedPosition = function(a, b) {
    this.lvl_sprite.x = a + 70 - this.lvl_sprite.width;
    this.lvl_sprite.y = b + 30;
    this.dmg_sprite.x = a + 70 - this.dmg_sprite.width;
    this.dmg_sprite.y = b + 47
  };
})()
